(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`d6ce8072-85d8-4fcb-a2b6-70779487a21d`,e._sentryDebugIdIdentifier=`sentry-dbid-d6ce8072-85d8-4fcb-a2b6-70779487a21d`)})()}catch{}import{E as e,It as t,P as n,T as r,Z as i,et as a}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as o}from"./_MapCache-DjbOQyB7.js";import{wi as s}from"./src-CppJvwzX.js";import"./sanitize-html-K63Olwt_.js";import{t as c,yr as l}from"./users.store-pCkD7Zo0.js";import{rs as u,ul as d}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./sso.store-Dd63iqNy.js";import{t as f}from"./AuthView-O45Jsyy-.js";var p=n({__name:`ChangePasswordView`,setup(n){let d=c(),p=o(),m=l(),h=s(),g=t(``),_=t(!1),v=t(null),y=e=>typeof e==`string`?e===g.value?!1:{messageKey:`auth.changePassword.passwordsMustMatchError`}:!1,b=()=>!h.currentRoute.value.query.token||typeof h.currentRoute.value.query.token!=`string`?null:h.currentRoute.value.query.token,x=()=>h.currentRoute.value.query.mfaEnabled?h.currentRoute.value.query.mfaEnabled===`true`:null,S=async e=>{try{_.value=!0;let t=b();if(t){let n={token:t,password:g.value,...e.mfaCode&&{mfaCode:e.mfaCode}};await d.changePassword(n),m.showMessage({type:`success`,title:p.baseText(`auth.changePassword.passwordUpdated`),message:p.baseText(`auth.changePassword.passwordUpdatedMessage`)}),await h.push({name:u.SIGNIN})}else m.showError(Error(p.baseText(`auth.validation.missingParameters`)),p.baseText(`auth.changePassword.error`))}catch(e){m.showError(e,p.baseText(`auth.changePassword.error`))}_.value=!1},C=e=>{e.name===`password`&&typeof e.value==`string`&&(g.value=e.value)};return i(async()=>{let e={title:p.baseText(`auth.changePassword`),buttonText:p.baseText(`auth.changePassword`),redirectText:p.baseText(`auth.signin`),redirectLink:`/signin`,inputs:[{name:`password`,properties:{label:p.baseText(`auth.newPassword`),type:`password`,required:!0,validationRules:[{name:`DEFAULT_PASSWORD_RULES`}],infoText:p.baseText(`auth.defaultPasswordRequirements`),autocomplete:`new-password`,capitalize:!0}},{name:`password2`,properties:{label:p.baseText(`auth.changePassword.reenterNewPassword`),type:`password`,required:!0,validators:{TWO_PASSWORDS_MATCH:{validate:y}},validationRules:[{name:`TWO_PASSWORDS_MATCH`}],autocomplete:`new-password`,capitalize:!0}}]},t=b();x()&&e.inputs.push({name:`mfaCode`,initialValue:``,properties:{required:!0,label:p.baseText(`mfa.code.input.label`),placeholder:p.baseText(`mfa.code.input.placeholder`),maxlength:6,capitalize:!0,validateOnBlur:!0}}),v.value=e;try{if(!t)throw Error(p.baseText(`auth.changePassword.missingTokenError`));await d.validatePasswordToken({token:t})}catch(e){m.showError(e,p.baseText(`auth.changePassword.tokenValidationError`)),h.replace({name:u.SIGNIN})}}),(t,n)=>v.value?(a(),r(f,{key:0,form:v.value,"form-loading":_.value,onSubmit:S,onUpdate:C},null,8,[`form`,`form-loading`])):e(``,!0)}});export{p as default};
//# sourceMappingURL=ChangePasswordView-DLS-lwzU.js.map