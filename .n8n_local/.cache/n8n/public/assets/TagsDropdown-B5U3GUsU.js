(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`3c84c7c2-2faf-4149-9b70-99dd9f2b6c5c`,e._sentryDebugIdIdentifier=`sentry-dbid-3c84c7c2-2faf-4149-9b70-99dd9f2b6c5c`)})()}catch{}import{C as e,Cn as t,D as n,E as r,G as i,Gt as a,It as o,J as s,M as c,P as l,T as u,Z as d,_ as f,_t as p,bt as m,et as h,h as g,it as _,vn as v,w as y}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{g as b,yt as x}from"./_MapCache-DjbOQyB7.js";import{Ui as S,ft as C,pt as w}from"./src-CppJvwzX.js";import{Xa as T,yr as E,zr as D}from"./users.store-pCkD7Zo0.js";var O={key:0},k={key:1},A={key:2},j=`__manage`,M=`__create`,N=l({__name:`TagsDropdown`,props:{placeholder:{default:``},modelValue:{default:()=>[]},eventBus:{default:null},allTags:{},isLoading:{type:Boolean},tagsById:{},createEnabled:{type:Boolean,default:!0},manageEnabled:{type:Boolean,default:!0},createTag:{type:Function,default:void 0},multipleLimit:{default:0},createTagI18nKey:{default:`tagsDropdown.createTag`}},emits:[`update:modelValue`,`esc`,`blur`,`manage-tags`],setup(l,{emit:T}){let N=x(),{showError:P}=E(),F=l,I=T,L=o(),R=o(),z=o(),B=o(``),V=o(!1),H=o(!1),U=o(),W=D(),G=e(()=>F.allTags.filter(e=>e&&e.name.toLowerCase().includes(B.value.toLowerCase()))),K=e(()=>F.modelValue.filter(e=>F.tagsById[e])),q=e(()=>({"tags-container":!0,focused:V.value})),J=e(()=>[`tags-dropdown`,`tags-dropdown-${W}`,F.createEnabled?`tags-dropdown-create-enabled`:``,F.manageEnabled?`tags-dropdown-manage-enabled`:``].join(` `));p(()=>F.allTags,()=>{F.modelValue.length!==K.value.length&&I(`update:modelValue`,K.value)}),d(()=>{let e=L.value?.innerSelect;if(e){let t=e.$refs.input;t&&(t.setAttribute(`maxlength`,`24`),t.addEventListener(`keydown`,e=>{let t=e;t.key===`Escape`?I(`esc`):t.key===`Enter`&&B.value.length===0&&(H.value=!0,I(`blur`),typeof L.value?.blur==`function`&&L.value.blur())}))}F.eventBus?.on(`focus`,Y)}),s(()=>{F.eventBus?.off(`focus`,Y)});function Y(){$(),Q()}function X(e=``){B.value=e,i(()=>Q())}async function Z(){if(!F.createTag)return;let e=B.value;try{let t=await F.createTag(e);I(`update:modelValue`,[...F.modelValue,t.id]),B.value=``}catch(t){P(t,N.baseText(`tagsDropdown.showError.title`),N.baseText(`tagsDropdown.showError.message`,{interpolate:{name:e}}))}}function ee(e){let t=e.find(e=>e===j),n=e.find(e=>e===M);t?(B.value=``,I(`manage-tags`),I(`blur`)):n?Z():setTimeout(()=>{H.value||I(`update:modelValue`,e),H.value=!1},0)}function Q(){z.value?.$el?z.value.$el.dispatchEvent(new Event(`mouseenter`)):R.value?.[0]?.$el&&R.value[0].$el.dispatchEvent(new Event(`mouseenter`))}function $(){L.value&&(L.value.focusOnInput(),V.value=!0)}function te(e){e?V.value=!0:(B.value=``,V.value=!1)}function ne(){i(()=>{$()})}return b(U,()=>{I(`blur`)},{ignore:[`.tags-dropdown-${W}`,`#tags-manager-modal`],detectIframe:!0}),(e,i)=>(h(),n(`div`,{ref_key:`container`,ref:U,class:v(q.value),onKeydown:i[0]||=g(()=>{},[`stop`])},[c(a(C),{ref_key:`selectRef`,ref:L,teleported:!0,"model-value":K.value,loading:l.isLoading,placeholder:l.placeholder,"filter-method":X,filterable:``,multiple:``,"multiple-limit":F.multipleLimit,"reserve-keyword":!1,"loading-text":`...`,"popper-class":J.value,"data-test-id":`tags-dropdown`,"onUpdate:modelValue":ee,onVisibleChange:te,onRemoveTag:ne},{default:m(()=>[l.createEnabled&&G.value.length===0&&B.value?(h(),u(a(w),{key:M,ref_key:`createRef`,ref:z,value:M,class:`ops`},{default:m(()=>[c(a(S),{icon:`circle-plus`}),y(`span`,null,t(a(N).baseText(F.createTagI18nKey,{interpolate:{filter:B.value}})),1)]),_:1})):G.value.length===0?(h(),u(a(w),{key:1,value:`message`,disabled:``},{default:m(()=>[l.createEnabled?(h(),n(`span`,O,t(a(N).baseText(`tagsDropdown.typeToCreateATag`)),1)):l.allTags.length>0?(h(),n(`span`,k,t(a(N).baseText(`tagsDropdown.noMatchingTagsExist`)),1)):(h(),n(`span`,A,t(a(N).baseText(`tagsDropdown.noTagsExist`)),1))]),_:1})):r(``,!0),(h(!0),n(f,null,_(G.value,(e,t)=>(h(),u(a(w),{key:e.id+`_`+t,ref_for:!0,ref_key:`tagRefs`,ref:R,value:e.id,label:e.name,class:`tag`,"data-test-id":`tag`},null,8,[`value`,`label`]))),128)),l.manageEnabled?(h(),u(a(w),{key:j,value:j,class:`ops manage-tags`},{default:m(()=>[c(a(S),{icon:`cog`}),y(`span`,null,t(a(N).baseText(`tagsDropdown.manageTags`)),1)]),_:1})):r(``,!0)]),_:1},8,[`model-value`,`loading`,`placeholder`,`multiple-limit`,`popper-class`])],34))}});export{N as t};
//# sourceMappingURL=TagsDropdown-B5U3GUsU.js.map