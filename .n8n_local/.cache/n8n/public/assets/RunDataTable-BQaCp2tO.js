(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`6b5b31e2-91f9-4673-8a7d-ac86ec8b9769`,e._sentryDebugIdIdentifier=`sentry-dbid-6b5b31e2-91f9-4673-8a7d-ac86ec8b9769`)})()}catch{}import{C as e,Cn as t,D as n,E as r,Gt as i,It as a,M as o,P as s,T as c,Z as l,_ as u,_t as d,bn as f,bt as p,et as m,it as h,j as g,mt as ee,p as _,vn as v,w as y,xt as b}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as x,yt as S}from"./_MapCache-DjbOQyB7.js";import{Mi as C,Oi as w,Q as te,Ui as T,k as ne}from"./src-CppJvwzX.js";import{t as E}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Bt as re,Lt as ie,Or as D,dt as ae,ln as O,r as k,s as oe,ua as se,xr as ce,yr as A}from"./users.store-pCkD7Zo0.js";import{as as j}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{N as le}from"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import{t as ue}from"./Draggable-YWqutRc8.js";import{t as M}from"./TextWithHighlights-FXXrxJMD.js";import{n as de,t as fe}from"./useTelemetryContext-Dq1_6uNp.js";import"./dateFormatter-C82w-7IH.js";import{t as pe}from"./useExecutionHelpers-mcaelfkG.js";var N=D(),P=[`src`,`alt`],F=1048576,me=E(s({__name:`BinaryEntryDataTable`,props:{value:{},depth:{}},setup(a){let s=a,c=oe(),l=k(),u=S(),d=e(()=>{if(!h.value)return!1;let e=s.value.mimeType,t=Number(s.value.bytes);return(e?.startsWith(`image/`)??!1)&&(t===void 0?!1:t<F)}),p=e(()=>{let{fileName:e,fileExtension:t}=s.value,n=e??`file`;return n?.includes(`.`)?n:t?`${n}.${t}`:n}),h=e(()=>{let{id:e,mimeType:t}=s.value;return c.getBinaryUrl(e,`download`,p.value,t??``)}),g=e(()=>{let{mimeType:e,fileSize:t}=s.value;return e+(t?`, ${t}`:``)}),ee=async()=>{try{let e=await fetch(h.value);if(!e.ok)throw Error(`Error downloading file`);(0,N.saveAs)(await e.blob(),p.value)}catch{A().showMessage({title:u.baseText(`runData.downloadBinaryData.error.title`),message:u.baseText(`runData.downloadBinaryData.error.message`),type:`error`})}},_=()=>{l.openModalWithData({name:j,data:{binaryData:s.value}})},b=e(()=>({marginLeft:s.depth?`${s.depth*15}px`:`0`})),x=e(()=>s.value.mimeType?.startsWith(`text/`)??!1?`file-text`:`file`);return(e,a)=>(m(),n(`div`,{class:v(e.$style.container),style:f(b.value)},[y(`div`,{class:v(e.$style.wrapper),onClick:_},[d.value?(m(),n(`img`,{key:0,src:h.value,class:v(e.$style.imagePreview),alt:p.value||`Image preview`},null,10,P)):(m(),n(`div`,{key:1,class:v(e.$style.iconWrapper)},[o(i(T),{icon:x.value,size:`xlarge`},null,8,[`icon`])],2))],2),y(`div`,{class:v(e.$style.info)},[y(`div`,{class:v(e.$style.filename),onClick:_},t(p.value),3),g.value?(m(),n(`div`,{key:0,class:v(e.$style.meta)},t(g.value),3)):r(``,!0)],2),y(`button`,{class:v(e.$style.download),onClick:ee},[o(i(T),{icon:`download`,size:`large`})],2)],6))}}),[[`__cssModules`,{$style:{container:`_container_6ylyr_125`,download:`_download_6ylyr_139`,wrapper:`_wrapper_6ylyr_143`,iconWrapper:`_iconWrapper_6ylyr_155`,imagePreview:`_imagePreview_6ylyr_165`,info:`_info_6ylyr_172`,filename:`_filename_6ylyr_182`,meta:`_meta_6ylyr_193`}}]]),he=[`data-row`],ge=[`data-row`],_e={key:0},ve=[`width`],ye=[`data-test-id`],be=[`data-row`],xe=[`data-row`,`data-col`],Se={key:1},I=40,L=E(s({__name:`RunDataTable`,props:{node:{},inputData:{},distanceFromActive:{},pageOffset:{},runIndex:{default:0},outputIndex:{default:0},totalRuns:{default:0},mappingEnabled:{type:Boolean,default:!1},hasDefaultHoverState:{type:Boolean,default:!1},search:{default:``},headerBgColor:{default:`base`},compact:{type:Boolean,default:!1},disableHoverHighlight:{type:Boolean,default:!1},collapsingColumnName:{}},emits:[`activeRowChanged`,`displayModeChange`,`mounted`,`collapsingColumnChanged`],setup(s,{emit:f}){let E=s,D=f,k=ce(),A=ee(`tableRef`),j=a(-1),N=a(!1),P=a(!1),F=a(null),L=a(null),R=a(-1),z=a(null),Ce=a(I),B=a(!1),V=a(),H=a(),U=re(),W=oe(),G=S(),we=ie(),Te=fe(),{trackOpeningRelatedExecution:Ee,resolveRelatedExecutionUrl:De}=pe(),{hoveringItem:K,focusedMappableInput:Oe,highlightDraggables:ke}=le(U),Ae=e(()=>U.canDraggableDrop),je=e(()=>U.draggableStickyPos),Me=e(()=>W.workflowExecutionPairedItemMappings),q=e(()=>Ye(E.inputData)),J=e(()=>E.collapsingColumnName?q.value.columns.indexOf(E.collapsingColumnName):-1);l(()=>{if(q.value?.columns&&V.value){let e=V.value.$refs.wrapper;e&&D(`mounted`,{avgRowHeight:e.offsetHeight/q.value.data.length})}});function Y(e){if(E.disableHoverHighlight)return!1;if(e===z.value)return!0;let t=E.pageOffset+e;if(t===0&&!K.value&&E.hasDefaultHoverState&&E.distanceFromActive===1)return!0;let n=O(E.node?.name??``,E.runIndex||0,E.outputIndex||0,t);if(!K.value||!Me.value[n])return!1;let r=O(K.value.nodeName,K.value.runIndex,K.value.outputIndex,K.value.itemIndex);return Me.value[n].has(r)}function Ne(e){return e===z.value?!0:z.value===null?e===0:!1}function X(e){let t=e.target,n=t.dataset.col,r=n?parseInt(n,10):NaN;if(isNaN(r)||(R.value=r,t&&E.mappingEnabled&&(j.value=r)),t){let e=t.dataset.row;e&&!isNaN(parseInt(e,10))&&(z.value=parseInt(e,10),D(`activeRowChanged`,E.pageOffset+z.value))}}function Z(){j.value=-1,z.value=null,D(`activeRowChanged`,null),R.value=-1}function Pe(e,t){L.value=Q(e,t)}function Fe(){L.value=null}function Ie(e,t){let n=Q(e,t);return L.value===n}function Le(e){return E.node?ae({nodeName:E.node.name,distanceFromActive:E.distanceFromActive,path:[e],binaryMode:W.workflow.settings?.binaryMode}):``}function Re(e){return e?e.dataset.name:``}function ze(e,t){let n=e[e.length-1];return typeof n==`string`?n:e.length>1?`${e[e.length-2]}[${n}]`:`${q.value.columns[t]}[${n}]`}function Q(e,t){if(!E.node)return``;let n=q.value.columns[t];return ae({nodeName:E.node.name,distanceFromActive:E.distanceFromActive,path:[n,...e],binaryMode:W.workflow.settings?.binaryMode})}function Be(e){return e===``||Array.isArray(e)&&e.length===0||typeof e==`object`&&!!e&&Object.keys(e).length===0||e==null}function $(e){return e===``?G.baseText(`runData.emptyString`):typeof e==`string`?e:Array.isArray(e)&&e.length===0?G.baseText(`runData.emptyArray`):typeof e==`object`&&e&&Object.keys(e).length===0?G.baseText(`runData.emptyObject`):e==null?`${e}`:e===!0||e===!1||typeof e==`number`?e.toString():JSON.stringify(e)}function Ve(e,t){P.value=!0,U.draggableStartDragging({type:`mapping`,data:t??``,dimensions:e?.getBoundingClientRect()??null}),U.resetMappingTelemetry()}function He(e,t){e?.dataset.value&&(F.value=e.dataset.value),Ve(e,t)}function Ue(e){F.value=null,Ge(e.dataset.name??``,`tree`,e.dataset.depth??`0`)}function We(e,t){if(F.value)return F.value===Q(e,t)}function Ge(e,t,n=`0`){U.draggableStopDragging(),setTimeout(()=>{let r=U.mappingTelemetry,i={src_node_type:E.node.type,src_field_name:e,src_nodes_back:E.distanceFromActive,src_run_index:E.runIndex,src_runs_total:E.totalRuns,src_field_nest_level:parseInt(n,10),src_view:`table`,src_element:t,success:!1,view_shown:Te.view_shown,...r};k.run(`runDataTable.onDragEnd`,i),we.track(`User dragged data for mapping`,i)},1e3)}function Ke(e){return typeof e!=`object`||!e||Array.isArray(e)&&e.length===0||typeof e==`object`&&Object.keys(e).length===0}function qe(e){return!Ke(e)}function Je(e){return q.value.hasJson[q.value.columns[e]]}function Ye(e){let t=[],n=[],r,i,a,o={hasExecutionIds:!1,data:[]},s={};return e.forEach(e=>{if(!e.hasOwnProperty(`json`))return;a=e.json,i=[];let c=Object.keys(a||{});c.length>I?(B.value=!0,r=c.slice(0,I)):r=c,e.metadata?.subExecution?(o.data.push(e.metadata),o.hasExecutionIds=!0):o.data.push(void 0),n.forEach(e=>{a.hasOwnProperty(e)?(i.push(a[e]),r.splice(r.indexOf(e),1),s[e]=s[e]||typeof a[e]==`object`&&Object.keys(a[e]??{}).length>0||!1):i.push(void 0)}),r.forEach(e=>{n.push(e),i.push(a[e]),s[e]=s[e]||typeof a[e]==`object`&&Object.keys(a[e]??{}).length>0||!1}),t.push(i)}),t.forEach(e=>{n.length>e.length&&e.push(...Array(n.length-e.length))}),{hasJson:s,columns:n,data:t,metadata:o}}function Xe(){D(`displayModeChange`,`json`)}function Ze(e){D(`collapsingColumnChanged`,J.value===e?null:q.value.columns[e]??null)}return d(Oe,e=>{setTimeout(()=>{N.value=!!Oe.value},e?300:150)}),d([J,A],([e,t])=>{if(e===-1){H.value=void 0;return}t!==null&&(H.value=[...t.querySelectorAll(`thead tr th`)].map(e=>e instanceof HTMLElement?e.getBoundingClientRect().width:0))},{immediate:!0,flush:`post`}),(e,a)=>(m(),n(`div`,{class:v([e.$style.dataDisplay,{[e.$style.highlight]:i(ke),[e.$style.lightHeader]:s.headerBgColor===`light`,[e.$style.compact]:E.compact,[e.$style.hasCollapsingColumn]:H.value!==void 0}])},[q.value.columns&&q.value.columns.length===0?(m(),n(`table`,{key:0,class:v(e.$style.table)},[y(`thead`,null,[y(`tr`,null,[q.value.metadata.hasExecutionIds?(m(),n(`th`,{key:0,class:v(e.$style.executionLinkRowHeader)},null,2)):r(``,!0),y(`th`,{class:v(e.$style.emptyCell)},null,2),y(`th`,{class:v(e.$style.tableRightMargin)},null,2)])]),y(`tbody`,null,[(m(!0),n(u,null,h(q.value.data,(a,s)=>(m(),n(`tr`,{key:s,class:v({[e.$style.hoveringRow]:Y(s)})},[q.value.metadata.hasExecutionIds?(m(),n(`td`,{key:0,"data-row":s,class:v(e.$style.executionLinkCell),onMouseenter:X,onMouseleave:Z},[q.value.metadata.data[s]?(m(),c(i(w),{key:0,content:i(G).baseText(`runData.table.viewSubExecution`,{interpolate:{id:`${q.value.metadata.data[s]?.subExecution.executionId}`}}),placement:`left`,"hide-after":0},{default:p(()=>[b(o(i(C),{variant:`subtle`,icon:`external-link`,"data-test-id":`debug-sub-execution`,size:`xsmall`,target:`_blank`,href:i(De)(q.value.metadata.data[s]),onClick:e=>i(Ee)(q.value.metadata.data[s],`table`)},null,8,[`href`,`onClick`]),[[_,Ne(s)]])]),_:2},1032,[`content`])):r(``,!0)],42,he)):r(``,!0),y(`td`,{"data-row":s,"data-col":0,onMouseenter:X,onMouseleave:Z},[o(i(te),null,{default:p(()=>[g(t(i(G).baseText(`runData.emptyItemHint`)),1)]),_:1})],40,ge),y(`td`,{class:v(e.$style.tableRightMargin)},null,2)],2))),128))])],2)):(m(),n(`table`,{key:1,ref_key:`tableRef`,ref:A,class:v(e.$style.table)},[H.value?(m(),n(`colgroup`,_e,[(m(!0),n(u,null,h(H.value,(e,t)=>(m(),n(`col`,{key:t,width:e},null,8,ve))),128))])):r(``,!0),y(`thead`,null,[y(`tr`,null,[q.value.metadata.hasExecutionIds?(m(),n(`th`,{key:0,class:v(e.$style.executionLinkRowHeader)},null,2)):r(``,!0),(m(!0),n(u,null,h(q.value.columns||[],(c,l)=>(m(),n(`th`,{key:c,class:v({[e.$style.isCollapsingColumn]:J.value===l,[e.$style.isHoveredColumn]:R.value===l})},[o(i(w),{placement:`bottom-start`,disabled:!s.mappingEnabled,"show-after":1e3},{content:p(()=>[y(`div`,null,[a[0]||=y(`img`,{src:`/static/data-mapping-gif.gif`},null,-1),g(` `+t(i(G).baseText(`dataMapping.dragColumnToFieldHint`)),1)])]),default:p(()=>[o(ue,{type:`mapping`,data:Le(c),disabled:!s.mappingEnabled,"can-drop":Ae.value,"sticky-position":je.value,onDragstart:Ve,onDragend:e=>Ge(e?.textContent??``,`column`)},{preview:p(({canDrop:e})=>[o(de,{html:i(se)(c,16,2),"can-drop":e},null,8,[`html`,`can-drop`])]),default:p(({isDragging:t})=>[y(`div`,{class:v({[e.$style.header]:!0,[e.$style.draggableHeader]:s.mappingEnabled,[e.$style.activeHeader]:(l===j.value||N.value)&&s.mappingEnabled,[e.$style.draggingHeader]:t})},[o(M,{content:$(c||``),search:s.search},null,8,[`content`,`search`]),o(i(w),{content:i(G).baseText(`dataMapping.tableView.columnCollapsing.tooltip`),disabled:s.mappingEnabled||J.value===l},{default:p(()=>[o(i(C),{variant:`ghost`,class:v(e.$style.collapseColumnButton),size:`xsmall`,icon:J.value===l?`chevrons-up-down`:`chevrons-down-up`,"aria-label":i(G).baseText(`dataMapping.tableView.columnCollapsing`),onClick:e=>Ze(l)},null,8,[`class`,`icon`,`aria-label`,`onClick`])]),_:2},1032,[`content`,`disabled`]),s.mappingEnabled?(m(),n(`div`,{key:0,class:v(e.$style.dragButton)},[o(i(T),{icon:`grip-vertical`})],2)):r(``,!0)],2)]),_:2},1032,[`data`,`disabled`,`can-drop`,`sticky-position`,`onDragend`])]),_:2},1032,[`disabled`])],2))),128)),B.value?(m(),n(`th`,{key:1,class:v(e.$style.header)},[o(i(w),{placement:`bottom-end`},{content:p(()=>[y(`div`,null,[o(i(x),{tag:`span`,keypath:`dataMapping.tableView.tableColumnsExceeded.tooltip`,scope:`global`},{columnLimit:p(()=>[g(t(Ce.value),1)]),link:p(()=>[y(`a`,{onClick:Xe},t(i(G).baseText(`dataMapping.tableView.tableColumnsExceeded.tooltip.link`)),1)]),_:1})])]),default:p(()=>[y(`span`,null,[o(i(T),{class:v(e.$style.warningTooltip),icon:`triangle-alert`},null,8,[`class`]),g(` `+t(i(G).baseText(`dataMapping.tableView.tableColumnsExceeded`)),1)])]),_:1})],2)):r(``,!0),y(`th`,{class:v(e.$style.tableRightMargin)},null,2)])]),o(ue,{ref_key:`draggableRef`,ref:V,tag:`tbody`,type:`mapping`,"target-data-key":`mappable`,disabled:!s.mappingEnabled,onDragstart:He,onDragend:Ue},{preview:p(({canDrop:e,el:t})=>[o(de,{html:i(se)(Re(t)||``,16,2),"can-drop":e},null,8,[`html`,`can-drop`])]),default:p(()=>[(m(!0),n(u,null,h(q.value.data,(t,a)=>(m(),n(`tr`,{key:a,class:v({[e.$style.hoveringRow]:Y(a)}),"data-test-id":Y(a)?`hovering-item`:void 0},[q.value.metadata.hasExecutionIds?(m(),n(`td`,{key:0,"data-row":a,class:v(e.$style.executionLinkCell),onMouseenter:X,onMouseleave:Z},[q.value.metadata.data[a]?(m(),c(i(w),{key:0,content:i(G).baseText(`runData.table.viewSubExecution`,{interpolate:{id:`${q.value.metadata.data[a]?.subExecution.executionId}`}}),placement:`left`,"hide-after":0},{default:p(()=>[b(o(i(C),{variant:`subtle`,icon:`external-link`,"data-test-id":`debug-sub-execution`,size:`xsmall`,target:`_blank`,href:i(De)(q.value.metadata.data[a]),onClick:e=>i(Ee)(q.value.metadata.data[a],`table`)},null,8,[`href`,`onClick`]),[[_,Ne(a)]])]),_:2},1032,[`content`])):r(``,!0)],42,be)):r(``,!0),(m(!0),n(u,null,h(t,(t,l)=>(m(),n(`td`,{key:l,"data-row":a,"data-col":l,class:v([Je(l)?e.$style.minColWidth:e.$style.limitColWidth,J.value===l?e.$style.isCollapsingColumn:``]),onMouseenter:X,onMouseleave:Z},[Ke(t)?(m(),c(M,{key:0,content:$(t),search:s.search,class:v({[e.$style.value]:!0,[e.$style.empty]:Be(t)})},null,8,[`content`,`search`,`class`])):qe(t)?(m(),c(i(ne),{key:1,"node-class":e.$style.nodeClass,value:t},{label:p(({label:t,path:n})=>[o(M,{"data-target":`mappable`,class:v({[e.$style.hoveringKey]:s.mappingEnabled&&Ie(n,l),[e.$style.draggingKey]:We(n,l),[e.$style.dataKey]:!0,[e.$style.mappable]:s.mappingEnabled}),content:t||i(G).baseText(`runData.unnamedField`),search:s.search,"data-name":ze(n,l),"data-value":Q(n,l),"data-depth":n.length,onMouseenter:()=>Pe(n,l),onMouseleave:Fe},null,8,[`class`,`content`,`search`,`data-name`,`data-value`,`data-depth`,`onMouseenter`])]),binary:p(({value:e})=>[o(me,{value:e},null,8,[`value`])]),value:p(({value:t})=>[o(M,{content:$(t),search:s.search,class:v({[e.$style.nestedValue]:!0,[e.$style.empty]:Be(t)})},null,8,[`content`,`search`,`class`])]),_:2},1032,[`node-class`,`value`])):r(``,!0)],42,xe))),128)),B.value?(m(),n(`td`,Se)):r(``,!0),y(`td`,{class:v(e.$style.tableRightMargin)},null,2)],10,ye))),128))]),_:1},8,[`disabled`])],2))],2))}}),[[`__cssModules`,{$style:{dataDisplay:`_dataDisplay_1ms2m_125`,compact:`_compact_1ms2m_137`,table:`_table_1ms2m_141`,lightHeader:`_lightHeader_1ms2m_158`,tableRightMargin:`_tableRightMargin_1ms2m_161`,hasCollapsingColumn:`_hasCollapsingColumn_1ms2m_196`,isCollapsingColumn:`_isCollapsingColumn_1ms2m_199`,nodeClass:`_nodeClass_1ms2m_228`,emptyCell:`_emptyCell_1ms2m_232`,header:`_header_1ms2m_236`,draggableHeader:`_draggableHeader_1ms2m_248`,dragButton:`_dragButton_1ms2m_252`,highlight:`_highlight_1ms2m_256`,draggingHeader:`_draggingHeader_1ms2m_260`,activeHeader:`_activeHeader_1ms2m_265`,dataKey:`_dataKey_1ms2m_276`,value:`_value_1ms2m_285`,nestedValue:`_nestedValue_1ms2m_289 _value_1ms2m_285`,mappable:`_mappable_1ms2m_294`,empty:`_empty_1ms2m_232`,limitColWidth:`_limitColWidth_1ms2m_303`,minColWidth:`_minColWidth_1ms2m_307`,hoveringKey:`_hoveringKey_1ms2m_311`,draggingKey:`_draggingKey_1ms2m_315`,hoveringRow:`_hoveringRow_1ms2m_331`,warningTooltip:`_warningTooltip_1ms2m_336`,executionLinkCell:`_executionLinkCell_1ms2m_340`,executionLinkRowHeader:`_executionLinkRowHeader_1ms2m_344`,collapseColumnButton:`_collapseColumnButton_1ms2m_348`,isHoveredColumn:`_isHoveredColumn_1ms2m_355`}}]]);export{L as default};
//# sourceMappingURL=RunDataTable-BQaCp2tO.js.map