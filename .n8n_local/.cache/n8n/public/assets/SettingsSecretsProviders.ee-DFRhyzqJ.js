(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`3f53ca48-9649-4191-bae4-481b39a76e01`,e._sentryDebugIdIdentifier=`sentry-dbid-3f53ca48-9649-4191-bae4-481b39a76e01`)})()}catch{}import{C as e,Cn as t,D as n,E as r,Gt as i,It as a,M as o,P as s,Q as c,T as l,Vt as u,Z as d,_ as f,bt as p,et as m,it as h,j as g,k as _,st as v,vn as y,w as b,xt as x}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as S,yt as C}from"./_MapCache-DjbOQyB7.js";import{At as w,Et as T,Hi as E,Oi as D,Pi as O,Tt as k,Ui as A,Vi as j,bt as M,gi as N,zi as P}from"./src-CppJvwzX.js";import{t as F}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Di as I,Gt as L,Jr as R,_r as z,fn as B,r as V,yr as H}from"./users.store-pCkD7Zo0.js";import{Es as U,oo as W,us as G}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as ee}from"./usePageRedirectionHelper-BoF8hzbN.js";import{n as K,t as q}from"./ProjectIcon-D-HRIqn6.js";import{t as J}from"./SecretsProviderImage.ee-Ds8eHg9b.js";import{t as Y}from"./useSecretsProvidersList.ee-COKc7Sm2.js";var X={"data-test-id":`secrets-provider-display-name`},Z={"data-test-id":`secrets-provider-secrets-count`},Q={"data-test-id":`secrets-provider-created-at`},te={key:1},ne=F(s({__name:`SecretsProviderConnectionCard.ee`,props:{provider:{},providerTypeInfo:{},project:{},canUpdate:{type:Boolean}},emits:[`edit`,`share`,`delete`],setup(a,{emit:s}){let c=C(),d=z(),f=a,h=s,S=u(f,`provider`),T=u(f,`providerTypeInfo`),E=e(()=>W.fromISO(R(S.value.createdAt)?S.value.createdAt.toISOString():S.value.createdAt||new Date().toISOString()).toFormat(`dd LLL yyyy`)),O=e(()=>S.value.state===`error`),A=e(()=>d.hasScope(`externalSecretsProvider:delete`)),N=e(()=>S.value.projects.length===0),F=e(()=>{if(f.project){let{name:e,email:t}=I(f.project.name??void 0);return e??t??``}return``}),L=e(()=>N.value?{type:`icon`,value:`globe`}:K(f.project?.icon)?f.project.icon:{type:`icon`,value:`layers`}),B=e(()=>N.value?c.baseText(`settings.secretsProviderConnections.badge.tooltip.global`):c.baseText(`settings.secretsProviderConnections.badge.tooltip.project`,{interpolate:{projectName:F.value}})),V=e(()=>{if(!f.canUpdate)return[];let e=[{label:c.baseText(`generic.edit`),value:`edit`},{label:c.baseText(`settings.secretsProviderConnections.actions.share`),value:`share`}];return A.value&&e.push({label:c.baseText(`generic.delete`),value:`delete`}),e});function H(e){e===`edit`?h(`edit`,S.value.name):e===`share`?h(`share`,S.value.name):e===`delete`&&h(`delete`,S.value.name)}return(e,a)=>{let s=v(`n8n-truncate`);return m(),l(i(M),{class:y(e.$style.card),hoverable:``},_({header:p(()=>[b(`div`,{class:y(e.$style.headerContainer)},[o(i(P),{tag:`h2`,bold:``,"data-test-id":`secrets-provider-name`},{default:p(()=>[g(t(S.value.name),1)]),_:1}),O.value?(m(),l(i(w),{key:0,theme:`warning`,bold:!1,size:`xsmall`,"data-test-id":`disconnected-badge`},{default:p(()=>[g(t(i(c).baseText(`settings.secretsProviderConnections.state.disconnected`)),1)]),_:1})):r(``,!0)],2)]),default:p(()=>[o(i(j),{class:`pb-4xs`,color:`text-light`,size:`small`},{default:p(()=>[b(`span`,X,t(T.value?.displayName??S.value.type),1),a[0]||=g(` | `,-1),b(`span`,Z,t(S.value.secretsCount===1?i(c).baseText(`settings.externalSecrets.card.secretCount`,{interpolate:{count:`${S.value.secretsCount}`}}):i(c).baseText(`settings.externalSecrets.card.secretsCount`,{interpolate:{count:`${S.value.secretsCount}`}})),1),a[1]||=g(` | `,-1),b(`span`,Q,t(i(c).baseText(`settings.secretsProviderConnections.card.createdAt`,{interpolate:{date:E.value}})),1)]),_:1})]),append:p(()=>[o(i(D),{class:y(e.$style.cardBadge),placement:`top`},{content:p(()=>[g(t(B.value),1)]),default:p(()=>[o(i(w),{class:y(e.$style.badge),theme:`tertiary`,"data-test-id":N.value?`secrets-provider-global-badge`:`secrets-provider-project-badge`},{default:p(()=>[o(q,{icon:L.value,"border-less":!0,size:`mini`},null,8,[`icon`]),N.value?(m(),n(`span`,te,t(i(c).baseText(`projects.badge.global`)),1)):x((m(),n(`span`,{key:0,class:y(e.$style.nowrap)},[g(t(F.value),1)],2)),[[s,F.value,`20`]])]),_:1},8,[`class`,`data-test-id`])]),_:1},8,[`class`]),o(i(k),{actions:V.value,"data-test-id":`secrets-provider-action-toggle`,onAction:H},null,8,[`actions`])]),_:2},[T.value?{name:`prepend`,fn:p(()=>[o(J,{class:y(e.$style.providerImage),provider:T.value,"data-test-id":`secrets-provider-image`},null,8,[`class`,`provider`])]),key:`0`}:void 0]),1032,[`class`])}}}),[[`__cssModules`,{$style:{card:`_card_1yi5y_2`,providerImage:`_providerImage_1yi5y_7`,headerContainer:`_headerContainer_1yi5y_12`,cardBadge:`_cardBadge_1yi5y_18`,badge:`_badge_1yi5y_22`,nowrap:`_nowrap_1yi5y_35`}}]]),re=F(s({__name:`SecretsProvidersEmptyState.ee`,props:{providerTypes:{},canCreate:{type:Boolean}},emits:[`addSecretsStore`],setup(s,{emit:f}){let h=C(),_=u(s,`providerTypes`),v=e(()=>_.value??[]),x=f,S=a(0),w=a(2),T=a(!1),D=a(!1),k=null;function j(){T.value=!0,setTimeout(()=>{S.value=(S.value+1)%v.value.length,T.value=!1},300)}function M(){D.value=!0,setTimeout(()=>{w.value=(w.value+1)%v.value.length,D.value=!1},300)}d(()=>{k=setInterval(()=>{j(),setTimeout(()=>{M()},1500)},3e3)}),c(()=>{k&&clearInterval(k)});function N(){x(`addSecretsStore`)}return(e,a)=>(m(),l(i(O),{class:`mt-2xl mb-l`,description:`yes`,"data-test-id":`secrets-provider-connections-empty-state`},{description:p(()=>[b(`div`,{class:y(e.$style.iconCardContainer)},[v.value?.[S.value]?(m(),n(`div`,{key:0,class:y(e.$style.iconCard)},[o(J,{provider:v.value?.[S.value],class:y([e.$style.providerLogo,{[e.$style.fading]:T.value}])},null,8,[`provider`,`class`])],2)):r(``,!0),b(`div`,{class:y(e.$style.iconCard)},[o(i(A),{icon:`vault`})],2),v.value?.[w.value]?(m(),n(`div`,{key:1,class:y(e.$style.iconCard)},[o(J,{provider:v.value?.[w.value],class:y([e.$style.providerLogo,{[e.$style.fading]:D.value}])},null,8,[`provider`,`class`])],2)):r(``,!0)],2),o(i(P),{tag:`h2`,size:`medium`,align:`center`,class:`mb-2xs`},{default:p(()=>[g(t(i(h).baseText(`settings.secretsProviderConnections.emptyState.heading`)),1)]),_:1}),b(`div`,null,t(i(h).baseText(`settings.secretsProviderConnections.emptyState.description`)),1)]),additionalContent:p(()=>[o(i(E),{variant:`ghost`,class:`mr-2xs n8n-button--highlight`,href:i(h).baseText(`settings.externalSecrets.docs`),target:`_blank`,"data-test-id":`secrets-provider-connections-learn-more`},{default:p(()=>[g(t(i(h).baseText(`generic.learnMore`))+` `,1),o(i(A),{icon:`arrow-up-right`})]),_:1},8,[`href`]),s.canCreate?(m(),l(i(E),{key:0,variant:`solid`,onClick:N},{default:p(()=>[g(t(i(h).baseText(`settings.secretsProviderConnections.buttons.addSecretsStore`)),1)]),_:1})):r(``,!0)]),_:1}))}}),[[`__cssModules`,{$style:{iconCardContainer:`_iconCardContainer_mo660_2`,iconCard:`_iconCard_mo660_2`,providerLogo:`_providerLogo_mo660_41`,fading:`_fading_mo660_52`}}]]),$={key:0,"data-test-id":`secrets-provider-connections-content-licensed`},ie={key:0,"data-test-id":`secrets-providers-loading`},ae={key:2},oe=[`href`],se=F(s({__name:`SettingsSecretsProviders.ee`,setup(a){let s=C(),c=Y(),u=L(),_=H(),v=B(),x=ee(),w=V(),D=e(()=>c.activeProviders.value.length>0);function k(e){return!e||e.projects.length===0?null:u.projects.find(t=>t.id===e.projects[0].id)??null}function M(e){return c.providerTypes.value.find(t=>t.type===e)}function F(e,t=`connection`){let n=c.activeProviders.value.map(e=>e.name);w.openModalWithData({name:U,data:{activeTab:t,providerKey:e,providerTypes:c.providerTypes.value,existingProviderNames:n,onClose:async()=>{await c.fetchActiveConnections()}}})}function I(e){F(e,`connection`)}function R(e){F(e,`connection`)}function z(e){F(e,`sharing`)}function W(e){let t=c.activeProviders.value.find(t=>t.name===e);t&&w.openModalWithData({name:G,data:{providerKey:t.name,providerName:t.name,secretsCount:t.secretsCount??0,onConfirm:async()=>{await c.fetchActiveConnections()}}})}d(async()=>{if(v.set(s.baseText(`settings.secretsProviderConnections.title`)),c.isEnterpriseExternalSecretsEnabled.value)try{await Promise.all([c.fetchProviderTypes(),c.fetchActiveConnections(),u.getAllProjects()])}catch(e){_.showError(e,s.baseText(`error`))}});function K(){x.goToUpgrade(`external-secrets`,`upgrade-external-secrets`)}return(e,a)=>(m(),n(`div`,{class:y(e.$style.container)},[b(`div`,{class:y([`mb-xl`,e.$style.headerContainer])},[b(`div`,{class:y(e.$style.headerTitle)},[o(i(P),{tag:`h1`,size:`2xlarge`},{default:p(()=>[g(t(i(s).baseText(`settings.secretsProviderConnections.title`)),1)]),_:1}),i(c).isEnterpriseExternalSecretsEnabled.value&&D.value?(m(),l(i(j),{key:0,color:`text-base`,size:`medium`},{default:p(()=>[g(t(i(s).baseText(`settings.secretsProviderConnections.description`))+` `+t(i(s).baseText(`credentialResolver.view.learnMore`))+` `,1),o(i(N),{theme:`text`,href:i(s).baseText(`settings.externalSecrets.docs`),size:`medium`,"new-window":``},{default:p(()=>[b(`span`,{class:y(e.$style.link)},[g(t(i(s).baseText(`generic.documentation`))+` `,1),o(i(A),{icon:`arrow-up-right`})],2)]),_:1},8,[`href`])]),_:1})):r(``,!0),D.value&&i(c).canCreate.value?(m(),l(i(E),{key:1,class:y(e.$style.addButton),type:`primary`,onClick:a[0]||=e=>F()},{default:p(()=>[o(i(A),{icon:`plus`}),g(` `+t(i(s).baseText(`settings.secretsProviderConnections.buttons.addSecretsStore`)),1)]),_:1},8,[`class`])):r(``,!0)],2)],2),i(c).isEnterpriseExternalSecretsEnabled.value?(m(),n(`div`,$,[i(c).isLoading.value&&!D.value?(m(),n(`div`,ie,[(m(),n(f,null,h(3,e=>b(`div`,{key:e,class:`mb-2xs`},[o(i(T),{variant:`p`,rows:1})])),64))])):D.value?(m(),n(`div`,ae,[(m(!0),n(f,null,h(i(c).activeProviders.value,e=>(m(),l(ne,{key:e.name,class:`mb-2xs`,provider:e,"provider-type-info":M(e.type),project:k(e),"can-update":i(c).canUpdate.value,onClick:t=>I(e.name),onEdit:R,onShare:z,onDelete:W},null,8,[`provider`,`provider-type-info`,`project`,`can-update`,`onClick`]))),128))])):(m(),l(re,{key:1,"provider-types":i(c).providerTypes.value,"can-create":i(c).canCreate.value,onAddSecretsStore:a[1]||=e=>F()},null,8,[`provider-types`,`can-create`]))])):(m(),l(i(O),{key:1,class:`mt-2xl mb-l`,"data-test-id":`secrets-provider-connections-content-unlicensed`,"button-text":i(s).baseText(`settings.externalSecrets.actionBox.buttonText`),onClick:K},{heading:p(()=>[b(`span`,null,t(i(s).baseText(`settings.externalSecrets.actionBox.title`)),1)]),description:p(()=>[o(i(S),{keypath:`settings.externalSecrets.actionBox.description`,scope:`global`},{link:p(()=>[b(`a`,{href:i(s).baseText(`settings.externalSecrets.docs`),target:`_blank`},t(i(s).baseText(`settings.externalSecrets.actionBox.description.link`)),9,oe)]),_:1})]),_:1},8,[`button-text`]))],2))}}),[[`__cssModules`,{$style:{container:`_container_wm73r_2`,headerContainer:`_headerContainer_wm73r_8`,headerTitle:`_headerTitle_wm73r_14`,addButton:`_addButton_wm73r_20`,link:`_link_wm73r_25`}}]]);export{se as default};
//# sourceMappingURL=SettingsSecretsProviders.ee-DFRhyzqJ.js.map