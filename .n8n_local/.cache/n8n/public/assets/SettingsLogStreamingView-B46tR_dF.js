(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`b4a21743-5683-4801-b685-df8bda97d955`,e._sentryDebugIdIdentifier=`sentry-dbid-b4a21743-5683-4801-b685-df8bda97d955`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,F as a,G as o,Gt as s,It as c,M as l,P as u,T as d,Z as f,_ as p,bt as m,et as h,it as g,j as _,q as v,st as y,vn as b,w as x,xt as S}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as C}from"./_MapCache-DjbOQyB7.js";import{Hi as w,Pi as T,Q as E,Tt as D,Vi as O,_t as k,bt as A,jt as j,zi as M}from"./src-CppJvwzX.js";import{t as N}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Tr as P,Vt as F,fn as I,r as ee,rt as te,s as ne,ur as re,ws as ie,zr as ae}from"./users.store-pCkD7Zo0.js";import{n as oe,t as se}from"./col-D8aZ4Gpw.js";import{Ha as L,Ji as R,Ss as z,Yc as ce,vs as B}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{v as V}from"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as le}from"./usePageRedirectionHelper-BoF8hzbN.js";import{t as H}from"./logStreaming.store-DPCwPbu7.js";var ue=N(u({__name:`EventDestinationCard`,props:{eventBus:{},destination:{default:()=>L(R)},readonly:{type:Boolean}},emits:[`edit`,`remove`],setup(e,{emit:r}){let i={OPEN:`open`,DELETE:`delete`},{confirm:a}=P(),o=C(),u=H(),p=c({}),g=c(null),y=e,S=r;f(()=>{p.value=Object.assign(L(R),y.destination),y.eventBus?.on(`destinationWasSaved`,E)}),v(()=>{y.eventBus?.off(`destinationWasSaved`,E)});let w=t(()=>{let e=[{label:o.baseText(`workflows.item.open`),value:i.OPEN}];return y.readonly||e.push({label:o.baseText(`workflows.item.delete`),value:i.DELETE}),e}),T=t(()=>`settings.log-streaming.${y.destination.__type}`);function E(){V(y.destination.id),u.getDestination(y.destination.id)&&(p.value=Object.assign(L(R),y.destination))}async function k(e){let t=e.target;g.value===t||g.value?.contains(t)||t?.contains(g.value)||S(`edit`,y.destination.id)}function N(e){let t=typeof e==`boolean`?e:!!e;p.value.enabled=t,F()}async function F(){await u.saveDestination(p.value)}async function I(e){if(e===i.OPEN)S(`edit`,y.destination.id);else if(e===i.DELETE){if(await a(o.baseText(`settings.log-streaming.destinationDelete.message`,{interpolate:{destinationName:y.destination.label??``}}),o.baseText(`settings.log-streaming.destinationDelete.headline`),{type:`warning`,confirmButtonText:o.baseText(`settings.log-streaming.destinationDelete.confirmButtonText`),cancelButtonText:o.baseText(`settings.log-streaming.destinationDelete.cancelButtonText`)})!==`confirm`)return;S(`remove`,y.destination.id)}}return(t,r)=>(h(),d(s(A),{class:b(t.$style.cardLink),"data-test-id":`destination-card`,onClick:k},{header:m(()=>[x(`div`,null,[l(s(M),{tag:`h2`,bold:``,class:b(t.$style.cardHeading)},{default:m(()=>[_(n(e.destination.label),1)]),_:1},8,[`class`]),x(`div`,{class:b(t.$style.cardDescription)},[l(s(O),{color:`text-light`,size:`small`},{default:m(()=>[x(`span`,null,n(s(o).baseText(T.value)),1)]),_:1})],2)])]),append:m(()=>[x(`div`,{ref_key:`cardActions`,ref:g,class:b(t.$style.cardActions)},[x(`div`,{class:b(t.$style.activeStatusText),"data-test-id":`destination-activator-status`},[p.value.enabled?(h(),d(s(O),{key:0,color:`success`,size:`small`,bold:``},{default:m(()=>[_(n(s(o).baseText(`workflowActivator.active`)),1)]),_:1})):(h(),d(s(O),{key:1,color:`text-base`,size:`small`,bold:``},{default:m(()=>[_(n(s(o).baseText(`workflowActivator.inactive`)),1)]),_:1}))],2),l(s(j),{class:`mr-s`,disabled:e.readonly,"model-value":p.value.enabled,title:p.value.enabled?s(o).baseText(`workflowActivator.deactivateWorkflow`):s(o).baseText(`workflowActivator.activateWorkflow`),"active-color":`#13ce66`,"inactive-color":`#8899AA`,"data-test-id":`workflow-activate-switch`,"onUpdate:modelValue":r[0]||=e=>N(e)},null,8,[`disabled`,`model-value`,`title`]),l(s(D),{actions:w.value,theme:`dark`,onAction:I},null,8,[`actions`])],2)]),_:1},8,[`class`]))}}),[[`__cssModules`,{$style:{cardLink:`_cardLink_s7ez3_125`,activeStatusText:`_activeStatusText_s7ez3_135`,cardHeading:`_cardHeading_s7ez3_143`,cardDescription:`_cardDescription_s7ez3_149`,cardActions:`_cardActions_s7ez3_156`}}]]),de={class:`mb-2xl`},fe={class:`ml-m`},pe={class:`mb-l`},me={class:`mt-m text-right`},he={key:1,"data-test-id":`action-box-licensed`},ge={key:0,class:`mb-l`},_e={"data-test-id":`action-box-unlicensed`},U=N(u({__name:`SettingsLogStreamingView`,setup(e){let u=`production`,D=ie(),O=H(),A=ne(),N=F(),P=ee(),z=te(),V=I(),U=C(),ve=le(),W=k(),G=c(!1),K=c([]),ye=t(()=>{let e=[];for(let[t,n]of Object.entries(O.items))e.push({key:t,label:n.destination?.label??`Destination`});return e.sort((e,t)=>e.label.localeCompare(t.label))}),q=t(()=>G.value?!1:D.isEnterpriseFeatureEnabled[ce.LogStreaming]),J=t(()=>re([`rbac`],{rbac:{scope:`logStreaming:manage`}}));f(async()=>{V.set(U.baseText(`settings.log-streaming.heading`)),q.value&&(await z.fetchCredentialTypes(!1),await z.fetchAllCredentials(),P.nodeViewInitialized=!1,await be(),O.$onAction(({name:e,after:t})=>{(e===`removeDestination`||e===`updateDestination`)&&t(async()=>{X()})}),W.on(`destinationWasSaved`,Y),W.on(`remove`,$),W.on(`closing`,Z))}),v(()=>{W.off(`destinationWasSaved`,Y),W.off(`remove`,$),W.off(`closing`,Z)});function Y(){X()}function X(){a()?.proxy?.$forceUpdate()}function Z(){N.removeAllNodes({setStateDirty:!1,removePinData:!0}),P.markStateClean()}async function be(){O.clearEventNames(),O.clearDestinations(),K.value=[];let e=await O.fetchEventNames();if(e)for(let t of e)O.addEventName(t);let t=await O.fetchDestinations();if(t)for(let e of t)O.addDestination(e),K.value.push(e);X()}function xe(){ve.goToUpgrade(`log-streaming`,`upgrade-log-streaming`)}function Se(){return O.items&&Object.keys(O.items).length>0}async function Q(){let e=L(R);e.id=ae(),O.addDestination(e),await o(),P.openModalWithData({name:B,data:{destination:e,isNew:!0,eventBus:W}})}async function $(e){if(!e)return;await O.deleteDestination(e);let t=A.getNodeByName(e);t&&A.removeNode(t)}async function Ce(e){if(!e)return;let t=O.getDestination(e);t&&P.openModalWithData({name:B,data:{destination:t,isNew:!1,eventBus:W}})}return(e,t)=>{let a=y(`n8n-html`);return h(),r(`div`,null,[x(`div`,{class:b(e.$style.header)},[x(`div`,de,[l(s(M),{size:`2xlarge`},{default:m(()=>[_(n(s(U).baseText(`settings.log-streaming.heading`)),1)]),_:1}),s(u)===`production`?i(``,!0):(h(),r(p,{key:0},[x(`span`,fe,`Disable License (`+n(s(u))+`)\xA0`,1),l(s(j),{modelValue:G.value,"onUpdate:modelValue":t[0]||=e=>G.value=e,size:`large`,"data-test-id":`disable-license-toggle`},null,8,[`modelValue`])],64))])],2),q.value?(h(),r(p,{key:0},[x(`div`,pe,[l(s(E),{theme:`info`,type:`note`},{default:m(()=>[S(x(`span`,null,null,512),[[a,s(U).baseText(`settings.log-streaming.infoText`)]])]),_:1})]),Se()?(h(),r(p,{key:0},[(h(!0),r(p,null,g(ye.value,t=>(h(),d(s(oe),{key:t.key,gutter:10,class:b(e.$style.destinationItem)},{default:m(()=>[s(O).items[t.key]?.destination?(h(),d(s(se),{key:0},{default:m(()=>[l(ue,{destination:s(O).items[t.key]?.destination,"event-bus":s(W),readonly:!J.value,onRemove:e=>$(s(O).items[t.key]?.destination?.id),onEdit:e=>Ce(s(O).items[t.key]?.destination?.id)},null,8,[`destination`,`event-bus`,`readonly`,`onRemove`,`onEdit`])]),_:2},1024)):i(``,!0)]),_:2},1032,[`class`]))),128)),x(`div`,me,[J.value?(h(),d(s(w),{key:0,size:`large`,onClick:Q},{default:m(()=>[_(n(s(U).baseText(`settings.log-streaming.add`)),1)]),_:1})):i(``,!0)])],64)):(h(),r(`div`,he,[l(s(T),{"button-text":s(U).baseText(`settings.log-streaming.add`),"onClick:button":Q},{heading:m(()=>[S(x(`span`,null,null,512),[[a,s(U).baseText(`settings.log-streaming.addFirstTitle`)]])]),_:1},8,[`button-text`])]))],64)):(h(),r(p,{key:1},[s(U).baseText(`settings.log-streaming.infoText`)?(h(),r(`div`,ge,[l(s(E),{theme:`info`,type:`note`},{default:m(()=>[S(x(`span`,null,null,512),[[a,s(U).baseText(`settings.log-streaming.infoText`)]])]),_:1})])):i(``,!0),x(`div`,_e,[l(s(T),{description:s(U).baseText(`settings.log-streaming.actionBox.description`),"button-text":s(U).baseText(`settings.log-streaming.actionBox.button`),"onClick:button":xe},{heading:m(()=>[S(x(`span`,null,null,512),[[a,s(U).baseText(`settings.log-streaming.actionBox.title`)]])]),_:1},8,[`description`,`button-text`])])],64))])}}}),[[`__cssModules`,{$style:{header:`_header_1gpds_125`,destinationItem:`_destinationItem_1gpds_135`}}]]);export{U as default};
//# sourceMappingURL=SettingsLogStreamingView-B46tR_dF.js.map