(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`4ec9b4dd-2f4b-4a68-a6ea-1615df61189d`,e._sentryDebugIdIdentifier=`sentry-dbid-4ec9b4dd-2f4b-4a68-a6ea-1615df61189d`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,M as s,P as c,T as l,bt as u,et as d,j as f,st as p,vn as m,w as h,xt as g}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as _,yt as v}from"./_MapCache-DjbOQyB7.js";import{U as y,zi as b}from"./src-CppJvwzX.js";import{t as x}from"./_plugin-vue_export-helper-B_J4Khre.js";import{C as S,Lt as C,Pi as w,Z as T,rt as E}from"./users.store-pCkD7Zo0.js";import{t as D}from"./NodeIcon-Dv1e4Lvu.js";import{i as O}from"./nodeTransforms-CG9uauaw.js";import{n as k,t as A}from"./templateTransforms-u0_D8fwP.js";import{t as j}from"./CredentialPicker-u0Fuk2eM.js";var M=e(T(),1);const N=(e,t)=>t.map(t=>({node:t,requiredCredentials:O(e,t)})).filter(({requiredCredentials:e})=>e.length>0),P=e=>{let t=new Map;for(let{node:n,requiredCredentials:r}of e){let e=n.credentials?k(n.credentials):{};for(let i of r){let r=i.name,a=e[i.name]??``,o=A(r,a),s=t.get(o);s||(s={key:o,nodeTypeName:n.type,credentialName:a,credentialType:r,usedBy:[]},t.set(o,s)),s.usedBy.push(n)}}return t},F=(e,t)=>{let n=new Map;for(let r of e){let e=r.nodeTypeName,i=t(e)??e,a=n.get(i);a?a.credentials.push(r):n.set(i,{appName:i,credentials:[r]})}return Array.from(n.values())},I=e=>{let n=o({}),r=S(),i=E(),a=(e,t)=>{let n=r.getNodeType(e,t);return n?w(n.displayName):e},s=t(()=>(0,M.default)(e.value?N(r,e.value):[],({node:e})=>e.position[0])),c=t(()=>P(s.value)),l=t(()=>Array.from(c.value.values()));return{appCredentials:t(()=>F(l.value,a)),credentialOverrides:t(()=>{let e={};for(let[t,r]of Object.entries(n.value)){let n=i.getCredentialById(r);n&&(e[t]={id:r,name:n.name})}return e}),credentialUsages:l,credentialsByKey:c,nodesRequiringCredentialsSorted:s,numFilledCredentials:t(()=>Object.keys(n.value).length),selectedCredentialIdByKey:n,setSelectedCredentialId:(e,t)=>{n.value[e]=t},unsetSelectedCredential:e=>{delete n.value[e]}}},L=(e,t)=>{let{i18n:n,formatFn:r}=t;if(e.length===0)return``;if(e.length===1)return r(e[0]);let i=e.slice(0,-1),a=e[e.length-1];return`${i.map(r).join(`, `)} ${n.baseText(`generic.and`)} ${r(a)}`};var R=x(c({__name:`AppsRequiringCredsNotice`,props:{appCredentials:{},source:{}},setup(e){let n=v(),r=e,i=t(()=>r.source===`builder`?`templateSetup.instructions.builder`:`templateSetup.instructions`),o=e=>`<b>${e.credentials.length}x ${e.appName}</b>`,c=t(()=>L(r.appCredentials,{formatFn:o,i18n:n}));return(e,t)=>{let n=p(`n8n-html`);return d(),l(a(y),{class:m(e.$style.notice),theme:`info`},{default:u(()=>[s(a(_),{tag:`span`,keypath:i.value,scope:`global`},{default:u(()=>[g(h(`span`,null,null,512),[[n,c.value]])]),_:1},8,[`keypath`])]),_:1},8,[`class`])}}}),[[`__cssModules`,{$style:{notice:`_notice_e6am5_125`}}]]),z={},B={class:`el-icon-success`};function V(e,t){return d(),r(`i`,B)}var H=x(z,[[`render`,V],[`__scopeId`,`data-v-563d175d`]]),U=x(c({__name:`SetupTemplateFormStep`,props:{order:{},credentials:{},selectedCredentialId:{default:null},source:{}},emits:[`credentialSelected`,`credentialDeselected`],setup(e,{emit:o}){let c=e,l=o,y=S(),x=v(),T=C(),E=t(()=>c.credentials.usedBy[0]),O=t(()=>y.getNodeType(E.value.type,E.value.typeVersion)),k=t(()=>O.value?w(O.value.displayName):E.value.type),A=t(()=>L(c.credentials.usedBy,{formatFn:e=>`<b>${e.name}</b>`,i18n:x})),M=t(()=>c.source===`builder`?`templateSetup.credential.description.builder`:`templateSetup.credential.description`),N=()=>{T.track(`User opened Credential modal`,{source:`cred_setup`,credentialType:c.credentials.credentialType,new_credential:!c.selectedCredentialId})};return(t,o)=>{let v=p(`n8n-html`);return d(),r(`li`,{class:m(t.$style.container),"data-test-id":`setup-credentials-form-step`},[s(a(b),{tag:`h2`,size:`large`},{default:u(()=>[O.value?(d(),r(`div`,{key:0,class:m(t.$style.heading),"data-test-id":`credential-step-heading`},[h(`span`,{class:m(t.$style.headingOrder)},n(e.order)+`.`,3),h(`span`,{class:m(t.$style.headingIcon)},[s(D,{"node-type":O.value},null,8,[`node-type`])],2),f(` `+n(k.value),1)],2)):i(``,!0)]),_:1}),h(`p`,{class:m(t.$style.description),"data-test-id":`credential-step-description`},[s(a(_),{tag:`span`,keypath:M.value,plural:e.credentials.usedBy.length,scope:`global`},{default:u(()=>[g(h(`span`,null,null,512),[[v,A.value]])]),_:1},8,[`keypath`,`plural`])],2),h(`div`,{class:m(t.$style.credentials)},[s(j,{class:m(t.$style.credentialPicker),"app-name":k.value,"personal-only":``,"credential-type":c.credentials.credentialType,"selected-credential-id":e.selectedCredentialId,onCredentialSelected:o[0]||=e=>l(`credentialSelected`,{credentialUsageKey:t.$props.credentials.key,credentialId:e}),onCredentialDeselected:o[1]||=e=>l(`credentialDeselected`,{credentialUsageKey:t.$props.credentials.key}),onCredentialModalOpened:N},null,8,[`class`,`app-name`,`credential-type`,`selected-credential-id`]),s(H,{class:m({[t.$style.credentialOk]:!0,[t.$style.invisible]:!e.selectedCredentialId})},null,8,[`class`])],2)],2)}}}),[[`__cssModules`,{$style:{container:`_container_atvc6_125`,heading:`_heading_atvc6_129`,headingOrder:`_headingOrder_atvc6_135`,headingIcon:`_headingIcon_atvc6_140`,description:`_description_atvc6_144`,credentials:`_credentials_atvc6_150`,credentialPicker:`_credentialPicker_atvc6_156`,credentialOk:`_credentialOk_atvc6_160`,invisible:`_invisible_atvc6_165`}}]]);export{R as n,I as r,U as t};
//# sourceMappingURL=SetupTemplateFormStep-M1Yhoabp.js.map