!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"n8n@2.9.4"}}catch(e){}}(),System.register(["./vue.runtime.esm-bundler-legacy-BquwEXRp.js","./_MapCache-legacy-BR_CVmoL.js","./src-legacy-kcwUfEuS.js","./_plugin-vue_export-helper-legacy-DtDV0xrP.js","./sanitize-html-legacy-rns0ELH_.js","./date-picker-legacy-B9cF0kNe.js","./users.store-legacy-B-bVJKl3.js","./ParameterInputList-legacy-B-cVfigK.js","./constants-legacy-DVkAm8xO.js","./merge-legacy-C4nCP5az.js","./_baseOrderBy-legacy-BnyL5wLN.js","./dateformat-legacy-BvMRGS_P.js","./useDebounce-legacy-BSzeAS4U.js","./dataTable.store-legacy-bRwnG61W.js","./useClipboard-legacy-CaRHRTup.js","./executions.store-legacy-OEeCPZk_.js","./assistant.store-legacy-5vR0xJ8p.js","./chatPanel.store-legacy-BsXu4GbL.js","./RunData-legacy-lPpXxp--.js","./NDVEmptyState-legacy-BucrD4N6.js","./useEnvFeatureFlag-legacy-D1JgdFvC.js","./externalSecrets.ee.store-legacy-iYi_lGhf.js","./uniqBy-legacy-D3DmQIZU.js","./semver-legacy-BKbx4Ujl.js","./usePinnedData-legacy-B5CI71uf.js","./nodeIcon-legacy-KJSlWBN7.js","./canvas.utils-legacy-BQnUeqx3.js","./nodeCreator.store-legacy-i0crt2uh.js","./useCanvasOperations-legacy-CEMGNuuE.js","./folders.store-legacy-BDfX2wrH.js","./QuickConnectBanner-legacy-D8p522S_.js","./useQuickConnect-legacy-C07VWAhK.js","./CredentialIcon-legacy-CaQiQjuK.js","./useDynamicCredentials-legacy-DtgrzjN_.js","./RunDataHtml-legacy-D5RK94OR.js","./Draggable-legacy-DR_TRqSl.js","./NodeIcon-legacy-DOI-M5xN.js","./VirtualSchema-legacy-DEUlCSUS.js","./useCalloutHelpers-legacy-Dcwge6qS.js","./useTelemetryContext-legacy-g7p6wUAa.js","./useRunWorkflow-legacy-4stFR283.js","./pushConnection.store-legacy-C36NF7Lj.js","./nodeTransforms-legacy-Bt0tXwjd.js","./vue-json-pretty-legacy-CxiVsaQm.js","./collaboration.store-legacy-COoId2Xe.js","./dateFormatter-legacy-Di9U0PH-.js","./useExecutionHelpers-legacy-BhqYaQxc.js","./useFreeAiCredits-legacy-CkLWMz48.js","./NodeSettings-legacy-lAEmS_aB.js","./KeyboardShortcutTooltip-legacy-C9k84nly.js","./vue-legacy-J35sU_a1.js","./CredentialPicker-legacy-Cca8dwDU.js","./sourceControl.eventBus-legacy-DO0IFl0k.js","./CanvasRunWorkflowButton-legacy-DmPqrO5o.js","./useCanvasMapping-legacy-B6GW_hUG.js","./useKeybindings-legacy-Ba2t_Uzp.js","./injectStrict-legacy-BDpFN7qf.js","./useActions-legacy-Cyiwb1IV.js","./setupPanel.store-legacy-BKxjwsK9.js","./useExecutionData-legacy-B-oDwo5t.js","./emptyStateBuilderPrompt.store-legacy-BPX3i9GN.js"],(function(e,t){var a,n,o,s,l,i,r,d,c,u,p,f,m,v,_,y,g,h,w,x,b,N,k,C,T,I,E,P,O,W,j,S,D,A,V,B,R,$,F,M,U,z,L,q,H,K,G,J,X,Q,Y,Z,ee,te,ae,ne,oe,se,le,ie,re,de,ce,ue,pe,fe,me,ve,_e,ye,ge,he,we,xe,be,Ne,ke,Ce,Te,Ie,Ee,Pe,Oe,We,je,Se,De,Ae,Ve,Be,Re,$e,Fe,Me,Ue,ze,Le,qe,He,Ke,Ge,Je,Xe,Qe,Ye,Ze,et,tt,at,nt,ot,st,lt,it,rt,dt,ct,ut,pt,ft,mt,vt,_t,yt,gt,ht,wt,xt,bt,Nt,kt,Ct,Tt,It,Et,Pt,Ot,Wt,jt,St,Dt,At,Vt,Bt,Rt,$t,Ft,Mt,Ut,zt,Lt,qt,Ht,Kt,Gt,Jt,Xt,Qt,Yt,Zt,ea,ta,aa,na,oa,sa,la,ia,ra,da,ca,ua,pa,fa,ma,va,_a,ya,ga,ha,wa,xa,ba,Na,ka,Ca,Ta,Ia,Ea,Pa,Oa,Wa,ja,Sa,Da,Aa,Va,Ba,Ra,$a,Fa,Ma,Ua,za,La,qa,Ha,Ka,Ga;function Ja(e,t){const a=new Set,n=ta(e,t);for(const s of n)a.add(s.name);const o=t.issues?.credentials??{};for(const s of Object.keys(o))a.add(s);if(t.credentials)for(const s of Object.keys(t.credentials))a.add(s);return Array.from(a)}return{setters:[function(e){a=e.C,n=e.Cn,o=e.D,s=e.E,l=e.G,i=e.Gt,r=e.It,d=e.J,c=e.K,u=e.L,p=e.M,f=e.N,m=e.P,v=e.Q,_=e.T,y=e.U,g=e.Vt,h=e.W,w=e.Y,x=e.Z,b=e._,N=e._t,k=e.at,C=e.bn,T=e.bt,I=e.c,E=e.et,P=e.ft,O=e.h,W=e.it,j=e.j,S=e.jt,D=e.mt,A=e.nt,V=e.q,B=e.vn,R=e.w,$=e.y},function(e){F=e.$,M=e.b,U=e.h,z=e.ot,L=e.st,q=e.yt},function(e){H=e.Bi,K=e.Ci,G=e.Hi,J=e.I,X=e.Ki,Q=e.Mi,Y=e.Oi,Z=e.Ot,ee=e.Q,te=e.Si,ae=e.St,ne=e.Ui,oe=e.Vi,se=e._t,le=e.d,ie=e.j,re=e.ji,de=e.kt,ce=e.wi,ue=e.xt,pe=e.z},function(e){fe=e.t},function(e){},function(e){},function(e){me=e.Bt,ve=e.C,_e=e.Ci,ye=e.Er,ge=e.Ft,he=e.Gt,we=e.It,xe=e.Ji,be=e.Ln,Ne=e.Lt,ke=e.Mn,Ce=e.Ot,Te=e.Rr,Ie=e.Sr,Ee=e.Tr,Pe=e.Vt,Oe=e.di,We=e.er,je=e.fn,Se=e.ga,De=e.gn,Ae=e.ia,Ve=e.ir,Be=e.li,Re=e.pn,$e=e.r,Fe=e.rt,Me=e.s,Ue=e.sa,ze=e.t,Le=e.un,qe=e.va,He=e.wr,Ke=e.xr,Ge=e.yr,Je=e.zn},function(e){Xe=e.D,Qe=e.M,Ye=e.N,Ze=e.P,et=e.T,tt=e._,at=e.a,nt=e.b,ot=e.d,st=e.h,lt=e.s,it=e.u,rt=e.v},function(e){e.An,dt=e.Ct,ct=e.Ga,ut=e.Gt,pt=e.M,ft=e.Qc,mt=e.R,vt=e.Ra,e.Ss,_t=e.Tc,e.To,yt=e.Tt,gt=e.Vs,ht=e.Zn,wt=e.bo,xt=e.da,bt=e.hr,Nt=e.hs,kt=e.is,Ct=e.mo,Tt=e.ns,It=e.ol,Et=e.qo,Pt=e.rs,Ot=e.so,Wt=e.ua,jt=e.wa,St=e.xc,Dt=e.xo},function(e){},function(e){At=e.N,Vt=e.r},function(e){},function(e){},function(e){},function(e){Bt=e.t},function(e){Rt=e.t},function(e){},function(e){$t=e.t},function(e){Ft=e.s},function(e){},function(e){},function(e){},function(e){},function(e){},function(e){},function(e){},function(e){Mt=e.c,Ut=e.l},function(e){zt=e.t},function(e){Lt=e.a,qt=e.i,Ht=e.r,Kt=e.t},function(e){},function(e){},function(e){},function(e){},function(e){},function(e){},function(e){},function(e){Gt=e.t},function(e){Jt=e.n,Xt=e.r},function(e){},function(e){Qt=e.t},function(e){Yt=e.n,Zt=e.t},function(e){ea=e.t},function(e){ta=e.i,aa=e.o},function(e){},function(e){na=e.n,oa=e.t},function(e){},function(e){},function(e){},function(e){},function(e){sa=e.t},function(e){},function(e){la=e.t},function(e){ia=e.t},function(e){ra=e.n,da=e.r,ca=e.t},function(e){ua=e.a,pa=e.i,fa=e.n,ma=e.s,va=e.t},function(e){_a=e.t},function(e){ya=e.t},function(e){},function(e){ga=e.t},function(e){ha=e.t},function(e){wa=e.t}],execute:function(){(xa=document.createElement("style")).textContent="._wrapper_gh0gb_125{width:100%;height:100%;display:flex;position:relative;overflow:hidden}._canvas_gh0gb_133{background-color:var(--canvas--color--background);justify-content:stretch;align-items:stretch;width:100%;height:100%;display:block;position:relative}._container_1xsug_125{padding-top:var(--spacing--xs);display:flex}._credential-label-row_1nlke_125{align-items:center;gap:var(--spacing--2xs);display:flex}._credential-label_1nlke_125{font-size:var(--font-size--sm);color:var(--color--text--shade-1)}._shared-nodes-hint_1nlke_136{font-size:var(--font-size--sm);color:var(--color--text--tint-1);cursor:default}._card_l1dfx_125{gap:var(--spacing--2xs);background-color:var(--color--background--light-2);border:var(--border);border-radius:var(--radius);flex-direction:column;width:100%;display:flex}._card_l1dfx_125 ._header-icon_l1dfx_134._chevron_l1dfx_134{display:none}._card_l1dfx_125:hover ._header-icon_l1dfx_134._chevron_l1dfx_134{display:block}._card_l1dfx_125:hover ._header-icon_l1dfx_134._trigger_l1dfx_140{display:none}._header_l1dfx_134{gap:var(--spacing--xs);cursor:pointer;user-select:none;padding:var(--spacing--sm)var(--spacing--sm)0;display:flex}._card_l1dfx_125:not(._collapsed_l1dfx_151) ._header_l1dfx_134{margin-bottom:var(--spacing--sm)}._card_l1dfx_125._no-content_l1dfx_154 ._header_l1dfx_134{margin-bottom:0}._node-name_l1dfx_158{font-weight:var(--font-weight--medium);flex:1}._complete-icon_l1dfx_163{color:var(--color--success)}._content_l1dfx_167{gap:var(--spacing--xs);padding:0 var(--spacing--sm);flex-direction:column;display:flex}._credential-container_l1dfx_174{gap:var(--spacing--3xs);flex-direction:column;display:flex}._credential-picker_l1dfx_180{flex:1}._footer_l1dfx_184{padding:var(--spacing--sm);justify-content:flex-end;display:flex}._footer-complete-check_l1dfx_190{align-items:center;gap:var(--spacing--4xs);display:flex}._card_l1dfx_125._collapsed_l1dfx_151 ._header_l1dfx_134{padding:var(--spacing--sm)}._card_l1dfx_125._collapsed_l1dfx_151 ._node-name_l1dfx_158{color:var(--color--text--tint-1);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}._card_l1dfx_125._completed_l1dfx_206{border-color:var(--color--success)}._card_l1dfx_125._completed_l1dfx_206 ._footer_l1dfx_184{justify-content:space-between}._container_1011p_125,._card-list_1011p_126{gap:var(--spacing--sm);flex-direction:column;flex:1;width:100%;display:flex}._empty-state_1011p_134{justify-content:center;align-items:center;gap:var(--spacing--2xs);flex-direction:column;width:100%;height:100%;display:flex}._empty-text_1011p_144{flex-direction:column;align-items:center;display:flex}._complete-message_1011p_150{text-align:center;color:var(--color--text--tint-1);font-size:var(--font-size--sm);padding:var(--spacing--sm)}._container_17sfi_125{width:100%;height:100%;padding:var(--spacing--xs);background-color:var(--color--background--light-1);top:calc(-1*var(--spacing--5xs));justify-content:center;display:flex;position:relative;overflow-x:hidden;overflow-y:auto}._component_1ef46_125{height:100%;overflow:auto}._multipleNodes_1ef46_130{min-height:100%;padding:var(--spacing--3xl)var(--spacing--md);justify-content:start;align-items:center;gap:var(--spacing--md);flex-direction:column;display:flex}._multipleNodesActions_1ef46_140{align-self:stretch;list-style-type:none}._multipleNodesAction_1ef46_140{margin-top:-1px}._multipleNodesAction_1ef46_140 button{border-color:var(--border-color--light);border-radius:0;justify-content:space-between;align-items:center;width:100%;display:flex;position:relative}._multipleNodesAction_1ef46_140 button:disabled{border-color:var(--border-color--light)}._multipleNodesAction_1ef46_140:first-of-type button{border-top-left-radius:var(--radius);border-top-right-radius:var(--radius)}._multipleNodesAction_1ef46_140:last-of-type button{border-bottom-left-radius:var(--radius);border-bottom-right-radius:var(--radius)}._multipleNodesAction_1ef46_140 button:hover{z-index:1}._component_1p4tv_125{padding:var(--spacing--2xs);align-items:center;gap:var(--spacing--2xs);border-bottom:var(--border);display:flex}._breadcrumbs_1p4tv_133{align-items:center;gap:var(--spacing--4xs);flex-grow:1;flex-shrink:1;display:flex}._content_9h1id_125{flex-direction:column;width:100%;height:100%;display:flex}._content_9h1id_125._emptyContent_9h1id_131{text-align:center;justify-content:center;align-items:center}._isNdvInFocusPanelEnabled_9h1id_136 ._content_9h1id_125._emptyContent_9h1id_131{flex-direction:column-reverse}._content_9h1id_125._emptyContent_9h1id_131 ._emptyText_9h1id_139{margin:0 var(--spacing--xl);gap:var(--spacing--2xs);flex-direction:column;display:flex}._content_9h1id_125._emptyContent_9h1id_131 ._focusParameterWrapper_9h1id_145{justify-content:center;align-items:center;gap:var(--spacing--2xs);margin-block:var(--spacing--md);display:flex}._content_9h1id_125._emptyContent_9h1id_131 ._focusParameterWrapper_9h1id_145 ._iconWrapper_9h1id_152{display:inline-block;position:relative}._content_9h1id_125._emptyContent_9h1id_131 ._focusParameterWrapper_9h1id_145 ._pointerIcon_9h1id_156{pointer-events:none;position:absolute;top:100%;left:50%;transform:translate(-20%,-30%)}._content_9h1id_125._emptyContent_9h1id_131 ._focusParameterWrapper_9h1id_145 [class*=_disabled_]{cursor:default!important}._content_9h1id_125 ._tabHeader_9h1id_166{border-bottom:1px solid var(--color--foreground);padding:var(--spacing--2xs);justify-content:space-between;align-items:center;display:flex}._content_9h1id_125 ._tabHeader_9h1id_166 ._tabHeaderText_9h1id_173{gap:var(--spacing--4xs);align-items:baseline;display:flex}._content_9h1id_125 ._tabHeader_9h1id_166 ._buttonWrapper_9h1id_178{gap:var(--spacing--2xs);align-items:center;display:flex}._content_9h1id_125 ._parameterDetailsWrapper_9h1id_183{gap:var(--spacing--2xs);height:100%;padding:var(--spacing--2xs);flex-direction:column;display:flex}._content_9h1id_125 ._parameterDetailsWrapper_9h1id_183 ._parameterOptionsWrapper_9h1id_190{justify-content:space-between;display:flex}._content_9h1id_125 ._parameterDetailsWrapper_9h1id_183 ._noExecutionDataTip_9h1id_194{align-content:center}._content_9h1id_125 ._parameterDetailsWrapper_9h1id_183 ._editorContainer_9h1id_197{flex-grow:1;height:0}._content_9h1id_125 ._parameterDetailsWrapper_9h1id_183 ._editorContainer_9h1id_197 ._editor_9h1id_197{width:100%;height:100%;font-size:var(--font-size--2xs);align-items:normal;display:flex}._content_9h1id_125 ._parameterDetailsWrapper_9h1id_183 ._editorContainer_9h1id_197 ._editor_9h1id_197 .cm-editor{background-color:var(--code--color--background);width:100%}._delayedShow_9h1id_213{opacity:0;transition:opacity .1s none;animation:.1s .1s forwards _triggerShow_9h1id_1}@keyframes _triggerShow_9h1id_1{to{opacity:1}}._closeButton_9h1id_224{cursor:pointer}._heightFull_9h1id_228{height:100%}._forceHover_9h1id_232{color:var(--button--color--text--secondary--hover-active-focus);border-color:var(--button--border-color--secondary--hover-active-focus)}._wrapper_1ek2u_125{border-left:1px solid var(--color--foreground);background:var(--color--background--light-3);flex-flow:row;flex-grow:0;flex-shrink:0;height:100%;display:flex;overflow:hidden}._container_1ek2u_137{flex-direction:column;height:100%;display:flex}._setup-panel-wrapper_1ek2u_143{flex-direction:column;width:100%;height:calc(100% - 36px);display:flex}._wrapper_1uyi2_125{width:100%;display:flex}._executionButtons_1uyi2_130{justify-content:center;align-items:center;gap:var(--spacing--xs);left:50%;bottom:var(--spacing--sm);width:auto;display:flex;position:absolute;transform:translate(-50%)}@media screen and (max-width:991px){._executionButtons_1uyi2_130{left:auto;right:var(--spacing--sm);transform:none}}._executionButtons_1uyi2_130 ._chatButton_1uyi2_148{align-self:stretch}._setupCredentialsButtonWrapper_1uyi2_152{left:var(--spacing--sm);top:var(--spacing--sm);position:absolute}._readOnlyEnvironmentNotification_1uyi2_158{position:absolute;bottom:16px;left:50%;transform:translate(-50%)}._canvasCenterPill_1uyi2_165{z-index:10;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}\n/*$vite$:1*/",document.head.appendChild(xa);try{ta="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},(Xa=(new ta.Error).stack)&&(ta._sentryDebugIds=ta._sentryDebugIds||{},ta._sentryDebugIds[Xa]="9941183a-c14a-43cd-9f72-16fe0ee30fd1",ta._sentryDebugIdIdentifier="sentry-dbid-9941183a-c14a-43cd-9f72-16fe0ee30fd1")}catch(ta){}var ta,Xa;ba=m({inheritAttrs:!1,__name:"WorkflowCanvas",props:{id:{default:"canvas"},workflow:{},workflowObject:{},fallbackNodes:{default:()=>[]},showFallbackNodes:{type:Boolean,default:!0},eventBus:{default:()=>se()},readOnly:{type:Boolean},executing:{type:Boolean},suppressInteraction:{type:Boolean,default:!1}},setup(e,{expose:t}){const n=e,l=D("canvas"),d=I(),{onNodesInitialized:c,viewport:u,viewportRef:p,getNodes:f,fitBounds:m}=Ve(n.id),v=g(n,"workflow"),y=g(n,"workflowObject"),{nodes:w,connections:x}=va({nodes:a((()=>n.showFallbackNodes?[...n.workflow.nodes,...n.fallbackNodes]:n.workflow.nodes)),connections:a((()=>n.workflow.connections)),workflowObject:y}),b=r(!1),{off:N}=c((()=>{b.value||(n.eventBus.emit("fitView"),b.value=!0,N())})),C=F(w,200),T=F(x,200);return t({executeContextMenuAction:(e,t)=>l.value?.executeContextMenuAction(e,t),ensureNodesAreVisible:e=>{const t=p.value;if(!t)return;const a=f.value.filter((t=>e.includes(t.id)));if(0===a.length)return;const o=c((()=>{const s=u.value,l=t.clientWidth,i=t.clientHeight,r=We(a),d=r.x*s.zoom+s.x,c=r.y*s.zoom+s.y,p=r.width*s.zoom,f=r.height*s.zoom;if(!(d>=0&&c>=0&&d+p<=l&&c+f<=i)){const e={x:-s.x/s.zoom,y:-s.y/s.zoom,width:l/s.zoom,height:i/s.zoom},t=Math.min(e.x,r.x),a=Math.min(e.y,r.y),n=Math.max(e.x+e.width,r.x+r.width),o=Math.max(e.y+e.height,r.y+r.height);m({x:t,y:a,width:n-t,height:o-a},{padding:.15,duration:100})}n.eventBus.emit("nodes:select",{ids:e}),o.off()}))}}),(t,a)=>(E(),o("div",{class:B(i(d).wrapper),"data-test-id":"canvas-wrapper"},[R("div",{id:"canvas",class:B(i(d).canvas)},[v.value?(E(),_(fa,h({key:0,id:e.id,ref:"canvas",nodes:e.executing?i(C):i(w),connections:e.executing?i(T):i(x),"event-bus":e.eventBus,"read-only":e.readOnly,executing:e.executing,"suppress-interaction":e.suppressInteraction},t.$attrs),null,16,["id","nodes","connections","event-bus","read-only","executing","suppress-interaction"])):s("",!0)],2),k(t.$slots,"default")],2))}}),Na=fe(ba,[["__cssModules",{$style:{wrapper:"_wrapper_gh0gb_125",canvas:"_canvas_gh0gb_133"}}]]),ka=fe(m({__name:"FocusSidebarTabs",props:{modelValue:{default:"setup"},tabLabels:{default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:t}){const n=q(),s=e,l=t,r=a((()=>[{label:s.tabLabels?.setup??n.baseText("setupPanel.tabs.setup"),value:"setup"},{label:s.tabLabels?.focus??n.baseText("setupPanel.tabs.focus"),value:"focus"}])),d=e=>{l("update:modelValue",e)};return(t,a)=>(E(),o("div",{class:B(t.$style.container),"data-test-id":"setup-panel-tabs"},[p(i(ie),{"model-value":e.modelValue,options:r.value,size:"small","onUpdate:modelValue":d},null,8,["model-value","options"])],2))}}),[["__cssModules",{$style:{container:"_container_1xsug_125"}}]]),Ca=e=>{const t=Me(),n=Fe(),o=ve(),s=we(),l=Pe(),i=Ge(),r=q(),d=a((()=>e?.value??t.allNodes)),c=e=>n.getCredentialTypeByName(e)?.displayName??e,u=e=>o.isTriggerNode(e.type),p=a((()=>d.value.filter((e=>!e.disabled)).map((e=>({node:e,credentialTypes:Ja(o,e),isTrigger:u(e)}))).filter((({credentialTypes:e,isTrigger:t})=>e.length>0||t)).sort(((e,t)=>Number(t.isTrigger)-Number(e.isTrigger)||e.node.position[0]-t.node.position[0])))),f=a((()=>{const e=new Map;for(const{node:t,credentialTypes:a}of p.value)for(const n of a){const a=e.get(n)??[];a.push(t.name),e.set(n,a)}return e})),m=a((()=>p.value.map((({node:e,credentialTypes:a,isTrigger:n})=>function(e,t,a,n,o=!1,s=!1){const l=t.map((t=>function(e,t,a,n){const o=e.credentials?.[t],s="string"==typeof o?void 0:o?.id??void 0,l=[(e.issues?.credentials??{})[t]??[]].flat();return{credentialType:t,credentialDisplayName:a(t),selectedCredentialId:s,issues:l,nodesWithSameCredential:n.get(t)??[]}}(e,t,a,n))),i=l.every((e=>e.selectedCredentialId&&0===e.issues.length));return{node:e,credentialRequirements:l,isComplete:o?i&&s:i,isTrigger:o}}(e,a,c,f.value,n,(e=>{const a=t.getWorkflowResultDataByNodeName(e);return null!==a&&a.length>0})(e.name)))))),v=a((()=>m.value.reduce(((e,t)=>e+t.credentialRequirements.filter((e=>!e.selectedCredentialId||e.issues.length>0)).length),0))),_=a((()=>m.value.length)),y=a((()=>m.value.length>0&&m.value.every((e=>e.isComplete))));return{nodeSetupStates:m,totalCredentialsMissing:v,totalNodesRequiringSetup:_,isAllComplete:y,setCredential:(e,a,o)=>{const d=n.getCredentialById(o);if(!d)return;const c=t.getNodeByName(e);if(!c)return;const u={id:o,name:d.name};l.updateNodeProperties({name:e,properties:{credentials:{...c.credentials,[a]:u}}}),s.updateNodeCredentialIssuesByName(e);const p=[];for(const n of m.value)if(n.node.name!==e&&n.credentialRequirements.some((e=>e.credentialType===a&&!e.selectedCredentialId))){const e=t.getNodeByName(n.node.name);e&&(l.updateNodeProperties({name:n.node.name,properties:{credentials:{...e.credentials,[a]:u}}}),p.push(n.node.name))}p.length>0&&(s.updateNodesCredentialsIssues(),i.showMessage({title:r.baseText("nodeCredentials.showMessage.title"),message:r.baseText("nodeCredentials.autoAssigned.message",{interpolate:{count:String(p.length)}}),type:"success"}))},unsetCredential:(e,a)=>{const n=t.getNodeByName(e);if(!n)return;const o={...n.credentials};delete o[a],l.updateNodeProperties({name:e,properties:{credentials:o}}),s.updateNodeCredentialIssuesByName(e)}}},Ta=["for"],Ia=fe(m({__name:"SetupCredentialLabel",props:{nodeName:{},credentialType:{},nodesWithSameCredential:{}},setup(e){const t=q();return(a,l)=>(E(),o("div",{class:B(a.$style["credential-label-row"])},[R("label",{"data-test-id":"node-setup-card-credential-label",for:`credential-picker-${e.nodeName}-${e.credentialType}`,class:B(a.$style["credential-label"])},n(i(t).baseText("setupPanel.credentialLabel")),11,Ta),e.nodesWithSameCredential.length>1?(E(),_(i(Y),{key:0,placement:"top"},{content:T((()=>[j(n(e.nodesWithSameCredential.join(", ")),1)])),default:T((()=>[R("span",{"data-test-id":"node-setup-card-shared-nodes-hint",class:B(a.$style["shared-nodes-hint"])},n(i(t).baseText("setupPanel.usedInNodes",{interpolate:{count:String(e.nodesWithSameCredential.length)}})),3)])),_:1})):s("",!0)],2))}}),[["__cssModules",{$style:{"credential-label-row":"_credential-label-row_1nlke_125","credential-label":"_credential-label_1nlke_125","shared-nodes-hint":"_shared-nodes-hint_1nlke_136"}}]]),Ea=m({__name:"NodeSetupCard",props:y({state:{}},{expanded:{type:Boolean,default:!1},expandedModifiers:{}}),emits:y(["credentialSelected","credentialDeselected"],["update:expanded"]),setup(e,{emit:t}){const l=e,d=P(e,"expanded"),c=t,u=q(),f=Ne(),m=ve(),v=Me(),{isExecuting:y,buttonLabel:g,buttonIcon:h,disabledReason:w,hasIssues:k,execute:C}=Xt(a((()=>l.state.node))),I=a((()=>m.getNodeType(l.state.node.type,l.state.node.typeVersion))),O=a((()=>y.value||k.value||!!w.value)),S=a((()=>l.state.isTrigger||l.state.isComplete)),D=a((()=>k.value?u.baseText("ndv.execute.requiredFieldsMissing"):w.value)),A=()=>{d.value=!d.value},V=r(!1),$=async()=>{V.value=!0,await C()};function F(e){const t=new Set;for(const a of e)for(const e of a.nodesWithSameCredential){const a=v.getNodeByName(e);a&&t.add(a.type)}return t}function M(e){let t=0;for(const a of e)t+=a.nodesWithSameCredential.length;return t}return N((()=>l.state.isComplete),(e=>{e&&(d.value=!1,V.value&&(f.track("User completed setup step",{template_id:v.workflow.meta?.templateId,workflow_id:v.workflowId,type:l.state.isTrigger?"trigger":"credential",nodes:Array.from(F(l.state.credentialRequirements)),related_nodes_count:M(l.state.credentialRequirements)}),V.value=!1))})),x((()=>{l.state.isComplete&&(d.value=!1)})),(t,a)=>(E(),o("div",{"data-test-id":"node-setup-card",class:B([t.$style.card,{[t.$style.collapsed]:!d.value,[t.$style.completed]:e.state.isComplete,[t.$style["no-content"]]:!e.state.credentialRequirements.length}])},[R("header",{"data-test-id":"node-setup-card-header",class:B(t.$style.header),onClick:A},[!d.value&&e.state.isComplete?(E(),_(i(ne),{key:0,"data-test-id":"node-setup-card-complete-icon",icon:"check",class:B(t.$style["complete-icon"]),size:"medium"},null,8,["class"])):(E(),_(Gt,{key:1,"node-type":I.value,size:16},null,8,["node-type"])),p(i(oe),{class:B(t.$style["node-name"]),size:"medium",color:"text-dark"},{default:T((()=>[j(n(l.state.node.name),1)])),_:1},8,["class"]),e.state.isTrigger?(E(),_(i(Y),{key:2},{content:T((()=>[j(n(i(u).baseText("nodeCreator.nodeItem.triggerIconTitle")),1)])),default:T((()=>[p(i(ne),{class:B([t.$style["header-icon"],t.$style.trigger]),icon:"zap",size:"small",color:"text-light"},null,8,["class"])])),_:1})):s("",!0),p(i(ne),{class:B([t.$style["header-icon"],t.$style.chevron]),icon:d.value?"chevrons-down-up":"chevrons-up-down",size:"medium",color:"text-light"},null,8,["class","icon"])],2),d.value?(E(),o(b,{key:0},[e.state.credentialRequirements.length?(E(),o("div",{key:0,class:B({[t.$style.content]:!0,"pb-s":!S.value})},[e.state.isTrigger?(E(),_(i(oe),{key:0,size:"medium",color:"text-light",class:"mb-3xs"},{default:T((()=>[j(n(i(u).baseText("setupPanel.trigger.credential.note")),1)])),_:1})):s("",!0),(E(!0),o(b,null,W(e.state.credentialRequirements,(a=>(E(),o("div",{key:a.credentialType,class:B(t.$style["credential-container"])},[p(Ia,{"node-name":e.state.node.name,"credential-type":a.credentialType,"nodes-with-same-credential":a.nodesWithSameCredential},null,8,["node-name","credential-type","nodes-with-same-credential"]),p(la,{"create-button-type":"secondary",class:B(t.$style["credential-picker"]),"app-name":a.credentialDisplayName,"credential-type":a.credentialType,"selected-credential-id":a.selectedCredentialId??null,onCredentialSelected:e=>{return t=a.credentialType,n=e,V.value=!0,void c("credentialSelected",{credentialType:t,credentialId:n});var t,n},onCredentialDeselected:e=>{return t=a.credentialType,V.value=!0,void c("credentialDeselected",t);var t}},null,8,["class","app-name","credential-type","selected-credential-id","onCredentialSelected","onCredentialDeselected"])],2)))),128))],2)):s("",!0),S.value?(E(),o("footer",{key:1,class:B(t.$style.footer)},[e.state.isComplete?(E(),o("div",{key:0,class:B(t.$style["footer-complete-check"])},[p(i(ne),{icon:"check",class:B(t.$style["complete-icon"]),size:"large"},null,8,["class"]),p(i(oe),{size:"medium",color:"success"},{default:T((()=>[j(n(i(u).baseText("generic.complete")),1)])),_:1})],2)):s("",!0),e.state.isTrigger?(E(),_(i(Y),{key:1,disabled:!D.value,placement:"top"},{content:T((()=>[j(n(D.value),1)])),default:T((()=>[p(i(G),{"data-test-id":"node-setup-card-test-button",label:i(g),disabled:O.value,loading:i(y),icon:i(h),size:"small",onClick:$},null,8,["label","disabled","loading","icon"])])),_:1},8,["disabled"])):s("",!0)],2)):s("",!0)],64)):s("",!0)],2))}}),Pa=fe(Ea,[["__cssModules",{$style:{card:"_card_l1dfx_125","header-icon":"_header-icon_l1dfx_134",chevron:"_chevron_l1dfx_134",trigger:"_trigger_l1dfx_140",header:"_header_l1dfx_134",collapsed:"_collapsed_l1dfx_151","no-content":"_no-content_l1dfx_154","node-name":"_node-name_l1dfx_158","complete-icon":"_complete-icon_l1dfx_163",content:"_content_l1dfx_167","credential-container":"_credential-container_l1dfx_174","credential-picker":"_credential-picker_l1dfx_180",footer:"_footer_l1dfx_184","footer-complete-check":"_footer-complete-check_l1dfx_190",completed:"_completed_l1dfx_206"}}]]),Oa=fe(m({__name:"SetupPanelCards",setup(e){const t=q(),a=Ne(),l=Me(),{nodeSetupStates:r,isAllComplete:d,setCredential:c,unsetCredential:u}=Ca();return N(d,(e=>{e&&a.track("User completed all setup steps",{template_id:l.workflow.meta?.templateId,workflow_id:l.workflowId})})),(e,a)=>(E(),o("div",{class:B(e.$style.container),"data-test-id":"setup-panel-cards-container"},[0===i(r).length?(E(),o("div",{key:0,class:B(e.$style["empty-state"]),"data-test-id":"setup-cards-empty"},[p(i(ne),{icon:"list-checks",class:B(e.$style["empty-icon"]),size:24,color:"text-base"},null,8,["class"]),R("div",{class:B(e.$style["empty-text"])},[p(i(oe),{size:"medium",color:"text-base",bold:!0,"data-test-id":"setup-cards-empty-heading"},{default:T((()=>[j(n(i(t).baseText("setupPanel.empty.heading")),1)])),_:1}),p(i(oe),{size:"medium",color:"text-light","data-test-id":"setup-cards-empty-description"},{default:T((()=>[j(n(i(t).baseText("setupPanel.empty.description")),1)])),_:1})],2)],2)):(E(),o("div",{key:1,class:B(e.$style["card-list"]),"data-test-id":"setup-cards-list"},[(E(!0),o(b,null,W(i(r),((e,t)=>(E(),_(Pa,{key:e.node.id,state:e,expanded:0===t,onCredentialSelected:t=>{return a=e.node.name,void c(a,(n=t).credentialType,n.credentialId);var a,n},onCredentialDeselected:t=>{return a=e.node.name,void u(a,t);var a}},null,8,["state","expanded","onCredentialSelected","onCredentialDeselected"])))),128)),i(d)?(E(),o("div",{key:0,class:B(e.$style["complete-message"]),"data-test-id":"setup-cards-complete-message"},[p(i(oe),{size:"medium",color:"text-base"},{default:T((()=>[j(n(i(t).baseText("setupPanel.everythingConfigured.message")),1)])),_:1})],2)):s("",!0)],2))],2))}}),[["__cssModules",{$style:{container:"_container_1011p_125","card-list":"_card-list_1011p_126","empty-state":"_empty-state_1011p_134","empty-text":"_empty-text_1011p_144","complete-message":"_complete-message_1011p_150"}}]]),Wa=fe(m({__name:"SetupPanel",setup:e=>(e,t)=>(E(),o("div",{class:B(e.$style.container),"data-test-id":"setup-panel-container"},[p(Oa)],2))}),[["__cssModules",{$style:{container:"_container_17sfi_125"}}]]),ja=m({__name:"ExperimentalNodeDetailsDrawer",props:{node:{},nodeIds:{},isReadOnly:{type:Boolean}},emits:["openNdv","contextMenuAction"],setup(e,{emit:t}){const l=t,d=pa(a((()=>e.node))),c=ma(a((()=>e.nodeIds))),u=me(),f=r(0),m=a((()=>[e.node.id,f.value].join("|")));return N((()=>u.activeNodeName),((e,t)=>{null===e&&null!==t&&(f.value+=1)})),A(St,d),(t,a)=>(E(),o("div",{class:B(t.$style.component)},[e.nodeIds.length>1?(E(),_(i(oe),{key:0,tag:"div",color:"text-base",class:B(t.$style.multipleNodes)},{default:T((()=>[R("div",null,n(e.nodeIds.length)+" nodes selected",1),R("ul",{class:B(t.$style.multipleNodesActions)},[(E(!0),o(b,null,W(i(c),(a=>(E(),o("li",{key:a.id,class:B(t.$style.multipleNodesAction)},[p(i(G),{variant:"subtle",disabled:a.disabled,onClick:t=>l("contextMenuAction",a.id,e.nodeIds)},{default:T((()=>[j(n(a.label)+" ",1),a.shortcut?(E(),_(i(Z),h({key:0,ref_for:!0},a.shortcut),null,16)):s("",!0)])),_:2},1032,["disabled","onClick"])],2)))),128))],2)])),_:1},8,["class"])):e.node?(E(),_(ua,{key:m.value,"node-id":e.node.id,"is-read-only":e.isReadOnly},null,8,["node-id","is-read-only"])):s("",!0)],2))}}),Sa=fe(ja,[["__cssModules",{$style:{component:"_component_1ef46_125",multipleNodes:"_multipleNodes_1ef46_130",multipleNodesActions:"_multipleNodesActions_1ef46_140",multipleNodesAction:"_multipleNodesAction_1ef46_140"}}]]),Da=m({__name:"ExperimentalFocusPanelHeader",props:{node:{},parameter:{},isExecutable:{type:Boolean},readOnly:{type:Boolean}},emits:["execute","openNdv","clearParameter","renameNode"],setup(e,{emit:t}){const l=t,r=ve(),d=q(),c=a((()=>r.getNodeType(e.node.type,e.node.typeVersion)));return(t,a)=>(E(),_(i(oe),{tag:"header",size:"small",bold:"",class:B(t.$style.component)},{default:T((()=>[p(Gt,{"node-type":c.value,size:16},null,8,["node-type"]),R("div",{class:B(t.$style.breadcrumbs)},[e.parameter?(E(),o(b,{key:0},[p(i(oe),{size:"small",color:"text-base",bold:""},{default:T((()=>[j(n(e.node.name),1)])),_:1}),p(i(oe),{size:"small",color:"text-light"},{default:T((()=>[...a[4]||(a[4]=[j("/",-1)])])),_:1}),j(" "+n(e.parameter.displayName),1)],64)):(E(),_(i(le),{key:1,"model-value":e.node.name,"min-width":0,"max-width":500,placeholder:i(d).baseText("ndv.title.rename.placeholder"),"read-only":e.readOnly,"onUpdate:modelValue":a[0]||(a[0]=e=>l("renameNode",e))},null,8,["model-value","placeholder","read-only"]))],2),e.parameter?(E(),_(i(Q),{key:0,variant:"ghost",icon:"x",size:"small",onClick:a[1]||(a[1]=e=>l("clearParameter"))})):(E(),_(i(Q),{key:1,variant:"ghost",icon:"expand",size:"small",onClick:a[2]||(a[2]=e=>l("openNdv"))})),e.isExecutable?(E(),_(Jt,{key:2,"data-test-id":"node-execute-button","node-name":e.node.name,tooltip:`Execute ${e.node.name}`,type:"secondary",size:"small",icon:"play",square:!0,"hide-label":!0,"telemetry-source":"focus",onExecute:a[3]||(a[3]=e=>l("execute"))},null,8,["node-name","tooltip"])):s("",!0)])),_:1},8,["class"]))}}),Aa=fe(Da,[["__cssModules",{$style:{component:"_component_1p4tv_125",breadcrumbs:"_breadcrumbs_1p4tv_133"}}]]),Va=m({name:"FocusPanel",__name:"FocusPanel",props:{isCanvasReadOnly:{type:Boolean}},emits:["focus","saveKeyboardShortcut","contextMenuAction"],setup(e,{emit:t}){const d=e,c=t,u=r(),f=q(),m=we(),v=De(),y=Me(),h=Pe(),w=ve(),x=Ne(),k=ot(),C=ge(),I=qt(),P=me(),O=Ve(y.workflowId),{renameNode:W}=Kt(),S=a((()=>v.resolvedParameter)),D=r(""),A=U((async()=>{if(!S.value)return!1;const e=S.value.parameterPath.split(".").slice(1,-1).join(".");return!!S.value.parameter.disabledOptions&&await k.shouldDisplayNodeParameter(S.value.node.parameters,S.value.node,S.value.parameter,e,"disabledOptions")}),!1),V=U((async()=>{if(!S.value)return!0;const e=S.value.parameterPath.split(".").slice(1,-1).join(".");return await k.shouldDisplayNodeParameter(S.value.node.parameters,S.value.node,S.value.parameter,e,"displayOptions")}),!0),$=a((()=>{if(!I.isNdvInFocusPanelEnabled||S.value)return S.value?.node;const e=O.getSelectedNodes.value[0];return e?.data?.render.type===Oe.Default?y.allNodes.find((t=>t.id===e.id)):void 0})),F=a((()=>O.getSelectedNodes.value.length>1)),M=a((()=>{if(!$.value)return!1;if(!V.value)return!1;const e=m.getForeignCredentialsIfSharingEnabled($.value.credentials);return m.isNodeExecutable($.value,!d.isCanvasReadOnly,e)})),{workflowRunData:z}=ha({node:$}),L=a((()=>{if(!$.value)return!0;const e=y.workflowObject.getParentNodes($.value.name,"main",1)[0];return Boolean(e&&z.value&&Object.prototype.hasOwnProperty.bind(z.value)(e))}));function H(e){return S.value?tt(S.value.parameter,e):void 0}const K=a((()=>S.value?.node.parameters.mode)),G=a((()=>H("editor")??void 0)),J=a((()=>"json"===G.value||"json"===S.value?.parameter.type?"json":H("editorLanguage")??"javaScript")),X=a((()=>H("rows"))),Q=a((()=>!!S.value&&w.isToolNode(S.value?.node.type))),Y=a((()=>!!S.value&&"n8n-nodes-base.html"===S.value.node.type)),Z=a((()=>S.value&&xe(S.value.parameter,S.value.value))),te=a((()=>Z.value?vt(S.value)?S.value.value:S.value:"")),ae=a((()=>S.value?.node.type===Ct)),se=a((()=>d.isCanvasReadOnly||A.value)),le=a((()=>({$vars:C.variablesAsObject}))),ie=a((()=>{if(S.value)return{nodeName:S.value.node.name,parameterPath:S.value.parameterPath}})),de=a((()=>h.executingNode.isNodeExecuting($.value?.name??""))),ce=a((()=>O.getSelectedNodes.value.map((e=>e.id)))),ue=a((()=>I.isNdvInFocusPanelEnabled?f.baseText("nodeView.focusPanel.v2.noParameters.title"):f.baseText("nodeView.focusPanel.noParameters.title"))),fe=a((()=>I.isNdvInFocusPanelEnabled?f.baseText("nodeView.focusPanel.v2.noParameters.subtitle"):f.baseText("nodeView.focusPanel.noParameters.subtitle"))),{resolvedExpression:_e}=lt({expression:te,additionalData:le,stringifyObject:S.value&&"multiOptions"!==S.value.parameter.type});function ye(e){void 0!==S.value&&k.updateNodeParameter(g(S.value.node.parameters),{value:e,name:S.value.parameterPath},e,S.value.node,Q.value)}async function he(){await l(),u.value&&(Ae(u.value)?u.value.focusOnInput():Ue(u.value)&&u.value.focus()),c("focus")}function be(e){if(S.value)switch(e){case"resetValue":"string"==typeof S.value.parameter.default&&ye(S.value.parameter.default),he();break;case"addExpression":{const e=st(S.value.value,S.value.parameter.type);ye("string"==typeof e?e:e.value),he();break}case"removeExpression":{const e=nt(S.value.value,_e.value,S.value.parameter.type,S.value.parameter.default,(S.value.parameter.options??[]).filter(rt));"string"==typeof e?ye(e):e&&"string"==typeof e.value&&ye(e.value),he();break}case"formatHtml":qe.emit("format-html")}}function ke(){if(I.isNdvInFocusPanelEnabled&&S.value)return v.unsetParameters(),void x.track("User removed focused param",{source:"closeIcon",parameters:v.focusedNodeParametersInTelemetryFormat});x.track("User closed focus panel",{source:"closeIcon",parameters:v.focusedNodeParametersInTelemetryFormat}),v.closeFocusPanel()}function Ce(){x.track("User executed node from focus panel",v.focusedNodeParametersInTelemetryFormat[0])}function Te(e){D.value=e,ye(e)}function Ie(){$.value&&P.setActiveNodeName($.value.name,"focus_panel")}function Ee(e){$.value&&W($.value.name,e)}return N([()=>v.lastFocusTimestamp,()=>Z.value],(()=>{setTimeout((()=>{he()}),50)})),N((()=>S.value),(e=>{if(e){const t=e.value;"string"==typeof t&&t!==D.value&&(D.value=t)}}),{immediate:!0}),(t,a)=>(E(),o("div",{"data-test-id":"focus-panel",class:B([t.$style.content,{[t.$style.isNdvInFocusPanelEnabled]:i(I).isNdvInFocusPanelEnabled}])},[i(I).isNdvInFocusPanelEnabled&&$.value&&!F.value?(E(),_(Aa,{key:0,node:$.value,parameter:S.value?.parameter,"is-executable":M.value,"read-only":e.isCanvasReadOnly,onExecute:Ce,onOpenNdv:Ie,onClearParameter:ke,onRenameNode:Ee},null,8,["node","parameter","is-executable","read-only"])):s("",!0),S.value?(E(),o("div",{key:1,class:B(t.$style.content),"data-test-id":"focus-parameter"},[i(I).isNdvInFocusPanelEnabled?s("",!0):(E(),o("div",{key:0,class:B(t.$style.tabHeader)},[R("div",{class:B(t.$style.tabHeaderText)},[p(i(oe),{color:"text-dark",size:"small"},{default:T((()=>[j(n(S.value.parameter.displayName),1)])),_:1}),p(i(oe),{color:"text-base",size:"xsmall"},{default:T((()=>[j(n(S.value.node.name),1)])),_:1})],2),R("div",{class:B(t.$style.buttonWrapper)},[p(Jt,{"data-test-id":"node-execute-button","node-name":S.value.node.name,tooltip:`Execute ${S.value.node.name}`,disabled:!M.value,size:"small",icon:"play",square:!0,"hide-label":!0,"telemetry-source":"focus",onExecute:Ce},null,8,["node-name","tooltip","disabled"]),p(i(ne),{class:B(t.$style.closeButton),icon:"x",color:"text-base",size:"xlarge",onClick:ke},null,8,["class"])],2)],2)),R("div",{class:B(t.$style.parameterDetailsWrapper)},[R("div",{class:B(t.$style.parameterOptionsWrapper)},[R("div",{class:B(t.$style.noExecutionDataTip)},[L.value||de.value?s("",!0):(E(),_(i(ee),{key:0,class:B(t.$style.delayedShow),bold:!0},{default:T((()=>[j(n(i(f).baseText("nodeView.focusPanel.noExecutionData")),1)])),_:1},8,["class"]))],2),i(V)?(E(),_(at,{key:0,parameter:S.value.parameter,value:S.value.value,"is-read-only":se.value,"onUpdate:modelValue":be},null,8,["parameter","value","is-read-only"])):s("",!0)],2),"string"==typeof S.value.value?(E(),o("div",{key:0,class:B(t.$style.editorContainer)},[i(V)?Z.value?(E(),_(Xe,{key:1,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e),class:B(t.$style.editor),"is-read-only":se.value,path:S.value.parameterPath,"data-test-id":"expression-modal-input","target-node-parameter-context":ie.value,onChange:a[1]||(a[1]=e=>Te(e.value))},null,8,["modelValue","class","is-read-only","path","target-node-parameter-context"])):["json","string"].includes(S.value.parameter.type)?(E(),o(b,{key:2},["codeNodeEditor"===G.value?(E(),_(Qe,{key:0,id:S.value.parameterPath,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":[a[2]||(a[2]=e=>D.value=e),Te],class:B(t.$style.heightFull),mode:K.value,"default-value":S.value.parameter.default,language:J.value,"is-read-only":se.value,"target-node-parameter-context":ie.value,"fill-parent":"","disable-ask-ai":!0},null,8,["id","modelValue","class","mode","default-value","language","is-read-only","target-node-parameter-context"])):"htmlEditor"===G.value?(E(),_(Ze,{key:1,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>D.value=e),Te],"is-read-only":se.value,rows:X.value,"disable-expression-coloring":!Y.value,"disable-expression-completions":!Y.value,fullscreen:"","target-node-parameter-context":ie.value},null,8,["modelValue","is-read-only","rows","disable-expression-coloring","disable-expression-completions","target-node-parameter-context"])):"cssEditor"===G.value?(E(),_(it,{key:2,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":[a[4]||(a[4]=e=>D.value=e),Te],"is-read-only":se.value,rows:X.value,fullscreen:"","target-node-parameter-context":ie.value},null,8,["modelValue","is-read-only","rows","target-node-parameter-context"])):"sqlEditor"===G.value?(E(),_(et,{key:3,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":[a[5]||(a[5]=e=>D.value=e),Te],dialect:H("sqlDialect"),"is-read-only":se.value,rows:X.value,fullscreen:"","target-node-parameter-context":ie.value},null,8,["modelValue","dialect","is-read-only","rows","target-node-parameter-context"])):"jsEditor"===G.value?(E(),_(Ye,{key:4,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":[a[6]||(a[6]=e=>D.value=e),Te],"is-read-only":se.value,rows:X.value,"posthog-capture":ae.value,"fill-parent":""},null,8,["modelValue","is-read-only","rows","posthog-capture"])):"json"===S.value.parameter.type?(E(),_(Ft,{key:5,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":[a[7]||(a[7]=e=>D.value=e),Te],"is-read-only":se.value,rows:X.value,fullscreen:"","fill-parent":""},null,8,["modelValue","is-read-only","rows"])):(E(),_(i(re),{key:6,ref_key:"inputField",ref:u,modelValue:D.value,"onUpdate:modelValue":[a[8]||(a[8]=e=>D.value=e),Te],class:B(t.$style.editor),readonly:se.value,type:"textarea",resize:"none"},null,8,["modelValue","class","readonly"]))],64)):s("",!0):(E(),o("div",{key:0,class:B([t.$style.content,t.$style.emptyContent])},[R("div",{class:B(t.$style.emptyText)},[p(i(oe),{color:"text-base"},{default:T((()=>[j(n(i(f).baseText("nodeView.focusPanel.missingParameter")),1)])),_:1})],2)],2))],2)):s("",!0)],2)],2)):$.value&&i(I).isNdvInFocusPanelEnabled?(E(),_(Sa,{key:2,node:$.value,"node-ids":ce.value,"is-read-only":se.value,onOpenNdv:Ie,onContextMenuAction:a[9]||(a[9]=(e,t)=>c("contextMenuAction",e,t))},null,8,["node","node-ids","is-read-only"])):(E(),o("div",{key:3,class:B([t.$style.content,t.$style.emptyContent])},[R("div",{class:B(t.$style.focusParameterWrapper)},[R("div",{class:B(t.$style.iconWrapper)},[p(i(ne),{class:B(t.$style.forceHover),icon:"panel-right",size:"medium"},null,8,["class"]),p(i(ne),{class:B(t.$style.pointerIcon),icon:"mouse-pointer",color:"text-dark",size:"large"},null,8,["class"])],2),p(i(ne),{icon:"ellipsis-vertical",size:"small",color:"text-base"}),p(i(pe),{size:"small","model-value":"expression",disabled:!0,options:[{label:i(f).baseText("parameterInput.fixed"),value:"fixed"},{label:i(f).baseText("parameterInput.expression"),value:"expression"}]},null,8,["options"])],2),R("div",{class:B(t.$style.emptyText)},[p(i(oe),{color:"text-base",size:"medium",bold:!0},{default:T((()=>[j(n(ue.value),1)])),_:1}),p(i(oe),{color:"text-base",size:"small"},{default:T((()=>[j(n(fe.value),1)])),_:1})],2)],2))],2))}}),Ba=fe(Va,[["__cssModules",{$style:{content:"_content_9h1id_125",emptyContent:"_emptyContent_9h1id_131",isNdvInFocusPanelEnabled:"_isNdvInFocusPanelEnabled_9h1id_136",emptyText:"_emptyText_9h1id_139",focusParameterWrapper:"_focusParameterWrapper_9h1id_145",iconWrapper:"_iconWrapper_9h1id_152",pointerIcon:"_pointerIcon_9h1id_156",tabHeader:"_tabHeader_9h1id_166",tabHeaderText:"_tabHeaderText_9h1id_173",buttonWrapper:"_buttonWrapper_9h1id_178",parameterDetailsWrapper:"_parameterDetailsWrapper_9h1id_183",parameterOptionsWrapper:"_parameterOptionsWrapper_9h1id_190",noExecutionDataTip:"_noExecutionDataTip_9h1id_194",editorContainer:"_editorContainer_9h1id_197",editor:"_editor_9h1id_197",delayedShow:"_delayedShow_9h1id_213",triggerShow:"_triggerShow_9h1id_1",closeButton:"_closeButton_9h1id_224",heightFull:"_heightFull_9h1id_228",forceHover:"_forceHover_9h1id_232"}}]]),Ra={key:0},$a=m({name:"FocusSidebar",__name:"FocusSidebar",props:{isCanvasReadOnly:{type:Boolean}},emits:["contextMenuAction"],setup(e,{emit:t}){const n=t,l=D("wrapper"),r=De(),c=Me(),u=qt(),f=ga(),m=Ne(),v=de(),y=Ve(c.workflowId),g=M();Qt({view_shown:"focus_panel"});const{selectedTab:h}=At(r),w=a((()=>r.focusPanelActive)),x=a((()=>r.focusPanelWidth)),b=a((()=>r.resolvedParameter)),k=a((()=>f.isFeatureEnabled)),I=a((()=>f.isFeatureEnabled&&"setup"===h.value)),P=a((()=>{if(!u.isNdvInFocusPanelEnabled||b.value)return b.value?.node;const e=y.getSelectedNodes.value[0];return e?.data?.render.type===Oe.Default?c.allNodes.find((t=>t.id===e.id)):void 0})),W=a((()=>{const e=b.value?.parameter.displayName??P.value?.name;return e?{focus:e}:void 0}));function j(e){"s"===e.key&&v.isCtrlKeyPressed(e)&&(e.stopPropagation(),e.preventDefault())}const A=()=>{document.removeEventListener("keydown",j,!0)};N((()=>r.focusPanelActive),(e=>{e?document.addEventListener("keydown",j,!0):A()}),{immediate:!0}),N(g,(e=>{if(!P.value||!e||!l.value?.contains(e))return;const t=e.closest(".parameter-input")?.getAttribute("data-parameter-path");t&&m.track("User focused focus panel",{node_id:P.value.id,node_type:P.value.type,parameter_path:t})}));const V=L((function(e){r.updateWidth(e.width)}),10);function $(e,t){n("contextMenuAction",e,t)}return d((()=>{A()})),(t,a)=>w.value?(E(),o("div",{key:0,ref:"wrapper","data-test-id":"focus-sidebar",class:B([t.$style.wrapper,"ignore-key-press-canvas",{[t.$style.isNdvInFocusPanelEnabled]:i(u).isNdvInFocusPanelEnabled}]),onKeydown:a[1]||(a[1]=O((()=>{}),["stop"]))},[p(i(J),{width:x.value,"supported-directions":["left"],"min-width":k.value?420:300,"max-width":i(u).isNdvInFocusPanelEnabled?void 0:1e3,"grid-size":8,style:C({width:`${x.value}px`}),onResize:i(V)},{default:T((()=>[R("div",{class:B(t.$style.container)},[k.value?(E(),o("div",Ra,[p(ka,{modelValue:i(h),"onUpdate:modelValue":a[0]||(a[0]=e=>S(h)?h.value=e:null),"tab-labels":W.value},null,8,["modelValue","tab-labels"])])):s("",!0),I.value?(E(),o("div",{key:1,class:B(t.$style["setup-panel-wrapper"])},[p(Wa)],2)):(E(),_(Ba,{key:2,"is-canvas-read-only":e.isCanvasReadOnly,onContextMenuAction:$},null,8,["is-canvas-read-only"]))],2)])),_:1},8,["width","min-width","max-width","style","onResize"])],34)):s("",!0)}}),Fa=fe($a,[["__cssModules",{$style:{wrapper:"_wrapper_1ek2u_125",container:"_container_1ek2u_137","setup-panel-wrapper":"_setup-panel-wrapper_1ek2u_143"}}]]),Ma=m({__name:"CanvasStopCurrentExecutionButton",props:{stopping:{type:Boolean}},setup(e){const t=e,n=q(),o=a((()=>t.stopping?n.baseText("nodeView.stoppingCurrentExecution"):n.baseText("nodeView.stopCurrentExecution")));return(t,a)=>(E(),_(i(Q),{variant:"subtle",icon:"square",size:"large",class:"stop-execution",title:o.value,loading:e.stopping,"data-test-id":"stop-execution-button"},null,8,["title","loading"]))}}),Ua=Ma,za=m({__name:"CanvasStopWaitingForWebhookButton",setup(e){const t=q();return(e,a)=>(E(),_(i(Q),{variant:"subtle",class:"stop-execution",icon:"square",size:"large",title:i(t).baseText("nodeView.stopWaitingForWebhookCall"),"data-test-id":"stop-execution-waiting-for-webhook-button"},null,8,["title"]))}}),La={"data-action":"reload"},qa={href:"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.wait/",target:"_blank"},Ha=m({__name:"NodeViewUnfinishedWorkflowMessage",setup(e){const t=q();return(e,a)=>(E(),o("div",null,[R("a",La,n(i(t).baseText("nodeView.refresh")),1),j(" "+n(i(t).baseText("nodeView.toSeeTheLatestStatus"))+". ",1),a[0]||(a[0]=R("br",null,null,-1)),R("a",qa,n(i(t).baseText("nodeView.moreInfo")),1)]))}}),Ka=m({__name:"CanvasChatButton",props:{label:{},variant:{}},setup:e=>(t,a)=>(E(),_(i(G),{label:e.label,size:"large",icon:"message-circle",variant:e.variant,"data-test-id":"workflow-chat-button"},null,8,["label","variant"]))}),Ga=m({name:"NodeView",__name:"NodeView",setup(e){const m=f((async()=>await X((()=>t.import("./NodeCreation-legacy-DEDSVlbn.js")),void 0))),y=f((async()=>await X((()=>t.import("./NodeDetailsView-legacy-BXQM9KNw.js")),void 0))),g=f((async()=>await X((()=>t.import("./NodeDetailsViewV2-legacy-DL5UUgez.js")),void 0))),h=f((async()=>await X((()=>t.import("./SetupWorkflowCredentialsButton-legacy-Cj14d-NN.js")),void 0))),k=I(),C=ce(),P=K(),O=q(),W=Ne(),S=Ke(),A=Ge(),R=Ee(),F=je(),M=Re({router:C,onSaved:e=>{Ht.emit("saved:workflow",{isFirstSave:e})}}),U=we(),L=Bt({onPaste:async function(e){if(be(P)!==Tt.WORKFLOW||!_n.value||!Jo())return;let t=null;if(e.match(pt)){if("confirm"!==await R.confirm(O.baseText("nodeView.confirmMessage.onClipboardPasteEvent.message",{interpolate:{plainTextData:e}}),O.baseText("nodeView.confirmMessage.onClipboardPasteEvent.headline"),{type:"warning",confirmButtonText:O.baseText("nodeView.confirmMessage.onClipboardPasteEvent.confirmButtonText"),cancelButtonText:O.baseText("nodeView.confirmMessage.onClipboardPasteEvent.cancelButtonText")}))return;t=await Aa(e)}else t=ct(e,{fallbackValue:null});if(!t)return;const a=(await Da(t,"paste",{importTags:!1,viewport:Zo.value})).nodes?.map((e=>e.id))??[];Qa.value?.ensureNodesAreVisible(a)}}),G=ve(),J=$e(),Q=Me(),Y=Te(),Z=He(),ee=zt(),ne=Fe(),oe=ge(),se=Vt(),le=Rt(),ie=Ie(),re=ye(),de=he(),pe=ze(),fe=Ce(),xe=ea(),We=me(),Ae=De(),Ve=Le(),Ue=Yt(),qe=Lt(),Xe=qt(),Qe=oa(),Ye=wa(),Ze=$t(),et=Pe();!function(){const e=oa(),t=z((()=>{e.recordActivity()}),It(ft.COLLABORATION.ACTIVITY)),a=["mousedown","keydown","touchstart"],n=()=>{a.forEach((e=>{document.addEventListener(e,t,{passive:!0})}))},o=()=>{a.forEach((e=>{document.removeEventListener(e,t)}))};N((()=>e.isCurrentUserWriter),(e=>{e?n():o()})),x((()=>{e.isCurrentUserWriter&&n()})),v((()=>{o()}))}();const{addBeforeUnloadEventBindings:tt,removeBeforeUnloadEventBindings:at}=na({route:P}),{registerCustomAction:nt,unregisterCustomAction:ot}=ra(),{runWorkflow:st,runEntireWorkflow:lt,stopCurrentExecution:it,stopWaitingForWebhook:rt}=Zt({router:C}),{updateNodePosition:vt,updateNodesPosition:Ct,tidyUp:St,revertUpdateNodePosition:At,renameNode:Ft,revertRenameNode:Gt,revertReplaceNodeParameters:Jt,setNodeActive:Xt,setNodeSelected:Qt,toggleNodesDisabled:la,revertToggleNodeDisabled:ua,toggleNodesPinned:pa,setNodeParameters:fa,deleteNode:ma,deleteNodes:va,copyNodes:ga,cutNodes:ha,duplicateNodes:xa,revertDeleteNode:ba,revertAddNode:ka,createConnection:Ca,revertCreateConnection:Ta,deleteConnection:Ia,revertDeleteConnection:Ea,revalidateNodeInputConnections:Pa,revalidateNodeOutputConnections:Oa,setNodeActiveByName:Wa,clearNodeActive:ja,tryToOpenSubworkflowInNewTab:Sa,importWorkflowData:Da,fetchWorkflowDataFromUrl:Aa,resetWorkspace:Va,initializeWorkspace:Ba,openExecution:Ra,editableWorkflow:$a,editableWorkflowObject:Ma,lastClickPosition:La,startChat:qa,addNodesAndConnections:Ga,fitView:Ja}=Kt(),{extractWorkflow:Xa}=da();_a({ctrl_alt_o:()=>J.openModal(kt)});const Qa=D("canvas"),Ya=r(!0),Za=r(null),en=r(!1),tn=r(!1),an=r(!0),nn=r(!1),on=r([]),sn=ya(_t),ln=a((()=>{const e=P.params.nodeId;return Array.isArray(e)?e[0]:e})),rn=a((()=>"true"===P.query.new)),dn=a((()=>"true"===P.query.hideControls)),cn=a((()=>P.name===Pt.DEMO)),un=a((()=>!!P?.meta?.readOnlyCanvas)),pn=a((()=>Z.preferences.branchReadOnly)),fn=a((()=>!0)),mn=a((()=>cn.value||pn.value||Qe.shouldBeReadOnly||!(bo.value.update??No.value.workflow.update)||$a.value.isArchived||Ve.streaming)),vn=a((()=>0===wn.value.length)),_n=a((()=>!We.activeNode&&0===J.activeModals.length)),yn=a((()=>qe.isOpen));function gn(){"addEvaluationTrigger"===P.query.action?ee.openNodeCreatorForTriggerNodes(yt.ADD_EVALUATION_TRIGGER_BUTTON):"addEvaluationNode"===P.query.action?ee.openNodeCreatorForActions(wt,yt.ADD_EVALUATION_NODE_BUTTON):"executeEvaluation"===P.query.action&&Ho.value&&lt("node",Ho.value.name),Ht.off("saved:workflow",Xo),P.name===Pt.EXECUTION_DEBUG&&Ht.on("saved:workflow",Xo),l((()=>{hn()}))}function hn(){U.updateNodesInputIssues(),U.updateNodesCredentialsIssues(),U.updateNodesParameterIssues()}const wn=a((()=>$a.value.nodes.filter((e=>G.isTriggerNode(e.type))))),xn=a((()=>wn.value.length>0)),bn=a((()=>wn.value.filter((e=>e.disabled)).length===wn.value.length));function Nn(e,t){St(e,t)}function kn(e){Xa(e)}function Cn(e){Ct(e,{trackHistory:!0})}function Tn(e,t){vt(e,t,{trackHistory:!0})}function In({nodeName:e,position:t}){At(e,{x:t[0],y:t[1]})}function En(e){const t=on.value.findIndex((t=>t.id===e));t>=0?on.value.splice(t,1):ma(e,{trackHistory:!0})}function Pn(e){va(e)}function On({node:e}){ba(e)}function Wn(e){Jo()&&la([e])}function jn({nodeName:e}){ua(e)}function Sn(e){Jo()&&la(e)}function Dn(e,t){La.value=[t.x,t.y],go()}function An(e,t){(t?.metaKey||t?.ctrlKey)&&Sa(e)||Xt(e,"canvas_default_view")}function Vn(e){Sa(e)}function Bn(){ja()}function Rn(e){go(),Qt(e)}async function $n(e){await ga(e),A.showMessage({title:O.baseText("generic.copiedToClipboard"),type:"success"})}async function Fn(e){mn.value?await ga(e):await ha(e)}async function Mn(e){if(!Jo())return;const t=await xa(e,{viewport:Zo.value});Qa.value?.ensureNodesAreVisible(t)}function Un(e,t){Jo()&&pa(e,t)}function zn(e,t){Qa.value?.executeContextMenuAction(e,t)}async function Ln(){await C.push({name:Pt.NEW_WORKFLOW})}function qn(e){We.activeNode?.name&&Ft(We.activeNode.name,e)}async function Hn(e){const t=Q.getNodeById(e)?.name??"",a=document.activeElement;if((!a||!Ut(a))&&_n.value&&!document.querySelector(".rename-prompt"))try{const e=R.prompt(O.baseText("nodeView.prompt.newName")+":",O.baseText("nodeView.prompt.renameNode")+`: ${t}`,{customClass:"rename-prompt",confirmButtonText:O.baseText("nodeView.prompt.rename"),cancelButtonText:O.baseText("nodeView.prompt.cancel"),inputErrorMessage:O.baseText("nodeView.prompt.invalidName"),inputValue:t,inputValidator:e=>!!e.trim()||O.baseText("nodeView.prompt.invalidName")});await l();const a=document.querySelector(".rename-prompt .el-input__inner");a?.focus(),a?.select();const n=await e;"confirm"===n.action&&await Ft(t,n.value,{trackHistory:!0})}catch(ta){}}async function Kn({currentName:e,newName:t}){await Gt(e,t)}async function Gn({nodeId:e,currentProperties:t,newProperties:a}){await Jt(e,t,a)}function Jn(e,t){fa(e,t)}function Xn(e){Pa(e)}function Qn(e){Oa(e)}function Yn(e,t){ee.openNodeCreatorForConnectingNode({connection:{source:e,sourceHandle:t},eventSource:yt.PLUS_ENDPOINT})}async function Zn(){let e;if(sn.value&&!rn.value)e={workflowId:sn.value};else{const t=("string"==typeof P.query?.projectId?P.query?.projectId:void 0)??de.personalProject?.id;if(void 0===t)throw new Error("Could not find projectId in the query nor could I find the personal project in the project store");e={projectId:t}}await ne.fetchAllCredentialsForWorkflow(e)}function eo(e){Ca(e,{trackHistory:!0})}function to({connection:e}){Ta(e)}function ao(e,t,a){a?.target.classList?.contains("clickable")||(J.lastInteractedWithNodeId=e.nodeId,J.lastInteractedWithNodeHandle=e.handleId,J.lastCancelledConnectionPosition=[t.x,t.y],setTimeout((()=>{e.nodeId&&ee.openNodeCreatorForConnectingNode({connection:{source:e.nodeId,sourceHandle:e.handleId},eventSource:yt.NODE_CONNECTION_DROP})})))}function no(e){Ia(e,{trackHistory:!0})}function oo({connection:e}){Ea(e)}async function so(e){const t=e.data,a="boolean"==typeof e.trackEvents?e.trackEvents:void 0,n="boolean"==typeof e.setStateDirty?e.setStateDirty:void 0;if(await Da(t,"file",{viewport:Zo.value,regenerateIds:!0===e.regenerateIds||void 0===e.regenerateIds,trackEvents:a,setStateDirty:n}),await l(),Ja(),ts(t.nodes?.map((e=>e.id))??[]),e.tidyUp){const t=e.nodesIdsToTidyUp;setTimeout((async()=>{Ht.emit("tidyUp",{source:"import-workflow-data",nodeIdsFilter:t,trackEvents:a}),await l(),Ja()}),0)}}async function lo(e){const t=await Aa(e.url);t&&(await Da(t,"url",{viewport:Zo.value}),Qa.value?.ensureNodesAreVisible(t.nodes?.map((e=>e.id))??[]))}const io=r(void 0);function ro(){io.value=void 0}async function co({nodes:e,connections:t},a=!1,n){if(!Jo())return;void 0!==io.value&&(J.resetLastInteractedWith(),e=e.map((e=>({...e,openDetail:!1}))));const{addedNodes:o}=await Ga(e,t,{dragAndDrop:a,position:n,viewport:Zo.value,telemetry:!0,replaceNodeId:io.value});o.length>0&&ts([o[o.length-1].id])}async function uo({node:e}){await ka(e.name)}function po(e){const t=Q.getNodeByName(e);t&&(Wa(e,"other"),ts([t.id]))}function fo(e,t,a=0){ee.openSelectiveNodeCreator({node:e,connectionType:t,connectionIndex:a})}function mo(e){ee.setNodeCreatorState(e),e.createNodeActive||(io.value=void 0,e.hasAddedNodes||J.resetLastInteractedWith())}function vo(e){mo({createNodeActive:!0,source:e})}function _o(e){ee.openNodeCreatorForTriggerNodes(e)}function yo(){Ae.toggleFocusPanel(),W.track(`User ${Ae.focusPanelActive?"opened":"closed"} focus panel`,{source:"canvasKeyboardShortcut",parameters:Ae.focusedNodeParametersInTelemetryFormat,parameterCount:Ae.focusedNodeParametersInTelemetryFormat.length})}function go(){ee.isCreateNodeActive&&(ee.isCreateNodeActive=!1)}function ho(){co({nodes:[{type:bt}],connections:[]})}function wo(e){const{type:t,mode:a}=Mt(e.sourceHandle);t===Ot.AiTool&&a===Be.Output?ee.openNodeCreatorForConnectingNode({connection:e,eventSource:yt.NODE_CONNECTION_ACTION,nodeCreatorView:dt}):ee.openNodeCreatorForConnectingNode({connection:e,eventSource:yt.NODE_CONNECTION_ACTION})}function xo(e){const t=Q.getNodeById(e);if(!t)return;const a=G.getNodeType(t.type);if(a)if(io.value=e,jt(a))ee.openNodeCreatorForTriggerNodes(yt.REPLACE_NODE_ACTION);else{const e=Wt(Ma.value,t,a).map((e=>"string"==typeof e?e:e.type)),n=xt(Ma.value,t,a).map((e=>"string"==typeof e?e:e.type));e[0]&&n[0]&&e[0]!==n[0]?ee.openNodeCreatorForRegularNodes(yt.REPLACE_NODE_ACTION):ee.openSelectiveNodeCreator({connectionType:e[0]??n[0],node:t.name})}}const bo=a((()=>sn.value?Et(Y.getWorkflowById(sn.value)?.scopes).workflow:{})),No=a((()=>Et((P.query?.projectId?de.myProjects.find((e=>e.id===P.query.projectId)):de.currentProject??de.personalProject)?.scopes))),ko=r(!1),Co=a((()=>Q.isWorkflowRunning)),To=a((()=>Q.executionWaitingForWebhook)),Io=a((()=>!(!Uo.value||!zo.value||Lo.value)||!xn.value||bn.value)),Eo=a((()=>!zo.value||Lo.value)),Po=a((()=>Co.value&&!To.value)),Oo=a((()=>Co.value&&To.value));async function Wo(e){const t=Q.getNodeById(e);t&&(aa(t)&&G.isToolNode(t.type)?J.openModalWithData({name:Nt,data:{nodeName:t.name}}):(function(e){const t={node_type:e.type,workflow_id:Q.workflowId,source:"canvas",push_ref:We.pushRef};W.track("User clicked execute node button",t),S.run("nodeView.onRunNode",t)}(t),Ue.clearAgentRequests(Q.workflowId,t.id),st({destinationNode:{nodeName:t.name,mode:"inclusive"},source:"Node.executeNode"})))}async function jo(e,t){const a=await Q.getWebhookUrl(e,t);a&&(L.copy(a),A.showMessage({title:O.baseText("nodeWebhooks.showMessage.title"),type:"success"}))}async function So(e){const t=Q.getNodeById(e);ht.includes(t?.type??"")?A.showMessage({title:O.baseText("nodeWebhooks.showMessage.testWebhookUrl"),type:"warning"}):jo(e,"test")}async function Do(e){Q.workflow.active?jo(e,"production"):A.showMessage({title:O.baseText("nodeWebhooks.showMessage.not.active"),type:"warning"})}function Ao(e){if(!e.finished&&e.data?.resultData?.error){let t=!1;if(e.data.resultData.runData){const a=e.data.resultData.runData;e:for(const e of Object.keys(a))for(const n of a[e])if(n.error){t=!0;break e}}!t&&(e.data.resultData.error.stack??e.data.resultData.error.message)&&(console.error(`Execution ${e.id} error:`),console.error(e.data.resultData.error.stack),A.showMessage({title:O.baseText("nodeView.showError.workflowError"),message:e.data.resultData.error.message,type:"error",duration:0}))}}function Vo(e){e.waitTill&&A.showMessage({title:O.baseText("nodeView.thisExecutionHasntFinishedYet"),message:u(Ha),type:"warning",duration:0})}async function Bo(){ko.value=!0,await it(),ko.value=!1}async function Ro(){await rt()}function $o(){Se.emit("runWorkflowButton:mouseenter")}function Fo(){Se.emit("runWorkflowButton:mouseleave")}const Mo=a((()=>$a.value.nodes.find((e=>e.type===ut)))),Uo=a((()=>!To.value&&!!$a.value.nodes.find((e=>["@n8n/n8n-nodes-langchain.manualChatTrigger","@n8n/n8n-nodes-langchain.chatTrigger"].includes(e.type)&&!0!==e.disabled)))),zo=a((()=>wn.value.every((e=>e.disabled||"@n8n/n8n-nodes-langchain.chatTrigger"===e.type)))),Lo=a((()=>Mo.value?Q.pinDataByNodeName(Mo.value.name):null));function qo(){qa("main")}const Ho=a((()=>$a.value.nodes.find((e=>e.type===Dt))));async function Ko(){try{if(await Promise.all([oe.fetchAllVariables(),fe.fetchAll(),Zn(),de.getAvailableProjects()]),sn.value&&!J.stateIsDirty){const e=await Y.fetchWorkflow(sn.value);e&&await async function(e){Va(),Ve.streaming?F.setDocumentTitle(e.name,"AI_BUILDING"):F.setDocumentTitle(e.name,"IDLE"),await Ba(e),S.run("workflow.open",{workflowId:e.id,workflowName:e.name}),Ja()}(e)}}catch(e){console.error(e)}}async function Go(e){if(e&&"string"==typeof e.data&&e.data?.includes?.('"command"'))try{const t=JSON.parse(e.data);if(t&&"openWorkflow"===t.command)try{t.projectId&&await de.fetchAndSetProject(t.projectId),await async function({workflow:e}){if(!e.nodes||!e.connections)throw new Error("Invalid workflow object");Va(),await Ba({...e,nodes:Je(e.nodes)}),Ja()}(t),an.value=t.canOpenNDV??!0,nn.value=t.hideNodeIssues??!1,tn.value=!1,!0===t.tidyUp&&Ht.emit("tidyUp",{source:"import-workflow-data"})}catch(ta){window.top&&window.top.postMessage(JSON.stringify({command:"error",message:O.baseText("openWorkflow.workflowImportError")}),"*"),A.showError(ta,O.baseText("openWorkflow.workflowImportError"))}else if(t&&"openExecution"===t.command)try{t.projectId&&await de.fetchAndSetProject(t.projectId),en.value="manual"!==t.executionMode&&"evaluation"!==t.executionMode,await async function(e,t){ie.startLoading(),Va();const a=await Ra(e,t);a&&(l((()=>{hn()})),ie.stopLoading(),Ja(),Ht.emit("open:execution",a),S.run("execution.open",{workflowId:a.workflowData.id,workflowName:a.workflowData.name,executionId:e}),W.track("User opened read-only execution",{workflow_id:a.workflowData.id,execution_mode:a.mode,execution_finished:a.finished}))}(t.executionId,t.nodeId),an.value=t.canOpenNDV??!0,nn.value=t.hideNodeIssues??!1,tn.value=!0}catch(ta){window.top&&window.top.postMessage(JSON.stringify({command:"error",message:O.baseText("nodeView.showError.openExecution.title")}),"*"),A.showMessage({title:O.baseText("nodeView.showError.openExecution.title"),message:ta.message,type:"error"})}else"setActiveExecution"===t?.command&&(le.activeExecution=await le.fetchExecution(t.executionId))}catch(ta){}}function Jo(){if(!J.nodeViewInitialized)return!0;if(Za.value?.visible)return!1;if(!(bo.value.update??No.value.workflow.update))return!1;if(Qe.shouldBeReadOnly)return!1;if(un.value||pn.value){const e=un.value?"executions":"workflows";return Za.value=A.showMessage({title:O.baseText(pn.value?`readOnlyEnv.showMessage.${e}.title`:"readOnly.showMessage.executions.title"),message:O.baseText(pn.value?`readOnlyEnv.showMessage.${e}.message`:"readOnly.showMessage.executions.message"),type:"info"}),!1}return!0}async function Xo(){P.name===Pt.EXECUTION_DEBUG&&await C.replace({name:Pt.WORKFLOW,params:{name:sn.value}})}const Qo=r({x:0,y:0,zoom:1}),Yo=r({width:0,height:0}),Zo=a((()=>ke(Qo.value,Yo.value)));function es(e,t){Qo.value=e,Yo.value=t,J.nodeViewOffsetPosition=[e.x,e.y]}function ts(e){setTimeout((()=>Ht.emit("nodes:select",{ids:e})))}function as(e){La.value=[e.x,e.y],Rn()}function ns(e){La.value=[e.x,e.y]}async function os(e,t){if(!t.dataTransfer)return;const a=ct(t.dataTransfer.getData(mt));a&&(await co(a,!0,[e.x,e.y]),mo({createNodeActive:!1,hasAddedNodes:!0}))}function ss(e){const t=Q.findNodeByPartialId(e);t?Xt(t.id,"other"):(A.showToast({title:O.baseText("nodeView.showMessage.ndvUrl.missingNodes.title"),message:O.baseText("nodeView.showMessage.ndvUrl.missingNodes.content"),type:"warning"}),C.replace({name:P.name,params:{name:sn.value},query:P.query}))}return N([()=>P.name,()=>P.params.name],(()=>{gn()})),N((()=>Ya.value||mn.value||0!==$a.value.nodes.length),(e=>{if(e)return void(on.value=[]);const t={id:Oe.AddNodes,name:Oe.AddNodes,type:Oe.AddNodes,typeVersion:1,position:[0,0],parameters:{}},a={id:Oe.ChoicePrompt,name:Oe.ChoicePrompt,type:Oe.ChoicePrompt,typeVersion:1,position:[0,0],parameters:{},draggable:!1};on.value=Ve.isAIBuilderEnabled?[a]:[t]})),N((()=>P.params.nodeId),(async e=>{"string"!=typeof e||""===e?We.unsetActiveNodeName():ss(e)})),N((()=>We.activeNode),(async e=>{if(![Pt.WORKFLOW].includes(String(P.name)))return;const t=e?.id?Q.getPartialIdForNode(e?.id):"";t!==P.params.nodeId&&await C.replace({name:P.name,params:{name:sn.value,nodeId:t},query:P.query})})),N((()=>J.dirtyStateSetCount),(e=>{if(e>0){if(cn.value)return;Qe.requestWriteAccess(),Ve.streaming||M.autoSaveWorkflow()}})),N((()=>Ve.streaming),((e,t)=>{t&&!e&&J.stateIsDirty&&!Qe.shouldBeReadOnly&&M.autoSaveWorkflow()})),te((async(e,t,a)=>{if(Ae.focusPanelActive&&Ae.closeFocusPanel(),pn.value)return void a();const n=be(e),o=[Pt.WORKFLOW,Pt.NEW_WORKFLOW].includes(t.name)&&[Pt.WORKFLOW,Pt.NEW_WORKFLOW].includes(e.name)&&t.params.name!==e.params.name;n!==Tt.EXECUTIONS&&t.name!==Pt.TEMPLATE_IMPORT&&(n!==Tt.WORKFLOW||t.name!==Pt.EXECUTION_DEBUG)||o?await Re({router:C}).promptSaveUnsavedWorkflowChanges(a,{async confirm(){if(t.name===Pt.NEW_WORKFLOW){const t=Q.workflowId;return await C.replace({name:Pt.WORKFLOW,params:{name:t}}),await C.push(e),!1}return et.setWorkflowId(""),!0}}):a()})),V((()=>{cn.value||xe.pushConnect(),window.addEventListener("message",Go)})),x((async()=>{ie.startLoading(),F.reset(),Qe.setRefreshCanvasCallback((async e=>{await Ba(e)}));try{gn(),A.showNotificationForViews([Pt.WORKFLOW,Pt.NEW_WORKFLOW]),P.query.settings&&(J.openModal(gt),C.replace({query:{settings:void 0}}))}finally{Ya.value=!1,ie.stopLoading(),S.run("nodeView.mount").catch((()=>{})),setTimeout((()=>{ln.value&&ss(ln.value)}),500),window.parent&&window.parent.postMessage(JSON.stringify({command:"n8nReady",version:se.versionCli}),"*"),async function(){const e=Ye.consumePendingPrompt();e&&(await Ze.open({mode:"builder",showCoachmark:!1}),await Ve.sendChatMessage({text:e,initialGeneration:!0,source:"empty-state"}))}()}pe.showPersonalizationSurvey(),pn.value&&[Pt.NEW_WORKFLOW,Pt.TEMPLATE_IMPORT].find((e=>e===P.name))&&l((async()=>{Va(),J.markStateClean(),await C.replace({name:Pt.HOMEPAGE})})),ia.on("pull",Ko),Ht.on("saved:workflow",re.showNpsSurveyIfPossible),tt(),Se.on("importWorkflowData",so),Se.on("importWorkflowUrl",lo),Se.on("openChat",qo),Ht.on("open:execution",Ao),Ht.on("open:execution",Vo),Ht.on("create:sticky",ho),nt({key:"openNodeDetail",action:({node:e})=>{Wa(e,"other")}}),nt({key:"openSelectiveNodeCreator",action:({creatorview:e,connectiontype:t,node:a})=>{ee.openSelectiveNodeCreator({node:a,connectionType:t,creatorView:e})}}),nt({key:"showNodeCreator",action:()=>{We.unsetActiveNodeName(),l((()=>{_o(yt.TAB)}))}})})),c((()=>{_e.on("nodeMove",In),_e.on("revertAddNode",uo),_e.on("revertRemoveNode",On),_e.on("revertAddConnection",to),_e.on("revertRemoveConnection",oo),_e.on("revertRenameNode",Kn),_e.on("revertReplaceNodeParameters",Gn),_e.on("enableNodeToggle",jn),J.addFirstStepOnLoad&&(_o(yt.TRIGGER_PLACEHOLDER_BUTTON),J.addFirstStepOnLoad=!1)})),w((()=>{J.closeModal(gt),_e.off("nodeMove",In),_e.off("revertAddNode",uo),_e.off("revertRemoveNode",On),_e.off("revertAddConnection",to),_e.off("revertRemoveConnection",oo),_e.off("revertRenameNode",Kn),_e.off("revertReplaceNodeParameters",Gn),_e.off("enableNodeToggle",jn),A.clearAllStickyNotifications()})),d((()=>{ia.off("pull",Ko),window.removeEventListener("message",Go),Ht.off("saved:workflow",re.showNpsSurveyIfPossible),Ht.off("saved:workflow",Xo),at(),Se.off("importWorkflowData",so),Se.off("importWorkflowUrl",lo),Se.off("openChat",qo),Ht.off("open:execution",Ao),Ht.off("open:execution",Vo),Ht.off("create:sticky",ho),ot("openNodeDetail"),ot("openSelectiveNodeCreator"),ot("showNodeCreator"),Ht.off("saved:workflow",Xo),cn.value||xe.pushDisconnect()})),(e,t)=>(E(),o("div",{class:B(i(k).wrapper)},[i($a)&&i(Ma)&&!Ya.value?(E(),_(Na,{key:0,id:i($a).id,ref:"canvas",workflow:i($a),"workflow-object":i(Ma),"fallback-nodes":on.value,"show-fallback-nodes":vn.value,"event-bus":i(Ht),"read-only":mn.value,executing:Co.value,"key-bindings":_n.value,"suppress-interaction":i(Xe).isMapperOpen,"hide-controls":dn.value,"onUpdate:nodes:position":Cn,"onUpdate:node:position":Tn,"onUpdate:node:activated":An,"onUpdate:node:deactivated":Bn,"onUpdate:node:selected":Rn,"onUpdate:node:enabled":Wn,"onUpdate:node:name":Hn,"onUpdate:node:parameters":Jn,"onUpdate:node:inputs":Xn,"onUpdate:node:outputs":Qn,"onUpdate:logsOpen":t[3]||(t[3]=e=>i(qe).toggleOpen(e)),"onUpdate:logs:inputOpen":i(qe).toggleInputOpen,"onUpdate:logs:outputOpen":i(qe).toggleOutputOpen,"onUpdate:hasRangeSelection":i(ie).setHasRangeSelection,"onOpen:subWorkflow":Vn,"onClick:node":Dn,"onClick:node:add":Yn,"onRun:node":Wo,"onCopy:production:url":Do,"onCopy:test:url":So,"onDelete:node":En,"onCreate:connection":eo,"onCreate:connection:cancelled":ao,"onDelete:connection":no,"onClick:connection:add":wo,"onClick:pane":as,"onCreate:node":vo,"onCreate:sticky":ho,"onDelete:nodes":Pn,"onUpdate:nodes:enabled":Sn,"onUpdate:nodes:pin":Un,"onDuplicate:nodes":Mn,"onCopy:nodes":$n,"onCut:nodes":Fn,"onReplace:node":xo,"onRun:workflow":t[4]||(t[4]=e=>i(lt)("main")),"onCreate:workflow":Ln,"onViewport:change":es,"onSelection:end":ns,onDragAndDrop:os,onTidyUp:Nn,"onToggle:focusPanel":yo,onExtractWorkflow:kn,onStartChat:t[5]||(t[5]=e=>i(qa)())},{default:T((()=>[mn.value?s("",!0):(E(),_($,{key:0},{default:T((()=>[p(i(h),{class:B(i(k).setupCredentialsButtonWrapper)},null,8,["class"])])),_:1})),mn.value?s("",!0):(E(),o("div",{key:1,class:B(i(k).executionButtons)},[Eo.value?(E(),_(ca,{key:0,"waiting-for-webhook":To.value,disabled:Io.value,executing:Co.value,"trigger-nodes":wn.value,"get-node-type":i(G).getNodeType,"selected-trigger-node-name":i(Q).selectedTriggerNodeName,onMouseenter:$o,onMouseleave:Fo,onExecute:t[0]||(t[0]=e=>i(lt)("main")),onSelectTriggerNode:i(Q).setSelectedTriggerNodeName},null,8,["waiting-for-webhook","disabled","executing","trigger-nodes","get-node-type","selected-trigger-node-name","onSelectTriggerNode"])):s("",!0),Uo.value?(E(),o(b,{key:1},[yn.value?(E(),_(Ka,{key:0,variant:"subtle",label:i(O).baseText("chat.hide"),class:B(i(k).chatButton),onClick:t[1]||(t[1]=e=>i(qe).toggleOpen(!1))},null,8,["label","class"])):(E(),_(sa,{key:1,label:i(O).baseText("chat.open"),shortcut:{keys:["c"]}},{default:T((()=>[p(Ka,{variant:Eo.value?"subtle":"solid",label:i(O).baseText("chat.open"),class:B(i(k).chatButton),onClick:qo},null,8,["variant","label","class"])])),_:1},8,["label"]))],64)):s("",!0),Po.value?(E(),_(Ua,{key:2,stopping:ko.value,onClick:Bo},null,8,["stopping"])):s("",!0),Oo.value?(E(),_(za,{key:3,onClick:Ro})):s("",!0)],2)),pn.value?(E(),_(i(H),{key:2,theme:"warning",icon:"lock",class:B(i(k).readOnlyEnvironmentNotification)},{default:T((()=>[j(n(i(O).baseText("readOnlyEnv.cantEditOrRun")),1)])),_:1},8,["class"])):s("",!0),i(Qe).currentWriter&&!i(Qe).isCurrentUserWriter?(E(),_(i(ue),{key:3,"first-name":i(Qe).currentWriter.user.firstName,"last-name":i(Qe).currentWriter.user.lastName,class:B(i(k).canvasCenterPill)},null,8,["first-name","last-name","class"])):s("",!0),i(Ve).streaming?(E(),_(i(ae),{key:4,class:B(i(k).canvasCenterPill),"show-stop":"",onStop:i(Ve).abortStreaming},null,8,["class","onStop"])):s("",!0),(E(),_($,null,{default:T((()=>[mn.value?s("",!0):(E(),_(i(m),{key:0,"create-node-active":i(ee).isCreateNodeActive,"node-view-scale":Qo.value.zoom,"focus-panel-active":i(Ae).focusPanelActive,onToggleNodeCreator:mo,onAddNodes:co,onClose:ro},null,8,["create-node-active","node-view-scale","focus-panel-active"]))])),_:1})),(E(),_($,null,{default:T((()=>[fn.value?s("",!0):(E(),_(i(y),{key:0,"workflow-object":i(Ma),"read-only":mn.value,"is-production-execution-preview":en.value,renaming:!1,onValueChanged:t[2]||(t[2]=e=>qn(e.value)),onStopExecution:Bo,onSwitchSelectedNode:po,onOpenConnectionNodeCreator:fo},null,8,["workflow-object","read-only","is-production-execution-preview"]))])),_:1})),(E(),_($,null,{default:T((()=>[fn.value?(E(),_(i(g),{key:0,"workflow-object":i(Ma),"read-only":mn.value,"is-production-execution-preview":en.value,onRenameNode:qn,onStopExecution:Bo,onSwitchSelectedNode:po,onOpenConnectionNodeCreator:fo},null,8,["workflow-object","read-only","is-production-execution-preview"])):s("",!0)])),_:1}))])),_:1},8,["id","workflow","workflow-object","fallback-nodes","show-fallback-nodes","event-bus","read-only","executing","key-bindings","suppress-interaction","hide-controls","onUpdate:logs:inputOpen","onUpdate:logs:outputOpen","onUpdate:hasRangeSelection"])):s("",!0),Ya.value||i(Xe).isNdvInFocusPanelEnabled&&mn.value?s("",!0):(E(),_(Fa,{key:1,"is-canvas-read-only":mn.value,onContextMenuAction:zn},null,8,["is-canvas-read-only"]))],2))}}),e("default",fe(Ga,[["__cssModules",{$style:{wrapper:"_wrapper_1uyi2_125",executionButtons:"_executionButtons_1uyi2_130",chatButton:"_chatButton_1uyi2_148",setupCredentialsButtonWrapper:"_setupCredentialsButtonWrapper_1uyi2_152",readOnlyEnvironmentNotification:"_readOnlyEnvironmentNotification_1uyi2_158",canvasCenterPill:"_canvasCenterPill_1uyi2_165"}}]]))}}}));
//# sourceMappingURL=NodeView-legacy-DDhSCUsx.js.map