(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`1fc22017-c30f-4a8f-9f4e-7e9b635b2091`,e._sentryDebugIdIdentifier=`sentry-dbid-1fc22017-c30f-4a8f-9f4e-7e9b635b2091`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{Cn as t,D as n,E as r,Gt as i,It as a,M as o,P as s,T as c,Z as l,_ as u,bt as d,c as f,et as p,j as m,vn as h,w as g}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as _}from"./_MapCache-DjbOQyB7.js";import{Hi as v,N as y,Pi as b,Tt as x,Ui as S,Vi as C,p as w,wi as T,zi as E}from"./src-CppJvwzX.js";import{t as D}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as O,Tr as k,fn as A,ws as j,yr as M}from"./users.store-pCkD7Zo0.js";import{Ss as N,rs as P}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import{t as F}from"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as I}from"./usePageRedirectionHelper-BoF8hzbN.js";import{t as L}from"./roles.store-Cq99swn7.js";var R=e(F(),1),z={class:`pb-xl`},B=D(s({__name:`ProjectRolesView`,setup(e){let{showError:s,showMessage:D}=M(),N=L(),F=T(),B=k(),V=_(),H=f(),U=j(),{goToUpgrade:W}=I(),G=O();l(()=>{A().set(V.baseText(`settings.projectRoles`))});let K=a([{title:V.baseText(`projectRoles.sourceControl.table.name`),key:`displayName`,width:400,disableSort:!0,resize:!1},{title:V.baseText(`projectRoles.sourceControl.table.type`),key:`systemRole`,disableSort:!0,resize:!1},{title:V.baseText(`projectRoles.sourceControl.table.assignedTo`),key:`usedByUsers`,disableSort:!0,align:`end`,value:e=>e.usedByUsers??0,width:75,resize:!1},{title:V.baseText(`projectRoles.sourceControl.table.lastEdited`),key:`updatedAt`,value:e=>e.updatedAt&&!e.systemRole?(0,R.default)(e.updatedAt,`d mmm, yyyy`):`â€”`,disableSort:!0,resize:!1},{title:``,key:`actions`,value:()=>``,width:50,minWidth:50,disableSort:!0,align:`center`,resize:!1}]);async function q(e){if(V.baseText(`projectRoles.action.delete.text`,{interpolate:{roleName:e.displayName}}),await B.confirm(V.baseText(`projectRoles.action.delete.text`,{interpolate:{roleName:e.displayName}}),V.baseText(`projectRoles.action.delete.title`,{interpolate:{roleName:e.displayName}}),{type:`warning`,confirmButtonText:V.baseText(`projectRoles.action.delete`),cancelButtonText:V.baseText(`projectRoles.action.cancel`)})===`confirm`)try{await N.deleteProjectRole(e.slug);let t=N.roles.project.findIndex(t=>t.slug===e.slug);t!==-1&&N.roles.project.splice(t,1),D({title:V.baseText(`projectRoles.action.delete.success`),type:`success`})}catch(e){s(e,V.baseText(`projectRoles.action.delete.error`));return}}async function J(e){try{let t=V.baseText(`projectRoles.action.duplicate.name`,{interpolate:{roleName:e.displayName}}),n=await N.createProjectRole({displayName:t,description:e.description??void 0,roleType:`project`,scopes:e.scopes});return N.roles.project.push(n),N.fetchRoles(),G.track(`User duplicated role`,{role_id:e.slug,role_name:e.displayName,permissions:e.scopes}),D({type:`success`,message:V.baseText(`projectRoles.action.duplicate.success`,{interpolate:{roleName:e.displayName,roleDuplicateName:t}})}),n}catch(e){s(e,V.baseText(`projectRoles.action.duplicate.error`));return}}let Y={duplicate:J,delete:q};function X(e){return{class:[H.tallRow,H.clickableRow]}}function Z(e){return[{label:V.baseText(`projectRoles.action.duplicate`),value:`duplicate`},{label:V.baseText(`projectRoles.action.delete`),value:`delete`,disabled:e.usedByUsers!==0}]}function Q(e,t){Y[e](t)}function $(e){F.push({name:e.systemRole?P.PROJECT_ROLE_VIEW:P.PROJECT_ROLE_SETTINGS,params:{roleSlug:e.slug}})}function ee(){G.track(`User clicked add role`),F.push({name:P.PROJECT_NEW_ROLE})}return(e,a)=>(p(),n(`div`,z,[g(`div`,{class:h([`mb-xl`,i(H).headerContainer])},[g(`div`,{class:h(i(H).headerTitle)},[o(i(E),{tag:`h1`,size:`2xlarge`},{default:d(()=>[m(t(i(V).baseText(`settings.projectRoles`)),1)]),_:1}),o(i(y),{clickable:!1,text:`Beta`})],2),i(U).isCustomRolesFeatureEnabled?(p(),c(i(v),{key:0,variant:`subtle`,onClick:ee},{default:d(()=>[m(t(i(V).baseText(`projectRoles.addRole`)),1)]),_:1})):r(``,!0)],2),i(U).isCustomRolesFeatureEnabled?(p(),c(i(w),{key:1,items:i(N).processedProjectRoles,headers:K.value,"items-length":i(N).processedProjectRoles.length,"items-per-page":i(N).processedProjectRoles.length,"page-sizes":[i(N).processedProjectRoles.length],"row-props":X,"onClick:row":a[1]||=(e,{item:t})=>$(t)},{"item.displayName":d(({item:e})=>[o(i(C),{tag:`div`,class:`mb-4xs`},{default:d(()=>[m(t(e.displayName),1)]),_:2},1024),o(i(C),{tag:`div`,size:`small`,color:`text-light`},{default:d(()=>[m(t(e.description),1)]),_:2},1024)]),"item.systemRole":d(({item:e})=>[e.systemRole?(p(),n(u,{key:0},[o(i(S),{icon:`lock`}),m(` `+t(i(V).baseText(`projectRoles.literal.system`)),1)],64)):(p(),n(u,{key:1},[o(i(S),{icon:`user-pen`}),m(` `+t(i(V).baseText(`projectRoles.literal.custom`)),1)],64))]),"item.actions":d(({item:e})=>[e.systemRole?r(``,!0):(p(),c(i(x),{key:0,actions:Z(e),onAction:t=>Q(t,e)},null,8,[`actions`,`onAction`]))]),_:2},1032,[`items`,`headers`,`items-length`,`items-per-page`,`page-sizes`])):(p(),c(i(b),{key:0,class:`mt-2xl mb-l`,"button-text":i(V).baseText(`settings.externalSecrets.actionBox.buttonText`),description:`yes`,onClick:a[0]||=e=>i(W)(`custom-roles`,`upgrade-custom-roles`)},{heading:d(()=>[g(`span`,null,t(i(V).baseText(`projectRoles.manageRoles.paywall.title`)),1)]),description:d(()=>[m(t(i(V).baseText(`projectRoles.manageRoles.paywall.text`)),1)]),_:1},8,[`button-text`]))]))}}),[[`__cssModules`,{$style:{headerContainer:`_headerContainer_1yma8_2`,headerTitle:`_headerTitle_1yma8_8`,clickableRow:`_clickableRow_1yma8_14`,tallRow:`_tallRow_1yma8_18`}}]]);export{B as default};
//# sourceMappingURL=ProjectRolesView-NsMO0c3R.js.map