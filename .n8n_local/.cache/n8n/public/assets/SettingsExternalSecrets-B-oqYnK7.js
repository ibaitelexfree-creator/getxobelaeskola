(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`5a3e2fbf-891b-4cfc-a7d8-31da51352b79`,e._sentryDebugIdIdentifier=`sentry-dbid-5a3e2fbf-891b-4cfc-a7d8-31da51352b79`)})()}catch{}import{C as e,Cn as t,D as n,E as r,G as i,Gt as a,M as o,P as s,T as c,Vt as l,Z as u,_ as d,bt as f,et as p,it as m,j as h,vn as g,w as _}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as v,yt as y}from"./_MapCache-DjbOQyB7.js";import{At as b,Bi as x,Hi as S,Pi as C,Tt as w,Ui as T,Vi as E,bt as D,zi as O}from"./src-CppJvwzX.js";import{t as k}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Jr as A,fn as j,r as M,yr as N}from"./users.store-pCkD7Zo0.js";import{ms as P,oo as F}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as I}from"./usePageRedirectionHelper-BoF8hzbN.js";import"./useEnvFeatureFlag-CHY3xSda.js";import{t as L}from"./externalSecrets.ee.store-RuZGBiOy.js";import{n as R,r as z,t as B}from"./ExternalSecretsProviderConnectionSwitch.ee-CQj4SLPh.js";var V=k(s({__name:`ExternalSecretsProviderCard.ee`,props:{provider:{}},setup(s){let d=s,m=L(),v=y(),x=M(),C=N(),O=l(d,`provider`),k=e(()=>O.value.data??{}),{connectionState:j,testConnection:I,setConnectionState:V}=z(O,k),H=e(()=>[{value:`setup`,label:v.baseText(`settings.externalSecrets.card.actionDropdown.setup`)},...d.provider.connected?[{value:`reload`,label:v.baseText(`settings.externalSecrets.card.actionDropdown.reload`)}]:[]]),U=e(()=>d.provider.connected||Object.keys(k.value).length>0),W=e(()=>F.fromISO(A(O.value.connectedAt)?O.value.connectedAt.toISOString():O.value.connectedAt||new Date().toISOString()).toFormat(`dd LLL yyyy`));u(()=>{V(d.provider.state)});async function G(){return d.provider.connected?!0:(await m.getProvider(d.provider.name),await i(),await I()!==`error`)}function K(){x.openModalWithData({name:P,data:{name:d.provider.name}})}async function q(){try{await m.reloadProvider(d.provider.name),C.showMessage({title:v.baseText(`settings.externalSecrets.card.reload.success.title`),message:v.baseText(`settings.externalSecrets.card.reload.success.description`,{interpolate:{provider:d.provider.displayName}}),type:`success`})}catch(e){C.showError(e,v.baseText(`error`))}}async function J(e){switch(e){case`setup`:K();break;case`reload`:await q();break}}return(e,i)=>(p(),c(a(D),{class:g(e.$style.card)},{default:f(()=>[_(`div`,{class:g(e.$style.cardBody)},[o(R,{class:g(e.$style.cardImage),provider:O.value},null,8,[`class`,`provider`]),_(`div`,{class:g(e.$style.cardContent)},[o(a(E),{bold:``},{default:f(()=>[h(t(O.value.displayName),1)]),_:1}),O.value.connected?(p(),c(a(E),{key:0,color:`text-light`,size:`small`},{default:f(()=>[_(`span`,null,t(a(v).baseText(`settings.externalSecrets.card.secretsCount`,{interpolate:{count:`${a(m).secrets[O.value.name]?.length}`}})),1),i[1]||=h(` | `,-1),_(`span`,null,t(a(v).baseText(`settings.externalSecrets.card.connectedAt`,{interpolate:{date:W.value}})),1)]),_:1})):r(``,!0)],2),O.value.name===`infisical`?(p(),n(`div`,{key:0,class:g(e.$style.deprecationWarning)},[o(a(T),{class:g(e.$style.warningTriangle),icon:`triangle-alert`},null,8,[`class`]),o(a(b),{class:`mr-xs`,theme:`tertiary`,bold:``,"data-test-id":`card-badge`},{default:f(()=>[h(t(a(v).baseText(`settings.externalSecrets.card.deprecated`)),1)]),_:1})],2)):r(``,!0),U.value?(p(),n(`div`,{key:1,class:g(e.$style.cardActions)},[o(B,{provider:O.value,"before-update":G,disabled:a(j)===`error`&&!O.value.connected},null,8,[`provider`,`disabled`]),o(a(w),{class:`ml-s`,theme:`dark`,actions:H.value,onAction:J},null,8,[`actions`])],2)):(p(),c(a(S),{key:2,variant:`subtle`,onClick:i[0]||=e=>K()},{default:f(()=>[h(t(a(v).baseText(`settings.externalSecrets.card.setUp`)),1)]),_:1}))],2)]),_:1},8,[`class`]))}}),[[`__cssModules`,{$style:{card:`_card_184zs_125`,cardImage:`_cardImage_184zs_130`,cardBody:`_cardBody_184zs_135`,cardContent:`_cardContent_184zs_141`,cardActions:`_cardActions_184zs_148`,deprecationWarning:`_deprecationWarning_184zs_155`,warningTriangle:`_warningTriangle_184zs_159`}}]]),H={class:`pb-3xl`},U={key:0,"data-test-id":`external-secrets-content-licensed`},W={href:`https://docs.n8n.io/external-secrets/`,target:`_blank`},G={href:`https://docs.n8n.io/external-secrets/`,target:`_blank`},K=s({__name:`SettingsExternalSecrets`,setup(r){let i=y(),s=L(),l=N(),g=j(),b=I(),S=e(()=>[...s.providers].sort((e,t)=>t.name.localeCompare(e.name)));u(()=>{if(g.set(i.baseText(`settings.externalSecrets.title`)),s.isEnterpriseExternalSecretsEnabled)try{s.fetchGlobalSecrets(),s.getProviders()}catch(e){l.showError(e,i.baseText(`error`))}});function w(){b.goToUpgrade(`external-secrets`,`upgrade-external-secrets`)}return(e,r)=>(p(),n(`div`,H,[o(a(O),{size:`2xlarge`},{default:f(()=>[h(t(a(i).baseText(`settings.externalSecrets.title`)),1)]),_:1}),a(s).isEnterpriseExternalSecretsEnabled?(p(),n(`div`,U,[o(a(x),{theme:`secondary`,class:`mt-2xl mb-l`},{default:f(()=>[h(t(a(i).baseText(`settings.externalSecrets.info`))+` `,1),_(`a`,W,t(a(i).baseText(`settings.externalSecrets.info.link`)),1)]),_:1}),(p(!0),n(d,null,m(S.value,e=>(p(),c(V,{key:e.name,provider:e},null,8,[`provider`]))),128))])):(p(),c(a(C),{key:1,class:`mt-2xl mb-l`,"data-test-id":`external-secrets-content-unlicensed`,"button-text":a(i).baseText(`settings.externalSecrets.actionBox.buttonText`),onClick:w},{heading:f(()=>[_(`span`,null,t(a(i).baseText(`settings.externalSecrets.actionBox.title`)),1)]),description:f(()=>[o(a(v),{keypath:`settings.externalSecrets.actionBox.description`,scope:`global`},{link:f(()=>[_(`a`,G,t(a(i).baseText(`settings.externalSecrets.actionBox.description.link`)),1)]),_:1})]),_:1},8,[`button-text`]))]))}});export{K as default};
//# sourceMappingURL=SettingsExternalSecrets-B-oqYnK7.js.map