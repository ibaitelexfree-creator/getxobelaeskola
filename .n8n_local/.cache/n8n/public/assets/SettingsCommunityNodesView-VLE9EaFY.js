(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`a63114e1-d2d6-4cd3-85f4-3ba5e065b331`,e._sentryDebugIdIdentifier=`sentry-dbid-a63114e1-d2d6-4cd3-85f4-3ba5e065b331`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,J as s,M as c,P as l,T as u,Z as d,_ as f,_t as p,bt as m,et as h,it as g,j as _,q as v,vn as y,w as b}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as x}from"./_MapCache-DjbOQyB7.js";import{Et as S,Hi as C,Oi as w,Pi as T,Tt as E,Ui as D,Vi as O,wi as k,zi as A}from"./src-CppJvwzX.js";import{t as j}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Aa as M,C as N,Ea as P,Lt as F,fn as I,ka as L,r as R,ws as z,xr as B,yr as V}from"./users.store-pCkD7Zo0.js";import{x as H}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./banners.store-Ce6ZTWqJ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./executions.store-DnLtKXBA.js";import"./assistant.store-BGYzebcZ.js";import{n as U,t as W}from"./semver-DulOjSKL.js";import"./usePinnedData-C6FFXoty.js";import"./nodeIcon--7uU1Imq.js";import"./canvas.utils-C8dCdoZZ.js";import"./nodeCreator.store-KD9kt9dE.js";import"./useCanvasOperations-BHGWcL34.js";import"./folders.store-CS_gIPIm.js";import"./useRunWorkflow-DzzlHC01.js";import{t as G}from"./pushConnection.store-IFO3HVvG.js";import"./readyToRun.store-DM7AW4os.js";import"./aiTemplatesStarterCollection.store-NMq1bc_J.js";import{t as K}from"./usePushConnection-Bqaw2gmy.js";var q=e(W(),1),J={key:0},Y=j(l({__name:`CommunityPackageCard`,props:{communityPackage:{default:null},loading:{type:Boolean,default:!1}},setup(e){let s=e,{openCommunityPackageUpdateConfirmModal:l,openCommunityPackageUninstallConfirmModal:d}=R(),v=x(),T=F(),k=z(),A=N(),j=o(),P=t(()=>s.communityPackage?.installedVersion||``),I=t(()=>k.isUnverifiedPackagesEnabled&&s.communityPackage?.updateAvailable),L=t(()=>{let e=j.value&&q.default.gt(j.value||``,P.value);return k.isCommunityNodesFeatureEnabled&&e}),B=[{label:v.baseText(`settings.communityNodes.viewDocsAction.label`),value:M.VIEW_DOCS,type:`external-link`},{label:v.baseText(`settings.communityNodes.uninstallAction.label`),value:M.UNINSTALL}];async function V(e){if(s.communityPackage)switch(e){case M.VIEW_DOCS:T.track(`user clicked to browse the cnr package documentation`,{package_name:s.communityPackage.packageName,package_version:s.communityPackage.installedVersion}),window.open(`${H}${s.communityPackage.packageName}`,`_blank`);break;case M.UNINSTALL:d(s.communityPackage.packageName);break;default:break}}function U(){s.communityPackage&&l(s.communityPackage.packageName,`instance settings`)}return p(()=>s.communityPackage?.packageName,async e=>{if(e){await A.loadNodeTypesIfNotLoaded();let t=A.visibleNodeTypes.find(t=>t.name.includes(e)),n=await A.getCommunityNodeAttributes(t?.name||``);n?.npmVersion&&(j.value=n.npmVersion)}},{immediate:!0}),(t,o)=>(h(),r(`div`,{class:y(t.$style.cardContainer),"data-test-id":`community-package-card`},[e.loading?(h(),r(`div`,{key:0,class:y(t.$style.cardSkeleton)},[c(a(S),{class:y(t.$style.loader),variant:`p`,rows:1},null,8,[`class`]),c(a(S),{class:y(t.$style.loader),variant:`p`,rows:1},null,8,[`class`])],2)):e.communityPackage?(h(),r(`div`,{key:1,class:y(t.$style.packageCard)},[b(`div`,{class:y(t.$style.cardInfoContainer)},[b(`div`,{class:y(t.$style.cardTitle)},[c(a(O),{bold:!0,size:`large`},{default:m(()=>[_(n(e.communityPackage.packageName),1)]),_:1})],2),b(`div`,{class:y(t.$style.cardSubtitle)},[c(a(O),{bold:!0,size:`small`,color:`text-light`},{default:m(()=>[_(n(a(v).baseText(`settings.communityNodes.packageNodes.label`,{adjustToNumber:e.communityPackage.installedNodes.length}))+`:\xA0 `,1)]),_:1}),c(a(O),{size:`small`,color:`text-light`},{default:m(()=>[(h(!0),r(f,null,g(e.communityPackage.installedNodes,(t,a)=>(h(),r(`span`,{key:t.name},[_(n(t.name),1),a==e.communityPackage.installedNodes.length-1?i(``,!0):(h(),r(`span`,J,`,`))]))),128))]),_:1})],2)],2),b(`div`,{class:y(t.$style.cardControlsContainer)},[c(a(O),{bold:!0,size:`large`,color:`text-light`},{default:m(()=>[_(` v`+n(e.communityPackage.installedVersion),1)]),_:1}),e.communityPackage.failedLoading===!0?(h(),u(a(w),{key:0,placement:`top`},{content:m(()=>[b(`div`,null,n(a(v).baseText(`settings.communityNodes.failedToLoad.tooltip`)),1)]),default:m(()=>[c(a(D),{icon:`triangle-alert`,color:`danger`,size:`large`})]),_:1})):I.value||L.value?(h(),u(a(w),{key:1,placement:`top`},{content:m(()=>[b(`div`,null,n(a(v).baseText(`settings.communityNodes.updateAvailable.tooltip`)),1)]),default:m(()=>[c(a(C),{variant:`outline`,label:`Update`,onClick:U})]),_:1})):(h(),u(a(w),{key:2,placement:`top`},{content:m(()=>[b(`div`,null,n(a(v).baseText(`settings.communityNodes.upToDate.tooltip`)),1)]),default:m(()=>[c(a(D),{icon:`circle-check`,color:`text-light`,size:`large`})]),_:1})),b(`div`,{class:y(t.$style.cardActions)},[c(a(E),{actions:B,onAction:V})],2)],2)],2)):i(``,!0)],2))}}),[[`__cssModules`,{$style:{cardContainer:`_cardContainer_wz5jy_125`,packageCard:`_packageCard_wz5jy_133`,cardSkeleton:`_cardSkeleton_wz5jy_134`,loader:`_loader_wz5jy_148`,cardInfoContainer:`_cardInfoContainer_wz5jy_159`,cardTitle:`_cardTitle_wz5jy_164`,cardSubtitle:`_cardSubtitle_wz5jy_171`,cardControlsContainer:`_cardControlsContainer_wz5jy_176`,cardActions:`_cardActions_wz5jy_182`}}]]),X=31,Z=j(l({__name:`SettingsCommunityNodesView`,setup(e){let l=o(!1),p=K({router:k()}),S=G(),w=B(),E=x(),D=F(),O=V(),j=I(),M=U(),N=R(),H=z(),W=t(()=>H.isUnverifiedPackagesEnabled?E.baseText(`settings.communityNodes.empty.title`):E.baseText(`settings.communityNodes.empty.verified.only.title`)),q=t(()=>{if(!H.isUnverifiedPackagesEnabled)return E.baseText(`settings.communityNodes.empty.verified.only.description`);let e=M.availablePackageCount;return e<X?E.baseText(`settings.communityNodes.empty.description.no-packages`,{interpolate:{docURL:P}}):E.baseText(`settings.communityNodes.empty.description`,{interpolate:{docURL:P,count:(Math.floor(e/10)*10).toString()}})}),J=t(()=>H.isUnverifiedPackagesEnabled?E.baseText(`settings.communityNodes.empty.installPackageLabel`):``),Z=t(()=>({calloutText:``,calloutTheme:void 0,hideButton:!1})),Q=()=>{$()},$=()=>{let e={is_empty_state:M.getInstalledPackages.length===0};D.track(`user clicked cnr install button`,e),w.run(`settingsCommunityNodesView.openInstallModal`,e),N.openModal(L)};return v(()=>{p.initialize(),S.pushConnect()}),d(async()=>{j.set(E.baseText(`settings.communityNodes`));try{l.value=!0,await M.fetchInstalledPackages();let e=M.getInstalledPackages,t=e.filter(e=>e.updateAvailable);D.track(`user viewed cnr settings page`,{num_of_packages_installed:e.length,installed_packages:e.map(e=>({package_name:e.packageName,package_version:e.installedVersion,package_nodes:e.installedNodes.map(e=>`${e.name}-v${e.latestVersion}`),is_update_available:e.updateAvailable!==void 0})),packages_to_update:t.map(e=>({package_name:e.packageName,package_version_current:e.installedVersion,package_version_available:e.updateAvailable})),number_of_updates_available:t.length})}catch(e){O.showError(e,E.baseText(`settings.communityNodes.fetchError.title`),E.baseText(`settings.communityNodes.fetchError.message`))}finally{l.value=!1}try{await M.fetchAvailableCommunityPackageCount()}finally{l.value=!1}}),s(()=>{S.pushDisconnect(),p.terminate()}),(e,t)=>(h(),r(`div`,{class:y(e.$style.container)},[b(`div`,{class:y(e.$style.headingContainer)},[c(a(A),{size:`2xlarge`},{default:m(()=>[_(n(a(E).baseText(`settings.communityNodes`)),1)]),_:1}),a(H).isUnverifiedPackagesEnabled&&a(M).getInstalledPackages.length>0&&!l.value?(h(),u(a(C),{key:0,label:a(E).baseText(`settings.communityNodes.installModal.installButton.label`),size:`large`,onClick:$},null,8,[`label`])):i(``,!0)],2),l.value?(h(),r(`div`,{key:0,class:y(e.$style.cardsContainer)},[(h(),r(f,null,g(2,e=>c(Y,{key:`index-`+e,loading:!0})),64))],2)):a(M).getInstalledPackages.length===0?(h(),r(`div`,{key:1,class:y(e.$style.actionBoxContainer)},[c(a(T),{heading:W.value,description:q.value,"button-text":J.value,"button-disabled":!a(H).isUnverifiedPackagesEnabled,"callout-text":Z.value.calloutText,"callout-theme":Z.value.calloutTheme,"onClick:button":Q},null,8,[`heading`,`description`,`button-text`,`button-disabled`,`callout-text`,`callout-theme`])],2)):(h(),r(`div`,{key:2,class:y(e.$style.cardsContainer)},[(h(!0),r(f,null,g(a(M).getInstalledPackages,e=>(h(),u(Y,{key:e.packageName,"community-package":e},null,8,[`community-package`]))),128))],2))],2))}}),[[`__cssModules`,{$style:{container:`_container_rpbd6_125`,headingContainer:`_headingContainer_rpbd6_133`,loadingContainer:`_loadingContainer_rpbd6_138`,actionBoxContainer:`_actionBoxContainer_rpbd6_143`,cardsContainer:`_cardsContainer_rpbd6_147`}}]]);export{Z as default};
//# sourceMappingURL=SettingsCommunityNodesView-VLE9EaFY.js.map