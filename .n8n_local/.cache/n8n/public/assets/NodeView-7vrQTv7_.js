const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NodeCreation-CbGcb5q0.js","assets/_plugin-vue_export-helper-B_J4Khre.js","assets/src-CppJvwzX.js","assets/CalendarDate-CR2L-kBx.js","assets/_MapCache-DjbOQyB7.js","assets/vue.runtime.esm-bundler-1e_FtHOF.js","assets/chunk-Din3qlHY.js","assets/sanitize-html-K63Olwt_.js","assets/en-CTDtIhP1.js","assets/src-By0uoI3W.css","assets/nodeCreator.store-KD9kt9dE.js","assets/constants-D1jZwsUK.js","assets/merge-CKxbv8m_.js","assets/users.store-pCkD7Zo0.js","assets/_baseOrderBy-El3qbNHQ.js","assets/dateformat-BhE5sUDK.js","assets/useDebounce-D6lADr4O.js","assets/nodeIcon--7uU1Imq.js","assets/canvas.utils-C8dCdoZZ.js","assets/assistant.store-BGYzebcZ.js","assets/KeyboardShortcutTooltip-BuQeOxiO.js","assets/KeyboardShortcutTooltip-Bz9DcSWs.css","assets/chatPanel.store-YdM_XYGp.js","assets/useActions-C_2-IL4P.js","assets/NodeCreation-D1x8Hya7.css","assets/NodeDetailsView--YayFmCn.js","assets/RunData-DoJODYvb.js","assets/uniqBy-Bd2DEoH8.js","assets/NDVEmptyState-Cd-QhxaI.js","assets/NDVEmptyState-wmCtLnDW.css","assets/vue-json-pretty-CT_xxsnb.js","assets/useRunWorkflow-DzzlHC01.js","assets/useCanvasOperations-BHGWcL34.js","assets/core-DLhNJSBD.js","assets/core-IO9YfrHc.js","assets/xml-BJs1rC06.js","assets/VueMarkdown-OrZqWAIM.js","assets/usePinnedData-C6FFXoty.js","assets/folders.store-CS_gIPIm.js","assets/executions.store-DnLtKXBA.js","assets/useCanvasOperations-C5vD0y-x.css","assets/retry-C_b9sBX6.js","assets/pushConnection.store-IFO3HVvG.js","assets/collaboration.store-QKYwE2H2.js","assets/useClipboard-Duc7LjuO.js","assets/useExecutionHelpers-mcaelfkG.js","assets/dateFormatter-C82w-7IH.js","assets/externalSecrets.ee.store-RuZGBiOy.js","assets/useEnvFeatureFlag-CHY3xSda.js","assets/RunDataHtml-Dkm6vMd9.js","assets/RunDataHtml-Dn-4rgtR.css","assets/RunData-Dg8CXr1L.css","assets/ParameterInputList-BmOOAGJV.js","assets/exports--h7UC0Af.js","assets/vue-BgT2pM2d.js","assets/comlink-Mw9RuxlG.js","assets/date-picker-CHH0vNVG.js","assets/flatten-D8LKlTI-.js","assets/dialog-Ds437WFa.js","assets/VirtualSchema-SoERffbL.js","assets/Draggable-YWqutRc8.js","assets/Draggable-B0pfmmgs.css","assets/NodeIcon-Dv1e4Lvu.js","assets/NodeIcon-Cd4SL1LV.css","assets/useCalloutHelpers-BqZQxC7j.js","assets/useTelemetryContext-Dq1_6uNp.js","assets/useTelemetryContext-DP1IjWBS.css","assets/nodeTransforms-CG9uauaw.js","assets/TextWithHighlights-FXXrxJMD.js","assets/TextWithHighlights-CnnnTpA3.css","assets/VirtualSchema-BRqEE3IK.css","assets/CredentialIcon-B1JZV04S.js","assets/CredentialIcon-D9KQZeCk.css","assets/useQuickConnect-D8uMNvJo.js","assets/useDynamicCredentials-BSZ25lEI.js","assets/ParameterInputList-xQvaQYBT.css","assets/NodeSettings-BBj2nP6A.js","assets/col-D8aZ4Gpw.js","assets/useFreeAiCredits-DbEV2VUt.js","assets/dataTable.store-dy4dvFXe.js","assets/QuickConnectBanner-zXpJTy1t.js","assets/semver-DulOjSKL.js","assets/QuickConnectBanner-BAG-wouZ.css","assets/NodeSettings-dmzkBe-2.css","assets/useLogsTreeExpand-CjcPPamK.js","assets/AnimatedSpinner-BEM3aFx0.js","assets/AnimatedSpinner-OiUdRqev.css","assets/useLogsTreeExpand-CdQhtp-t.css","assets/CopyInput-DChEtJl3.js","assets/CopyInput-B98-wdxU.css","assets/useExecutionData-CwkDVUHC.js","assets/TriggerPanel-CtLae2vY.js","assets/RunDataParsedAiContent-D3oW1jPS.js","assets/RunDataParsedAiContent-vue_dQQ_.css","assets/TriggerPanel-DYfzWzGb.css","assets/NodeDetailsView-DGjkLJen.css","assets/NodeDetailsViewV2-CkJpFe7O.js","assets/useKeybindings-B_gtbMl6.js","assets/NodeDetailsViewV2-BHoFcZVS.css","assets/SetupWorkflowCredentialsButton--TsWCmDa.js","assets/readyToRun.store-DM7AW4os.js","assets/setupPanel.store-BkfXtNZF.js"])))=>i.map(i=>d[i]);
(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`28b97f8b-e8fe-428f-a980-b74a33c3aedf`,e._sentryDebugIdIdentifier=`sentry-dbid-28b97f8b-e8fe-428f-a980-b74a33c3aedf`)})()}catch{}import{C as e,Cn as t,D as n,E as r,G as i,Gt as a,It as o,J as s,K as c,L as l,M as u,N as d,P as f,Q as p,T as m,U as h,Vt as ee,W as g,Y as te,Z as _,_ as v,_t as y,at as b,bn as x,bt as S,c as C,et as w,ft as T,h as E,it as ne,j as D,jt as re,mt as ie,nt as O,q as k,vn as A,w as j,y as ae}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{$ as M,b as N,h as oe,ot as se,st as ce,yt as P}from"./_MapCache-DjbOQyB7.js";import{Bi as le,Ci as ue,Hi as F,I,Ki as L,Mi as de,Oi as R,Ot as z,Q as fe,Si as pe,St as me,Ui as B,Vi as V,_t as he,d as ge,j as H,ji as _e,kt as ve,wi as ye,xt as be,z as xe}from"./src-CppJvwzX.js";import{t as U}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import"./date-picker-CHH0vNVG.js";import{Bt as Se,C as Ce,Ci as W,Er as we,Ft as Te,Gt as Ee,It as De,Ji as Oe,Ln as ke,Lt as Ae,Mn as je,Ot as Me,Rr as Ne,Sr as Pe,Tr as G,Vt as Fe,di as Ie,er as K,fn as Le,ga as q,gn as Re,ia as ze,ir as Be,li as Ve,pn as He,r as Ue,rt as We,s as Ge,sa as Ke,t as qe,un as Je,va as Ye,wr as Xe,xr as Ze,yr as Qe,zn as $e}from"./users.store-pCkD7Zo0.js";import{D as J,M as et,N as tt,P as nt,T as rt,_ as it,a as at,b as ot,d as st,h as ct,s as lt,u as ut,v as dt}from"./ParameterInputList-BmOOAGJV.js";import{An as ft,Ct as pt,Ga as mt,Gt as ht,M as gt,Qc as _t,R as vt,Ra as yt,Ss as bt,Tc as xt,To as St,Tt as Y,Vs as Ct,Zn as wt,bo as Tt,da as Et,hr as Dt,hs as Ot,is as kt,mo as At,ns as jt,ol as Mt,qo as Nt,rs as X,so as Pt,ua as Ft,wa as It,xc as Lt,xo as Rt}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{N as zt,r as Bt}from"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./dataTable.store-dy4dvFXe.js";import{t as Vt}from"./useClipboard-Duc7LjuO.js";import{t as Ht}from"./executions.store-DnLtKXBA.js";import"./assistant.store-BGYzebcZ.js";import{t as Ut}from"./chatPanel.store-YdM_XYGp.js";import{s as Wt}from"./RunData-DoJODYvb.js";import"./NDVEmptyState-Cd-QhxaI.js";import"./useEnvFeatureFlag-CHY3xSda.js";import"./externalSecrets.ee.store-RuZGBiOy.js";import"./uniqBy-Bd2DEoH8.js";import"./semver-DulOjSKL.js";import"./usePinnedData-C6FFXoty.js";import"./nodeIcon--7uU1Imq.js";import{c as Gt,l as Kt}from"./canvas.utils-C8dCdoZZ.js";import{t as qt}from"./nodeCreator.store-KD9kt9dE.js";import{a as Jt,i as Yt,r as Z,t as Xt}from"./useCanvasOperations-BHGWcL34.js";import"./folders.store-CS_gIPIm.js";import"./QuickConnectBanner-zXpJTy1t.js";import"./useQuickConnect-D8uMNvJo.js";import"./CredentialIcon-B1JZV04S.js";import"./useDynamicCredentials-BSZ25lEI.js";import"./RunDataHtml-Dkm6vMd9.js";import"./Draggable-YWqutRc8.js";import{t as Zt}from"./NodeIcon-Dv1e4Lvu.js";import{n as Qt,r as $t}from"./VirtualSchema-SoERffbL.js";import"./useCalloutHelpers-BqZQxC7j.js";import{t as en}from"./useTelemetryContext-Dq1_6uNp.js";import{n as tn,t as nn}from"./useRunWorkflow-DzzlHC01.js";import{t as rn}from"./pushConnection.store-IFO3HVvG.js";import{i as an,o as on}from"./nodeTransforms-CG9uauaw.js";import"./vue-json-pretty-CT_xxsnb.js";import{n as sn,t as cn}from"./collaboration.store-QKYwE2H2.js";import"./dateFormatter-C82w-7IH.js";import"./useExecutionHelpers-mcaelfkG.js";import"./useFreeAiCredits-DbEV2VUt.js";import"./NodeSettings-BBj2nP6A.js";import{t as ln}from"./KeyboardShortcutTooltip-BuQeOxiO.js";import"./vue-BgT2pM2d.js";import{t as un}from"./CredentialPicker-u0Fuk2eM.js";import{t as dn}from"./sourceControl.eventBus-C0Et3VBv.js";import{n as fn,r as pn,t as mn}from"./CanvasRunWorkflowButton-B7EvorNA.js";import{a as hn,i as gn,n as _n,s as vn,t as yn}from"./useCanvasMapping-DLJo3gwW.js";import{t as bn}from"./useKeybindings-B_gtbMl6.js";import{t as xn}from"./injectStrict-CjZBqt9B.js";import"./useActions-C_2-IL4P.js";import{t as Sn}from"./setupPanel.store-BkfXtNZF.js";import{t as Cn}from"./useExecutionData-CwkDVUHC.js";import{t as wn}from"./emptyStateBuilderPrompt.store-BWGATy_3.js";var Tn=U(f({inheritAttrs:!1,__name:`WorkflowCanvas`,props:{id:{default:`canvas`},workflow:{},workflowObject:{},fallbackNodes:{default:()=>[]},showFallbackNodes:{type:Boolean,default:!0},eventBus:{default:()=>he()},readOnly:{type:Boolean},executing:{type:Boolean},suppressInteraction:{type:Boolean,default:!1}},setup(t,{expose:i}){let s=t,c=ie(`canvas`),l=C(),{onNodesInitialized:u,viewport:d,viewportRef:f,getNodes:p,fitBounds:h}=Be(s.id),te=ee(s,`workflow`),_=ee(s,`workflowObject`),{nodes:v,connections:y}=yn({nodes:e(()=>s.showFallbackNodes?[...s.workflow.nodes,...s.fallbackNodes]:s.workflow.nodes),connections:e(()=>s.workflow.connections),workflowObject:_}),x=o(!1),{off:S}=u(()=>{x.value||(s.eventBus.emit(`fitView`),x.value=!0,S())}),T=M(v,200),E=M(y,200);return i({executeContextMenuAction:(e,t)=>c.value?.executeContextMenuAction(e,t),ensureNodesAreVisible:e=>{let t=f.value;if(!t)return;let n=p.value.filter(t=>e.includes(t.id));if(n.length===0)return;let r=u(()=>{let i=d.value,a=t.clientWidth,o=t.clientHeight,c=K(n),l=c.x*i.zoom+i.x,u=c.y*i.zoom+i.y,f=c.width*i.zoom,p=c.height*i.zoom;if(!(l>=0&&u>=0&&l+f<=a&&u+p<=o)){let e={x:-i.x/i.zoom,y:-i.y/i.zoom,width:a/i.zoom,height:o/i.zoom},t=Math.min(e.x,c.x),n=Math.min(e.y,c.y),r=Math.max(e.x+e.width,c.x+c.width),s=Math.max(e.y+e.height,c.y+c.height);h({x:t,y:n,width:r-t,height:s-n},{padding:.15,duration:100})}s.eventBus.emit(`nodes:select`,{ids:e}),r.off()})}}),(e,i)=>(w(),n(`div`,{class:A(a(l).wrapper),"data-test-id":`canvas-wrapper`},[j(`div`,{id:`canvas`,class:A(a(l).canvas)},[te.value?(w(),m(_n,g({key:0,id:t.id,ref:`canvas`,nodes:t.executing?a(T):a(v),connections:t.executing?a(E):a(y),"event-bus":t.eventBus,"read-only":t.readOnly,executing:t.executing,"suppress-interaction":t.suppressInteraction},e.$attrs),null,16,[`id`,`nodes`,`connections`,`event-bus`,`read-only`,`executing`,`suppress-interaction`])):r(``,!0)],2),b(e.$slots,`default`)],2))}}),[[`__cssModules`,{$style:{wrapper:`_wrapper_gh0gb_125`,canvas:`_canvas_gh0gb_133`}}]]),En=U(f({__name:`FocusSidebarTabs`,props:{modelValue:{default:`setup`},tabLabels:{default:()=>({})}},emits:[`update:modelValue`],setup(t,{emit:r}){let i=P(),o=t,s=r,c=e(()=>[{label:o.tabLabels?.setup??i.baseText(`setupPanel.tabs.setup`),value:`setup`},{label:o.tabLabels?.focus??i.baseText(`setupPanel.tabs.focus`),value:`focus`}]),l=e=>{s(`update:modelValue`,e)};return(e,r)=>(w(),n(`div`,{class:A(e.$style.container),"data-test-id":`setup-panel-tabs`},[u(a(H),{"model-value":t.modelValue,options:c.value,size:`small`,"onUpdate:modelValue":l},null,8,[`model-value`,`options`])],2))}}),[[`__cssModules`,{$style:{container:`_container_1xsug_125`}}]]);function Dn(e,t){let n=new Set,r=an(e,t);for(let e of r)n.add(e.name);let i=t.issues?.credentials??{};for(let e of Object.keys(i))n.add(e);if(t.credentials)for(let e of Object.keys(t.credentials))n.add(e);return Array.from(n)}function On(e,t,n,r){let i=e.credentials?.[t],a=typeof i==`string`?void 0:i?.id??void 0,o=[(e.issues?.credentials??{})[t]??[]].flat();return{credentialType:t,credentialDisplayName:n(t),selectedCredentialId:a,issues:o,nodesWithSameCredential:r.get(t)??[]}}function kn(e){return e.every(e=>e.selectedCredentialId&&e.issues.length===0)}function An(e,t,n,r,i=!1,a=!1){let o=t.map(t=>On(e,t,n,r)),s=kn(o);return{node:e,credentialRequirements:o,isComplete:i?s&&a:s,isTrigger:i}}const jn=t=>{let n=Ge(),r=We(),i=Ce(),a=De(),o=Fe(),s=Qe(),c=P(),l=e(()=>t?.value??n.allNodes),u=e=>r.getCredentialTypeByName(e)?.displayName??e,d=e=>i.isTriggerNode(e.type),f=e=>{let t=n.getWorkflowResultDataByNodeName(e);return t!==null&&t.length>0},p=e(()=>l.value.filter(e=>!e.disabled).map(e=>({node:e,credentialTypes:Dn(i,e),isTrigger:d(e)})).filter(({credentialTypes:e,isTrigger:t})=>e.length>0||t).sort((e,t)=>Number(t.isTrigger)-Number(e.isTrigger)||e.node.position[0]-t.node.position[0])),m=e(()=>{let e=new Map;for(let{node:t,credentialTypes:n}of p.value)for(let r of n){let n=e.get(r)??[];n.push(t.name),e.set(r,n)}return e}),h=e(()=>p.value.map(({node:e,credentialTypes:t,isTrigger:n})=>An(e,t,u,m.value,n,f(e.name))));return{nodeSetupStates:h,totalCredentialsMissing:e(()=>h.value.reduce((e,t)=>e+t.credentialRequirements.filter(e=>!e.selectedCredentialId||e.issues.length>0).length,0)),totalNodesRequiringSetup:e(()=>h.value.length),isAllComplete:e(()=>h.value.length>0&&h.value.every(e=>e.isComplete)),setCredential:(e,t,i)=>{let l=r.getCredentialById(i);if(!l)return;let u=n.getNodeByName(e);if(!u)return;let d={id:i,name:l.name};o.updateNodeProperties({name:e,properties:{credentials:{...u.credentials,[t]:d}}}),a.updateNodeCredentialIssuesByName(e);let f=[];for(let r of h.value)if(r.node.name!==e&&r.credentialRequirements.some(e=>e.credentialType===t&&!e.selectedCredentialId)){let e=n.getNodeByName(r.node.name);e&&(o.updateNodeProperties({name:r.node.name,properties:{credentials:{...e.credentials,[t]:d}}}),f.push(r.node.name))}f.length>0&&(a.updateNodesCredentialsIssues(),s.showMessage({title:c.baseText(`nodeCredentials.showMessage.title`),message:c.baseText(`nodeCredentials.autoAssigned.message`,{interpolate:{count:String(f.length)}}),type:`success`}))},unsetCredential:(e,t)=>{let r=n.getNodeByName(e);if(!r)return;let i={...r.credentials};delete i[t],o.updateNodeProperties({name:e,properties:{credentials:i}}),a.updateNodeCredentialIssuesByName(e)}}};var Mn=[`for`],Nn=U(f({__name:`SetupCredentialLabel`,props:{nodeName:{},credentialType:{},nodesWithSameCredential:{}},setup(e){let i=P();return(o,s)=>(w(),n(`div`,{class:A(o.$style[`credential-label-row`])},[j(`label`,{"data-test-id":`node-setup-card-credential-label`,for:`credential-picker-${e.nodeName}-${e.credentialType}`,class:A(o.$style[`credential-label`])},t(a(i).baseText(`setupPanel.credentialLabel`)),11,Mn),e.nodesWithSameCredential.length>1?(w(),m(a(R),{key:0,placement:`top`},{content:S(()=>[D(t(e.nodesWithSameCredential.join(`, `)),1)]),default:S(()=>[j(`span`,{"data-test-id":`node-setup-card-shared-nodes-hint`,class:A(o.$style[`shared-nodes-hint`])},t(a(i).baseText(`setupPanel.usedInNodes`,{interpolate:{count:String(e.nodesWithSameCredential.length)}})),3)]),_:1})):r(``,!0)],2))}}),[[`__cssModules`,{$style:{"credential-label-row":`_credential-label-row_1nlke_125`,"credential-label":`_credential-label_1nlke_125`,"shared-nodes-hint":`_shared-nodes-hint_1nlke_136`}}]]),Pn=U(f({__name:`NodeSetupCard`,props:h({state:{}},{expanded:{type:Boolean,default:!1},expandedModifiers:{}}),emits:h([`credentialSelected`,`credentialDeselected`],[`update:expanded`]),setup(i,{emit:s}){let c=i,l=T(i,`expanded`),d=s,f=P(),p=Ae(),h=Ce(),ee=Ge(),{isExecuting:g,buttonLabel:te,buttonIcon:b,disabledReason:x,hasIssues:C,execute:E}=$t(e(()=>c.state.node)),re=e(()=>h.getNodeType(c.state.node.type,c.state.node.typeVersion)),ie=e(()=>g.value||C.value||!!x.value),O=e(()=>c.state.isTrigger||c.state.isComplete),k=e(()=>C.value?f.baseText(`ndv.execute.requiredFieldsMissing`):x.value),ae=()=>{l.value=!l.value},M=o(!1),N=(e,t)=>{M.value=!0,d(`credentialSelected`,{credentialType:e,credentialId:t})},oe=e=>{M.value=!0,d(`credentialDeselected`,e)},se=async()=>{M.value=!0,await E()};function ce(e){let t=new Set;for(let n of e)for(let e of n.nodesWithSameCredential){let n=ee.getNodeByName(e);n&&t.add(n.type)}return t}function le(e){let t=0;for(let n of e)t+=n.nodesWithSameCredential.length;return t}return y(()=>c.state.isComplete,e=>{e&&(l.value=!1,M.value&&=(p.track(`User completed setup step`,{template_id:ee.workflow.meta?.templateId,workflow_id:ee.workflowId,type:c.state.isTrigger?`trigger`:`credential`,nodes:Array.from(ce(c.state.credentialRequirements)),related_nodes_count:le(c.state.credentialRequirements)}),!1))}),_(()=>{c.state.isComplete&&(l.value=!1)}),(e,o)=>(w(),n(`div`,{"data-test-id":`node-setup-card`,class:A([e.$style.card,{[e.$style.collapsed]:!l.value,[e.$style.completed]:i.state.isComplete,[e.$style[`no-content`]]:!i.state.credentialRequirements.length}])},[j(`header`,{"data-test-id":`node-setup-card-header`,class:A(e.$style.header),onClick:ae},[!l.value&&i.state.isComplete?(w(),m(a(B),{key:0,"data-test-id":`node-setup-card-complete-icon`,icon:`check`,class:A(e.$style[`complete-icon`]),size:`medium`},null,8,[`class`])):(w(),m(Zt,{key:1,"node-type":re.value,size:16},null,8,[`node-type`])),u(a(V),{class:A(e.$style[`node-name`]),size:`medium`,color:`text-dark`},{default:S(()=>[D(t(c.state.node.name),1)]),_:1},8,[`class`]),i.state.isTrigger?(w(),m(a(R),{key:2},{content:S(()=>[D(t(a(f).baseText(`nodeCreator.nodeItem.triggerIconTitle`)),1)]),default:S(()=>[u(a(B),{class:A([e.$style[`header-icon`],e.$style.trigger]),icon:`zap`,size:`small`,color:`text-light`},null,8,[`class`])]),_:1})):r(``,!0),u(a(B),{class:A([e.$style[`header-icon`],e.$style.chevron]),icon:l.value?`chevrons-down-up`:`chevrons-up-down`,size:`medium`,color:`text-light`},null,8,[`class`,`icon`])],2),l.value?(w(),n(v,{key:0},[i.state.credentialRequirements.length?(w(),n(`div`,{key:0,class:A({[e.$style.content]:!0,"pb-s":!O.value})},[i.state.isTrigger?(w(),m(a(V),{key:0,size:`medium`,color:`text-light`,class:`mb-3xs`},{default:S(()=>[D(t(a(f).baseText(`setupPanel.trigger.credential.note`)),1)]),_:1})):r(``,!0),(w(!0),n(v,null,ne(i.state.credentialRequirements,t=>(w(),n(`div`,{key:t.credentialType,class:A(e.$style[`credential-container`])},[u(Nn,{"node-name":i.state.node.name,"credential-type":t.credentialType,"nodes-with-same-credential":t.nodesWithSameCredential},null,8,[`node-name`,`credential-type`,`nodes-with-same-credential`]),u(un,{"create-button-type":`secondary`,class:A(e.$style[`credential-picker`]),"app-name":t.credentialDisplayName,"credential-type":t.credentialType,"selected-credential-id":t.selectedCredentialId??null,onCredentialSelected:e=>N(t.credentialType,e),onCredentialDeselected:e=>oe(t.credentialType)},null,8,[`class`,`app-name`,`credential-type`,`selected-credential-id`,`onCredentialSelected`,`onCredentialDeselected`])],2))),128))],2)):r(``,!0),O.value?(w(),n(`footer`,{key:1,class:A(e.$style.footer)},[i.state.isComplete?(w(),n(`div`,{key:0,class:A(e.$style[`footer-complete-check`])},[u(a(B),{icon:`check`,class:A(e.$style[`complete-icon`]),size:`large`},null,8,[`class`]),u(a(V),{size:`medium`,color:`success`},{default:S(()=>[D(t(a(f).baseText(`generic.complete`)),1)]),_:1})],2)):r(``,!0),i.state.isTrigger?(w(),m(a(R),{key:1,disabled:!k.value,placement:`top`},{content:S(()=>[D(t(k.value),1)]),default:S(()=>[u(a(F),{"data-test-id":`node-setup-card-test-button`,label:a(te),disabled:ie.value,loading:a(g),icon:a(b),size:`small`,onClick:se},null,8,[`label`,`disabled`,`loading`,`icon`])]),_:1},8,[`disabled`])):r(``,!0)],2)):r(``,!0)],64)):r(``,!0)],2))}}),[[`__cssModules`,{$style:{card:`_card_l1dfx_125`,"header-icon":`_header-icon_l1dfx_134`,chevron:`_chevron_l1dfx_134`,trigger:`_trigger_l1dfx_140`,header:`_header_l1dfx_134`,collapsed:`_collapsed_l1dfx_151`,"no-content":`_no-content_l1dfx_154`,"node-name":`_node-name_l1dfx_158`,"complete-icon":`_complete-icon_l1dfx_163`,content:`_content_l1dfx_167`,"credential-container":`_credential-container_l1dfx_174`,"credential-picker":`_credential-picker_l1dfx_180`,footer:`_footer_l1dfx_184`,"footer-complete-check":`_footer-complete-check_l1dfx_190`,completed:`_completed_l1dfx_206`}}]]),Fn=U(f({__name:`SetupPanelCards`,setup(e){let i=P(),o=Ae(),s=Ge(),{nodeSetupStates:c,isAllComplete:l,setCredential:d,unsetCredential:f}=jn();y(l,e=>{e&&o.track(`User completed all setup steps`,{template_id:s.workflow.meta?.templateId,workflow_id:s.workflowId})});let p=(e,t)=>{d(e,t.credentialType,t.credentialId)},h=(e,t)=>{f(e,t)};return(e,o)=>(w(),n(`div`,{class:A(e.$style.container),"data-test-id":`setup-panel-cards-container`},[a(c).length===0?(w(),n(`div`,{key:0,class:A(e.$style[`empty-state`]),"data-test-id":`setup-cards-empty`},[u(a(B),{icon:`list-checks`,class:A(e.$style[`empty-icon`]),size:24,color:`text-base`},null,8,[`class`]),j(`div`,{class:A(e.$style[`empty-text`])},[u(a(V),{size:`medium`,color:`text-base`,bold:!0,"data-test-id":`setup-cards-empty-heading`},{default:S(()=>[D(t(a(i).baseText(`setupPanel.empty.heading`)),1)]),_:1}),u(a(V),{size:`medium`,color:`text-light`,"data-test-id":`setup-cards-empty-description`},{default:S(()=>[D(t(a(i).baseText(`setupPanel.empty.description`)),1)]),_:1})],2)],2)):(w(),n(`div`,{key:1,class:A(e.$style[`card-list`]),"data-test-id":`setup-cards-list`},[(w(!0),n(v,null,ne(a(c),(e,t)=>(w(),m(Pn,{key:e.node.id,state:e,expanded:t===0,onCredentialSelected:t=>p(e.node.name,t),onCredentialDeselected:t=>h(e.node.name,t)},null,8,[`state`,`expanded`,`onCredentialSelected`,`onCredentialDeselected`]))),128)),a(l)?(w(),n(`div`,{key:0,class:A(e.$style[`complete-message`]),"data-test-id":`setup-cards-complete-message`},[u(a(V),{size:`medium`,color:`text-base`},{default:S(()=>[D(t(a(i).baseText(`setupPanel.everythingConfigured.message`)),1)]),_:1})],2)):r(``,!0)],2))],2))}}),[[`__cssModules`,{$style:{container:`_container_1011p_125`,"card-list":`_card-list_1011p_126`,"empty-state":`_empty-state_1011p_134`,"empty-text":`_empty-text_1011p_144`,"complete-message":`_complete-message_1011p_150`}}]]),Q=U(f({__name:`SetupPanel`,setup(e){return(e,t)=>(w(),n(`div`,{class:A(e.$style.container),"data-test-id":`setup-panel-container`},[u(Fn)],2))}}),[[`__cssModules`,{$style:{container:`_container_17sfi_125`}}]]),In=U(f({__name:`ExperimentalNodeDetailsDrawer`,props:{node:{},nodeIds:{},isReadOnly:{type:Boolean}},emits:[`openNdv`,`contextMenuAction`],setup(i,{emit:s}){let c=s,l=gn(e(()=>i.node)),d=vn(e(()=>i.nodeIds)),f=Se(),p=o(0),h=e(()=>[i.node.id,p.value].join(`|`));return y(()=>f.activeNodeName,(e,t)=>{e===null&&t!==null&&(p.value+=1)}),O(Lt,l),(e,o)=>(w(),n(`div`,{class:A(e.$style.component)},[i.nodeIds.length>1?(w(),m(a(V),{key:0,tag:`div`,color:`text-base`,class:A(e.$style.multipleNodes)},{default:S(()=>[j(`div`,null,t(i.nodeIds.length)+` nodes selected`,1),j(`ul`,{class:A(e.$style.multipleNodesActions)},[(w(!0),n(v,null,ne(a(d),o=>(w(),n(`li`,{key:o.id,class:A(e.$style.multipleNodesAction)},[u(a(F),{variant:`subtle`,disabled:o.disabled,onClick:e=>c(`contextMenuAction`,o.id,i.nodeIds)},{default:S(()=>[D(t(o.label)+` `,1),o.shortcut?(w(),m(a(z),g({key:0,ref_for:!0},o.shortcut),null,16)):r(``,!0)]),_:2},1032,[`disabled`,`onClick`])],2))),128))],2)]),_:1},8,[`class`])):i.node?(w(),m(hn,{key:h.value,"node-id":i.node.id,"is-read-only":i.isReadOnly},null,8,[`node-id`,`is-read-only`])):r(``,!0)],2))}}),[[`__cssModules`,{$style:{component:`_component_1ef46_125`,multipleNodes:`_multipleNodes_1ef46_130`,multipleNodesActions:`_multipleNodesActions_1ef46_140`,multipleNodesAction:`_multipleNodesAction_1ef46_140`}}]]),Ln=U(f({__name:`ExperimentalFocusPanelHeader`,props:{node:{},parameter:{},isExecutable:{type:Boolean},readOnly:{type:Boolean}},emits:[`execute`,`openNdv`,`clearParameter`,`renameNode`],setup(i,{emit:o}){let s=o,c=Ce(),l=P(),d=e(()=>c.getNodeType(i.node.type,i.node.typeVersion));return(e,o)=>(w(),m(a(V),{tag:`header`,size:`small`,bold:``,class:A(e.$style.component)},{default:S(()=>[u(Zt,{"node-type":d.value,size:16},null,8,[`node-type`]),j(`div`,{class:A(e.$style.breadcrumbs)},[i.parameter?(w(),n(v,{key:0},[u(a(V),{size:`small`,color:`text-base`,bold:``},{default:S(()=>[D(t(i.node.name),1)]),_:1}),u(a(V),{size:`small`,color:`text-light`},{default:S(()=>[...o[4]||=[D(`/`,-1)]]),_:1}),D(` `+t(i.parameter.displayName),1)],64)):(w(),m(a(ge),{key:1,"model-value":i.node.name,"min-width":0,"max-width":500,placeholder:a(l).baseText(`ndv.title.rename.placeholder`),"read-only":i.readOnly,"onUpdate:modelValue":o[0]||=e=>s(`renameNode`,e)},null,8,[`model-value`,`placeholder`,`read-only`]))],2),i.parameter?(w(),m(a(de),{key:0,variant:`ghost`,icon:`x`,size:`small`,onClick:o[1]||=e=>s(`clearParameter`)})):(w(),m(a(de),{key:1,variant:`ghost`,icon:`expand`,size:`small`,onClick:o[2]||=e=>s(`openNdv`)})),i.isExecutable?(w(),m(Qt,{key:2,"data-test-id":`node-execute-button`,"node-name":i.node.name,tooltip:`Execute ${i.node.name}`,type:`secondary`,size:`small`,icon:`play`,square:!0,"hide-label":!0,"telemetry-source":`focus`,onExecute:o[3]||=e=>s(`execute`)},null,8,[`node-name`,`tooltip`])):r(``,!0)]),_:1},8,[`class`]))}}),[[`__cssModules`,{$style:{component:`_component_1p4tv_125`,breadcrumbs:`_breadcrumbs_1p4tv_133`}}]]),Rn=U(f({name:`FocusPanel`,__name:`FocusPanel`,props:{isCanvasReadOnly:{type:Boolean}},emits:[`focus`,`saveKeyboardShortcut`,`contextMenuAction`],setup(s,{emit:c}){let l=s,d=c,f=o(),p=P(),h=De(),g=Re(),te=Ge(),_=Fe(),b=Ce(),x=Ae(),C=st(),T=Te(),E=Yt(),ne=Se(),re=Be(te.workflowId),{renameNode:ie}=Xt(),O=e(()=>g.resolvedParameter),k=o(``),ae=oe(async()=>{if(!O.value)return!1;let e=O.value.parameterPath.split(`.`).slice(1,-1).join(`.`);return!!O.value.parameter.disabledOptions&&await C.shouldDisplayNodeParameter(O.value.node.parameters,O.value.node,O.value.parameter,e,`disabledOptions`)},!1),M=oe(async()=>{if(!O.value)return!0;let e=O.value.parameterPath.split(`.`).slice(1,-1).join(`.`);return await C.shouldDisplayNodeParameter(O.value.node.parameters,O.value.node,O.value.parameter,e,`displayOptions`)},!0),N=e(()=>{if(!E.isNdvInFocusPanelEnabled||O.value)return O.value?.node;let e=re.getSelectedNodes.value[0];return e?.data?.render.type===Ie.Default?te.allNodes.find(t=>t.id===e.id):void 0}),se=e(()=>re.getSelectedNodes.value.length>1),ce=e(()=>{if(!N.value||!M.value)return!1;let e=h.getForeignCredentialsIfSharingEnabled(N.value.credentials);return h.isNodeExecutable(N.value,!l.isCanvasReadOnly,e)}),{workflowRunData:le}=Cn({node:N}),ue=e(()=>{if(!N.value)return!0;let e=te.workflowObject.getParentNodes(N.value.name,`main`,1)[0];return!!(e&&le.value&&Object.prototype.hasOwnProperty.bind(le.value)(e))});function F(e){return O.value?it(O.value.parameter,e):void 0}let I=e(()=>O.value?.node.parameters.mode),L=e(()=>F(`editor`)??void 0),de=e(()=>L.value===`json`||O.value?.parameter.type===`json`?`json`:F(`editorLanguage`)??`javaScript`),R=e(()=>F(`rows`)),z=e(()=>O.value?b.isToolNode(O.value?.node.type):!1),pe=e(()=>!!O.value&&O.value.node.type===`n8n-nodes-base.html`),me=e(()=>O.value&&Oe(O.value.parameter,O.value.value)),he=e(()=>me.value?yt(O.value)?O.value.value:O.value:``),ge=e(()=>O.value?.node.type===At),H=e(()=>l.isCanvasReadOnly||ae.value),ve=e(()=>({$vars:T.variablesAsObject})),ye=e(()=>{if(O.value)return{nodeName:O.value.node.name,parameterPath:O.value.parameterPath}}),be=e(()=>_.executingNode.isNodeExecuting(N.value?.name??``)),U=e(()=>re.getSelectedNodes.value.map(e=>e.id)),W=e(()=>E.isNdvInFocusPanelEnabled?p.baseText(`nodeView.focusPanel.v2.noParameters.title`):p.baseText(`nodeView.focusPanel.noParameters.title`)),we=e(()=>E.isNdvInFocusPanelEnabled?p.baseText(`nodeView.focusPanel.v2.noParameters.subtitle`):p.baseText(`nodeView.focusPanel.noParameters.subtitle`)),{resolvedExpression:Ee}=lt({expression:he,additionalData:ve,stringifyObject:O.value&&O.value.parameter.type!==`multiOptions`});function ke(e){O.value!==void 0&&C.updateNodeParameter(ee(O.value.node.parameters),{value:e,name:O.value.parameterPath},e,O.value.node,z.value)}async function je(){await i(),f.value&&(ze(f.value)?f.value.focusOnInput():Ke(f.value)&&f.value.focus()),d(`focus`)}function Me(e){if(O.value)switch(e){case`resetValue`:typeof O.value.parameter.default==`string`&&ke(O.value.parameter.default),je();break;case`addExpression`:{let e=ct(O.value.value,O.value.parameter.type);ke(typeof e==`string`?e:e.value),je();break}case`removeExpression`:{let e=ot(O.value.value,Ee.value,O.value.parameter.type,O.value.parameter.default,(O.value.parameter.options??[]).filter(dt));typeof e==`string`?ke(e):e&&typeof e.value==`string`&&ke(e.value),je();break}case`formatHtml`:Ye.emit(`format-html`);break}}function Ne(){if(E.isNdvInFocusPanelEnabled&&O.value){g.unsetParameters(),x.track(`User removed focused param`,{source:`closeIcon`,parameters:g.focusedNodeParametersInTelemetryFormat});return}x.track(`User closed focus panel`,{source:`closeIcon`,parameters:g.focusedNodeParametersInTelemetryFormat}),g.closeFocusPanel()}function Pe(){x.track(`User executed node from focus panel`,g.focusedNodeParametersInTelemetryFormat[0])}function G(e){k.value=e,ke(e)}function K(){setTimeout(()=>{je()},50)}y([()=>g.lastFocusTimestamp,()=>me.value],()=>K()),y(()=>O.value,e=>{if(e){let t=e.value;typeof t==`string`&&t!==k.value&&(k.value=t)}},{immediate:!0});function Le(){N.value&&ne.setActiveNodeName(N.value.name,`focus_panel`)}function q(e){N.value&&ie(N.value.name,e)}return(e,i)=>(w(),n(`div`,{"data-test-id":`focus-panel`,class:A([e.$style.content,{[e.$style.isNdvInFocusPanelEnabled]:a(E).isNdvInFocusPanelEnabled}])},[a(E).isNdvInFocusPanelEnabled&&N.value&&!se.value?(w(),m(Ln,{key:0,node:N.value,parameter:O.value?.parameter,"is-executable":ce.value,"read-only":s.isCanvasReadOnly,onExecute:Pe,onOpenNdv:Le,onClearParameter:Ne,onRenameNode:q},null,8,[`node`,`parameter`,`is-executable`,`read-only`])):r(``,!0),O.value?(w(),n(`div`,{key:1,class:A(e.$style.content),"data-test-id":`focus-parameter`},[a(E).isNdvInFocusPanelEnabled?r(``,!0):(w(),n(`div`,{key:0,class:A(e.$style.tabHeader)},[j(`div`,{class:A(e.$style.tabHeaderText)},[u(a(V),{color:`text-dark`,size:`small`},{default:S(()=>[D(t(O.value.parameter.displayName),1)]),_:1}),u(a(V),{color:`text-base`,size:`xsmall`},{default:S(()=>[D(t(O.value.node.name),1)]),_:1})],2),j(`div`,{class:A(e.$style.buttonWrapper)},[u(Qt,{"data-test-id":`node-execute-button`,"node-name":O.value.node.name,tooltip:`Execute ${O.value.node.name}`,disabled:!ce.value,size:`small`,icon:`play`,square:!0,"hide-label":!0,"telemetry-source":`focus`,onExecute:Pe},null,8,[`node-name`,`tooltip`,`disabled`]),u(a(B),{class:A(e.$style.closeButton),icon:`x`,color:`text-base`,size:`xlarge`,onClick:Ne},null,8,[`class`])],2)],2)),j(`div`,{class:A(e.$style.parameterDetailsWrapper)},[j(`div`,{class:A(e.$style.parameterOptionsWrapper)},[j(`div`,{class:A(e.$style.noExecutionDataTip)},[!ue.value&&!be.value?(w(),m(a(fe),{key:0,class:A(e.$style.delayedShow),bold:!0},{default:S(()=>[D(t(a(p).baseText(`nodeView.focusPanel.noExecutionData`)),1)]),_:1},8,[`class`])):r(``,!0)],2),a(M)?(w(),m(at,{key:0,parameter:O.value.parameter,value:O.value.value,"is-read-only":H.value,"onUpdate:modelValue":Me},null,8,[`parameter`,`value`,`is-read-only`])):r(``,!0)],2),typeof O.value.value==`string`?(w(),n(`div`,{key:0,class:A(e.$style.editorContainer)},[a(M)?me.value?(w(),m(J,{key:1,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":i[0]||=e=>k.value=e,class:A(e.$style.editor),"is-read-only":H.value,path:O.value.parameterPath,"data-test-id":`expression-modal-input`,"target-node-parameter-context":ye.value,onChange:i[1]||=e=>G(e.value)},null,8,[`modelValue`,`class`,`is-read-only`,`path`,`target-node-parameter-context`])):[`json`,`string`].includes(O.value.parameter.type)?(w(),n(v,{key:2},[L.value===`codeNodeEditor`?(w(),m(et,{key:0,id:O.value.parameterPath,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":[i[2]||=e=>k.value=e,G],class:A(e.$style.heightFull),mode:I.value,"default-value":O.value.parameter.default,language:de.value,"is-read-only":H.value,"target-node-parameter-context":ye.value,"fill-parent":``,"disable-ask-ai":!0},null,8,[`id`,`modelValue`,`class`,`mode`,`default-value`,`language`,`is-read-only`,`target-node-parameter-context`])):L.value===`htmlEditor`?(w(),m(nt,{key:1,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":[i[3]||=e=>k.value=e,G],"is-read-only":H.value,rows:R.value,"disable-expression-coloring":!pe.value,"disable-expression-completions":!pe.value,fullscreen:``,"target-node-parameter-context":ye.value},null,8,[`modelValue`,`is-read-only`,`rows`,`disable-expression-coloring`,`disable-expression-completions`,`target-node-parameter-context`])):L.value===`cssEditor`?(w(),m(ut,{key:2,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":[i[4]||=e=>k.value=e,G],"is-read-only":H.value,rows:R.value,fullscreen:``,"target-node-parameter-context":ye.value},null,8,[`modelValue`,`is-read-only`,`rows`,`target-node-parameter-context`])):L.value===`sqlEditor`?(w(),m(rt,{key:3,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":[i[5]||=e=>k.value=e,G],dialect:F(`sqlDialect`),"is-read-only":H.value,rows:R.value,fullscreen:``,"target-node-parameter-context":ye.value},null,8,[`modelValue`,`dialect`,`is-read-only`,`rows`,`target-node-parameter-context`])):L.value===`jsEditor`?(w(),m(tt,{key:4,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":[i[6]||=e=>k.value=e,G],"is-read-only":H.value,rows:R.value,"posthog-capture":ge.value,"fill-parent":``},null,8,[`modelValue`,`is-read-only`,`rows`,`posthog-capture`])):O.value.parameter.type===`json`?(w(),m(Wt,{key:5,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":[i[7]||=e=>k.value=e,G],"is-read-only":H.value,rows:R.value,fullscreen:``,"fill-parent":``},null,8,[`modelValue`,`is-read-only`,`rows`])):(w(),m(a(_e),{key:6,ref_key:`inputField`,ref:f,modelValue:k.value,"onUpdate:modelValue":[i[8]||=e=>k.value=e,G],class:A(e.$style.editor),readonly:H.value,type:`textarea`,resize:`none`},null,8,[`modelValue`,`class`,`readonly`]))],64)):r(``,!0):(w(),n(`div`,{key:0,class:A([e.$style.content,e.$style.emptyContent])},[j(`div`,{class:A(e.$style.emptyText)},[u(a(V),{color:`text-base`},{default:S(()=>[D(t(a(p).baseText(`nodeView.focusPanel.missingParameter`)),1)]),_:1})],2)],2))],2)):r(``,!0)],2)],2)):N.value&&a(E).isNdvInFocusPanelEnabled?(w(),m(In,{key:2,node:N.value,"node-ids":U.value,"is-read-only":H.value,onOpenNdv:Le,onContextMenuAction:i[9]||=(e,t)=>d(`contextMenuAction`,e,t)},null,8,[`node`,`node-ids`,`is-read-only`])):(w(),n(`div`,{key:3,class:A([e.$style.content,e.$style.emptyContent])},[j(`div`,{class:A(e.$style.focusParameterWrapper)},[j(`div`,{class:A(e.$style.iconWrapper)},[u(a(B),{class:A(e.$style.forceHover),icon:`panel-right`,size:`medium`},null,8,[`class`]),u(a(B),{class:A(e.$style.pointerIcon),icon:`mouse-pointer`,color:`text-dark`,size:`large`},null,8,[`class`])],2),u(a(B),{icon:`ellipsis-vertical`,size:`small`,color:`text-base`}),u(a(xe),{size:`small`,"model-value":`expression`,disabled:!0,options:[{label:a(p).baseText(`parameterInput.fixed`),value:`fixed`},{label:a(p).baseText(`parameterInput.expression`),value:`expression`}]},null,8,[`options`])],2),j(`div`,{class:A(e.$style.emptyText)},[u(a(V),{color:`text-base`,size:`medium`,bold:!0},{default:S(()=>[D(t(W.value),1)]),_:1}),u(a(V),{color:`text-base`,size:`small`},{default:S(()=>[D(t(we.value),1)]),_:1})],2)],2))],2))}}),[[`__cssModules`,{$style:{content:`_content_9h1id_125`,emptyContent:`_emptyContent_9h1id_131`,isNdvInFocusPanelEnabled:`_isNdvInFocusPanelEnabled_9h1id_136`,emptyText:`_emptyText_9h1id_139`,focusParameterWrapper:`_focusParameterWrapper_9h1id_145`,iconWrapper:`_iconWrapper_9h1id_152`,pointerIcon:`_pointerIcon_9h1id_156`,tabHeader:`_tabHeader_9h1id_166`,tabHeaderText:`_tabHeaderText_9h1id_173`,buttonWrapper:`_buttonWrapper_9h1id_178`,parameterDetailsWrapper:`_parameterDetailsWrapper_9h1id_183`,parameterOptionsWrapper:`_parameterOptionsWrapper_9h1id_190`,noExecutionDataTip:`_noExecutionDataTip_9h1id_194`,editorContainer:`_editorContainer_9h1id_197`,editor:`_editor_9h1id_197`,delayedShow:`_delayedShow_9h1id_213`,triggerShow:`_triggerShow_9h1id_1`,closeButton:`_closeButton_9h1id_224`,heightFull:`_heightFull_9h1id_228`,forceHover:`_forceHover_9h1id_232`}}]]),zn={key:0},Bn=U(f({name:`FocusSidebar`,__name:`FocusSidebar`,props:{isCanvasReadOnly:{type:Boolean}},emits:[`contextMenuAction`],setup(t,{emit:i}){let o=i,c=ie(`wrapper`),l=Re(),d=Ge(),f=Yt(),p=Sn(),h=Ae(),ee=ve(),g=Be(d.workflowId),te=N();en({view_shown:`focus_panel`});let{selectedTab:_}=zt(l),v=e(()=>l.focusPanelActive),b=e(()=>l.focusPanelWidth),C=e(()=>l.resolvedParameter),T=e(()=>p.isFeatureEnabled),ne=e(()=>p.isFeatureEnabled&&_.value===`setup`),D=e(()=>{if(!f.isNdvInFocusPanelEnabled||C.value)return C.value?.node;let e=g.getSelectedNodes.value[0];return e?.data?.render.type===Ie.Default?d.allNodes.find(t=>t.id===e.id):void 0}),O=e(()=>{let e=C.value?.parameter.displayName??D.value?.name;return e?{focus:e}:void 0});function k(e){e.key===`s`&&ee.isCtrlKeyPressed(e)&&(e.stopPropagation(),e.preventDefault())}let ae=()=>{document.addEventListener(`keydown`,k,!0)},M=()=>{document.removeEventListener(`keydown`,k,!0)};y(()=>l.focusPanelActive,e=>{e?ae():M()},{immediate:!0}),y(te,e=>{if(!D.value||!e||!c.value?.contains(e))return;let t=e.closest(`.parameter-input`)?.getAttribute(`data-parameter-path`);t&&h.track(`User focused focus panel`,{node_id:D.value.id,node_type:D.value.type,parameter_path:t})});function oe(e){l.updateWidth(e.width)}let se=ce(oe,10);function P(e,t){o(`contextMenuAction`,e,t)}return s(()=>{M()}),(e,i)=>v.value?(w(),n(`div`,{key:0,ref:`wrapper`,"data-test-id":`focus-sidebar`,class:A([e.$style.wrapper,`ignore-key-press-canvas`,{[e.$style.isNdvInFocusPanelEnabled]:a(f).isNdvInFocusPanelEnabled}]),onKeydown:i[1]||=E(()=>{},[`stop`])},[u(a(I),{width:b.value,"supported-directions":[`left`],"min-width":T.value?420:300,"max-width":a(f).isNdvInFocusPanelEnabled?void 0:1e3,"grid-size":8,style:x({width:`${b.value}px`}),onResize:a(se)},{default:S(()=>[j(`div`,{class:A(e.$style.container)},[T.value?(w(),n(`div`,zn,[u(En,{modelValue:a(_),"onUpdate:modelValue":i[0]||=e=>re(_)?_.value=e:null,"tab-labels":O.value},null,8,[`modelValue`,`tab-labels`])])):r(``,!0),ne.value?(w(),n(`div`,{key:1,class:A(e.$style[`setup-panel-wrapper`])},[u(Q)],2)):(w(),m(Rn,{key:2,"is-canvas-read-only":t.isCanvasReadOnly,onContextMenuAction:P},null,8,[`is-canvas-read-only`]))],2)]),_:1},8,[`width`,`min-width`,`max-width`,`style`,`onResize`])],34)):r(``,!0)}}),[[`__cssModules`,{$style:{wrapper:`_wrapper_1ek2u_125`,container:`_container_1ek2u_137`,"setup-panel-wrapper":`_setup-panel-wrapper_1ek2u_143`}}]]),Vn=f({__name:`CanvasStopCurrentExecutionButton`,props:{stopping:{type:Boolean}},setup(t){let n=t,r=P(),i=e(()=>n.stopping?r.baseText(`nodeView.stoppingCurrentExecution`):r.baseText(`nodeView.stopCurrentExecution`));return(e,n)=>(w(),m(a(de),{variant:`subtle`,icon:`square`,size:`large`,class:`stop-execution`,title:i.value,loading:t.stopping,"data-test-id":`stop-execution-button`},null,8,[`title`,`loading`]))}}),Hn=f({__name:`CanvasStopWaitingForWebhookButton`,setup(e){let t=P();return(e,n)=>(w(),m(a(de),{variant:`subtle`,class:`stop-execution`,icon:`square`,size:`large`,title:a(t).baseText(`nodeView.stopWaitingForWebhookCall`),"data-test-id":`stop-execution-waiting-for-webhook-button`},null,8,[`title`]))}}),Un={"data-action":`reload`},Wn={href:`https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.wait/`,target:`_blank`},Gn=f({__name:`NodeViewUnfinishedWorkflowMessage`,setup(e){let r=P();return(e,i)=>(w(),n(`div`,null,[j(`a`,Un,t(a(r).baseText(`nodeView.refresh`)),1),D(` `+t(a(r).baseText(`nodeView.toSeeTheLatestStatus`))+`. `,1),i[0]||=j(`br`,null,null,-1),j(`a`,Wn,t(a(r).baseText(`nodeView.moreInfo`)),1)]))}}),Kn=f({__name:`CanvasChatButton`,props:{label:{},variant:{}},setup(e){return(t,n)=>(w(),m(a(F),{label:e.label,size:`large`,icon:`message-circle`,variant:e.variant,"data-test-id":`workflow-chat-button`},null,8,[`label`,`variant`]))}});function qn(){let e=cn(),t=se(()=>{e.recordActivity()},Mt(_t.COLLABORATION.ACTIVITY)),n=[`mousedown`,`keydown`,`touchstart`],r=()=>{n.forEach(e=>{document.addEventListener(e,t,{passive:!0})})},i=()=>{n.forEach(e=>{document.removeEventListener(e,t)})};return y(()=>e.isCurrentUserWriter,e=>{e?r():i()}),_(()=>{e.isCurrentUserWriter&&r()}),p(()=>{i()}),{recordActivity:t}}var Jn=U(f({name:`NodeView`,__name:`NodeView`,setup(f){let p=d(async()=>await L(()=>import(`./NodeCreation-CbGcb5q0.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),h=d(async()=>await L(()=>import(`./NodeDetailsView--YayFmCn.js`),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,19,43,44,22,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,23,83,84,85,86,87,88,89,90,91,92,93,94,95]))),ee=d(async()=>await L(()=>import(`./NodeDetailsViewV2-CkJpFe7O.js`),__vite__mapDeps([96,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,19,43,44,22,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,23,83,84,85,86,87,88,89,97,90,91,92,93,94,98]))),g=d(async()=>await L(()=>import(`./SetupWorkflowCredentialsButton--TsWCmDa.js`),__vite__mapDeps([99,2,1,3,4,5,6,7,8,9,11,12,13,14,15,16,67,100,38,101]))),b=C(),x=ye(),T=ue(),E=P(),ne=Ae(),re=Ze(),O=Qe(),j=G(),M=Le(),N=He({router:x,onSaved:e=>{Z.emit(`saved:workflow`,{isFirstSave:e})}}),oe=De(),se=Vt({onPaste:Ir}),ce=Ce(),F=Ue(),I=Ge(),de=Ne(),R=Xe(),z=qt(),fe=We(),B=Te(),V=Bt(),he=Ht(),ge=Pe(),H=we(),_e=Ee(),ve=qe(),xe=Me(),U=rn(),Oe=Se(),K=Re(),ze=Je(),Be=tn(),Ke=Jt(),Ye=Yt(),J=cn(),et=wn(),tt=Ut(),nt=Fe();qn();let{addBeforeUnloadEventBindings:rt,removeBeforeUnloadEventBindings:it}=sn({route:T}),{registerCustomAction:at,unregisterCustomAction:ot}=fn(),{runWorkflow:st,runEntireWorkflow:ct,stopCurrentExecution:lt,stopWaitingForWebhook:ut}=nn({router:x}),{updateNodePosition:dt,updateNodesPosition:ft,tidyUp:_t,revertUpdateNodePosition:yt,renameNode:bt,revertRenameNode:St,revertReplaceNodeParameters:At,setNodeActive:Mt,setNodeSelected:Lt,toggleNodesDisabled:zt,revertToggleNodeDisabled:Wt,toggleNodesPinned:Zt,setNodeParameters:Qt,deleteNode:$t,deleteNodes:en,copyNodes:an,cutNodes:un,duplicateNodes:hn,revertDeleteNode:gn,revertAddNode:_n,createConnection:vn,revertCreateConnection:yn,deleteConnection:Sn,revertDeleteConnection:Cn,revalidateNodeInputConnections:En,revalidateNodeOutputConnections:Dn,setNodeActiveByName:On,clearNodeActive:kn,tryToOpenSubworkflowInNewTab:An,importWorkflowData:jn,fetchWorkflowDataFromUrl:Mn,resetWorkspace:Nn,initializeWorkspace:Pn,openExecution:Fn,editableWorkflow:Q,editableWorkflowObject:In,lastClickPosition:Ln,startChat:Rn,addNodesAndConnections:zn,fitView:Un}=Xt(),{extractWorkflow:Wn}=pn();bn({ctrl_alt_o:()=>F.openModal(kt)});let Jn=ie(`canvas`),Yn=o(!0),Xn=o(null),Zn=o(!1),Qn=o(!1),$n=o(!0),er=o(!1),tr=o([]),nr=xn(xt),rr=e(()=>{let e=T.params.nodeId;return Array.isArray(e)?e[0]:e}),ir=e(()=>T.query.new===`true`),ar=e(()=>T.query.hideControls===`true`),or=e(()=>T.name===X.DEMO),sr=e(()=>!!T?.meta?.readOnlyCanvas),cr=e(()=>R.preferences.branchReadOnly),lr=e(()=>!0),$=e(()=>or.value||cr.value||J.shouldBeReadOnly||!(Ci.value.update??wi.value.workflow.update)||Q.value.isArchived||ze.streaming),ur=e(()=>gr.value.length===0),dr=e(()=>!Oe.activeNode&&F.activeModals.length===0),fr=e(()=>Ke.isOpen);function pr(){T.query.action===`addEvaluationTrigger`?z.openNodeCreatorForTriggerNodes(Y.ADD_EVALUATION_TRIGGER_BUTTON):T.query.action===`addEvaluationNode`?z.openNodeCreatorForActions(Tt,Y.ADD_EVALUATION_NODE_BUTTON):T.query.action===`executeEvaluation`&&Zi.value&&ct(`node`,Zi.value.name),Z.off(`saved:workflow`,da),T.name===X.EXECUTION_DEBUG&&Z.on(`saved:workflow`,da),i(()=>{mr()})}function mr(){oe.updateNodesInputIssues(),oe.updateNodesCredentialsIssues(),oe.updateNodesParameterIssues()}async function hr(e){Nn(),ze.streaming?M.setDocumentTitle(e.name,`AI_BUILDING`):M.setDocumentTitle(e.name,`IDLE`),await Pn(e),re.run(`workflow.open`,{workflowId:e.id,workflowName:e.name}),Un()}let gr=e(()=>Q.value.nodes.filter(e=>ce.isTriggerNode(e.type))),_r=e(()=>gr.value.length>0),vr=e(()=>gr.value.filter(e=>e.disabled).length===gr.value.length);function yr(e,t){_t(e,t)}function br(e){Wn(e)}function xr(e){ft(e,{trackHistory:!0})}function Sr(e,t){dt(e,t,{trackHistory:!0})}function Cr({nodeName:e,position:t}){yt(e,{x:t[0],y:t[1]})}function wr(e){let t=tr.value.findIndex(t=>t.id===e);t>=0?tr.value.splice(t,1):$t(e,{trackHistory:!0})}function Tr(e){en(e)}function Er({node:e}){gn(e)}function Dr(e){la()&&zt([e])}function Or({nodeName:e}){Wt(e)}function kr(e){la()&&zt(e)}function Ar(e,t){Ln.value=[t.x,t.y],yi()}function jr(e,t){(t?.metaKey||t?.ctrlKey)&&An(e)||Mt(e,`canvas_default_view`)}function Mr(e){An(e)}function Nr(){kn()}function Pr(e){yi(),Lt(e)}async function Fr(e){await an(e),O.showMessage({title:E.baseText(`generic.copiedToClipboard`),type:`success`})}async function Ir(e){if(ke(T)!==jt.WORKFLOW||!dr.value||!la())return;let t=null;if(e.match(gt)){if(await j.confirm(E.baseText(`nodeView.confirmMessage.onClipboardPasteEvent.message`,{interpolate:{plainTextData:e}}),E.baseText(`nodeView.confirmMessage.onClipboardPasteEvent.headline`),{type:`warning`,confirmButtonText:E.baseText(`nodeView.confirmMessage.onClipboardPasteEvent.confirmButtonText`),cancelButtonText:E.baseText(`nodeView.confirmMessage.onClipboardPasteEvent.cancelButtonText`)})!==`confirm`)return;t=await Mn(e)}else t=mt(e,{fallbackValue:null});if(!t)return;let n=(await jn(t,`paste`,{importTags:!1,viewport:ma.value})).nodes?.map(e=>e.id)??[];Jn.value?.ensureNodesAreVisible(n)}async function Lr(e){$.value?await an(e):await un(e)}async function Rr(e){if(!la())return;let t=await hn(e,{viewport:ma.value});Jn.value?.ensureNodesAreVisible(t)}function zr(e,t){la()&&Zt(e,t)}function Br(e,t){Jn.value?.executeContextMenuAction(e,t)}function Vr(){Z.on(`saved:workflow`,H.showNpsSurveyIfPossible)}function Hr(){Z.off(`saved:workflow`,H.showNpsSurveyIfPossible),Z.off(`saved:workflow`,da)}async function Ur(){await x.push({name:X.NEW_WORKFLOW})}function Wr(e){Oe.activeNode?.name&&bt(Oe.activeNode.name,e)}async function Gr(e){let t=I.getNodeById(e)?.name??``,n=document.activeElement;if(!(n&&Kt(n))&&!(!dr.value||document.querySelector(`.rename-prompt`)))try{let e=j.prompt(E.baseText(`nodeView.prompt.newName`)+`:`,E.baseText(`nodeView.prompt.renameNode`)+`: ${t}`,{customClass:`rename-prompt`,confirmButtonText:E.baseText(`nodeView.prompt.rename`),cancelButtonText:E.baseText(`nodeView.prompt.cancel`),inputErrorMessage:E.baseText(`nodeView.prompt.invalidName`),inputValue:t,inputValidator:e=>e.trim()?!0:E.baseText(`nodeView.prompt.invalidName`)});await i();let n=document.querySelector(`.rename-prompt .el-input__inner`);n?.focus(),n?.select();let r=await e;r.action===`confirm`&&await bt(t,r.value,{trackHistory:!0})}catch{}}async function Kr({currentName:e,newName:t}){await St(e,t)}async function qr({nodeId:e,currentProperties:t,newProperties:n}){await At(e,t,n)}function Jr(e,t){Qt(e,t)}function Yr(e){En(e)}function Xr(e){Dn(e)}function Zr(e,t){z.openNodeCreatorForConnectingNode({connection:{source:e,sourceHandle:t},eventSource:Y.PLUS_ENDPOINT})}async function Qr(){let e;if(nr.value&&!ir.value)e={workflowId:nr.value};else{let t=(typeof T.query?.projectId==`string`?T.query?.projectId:void 0)??_e.personalProject?.id;if(t===void 0)throw Error(`Could not find projectId in the query nor could I find the personal project in the project store`);e={projectId:t}}await fe.fetchAllCredentialsForWorkflow(e)}function $r(e){vn(e,{trackHistory:!0})}function ei({connection:e}){yn(e)}function ti(e,t,n){(n?.target).classList?.contains(`clickable`)||(F.lastInteractedWithNodeId=e.nodeId,F.lastInteractedWithNodeHandle=e.handleId,F.lastCancelledConnectionPosition=[t.x,t.y],setTimeout(()=>{e.nodeId&&z.openNodeCreatorForConnectingNode({connection:{source:e.nodeId,sourceHandle:e.handleId},eventSource:Y.NODE_CONNECTION_DROP})}))}function ni(e){Sn(e,{trackHistory:!0})}function ri({connection:e}){Cn(e)}async function ii({workflow:e}){if(!e.nodes||!e.connections)throw Error(`Invalid workflow object`);Nn(),await Pn({...e,nodes:$e(e.nodes)}),Un()}async function ai(e){let t=e.data,n=typeof e.trackEvents==`boolean`?e.trackEvents:void 0,r=typeof e.setStateDirty==`boolean`?e.setStateDirty:void 0;if(await jn(t,`file`,{viewport:ma.value,regenerateIds:e.regenerateIds===!0||e.regenerateIds===void 0,trackEvents:n,setStateDirty:r}),await i(),Un(),ga(t.nodes?.map(e=>e.id)??[]),e.tidyUp){let t=e.nodesIdsToTidyUp;setTimeout(async()=>{Z.emit(`tidyUp`,{source:`import-workflow-data`,nodeIdsFilter:t,trackEvents:n}),await i(),Un()},0)}}async function oi(e){let t=await Mn(e.url);t&&(await jn(t,`url`,{viewport:ma.value}),Jn.value?.ensureNodesAreVisible(t.nodes?.map(e=>e.id)??[]))}function si(){q.on(`importWorkflowData`,ai),q.on(`importWorkflowUrl`,oi),q.on(`openChat`,Xi)}function ci(){q.off(`importWorkflowData`,ai),q.off(`importWorkflowUrl`,oi),q.off(`openChat`,Xi)}let li=o(void 0);function ui(){li.value=void 0}async function di({nodes:e,connections:t},n=!1,r){if(!la())return;li.value!==void 0&&(F.resetLastInteractedWith(),e=e.map(e=>({...e,openDetail:!1})));let{addedNodes:i}=await zn(e,t,{dragAndDrop:n,position:r,viewport:ma.value,telemetry:!0,replaceNodeId:li.value});if(i.length>0){let e=i[i.length-1].id;ga([e])}}async function fi({node:e}){await _n(e.name)}function pi(e){let t=I.getNodeByName(e);t&&(On(e,`other`),ga([t.id]))}function mi(e,t,n=0){z.openSelectiveNodeCreator({node:e,connectionType:t,connectionIndex:n})}function hi(e){z.setNodeCreatorState(e),e.createNodeActive||(li.value=void 0,e.hasAddedNodes||F.resetLastInteractedWith())}function gi(e){hi({createNodeActive:!0,source:e})}function _i(e){z.openNodeCreatorForTriggerNodes(e)}function vi(){K.toggleFocusPanel(),ne.track(`User ${K.focusPanelActive?`opened`:`closed`} focus panel`,{source:`canvasKeyboardShortcut`,parameters:K.focusedNodeParametersInTelemetryFormat,parameterCount:K.focusedNodeParametersInTelemetryFormat.length})}function yi(){z.isCreateNodeActive&&=!1}function bi(){di({nodes:[{type:Dt}],connections:[]})}function xi(e){let{type:t,mode:n}=Gt(e.sourceHandle);t===Pt.AiTool&&n===Ve.Output?z.openNodeCreatorForConnectingNode({connection:e,eventSource:Y.NODE_CONNECTION_ACTION,nodeCreatorView:pt}):z.openNodeCreatorForConnectingNode({connection:e,eventSource:Y.NODE_CONNECTION_ACTION})}function Si(e){let t=I.getNodeById(e);if(!t)return;let n=ce.getNodeType(t.type);if(n)if(li.value=e,It(n))z.openNodeCreatorForTriggerNodes(Y.REPLACE_NODE_ACTION);else{let e=Ft(In.value,t,n).map(e=>typeof e==`string`?e:e.type),r=Et(In.value,t,n).map(e=>typeof e==`string`?e:e.type);e[0]&&r[0]&&e[0]!==r[0]?z.openNodeCreatorForRegularNodes(Y.REPLACE_NODE_ACTION):z.openSelectiveNodeCreator({connectionType:e[0]??r[0],node:t.name})}}let Ci=e(()=>nr.value?Nt(de.getWorkflowById(nr.value)?.scopes).workflow:{}),wi=e(()=>Nt((T.query?.projectId?_e.myProjects.find(e=>e.id===T.query.projectId):_e.currentProject??_e.personalProject)?.scopes)),Ti=o(!1),Ei=e(()=>I.isWorkflowRunning),Di=e(()=>I.executionWaitingForWebhook),Oi=e(()=>qi.value&&Ji.value&&!Yi.value?!0:!_r.value||vr.value),ki=e(()=>!Ji.value||Yi.value),Ai=e(()=>Ei.value&&!Di.value),ji=e(()=>Ei.value&&Di.value);async function Mi(e){let t=I.getNodeById(e);t&&(on(t)&&ce.isToolNode(t.type)?F.openModalWithData({name:Ot,data:{nodeName:t.name}}):(Ii(t),Be.clearAgentRequests(I.workflowId,t.id),st({destinationNode:{nodeName:t.name,mode:`inclusive`},source:`Node.executeNode`})))}async function Ni(e,t){let n=await I.getWebhookUrl(e,t);n&&(se.copy(n),O.showMessage({title:E.baseText(`nodeWebhooks.showMessage.title`),type:`success`}))}async function Pi(e){let t=I.getNodeById(e);if(wt.includes(t?.type??``)){O.showMessage({title:E.baseText(`nodeWebhooks.showMessage.testWebhookUrl`),type:`warning`});return}Ni(e,`test`)}async function Fi(e){if(!I.workflow.active){O.showMessage({title:E.baseText(`nodeWebhooks.showMessage.not.active`),type:`warning`});return}Ni(e,`production`)}function Ii(e){let t={node_type:e.type,workflow_id:I.workflowId,source:`canvas`,push_ref:Oe.pushRef};ne.track(`User clicked execute node button`,t),re.run(`nodeView.onRunNode`,t)}async function Li(e,t){ge.startLoading(),Nn();let n=await Fn(e,t);n&&(i(()=>{mr()}),ge.stopLoading(),Un(),Z.emit(`open:execution`,n),re.run(`execution.open`,{workflowId:n.workflowData.id,workflowName:n.workflowData.name,executionId:e}),ne.track(`User opened read-only execution`,{workflow_id:n.workflowData.id,execution_mode:n.mode,execution_finished:n.finished}))}function Ri(e){if(!e.finished&&e.data?.resultData?.error){let t=!1;if(e.data.resultData.runData){let n=e.data.resultData.runData;errorCheck:for(let e of Object.keys(n))for(let r of n[e])if(r.error){t=!0;break errorCheck}}!t&&(e.data.resultData.error.stack??e.data.resultData.error.message)&&(console.error(`Execution ${e.id} error:`),console.error(e.data.resultData.error.stack),O.showMessage({title:E.baseText(`nodeView.showError.workflowError`),message:e.data.resultData.error.message,type:`error`,duration:0}))}}function zi(e){e.waitTill&&O.showMessage({title:E.baseText(`nodeView.thisExecutionHasntFinishedYet`),message:l(Gn),type:`warning`,duration:0})}function Bi(){Z.on(`open:execution`,Ri),Z.on(`open:execution`,zi)}function Vi(){Z.off(`open:execution`,Ri),Z.off(`open:execution`,zi)}async function Hi(){Ti.value=!0,await lt(),Ti.value=!1}async function Ui(){await ut()}function Wi(){q.emit(`runWorkflowButton:mouseenter`)}function Gi(){q.emit(`runWorkflowButton:mouseleave`)}let Ki=e(()=>Q.value.nodes.find(e=>e.type===ht)),qi=e(()=>!Di.value&&!!Q.value.nodes.find(e=>[`@n8n/n8n-nodes-langchain.manualChatTrigger`,`@n8n/n8n-nodes-langchain.chatTrigger`].includes(e.type)&&e.disabled!==!0)),Ji=e(()=>gr.value.every(e=>e.disabled||e.type===`@n8n/n8n-nodes-langchain.chatTrigger`)),Yi=e(()=>Ki.value?I.pinDataByNodeName(Ki.value.name):null);function Xi(){Rn(`main`)}let Zi=e(()=>Q.value.nodes.find(e=>e.type===Rt));function Qi(){W.on(`nodeMove`,Cr),W.on(`revertAddNode`,fi),W.on(`revertRemoveNode`,Er),W.on(`revertAddConnection`,ei),W.on(`revertRemoveConnection`,ri),W.on(`revertRenameNode`,Kr),W.on(`revertReplaceNodeParameters`,qr),W.on(`enableNodeToggle`,Or)}function $i(){W.off(`nodeMove`,Cr),W.off(`revertAddNode`,fi),W.off(`revertRemoveNode`,Er),W.off(`revertAddConnection`,ei),W.off(`revertRemoveConnection`,ri),W.off(`revertRenameNode`,Kr),W.off(`revertReplaceNodeParameters`,qr),W.off(`enableNodeToggle`,Or)}async function ea(){try{if(await Promise.all([B.fetchAllVariables(),xe.fetchAll(),Qr(),_e.getAvailableProjects()]),nr.value&&!F.stateIsDirty){let e=await de.fetchWorkflow(nr.value);e&&await hr(e)}}catch(e){console.error(e)}}function ta(){dn.on(`pull`,ea)}function na(){dn.off(`pull`,ea)}function ra(){Z.on(`create:sticky`,bi)}function ia(){Z.off(`create:sticky`,bi)}function aa(){window.addEventListener(`message`,ca)}function oa(){window.removeEventListener(`message`,ca)}function sa(){window.parent&&window.parent.postMessage(JSON.stringify({command:`n8nReady`,version:V.versionCli}),`*`)}async function ca(e){if(!(!e||typeof e.data!=`string`||!e.data?.includes?.(`"command"`)))try{let t=JSON.parse(e.data);if(t&&t.command===`openWorkflow`)try{t.projectId&&await _e.fetchAndSetProject(t.projectId),await ii(t),$n.value=t.canOpenNDV??!0,er.value=t.hideNodeIssues??!1,Qn.value=!1,t.tidyUp===!0&&Z.emit(`tidyUp`,{source:`import-workflow-data`})}catch(e){window.top&&window.top.postMessage(JSON.stringify({command:`error`,message:E.baseText(`openWorkflow.workflowImportError`)}),`*`),O.showError(e,E.baseText(`openWorkflow.workflowImportError`))}else if(t&&t.command===`openExecution`)try{t.projectId&&await _e.fetchAndSetProject(t.projectId),Zn.value=t.executionMode!==`manual`&&t.executionMode!==`evaluation`,await Li(t.executionId,t.nodeId),$n.value=t.canOpenNDV??!0,er.value=t.hideNodeIssues??!1,Qn.value=!0}catch(e){window.top&&window.top.postMessage(JSON.stringify({command:`error`,message:E.baseText(`nodeView.showError.openExecution.title`)}),`*`),O.showMessage({title:E.baseText(`nodeView.showError.openExecution.title`),message:e.message,type:`error`})}else t?.command===`setActiveExecution`&&(he.activeExecution=await he.fetchExecution(t.executionId))}catch{}}function la(){if(!F.nodeViewInitialized)return!0;if(Xn.value?.visible||!(Ci.value.update??wi.value.workflow.update)||J.shouldBeReadOnly)return!1;if(sr.value||cr.value){let e=sr.value?`executions`:`workflows`;return Xn.value=O.showMessage({title:E.baseText(cr.value?`readOnlyEnv.showMessage.${e}.title`:`readOnly.showMessage.executions.title`),message:E.baseText(cr.value?`readOnlyEnv.showMessage.${e}.message`:`readOnly.showMessage.executions.message`),type:`info`}),!1}return!0}function ua(){cr.value&&[X.NEW_WORKFLOW,X.TEMPLATE_IMPORT].find(e=>e===T.name)&&i(async()=>{Nn(),F.markStateClean(),await x.replace({name:X.HOMEPAGE})})}async function da(){T.name===X.EXECUTION_DEBUG&&await x.replace({name:X.WORKFLOW,params:{name:nr.value}})}let fa=o({x:0,y:0,zoom:1}),pa=o({width:0,height:0}),ma=e(()=>je(fa.value,pa.value));function ha(e,t){fa.value=e,pa.value=t,F.nodeViewOffsetPosition=[e.x,e.y]}function ga(e){setTimeout(()=>Z.emit(`nodes:select`,{ids:e}))}function _a(e){Ln.value=[e.x,e.y],Pr()}function va(e){Ln.value=[e.x,e.y]}async function ya(e,t){if(!t.dataTransfer)return;let n=mt(t.dataTransfer.getData(vt));n&&(await di(n,!0,[e.x,e.y]),hi({createNodeActive:!1,hasAddedNodes:!0}))}function ba(){at({key:`openNodeDetail`,action:({node:e})=>{On(e,`other`)}}),at({key:`openSelectiveNodeCreator`,action:({creatorview:e,connectiontype:t,node:n})=>{z.openSelectiveNodeCreator({node:n,connectionType:t,creatorView:e})}}),at({key:`showNodeCreator`,action:()=>{Oe.unsetActiveNodeName(),i(()=>{_i(Y.TAB)})}})}function xa(){ot(`openNodeDetail`),ot(`openSelectiveNodeCreator`),ot(`showNodeCreator`)}function Sa(){F.addFirstStepOnLoad&&=(_i(Y.TRIGGER_PLACEHOLDER_BUTTON),!1)}async function Ca(){let e=et.consumePendingPrompt();e&&(await tt.open({mode:`builder`,showCoachmark:!1}),await ze.sendChatMessage({text:e,initialGeneration:!0,source:`empty-state`}))}function wa(e){let t=I.findNodeByPartialId(e);t?Mt(t.id,`other`):(O.showToast({title:E.baseText(`nodeView.showMessage.ndvUrl.missingNodes.title`),message:E.baseText(`nodeView.showMessage.ndvUrl.missingNodes.content`),type:`warning`}),x.replace({name:T.name,params:{name:nr.value},query:T.query}))}return y([()=>T.name,()=>T.params.name],()=>{pr()}),y(()=>Yn.value||$.value||Q.value.nodes.length!==0,e=>{if(e){tr.value=[];return}let t={id:Ie.AddNodes,name:Ie.AddNodes,type:Ie.AddNodes,typeVersion:1,position:[0,0],parameters:{}},n={id:Ie.ChoicePrompt,name:Ie.ChoicePrompt,type:Ie.ChoicePrompt,typeVersion:1,position:[0,0],parameters:{},draggable:!1};tr.value=ze.isAIBuilderEnabled?[n]:[t]}),y(()=>T.params.nodeId,async e=>{typeof e!=`string`||e===``?Oe.unsetActiveNodeName():wa(e)}),y(()=>Oe.activeNode,async e=>{if(![X.WORKFLOW].includes(String(T.name)))return;let t=e?.id?I.getPartialIdForNode(e?.id):``;t!==T.params.nodeId&&await x.replace({name:T.name,params:{name:nr.value,nodeId:t},query:T.query})}),y(()=>F.dirtyStateSetCount,e=>{if(e>0){if(or.value)return;J.requestWriteAccess(),ze.streaming||N.autoSaveWorkflow()}}),y(()=>ze.streaming,(e,t)=>{t&&!e&&F.stateIsDirty&&!J.shouldBeReadOnly&&N.autoSaveWorkflow()}),pe(async(e,t,n)=>{if(K.focusPanelActive&&K.closeFocusPanel(),cr.value){n();return}let r=ke(e),i=[X.WORKFLOW,X.NEW_WORKFLOW].includes(t.name)&&[X.WORKFLOW,X.NEW_WORKFLOW].includes(e.name)&&t.params.name!==e.params.name;if((r===jt.EXECUTIONS||t.name===X.TEMPLATE_IMPORT||r===jt.WORKFLOW&&t.name===X.EXECUTION_DEBUG)&&!i){n();return}await He({router:x}).promptSaveUnsavedWorkflowChanges(n,{async confirm(){if(t.name===X.NEW_WORKFLOW){let t=I.workflowId;return await x.replace({name:X.WORKFLOW,params:{name:t}}),await x.push(e),!1}return nt.setWorkflowId(``),!0}})}),k(()=>{or.value||U.pushConnect(),aa()}),_(async()=>{ge.startLoading(),M.reset(),J.setRefreshCanvasCallback(async e=>{await Pn(e)});try{pr(),O.showNotificationForViews([X.WORKFLOW,X.NEW_WORKFLOW]),T.query.settings&&(F.openModal(Ct),x.replace({query:{settings:void 0}}))}finally{Yn.value=!1,ge.stopLoading(),re.run(`nodeView.mount`).catch(()=>{}),setTimeout(()=>{rr.value&&wa(rr.value)},500),sa(),Ca()}ve.showPersonalizationSurvey(),ua(),ta(),Vr(),rt(),si(),Bi(),ra(),ba()}),c(()=>{Qi(),Sa()}),te(()=>{F.closeModal(Ct),$i(),O.clearAllStickyNotifications()}),s(()=>{na(),oa(),Hr(),it(),ci(),Vi(),ia(),xa(),Z.off(`saved:workflow`,da),or.value||U.pushDisconnect()}),(e,i)=>(w(),n(`div`,{class:A(a(b).wrapper)},[a(Q)&&a(In)&&!Yn.value?(w(),m(Tn,{key:0,id:a(Q).id,ref:`canvas`,workflow:a(Q),"workflow-object":a(In),"fallback-nodes":tr.value,"show-fallback-nodes":ur.value,"event-bus":a(Z),"read-only":$.value,executing:Ei.value,"key-bindings":dr.value,"suppress-interaction":a(Ye).isMapperOpen,"hide-controls":ar.value,"onUpdate:nodes:position":xr,"onUpdate:node:position":Sr,"onUpdate:node:activated":jr,"onUpdate:node:deactivated":Nr,"onUpdate:node:selected":Pr,"onUpdate:node:enabled":Dr,"onUpdate:node:name":Gr,"onUpdate:node:parameters":Jr,"onUpdate:node:inputs":Yr,"onUpdate:node:outputs":Xr,"onUpdate:logsOpen":i[3]||=e=>a(Ke).toggleOpen(e),"onUpdate:logs:inputOpen":a(Ke).toggleInputOpen,"onUpdate:logs:outputOpen":a(Ke).toggleOutputOpen,"onUpdate:hasRangeSelection":a(ge).setHasRangeSelection,"onOpen:subWorkflow":Mr,"onClick:node":Ar,"onClick:node:add":Zr,"onRun:node":Mi,"onCopy:production:url":Fi,"onCopy:test:url":Pi,"onDelete:node":wr,"onCreate:connection":$r,"onCreate:connection:cancelled":ti,"onDelete:connection":ni,"onClick:connection:add":xi,"onClick:pane":_a,"onCreate:node":gi,"onCreate:sticky":bi,"onDelete:nodes":Tr,"onUpdate:nodes:enabled":kr,"onUpdate:nodes:pin":zr,"onDuplicate:nodes":Rr,"onCopy:nodes":Fr,"onCut:nodes":Lr,"onReplace:node":Si,"onRun:workflow":i[4]||=e=>a(ct)(`main`),"onCreate:workflow":Ur,"onViewport:change":ha,"onSelection:end":va,onDragAndDrop:ya,onTidyUp:yr,"onToggle:focusPanel":vi,onExtractWorkflow:br,onStartChat:i[5]||=e=>a(Rn)()},{default:S(()=>[$.value?r(``,!0):(w(),m(ae,{key:0},{default:S(()=>[u(a(g),{class:A(a(b).setupCredentialsButtonWrapper)},null,8,[`class`])]),_:1})),$.value?r(``,!0):(w(),n(`div`,{key:1,class:A(a(b).executionButtons)},[ki.value?(w(),m(mn,{key:0,"waiting-for-webhook":Di.value,disabled:Oi.value,executing:Ei.value,"trigger-nodes":gr.value,"get-node-type":a(ce).getNodeType,"selected-trigger-node-name":a(I).selectedTriggerNodeName,onMouseenter:Wi,onMouseleave:Gi,onExecute:i[0]||=e=>a(ct)(`main`),onSelectTriggerNode:a(I).setSelectedTriggerNodeName},null,8,[`waiting-for-webhook`,`disabled`,`executing`,`trigger-nodes`,`get-node-type`,`selected-trigger-node-name`,`onSelectTriggerNode`])):r(``,!0),qi.value?(w(),n(v,{key:1},[fr.value?(w(),m(Kn,{key:0,variant:`subtle`,label:a(E).baseText(`chat.hide`),class:A(a(b).chatButton),onClick:i[1]||=e=>a(Ke).toggleOpen(!1)},null,8,[`label`,`class`])):(w(),m(ln,{key:1,label:a(E).baseText(`chat.open`),shortcut:{keys:[`c`]}},{default:S(()=>[u(Kn,{variant:ki.value?`subtle`:`solid`,label:a(E).baseText(`chat.open`),class:A(a(b).chatButton),onClick:Xi},null,8,[`variant`,`label`,`class`])]),_:1},8,[`label`]))],64)):r(``,!0),Ai.value?(w(),m(Vn,{key:2,stopping:Ti.value,onClick:Hi},null,8,[`stopping`])):r(``,!0),ji.value?(w(),m(Hn,{key:3,onClick:Ui})):r(``,!0)],2)),cr.value?(w(),m(a(le),{key:2,theme:`warning`,icon:`lock`,class:A(a(b).readOnlyEnvironmentNotification)},{default:S(()=>[D(t(a(E).baseText(`readOnlyEnv.cantEditOrRun`)),1)]),_:1},8,[`class`])):r(``,!0),a(J).currentWriter&&!a(J).isCurrentUserWriter?(w(),m(a(be),{key:3,"first-name":a(J).currentWriter.user.firstName,"last-name":a(J).currentWriter.user.lastName,class:A(a(b).canvasCenterPill)},null,8,[`first-name`,`last-name`,`class`])):r(``,!0),a(ze).streaming?(w(),m(a(me),{key:4,class:A(a(b).canvasCenterPill),"show-stop":``,onStop:a(ze).abortStreaming},null,8,[`class`,`onStop`])):r(``,!0),(w(),m(ae,null,{default:S(()=>[$.value?r(``,!0):(w(),m(a(p),{key:0,"create-node-active":a(z).isCreateNodeActive,"node-view-scale":fa.value.zoom,"focus-panel-active":a(K).focusPanelActive,onToggleNodeCreator:hi,onAddNodes:di,onClose:ui},null,8,[`create-node-active`,`node-view-scale`,`focus-panel-active`]))]),_:1})),(w(),m(ae,null,{default:S(()=>[lr.value?r(``,!0):(w(),m(a(h),{key:0,"workflow-object":a(In),"read-only":$.value,"is-production-execution-preview":Zn.value,renaming:!1,onValueChanged:i[2]||=e=>Wr(e.value),onStopExecution:Hi,onSwitchSelectedNode:pi,onOpenConnectionNodeCreator:mi},null,8,[`workflow-object`,`read-only`,`is-production-execution-preview`]))]),_:1})),(w(),m(ae,null,{default:S(()=>[lr.value?(w(),m(a(ee),{key:0,"workflow-object":a(In),"read-only":$.value,"is-production-execution-preview":Zn.value,onRenameNode:Wr,onStopExecution:Hi,onSwitchSelectedNode:pi,onOpenConnectionNodeCreator:mi},null,8,[`workflow-object`,`read-only`,`is-production-execution-preview`])):r(``,!0)]),_:1}))]),_:1},8,[`id`,`workflow`,`workflow-object`,`fallback-nodes`,`show-fallback-nodes`,`event-bus`,`read-only`,`executing`,`key-bindings`,`suppress-interaction`,`hide-controls`,`onUpdate:logs:inputOpen`,`onUpdate:logs:outputOpen`,`onUpdate:hasRangeSelection`])):r(``,!0),!Yn.value&&(!a(Ye).isNdvInFocusPanelEnabled||!$.value)?(w(),m(Bn,{key:1,"is-canvas-read-only":$.value,onContextMenuAction:Br},null,8,[`is-canvas-read-only`])):r(``,!0)],2))}}),[[`__cssModules`,{$style:{wrapper:`_wrapper_1uyi2_125`,executionButtons:`_executionButtons_1uyi2_130`,chatButton:`_chatButton_1uyi2_148`,setupCredentialsButtonWrapper:`_setupCredentialsButtonWrapper_1uyi2_152`,readOnlyEnvironmentNotification:`_readOnlyEnvironmentNotification_1uyi2_158`,canvasCenterPill:`_canvasCenterPill_1uyi2_165`}}]]);export{Jn as default};
//# sourceMappingURL=NodeView-7vrQTv7_.js.map