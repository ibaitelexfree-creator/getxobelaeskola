(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`12a94b71-d8f1-4112-abf5-d4816922a088`,e._sentryDebugIdIdentifier=`sentry-dbid-12a94b71-d8f1-4112-abf5-d4816922a088`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{Cn as t,D as n,E as r,Gt as i,It as a,M as o,P as s,T as c,Z as l,_ as u,bt as d,et as f,it as p,j as m,vn as h,w as g}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as _,yt as v}from"./_MapCache-DjbOQyB7.js";import{Hi as y,Pi as b,Tt as x,Vi as S,bt as C,gi as w,zi as T}from"./src-CppJvwzX.js";import{t as E}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as ee,Ta as D,Tr as O,fn as k,lr as A,r as j,ws as M,yr as te}from"./users.store-pCkD7Zo0.js";import{n as ne,t as re}from"./col-D8aZ4Gpw.js";import{Ss as ie,h as ae,oo as N}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{N as P,r as F}from"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as I}from"./usePageRedirectionHelper-BoF8hzbN.js";import{t as L}from"./apiKeys.store-n_GNjqP1.js";var R=E(s({__name:`ApiKeyCard`,props:{apiKey:{}},emits:[`edit`,`delete`],setup(e,{emit:s}){let l={EDIT:`edit`,DELETE:`delete`},u=[{label:`Edit`,value:l.EDIT},{label:`Delete`,value:l.DELETE}],p=v(),_=a(null),y=e,b=s;async function w(e){e===l.EDIT?b(`edit`,y.apiKey.id):e===l.DELETE&&b(`delete`,y.apiKey.id)}let T=e=>e.expiresAt?e.expiresAt<=Date.now()/1e3:!1,E=e=>{if(!e.expiresAt)return p.baseText(`settings.api.neverExpires`);if(T(e))return p.baseText(`settings.api.expired`);let t=N.fromSeconds(e.expiresAt).toFormat(`ccc, MMM d yyyy`);return p.baseText(`settings.api.expirationTime`,{interpolate:{time:t}})};return(a,s)=>(f(),c(i(C),{class:h(a.$style.cardLink),"data-test-id":`api-key-card`,onClick:s[0]||=e=>w(`edit`)},{header:d(()=>[g(`div`,null,[o(i(S),{tag:`h2`,bold:``,class:h(a.$style.cardHeading)},{default:d(()=>[m(t(e.apiKey.label),1)]),_:1},8,[`class`]),g(`div`,{class:h([a.$style.cardDescription])},[o(i(S),{color:T(e.apiKey)?`warning`:`text-light`,size:`small`},{default:d(()=>[g(`span`,null,t(E(e.apiKey)),1)]),_:1},8,[`color`])],2)]),e.apiKey.apiKey.includes(`*`)?(f(),n(`div`,{key:0,class:h(a.$style.cardApiKey)},[o(i(S),{color:`text-light`,size:`small`},{default:d(()=>[m(t(e.apiKey.apiKey),1)]),_:1})],2)):r(``,!0)]),append:d(()=>[g(`div`,{ref_key:`cardActions`,ref:_,class:h(a.$style.cardActions)},[o(i(x),{actions:u,theme:`dark`,onAction:w})],2)]),_:1},8,[`class`]))}}),[[`__cssModules`,{$style:{cardLink:`_cardLink_ec33a_125`,cardHeading:`_cardHeading_ec33a_135`,cardDescription:`_cardDescription_ec33a_142`,cardActions:`_cardActions_ec33a_149`,cardApiKey:`_cardApiKey_ec33a_158`}}]]),z=[`textContent`],B=[`textContent`],V={class:`mt-m text-right`},H=E(s({__name:`SettingsApiView`,setup(e){let s=M(),x=j(),C=A(),{showError:E,showMessage:ie}=te(),{confirm:N}=O(),H=k(),U=v(),{goToUpgrade:W}=I(),G=ee(),K=a(!1),q=L(),{getAndCacheApiKeys:oe,deleteApiKey:se,getApiKeyAvailableScopes:ce}=q,{apiKeysSortByCreationDate:J}=P(q),{isSwaggerUIEnabled:Y,publicApiPath:le,publicApiLatestVersion:X}=s,{baseUrl:ue}=F(),{isPublicApiEnabled:Z}=s,Q=a(``),$=async()=>{G.track(`User clicked create API key button`),x.openModalWithData({name:D,data:{mode:`new`}})};l(async()=>{H.set(U.baseText(`settings.api`)),Q.value=Y?`${ue}${le}/v${X}/docs`:`https://${ae}/api/api-reference/`,Z&&await fe()});function de(){W(`settings-n8n-api`,`upgrade-api`,`redirect`)}async function fe(){try{K.value=!0,await Promise.all([oe(),ce()])}catch(e){E(e,U.baseText(`settings.api.view.error`))}finally{K.value=!1}}async function pe(e){if(await N(U.baseText(`settings.api.delete.description`),U.baseText(`settings.api.delete.title`),{confirmButtonText:U.baseText(`settings.api.delete.button`),cancelButtonText:U.baseText(`generic.cancel`)})===`confirm`)try{await se(e),ie({title:U.baseText(`settings.api.delete.toast`),type:`success`})}catch(e){E(e,U.baseText(`settings.api.delete.error`))}finally{G.track(`User clicked delete API key button`)}}function me(e){x.openModalWithData({name:D,data:{mode:`edit`,activeId:e}})}return(e,a)=>(f(),n(`div`,{class:h(e.$style.container)},[g(`div`,{class:h(e.$style.header)},[o(i(T),{size:`2xlarge`},{default:d(()=>[m(t(i(U).baseText(`settings.api`)),1)]),_:1})],2),i(Z)&&i(J).length?(f(),n(`p`,{key:0,class:h(e.$style.topHint)},[o(i(S),null,{default:d(()=>[o(i(_),{keypath:`settings.api.view.info`,tag:`span`,scope:`global`},{apiAction:d(()=>[g(`a`,{"data-test-id":`api-docs-link`,href:`https://docs.n8n.io/api`,target:`_blank`,textContent:t(i(U).baseText(`settings.api.view.info.api`))},null,8,z)]),webhookAction:d(()=>[g(`a`,{"data-test-id":`webhook-docs-link`,href:`https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook/`,target:`_blank`,textContent:t(i(U).baseText(`settings.api.view.info.webhook`))},null,8,B)]),_:1})]),_:1})],2)):r(``,!0),g(`div`,{class:h(e.$style.apiKeysContainer)},[i(J).length?(f(!0),n(u,{key:0},p(i(J),(t,n)=>(f(),c(i(ne),{key:t.id,gutter:10,class:h([{[e.$style.destinationItem]:n!==i(J).length-1}])},{default:d(()=>[o(i(re),null,{default:d(()=>[o(R,{"api-key":t,onDelete:pe,onEdit:me},null,8,[`api-key`])]),_:2},1024)]),_:2},1032,[`class`]))),128)):r(``,!0)],2),i(Z)&&i(J).length?(f(),n(`div`,{key:1,class:h(e.$style.BottomHint)},[o(i(S),{size:`small`,color:`text-light`},{default:d(()=>[m(t(i(U).baseText(`settings.api.view.${i(s).isSwaggerUIEnabled?`tryapi`:`more-details`}`)),1)]),_:1}),a[0]||=m(` `+t(` `)+` `,-1),i(Y)?(f(),c(i(w),{key:0,"data-test-id":`api-playground-link`,to:Q.value,"new-window":!0,size:`small`},{default:d(()=>[m(t(i(U).baseText(`settings.api.view.apiPlayground`)),1)]),_:1},8,[`to`])):(f(),c(i(w),{key:1,"data-test-id":`api-endpoint-docs-link`,to:Q.value,"new-window":!0,size:`small`},{default:d(()=>[m(t(i(U).baseText(`settings.api.view.external-docs`)),1)]),_:1},8,[`to`]))],2)):r(``,!0),g(`div`,V,[i(Z)&&i(J).length?(f(),c(i(y),{key:0,size:`large`,onClick:$},{default:d(()=>[m(t(i(U).baseText(`settings.api.create.button`)),1)]),_:1})):r(``,!0)]),!i(Z)&&i(C).userIsTrialing?(f(),c(i(b),{key:2,"data-test-id":`public-api-upgrade-cta`,heading:i(U).baseText(`settings.api.trial.upgradePlan.title`),description:i(U).baseText(`settings.api.trial.upgradePlan.description`),"button-text":i(U).baseText(`settings.api.trial.upgradePlan.cta`),"onClick:button":de},null,8,[`heading`,`description`,`button-text`])):r(``,!0),i(Z)&&!i(J).length?(f(),c(i(b),{key:3,"button-text":i(U).baseText(K.value?`settings.api.create.button.loading`:`settings.api.create.button`),description:i(U).baseText(`settings.api.create.description`),"onClick:button":$},null,8,[`button-text`,`description`])):r(``,!0)],2))}}),[[`__cssModules`,{$style:{header:`_header_g9f1h_125`,card:`_card_g9f1h_135`,destinationItem:`_destinationItem_g9f1h_139`,delete:`_delete_g9f1h_143`,topHint:`_topHint_g9f1h_150`,BottomHint:`_BottomHint_g9f1h_161`,apiKeysContainer:`_apiKeysContainer_g9f1h_166`}}]]);export{H as default};
//# sourceMappingURL=SettingsApiView-phzGmfxB.js.map