(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`999bb7fc-7334-44ee-a7d2-1a83309589e0`,e._sentryDebugIdIdentifier=`sentry-dbid-999bb7fc-7334-44ee-a7d2-1a83309589e0`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,J as s,M as c,P as l,T as u,Z as d,_ as f,_t as p,at as m,bt as h,c as g,et as _,h as v,it as y,j as b,mt as x,ot as S,q as C,vn as w,w as T}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as E,j as D,yt as O}from"./_MapCache-DjbOQyB7.js";import{Ci as k,Hi as A,Lt as j,Mi as M,Mt as ee,Oi as N,Rt as P,Ui as F,Vi as I,dt as te,gi as L,st as R,zt as z}from"./src-CppJvwzX.js";import{t as B}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import"./date-picker-CHH0vNVG.js";import{Lt as V,Rr as H,Tr as ne,fn as U,g as W,s as G,ws as re,xr as K,yr as ie}from"./users.store-pCkD7Zo0.js";import{Mo as q,Ss as ae,Yc as oe,qo as se,rs as ce}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{N as J}from"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as le}from"./usePageRedirectionHelper-BoF8hzbN.js";import{t as ue}from"./executions.store-DnLtKXBA.js";import"./folders.store-CS_gIPIm.js";import"./ProjectIcon-D-HRIqn6.js";import{t as Y}from"./dateFormatter-C82w-7IH.js";import{t as de}from"./useExecutionHelpers-mcaelfkG.js";import"./TagsDropdown-B5U3GUsU.js";import"./WorkflowTagsDropdown-Bab-8Jcr.js";import{t as fe}from"./insights.store-CIIvho7C.js";import"./insights.constants-DHL43iRt.js";import"./insights.utils-B2NpOI0Q.js";import{r as pe}from"./readyToRun.store-DM7AW4os.js";import{t as X}from"./AnimatedSpinner-BEM3aFx0.js";import{t as Z}from"./ProjectHeader-KFxxuu0P.js";import{t as me}from"./InsightsSummary-8qyRMqyz.js";import{t as he}from"./SelectedItemsInfo-BMlgQAdy.js";import"./AnnotationTagsDropdown.ee-Cj5VoFhA.js";import{i as ge,n as _e,r as ve,t as ye}from"./ExecutionsTime-BalErGV0.js";var be=B(l({__name:`GlobalExecutionsListItemQueuedTooltip`,props:{status:{},concurrencyCap:{},isCloudDeployment:{type:Boolean}},emits:[`goToUpgrade`],setup(e,{emit:t}){let r=e,o=t,s=O();return(e,t)=>(_(),u(a(N),{placement:`top`},{content:h(()=>[r.status===`waiting`?(_(),u(a(E),{key:0,keypath:`executionsList.statusTooltipText.theWorkflowIsWaitingIndefinitely`,scope:`global`})):i(``,!0),r.status===`new`?(_(),u(a(E),{key:1,keypath:`executionsList.statusTooltipText.waitingForConcurrencyCapacity`,scope:`global`},{instance:h(()=>[r.isCloudDeployment?(_(),u(a(E),{key:0,keypath:`executionsList.statusTooltipText.waitingForConcurrencyCapacity.cloud`,scope:`global`},{concurrencyCap:h(()=>[b(n(r.concurrencyCap),1)]),link:h(()=>[c(a(L),{bold:``,size:`small`,class:w(e.$style.link),onClick:t[0]||=e=>o(`goToUpgrade`)},{default:h(()=>[b(n(a(s).baseText(`generic.upgradeNow`)),1)]),_:1},8,[`class`])]),_:1})):(_(),u(a(E),{key:1,keypath:`executionsList.statusTooltipText.waitingForConcurrencyCapacity.self`,scope:`global`},{concurrencyCap:h(()=>[b(n(r.concurrencyCap),1)]),link:h(()=>[c(a(L),{class:w(e.$style.link),href:a(s).baseText(`executions.concurrency.docsLink`),target:`_blank`},{default:h(()=>[b(n(a(s).baseText(`generic.viewDocs`)),1)]),_:1},8,[`class`,`href`])]),_:1}))]),_:1})):i(``,!0)]),default:h(()=>[m(e.$slots,`default`)]),_:3}))}}),[[`__cssModules`,{$style:{link:`_link_1g7mx_125`}}]]),Q={"data-test-id":`execution-status`},xe={"data-test-id":`execution-time`},Se={key:0},Ce={key:1},$={key:2},we=B(l({__name:`GlobalExecutionsListItem`,props:{execution:{},selected:{type:Boolean,default:!1},workflowName:{default:``},workflowPermissions:{},concurrencyCap:{},isCloudDeployment:{type:Boolean}},emits:[`stop`,`select`,`retrySaved`,`retryOriginal`,`delete`,`goToUpgrade`],setup(e,{emit:s}){let l=s,d=e,p=g(),m=O(),y=de(),x=o(!1),C=t(()=>d.execution.status===`running`),E=t(()=>d.execution.waitTill?new Date(d.execution.waitTill).getTime()===q.getTime():!1),D=t(()=>y.isExecutionRetriable(d.execution)),k={CRASHED:`crashed`,ERROR:`error`,WAITING:`waiting`,SUCCESS:`success`,NEW:`new`,RUNNING:`running`,UNKNOWN:`unknown`,CANCELED:`canceled`},ee={[k.CRASHED]:{icon:`status-error`,color:`danger`},[k.ERROR]:{icon:`status-error`,color:`danger`},[k.WAITING]:{icon:`status-waiting`,color:`secondary`},[k.SUCCESS]:{icon:`status-completed`,color:`success`},[k.NEW]:{icon:`status-new`,color:`foreground-xdark`},[k.RUNNING]:{icon:`spinner`,color:`secondary`},[k.UNKNOWN]:{icon:`status-unknown`,color:`foreground-xdark`},[k.CANCELED]:{icon:`status-canceled`,color:`foreground-xdark`}},te=[k.ERROR,k.CRASHED],L=t(()=>({[p.dangerBg]:te.includes(d.execution.status)})),B=t(()=>d.execution.startedAt?W(d.execution.startedAt):m.baseText(`executionsList.startingSoon`)),V=t(()=>d.execution.waitTill?W(d.execution.waitTill):``),H=t(()=>d.execution.stoppedAt?m.displayTimer(new Date(d.execution.stoppedAt).getTime()-new Date(d.execution.startedAt??d.execution.createdAt).getTime(),!0):``);function ne(e){return e===k.CRASHED?m.baseText(`executionsList.error`):m.baseText(`executionsList.${e}`)}let U=t(()=>({...ee[d.execution.status],label:ne(d.execution.status)}));function W(e){let{date:t,time:n}=Y(e);return m.baseText(`executionsList.started`,{interpolate:{time:n,date:t}})}function G(){x.value=!0,l(`stop`,d.execution)}function re(){l(`select`,d.execution)}async function K(e){l(e,d.execution)}return(t,o)=>{let s=S(`RouterLink`);return _(),r(`tr`,{class:w(L.value)},[T(`td`,null,[c(a(R),{"model-value":e.selected,"data-test-id":`select-execution-checkbox`,disabled:!(e.execution.id&&e.execution.stoppedAt),class:`mb-0`,style:{marginTop:`-3px`},"onUpdate:modelValue":re},null,8,[`model-value`,`disabled`])]),T(`td`,null,[c(a(N),{content:e.execution.workflowName||e.workflowName,placement:`top`},{default:h(()=>[c(s,{to:{name:a(ce).EXECUTION_PREVIEW,params:{name:e.execution.workflowId,executionId:e.execution.id}},class:w(t.$style.workflowName),target:`_blank`},{default:h(()=>[b(n(e.execution.workflowName||e.workflowName),1)]),_:1},8,[`to`,`class`])]),_:1},8,[`content`])]),T(`td`,Q,[E.value||e.execution.status===k.NEW?(_(),u(be,{key:0,status:d.execution.status,"concurrency-cap":d.concurrencyCap,"is-cloud-deployment":d.isCloudDeployment,onGoToUpgrade:o[0]||=e=>l(`goToUpgrade`)},{default:h(()=>[T(`div`,null,[c(a(F),{icon:U.value.icon,color:U.value.color,class:`mr-2xs`},null,8,[`icon`,`color`]),b(` `+n(U.value.label),1)])]),_:1},8,[`status`,`concurrency-cap`,`is-cloud-deployment`])):(_(),u(a(N),{key:1,disabled:e.execution.status!==k.WAITING,content:a(m).baseText(`executionsList.statusWaiting`,{interpolate:{status:e.execution.status,time:V.value}})},{default:h(()=>[T(`div`,null,[e.execution.status===k.RUNNING?(_(),u(a(I),{key:0,color:`secondary`,class:`mr-2xs`},{default:h(()=>[c(X)]),_:1})):(_(),u(a(F),{key:1,size:`medium`,icon:U.value.icon,color:U.value.color,class:`mr-2xs`},null,8,[`icon`,`color`])),b(` `+n(U.value.label),1)])]),_:1},8,[`disabled`,`content`]))]),T(`td`,null,n(B.value),1),T(`td`,xe,[H.value?(_(),r(f,{key:0},[b(n(H.value),1)],64)):(_(),u(ye,{key:1,"start-time":e.execution.startedAt??e.execution.createdAt},null,8,[`start-time`]))]),T(`td`,null,[e.execution.id?(_(),r(`span`,Se,n(e.execution.id),1)):i(``,!0),e.execution.retryOf?(_(),r(`span`,Ce,[o[1]||=T(`br`,null,null,-1),T(`small`,null,` (`+n(a(m).baseText(`executionsList.retryOf`))+` `+n(e.execution.retryOf)+`) `,1)])):e.execution.retrySuccessId?(_(),r(`span`,$,[o[2]||=T(`br`,null,null,-1),T(`small`,null,` (`+n(a(m).baseText(`executionsList.successRetry`))+` `+n(e.execution.retrySuccessId)+`) `,1)])):i(``,!0)]),T(`td`,null,[e.execution.mode===`manual`?(_(),u(a(N),{key:0,content:`Manual Execution`,placement:`top`},{default:h(()=>[c(a(F),{icon:`flask-conical`})]),_:1})):e.execution.mode===`chat`?(_(),u(a(N),{key:1,content:`Chat Execution`,placement:`top`},{default:h(()=>[c(a(F),{icon:`messages-square`})]),_:1})):i(``,!0)]),T(`td`,null,[!e.execution.stoppedAt||e.execution.waitTill?(_(),u(a(A),{key:0,variant:`ghost`,"data-test-id":`stop-execution-button`,loading:x.value,disabled:x.value,onClick:v(G,[`stop`])},{default:h(()=>[b(n(a(m).baseText(`executionsList.stop`)),1)]),_:1},8,[`loading`,`disabled`])):i(``,!0)]),T(`td`,null,[C.value?i(``,!0):(_(),u(a(j),{key:0,trigger:`click`,onCommand:K},{dropdown:h(()=>[c(a(z),{class:w({[t.$style.actions]:!0,[t.$style.deleteOnly]:!D.value})},{default:h(()=>[D.value?(_(),u(a(P),{key:0,"data-test-id":`execution-retry-saved-dropdown-item`,class:w(t.$style.retryAction),command:`retrySaved`,disabled:!e.workflowPermissions.execute},{default:h(()=>[b(n(a(m).baseText(`executionsList.retryWithCurrentlySavedWorkflow`)),1)]),_:1},8,[`class`,`disabled`])):i(``,!0),D.value?(_(),u(a(P),{key:1,"data-test-id":`execution-retry-original-dropdown-item`,class:w(t.$style.retryAction),command:`retryOriginal`,disabled:!e.workflowPermissions.execute},{default:h(()=>[b(n(a(m).baseText(`executionsList.retryWithOriginalWorkflow`)),1)]),_:1},8,[`class`,`disabled`])):i(``,!0),c(a(P),{"data-test-id":`execution-delete-dropdown-item`,class:w(t.$style.deleteAction),command:`delete`,disabled:!e.workflowPermissions.update},{default:h(()=>[b(n(a(m).baseText(`generic.delete`)),1)]),_:1},8,[`class`,`disabled`])]),_:1},8,[`class`])]),default:h(()=>[c(a(M),{variant:`subtle`,icon:`ellipsis-vertical`})]),_:1}))])],2)}}}),[[`__cssModules`,{$style:{dangerBg:`_dangerBg_11wla_125`,workflowName:`_workflowName_11wla_129`}}]]),Te={key:0},Ee={style:{width:`50px`}},De={colspan:`8`},Oe={style:{width:`50px`}},ke={colspan:`9`,style:{"text-align":`center`}},Ae={key:0,"data-test-id":`execution-list-empty`},je=B(l({__name:`GlobalExecutionsList`,props:{executions:{},filters:{},total:{default:0},concurrentTotal:{default:0},estimated:{type:Boolean,default:!1}},emits:[`update:filters`,`execution:stop`],setup(e,{emit:s}){let l=e,d=s,g=O(),v=V(),S=G(),C=H(),E=ue(),k=re(),j=le(),M=o(!1),N=o(!1),P=o({}),F=ne(),I=ie(),L=t(()=>N.value?l.total:Object.keys(P.value).length),z=t(()=>[{id:`all`,name:g.baseText(`executionsList.allWorkflows`)},...C.allWorkflows]),B=t(()=>k.isEnterpriseFeatureEnabled[oe.AdvancedExecutionFilters]),U=t(()=>k.isConcurrencyEnabled&&!k.isQueueModeEnabled);p(()=>l.executions,()=>{l.executions.length===0&&J(),me()});function K(){N.value=!N.value,M.value=!N.value,q()}function q(){M.value=!M.value,M.value?Z():(N.value=!1,P.value={})}function ae(e){let t=e.id;if(P.value[t]){let{[t]:e,...n}=P.value;P.value=n}else P.value={...P.value,[t]:!0};M.value=Object.keys(P.value).length===l.executions.length,N.value=Object.keys(P.value).length===l.total}async function ce(){let e=[B.value&&g.baseText(`executionsList.confirmMessage.annotationsNote`),g.baseText(`executionsList.confirmMessage.message`,{interpolate:{count:L.value.toString()}})].filter(Boolean).join(` `);if(await F.confirm(e,g.baseText(`executionsList.confirmMessage.headline`),{type:`warning`,confirmButtonText:g.baseText(`executionsList.confirmMessage.confirmButtonText`),cancelButtonText:g.baseText(`executionsList.confirmMessage.cancelButtonText`)})===`confirm`){try{await E.deleteExecutions({filters:E.executionsFilters,...N.value?{deleteBefore:new Date}:{ids:Object.keys(P.value)}})}catch(e){I.showError(e,g.baseText(`executionsList.showError.handleDeleteSelected.title`));return}I.showMessage({title:g.baseText(`executionsList.showMessage.handleDeleteSelected.title`),type:`success`}),J()}}function J(){M.value=!1,N.value=!1,P.value={}}async function Y(e){d(`update:filters`,e),J()}function de(e){return pe(e.workflowId??``)??g.baseText(`executionsList.unsavedWorkflow`)}function fe(e){return se(e.scopes).workflow}function pe(e){return z.value.find(t=>t.id===e)?.name}D(x(`loadMoreButton`),([e])=>{e?.isIntersecting&&X()});async function X(){if(E.filters.status===`running`)return;let e=l.executions.at(-1);try{await E.fetchExecutions(E.executionsFilters,e?.id)}catch(e){I.showError(e,g.baseText(`executionsList.showError.loadMore.title`))}}function Z(){l.executions.forEach(e=>{P.value[e.id]=!0})}function me(){N.value&&(M.value=!0,Z())}async function ye(e){await Q(e,!0)}async function be(e){await Q(e,!1)}async function Q(e,t){try{let n=W((await E.retryExecution(e.id,t)).status);n&&I.showMessage(n)}catch(e){I.showError(e,g.baseText(`executionsList.showError.retryExecution.title`))}v.track(`User clicked retry execution button`,{workflow_id:S.workflowId,execution_id:e.id,retry_type:t?`current`:`original`})}async function xe(e){try{await E.stopCurrentExecution(e.id),I.showMessage({title:g.baseText(`executionsList.showMessage.stopExecution.title`),message:g.baseText(`executionsList.showMessage.stopExecution.message`,{interpolate:{activeExecutionId:e.id}}),type:`success`}),d(`execution:stop`)}catch(e){I.showError(e,g.baseText(`executionsList.showError.stopExecution.title`))}}async function Se(e){if(!(e.annotation&&(e.annotation.vote||e.annotation.tags.length>0)&&await F.confirm(g.baseText(`executionsList.confirmMessage.annotatedExecutionMessage`),g.baseText(`executionDetails.confirmMessage.headline`),{type:`warning`,confirmButtonText:g.baseText(`executionDetails.confirmMessage.confirmButtonText`),cancelButtonText:``})!==`confirm`))try{if(await E.deleteExecutions({ids:[e.id]}),M.value){let{[e.id]:t,...n}=P.value;P.value=n}}catch(e){I.showError(e,g.baseText(`executionsList.showError.handleDeleteSelected.title`))}}async function Ce(e){e?await E.startAutoRefreshInterval():E.stopAutoRefreshInterval()}let $=()=>{j.goToUpgrade(`concurrency`,`upgrade-concurrency`)};return(t,o)=>(_(),r(`div`,{class:w(t.$style.execListWrapper)},[m(t.$slots,`default`),T(`div`,{class:w(t.$style.execListHeaderControls)},[U.value?(_(),u(ge,{key:0,"running-executions-count":e.concurrentTotal,"concurrency-cap":a(k).concurrency,"is-cloud-deployment":a(k).isCloudDeployment,onGoToUpgrade:$},null,8,[`running-executions-count`,`concurrency-cap`,`is-cloud-deployment`])):(_(),u(a(R),{key:1,modelValue:a(E).autoRefresh,"onUpdate:modelValue":[o[0]||=e=>a(E).autoRefresh=e,Ce],"data-test-id":`execution-auto-refresh-checkbox`,label:a(g).baseText(`executionsList.autoRefresh`)},null,8,[`modelValue`,`label`])),T(`div`,{class:w(t.$style.execHeaderRight)},[c(_e,{executions:l.executions},null,8,[`executions`]),c(ve,{workflows:z.value,class:`execFilter`,onFilterChanged:Y},null,8,[`workflows`])],2)],2),T(`div`,{class:w(t.$style.execList)},[T(`div`,{class:w(t.$style.execTable)},[c(a(te),null,{default:h(()=>[T(`thead`,null,[M.value&&e.total>0?(_(),r(`tr`,Te,[T(`th`,Ee,[c(a(R),{"model-value":N.value,"data-test-id":`select-all-executions-checkbox`,class:`mb-0`,"onUpdate:modelValue":K},null,8,[`model-value`])]),T(`th`,De,n(a(g).baseText(`executionsList.selectAll`,{adjustToNumber:e.total,interpolate:{count:`${e.total}`}})),1)])):i(``,!0),T(`tr`,null,[T(`th`,Oe,[c(a(R),{"model-value":M.value,disabled:e.total<1,"data-test-id":`select-visible-executions-checkbox`,class:`mb-0`,"onUpdate:modelValue":q},null,8,[`model-value`,`disabled`])]),T(`th`,null,n(a(g).baseText(`generic.workflow`)),1),T(`th`,null,n(a(g).baseText(`executionsList.status`)),1),T(`th`,null,n(a(g).baseText(`executionsList.startedAt`)),1),T(`th`,null,n(a(g).baseText(`executionsList.runTime`)),1),T(`th`,null,n(a(g).baseText(`executionsList.id`)),1),o[2]||=T(`th`,null,null,-1),o[3]||=T(`th`,{style:{width:`69px`}},null,-1),o[4]||=T(`th`,{style:{width:`50px`}},null,-1)])]),T(`tbody`,null,[(_(!0),r(f,null,y(e.executions,e=>(_(),u(we,{key:e.id,execution:e,"workflow-name":de(e),"workflow-permissions":fe(e),selected:P.value[e.id]||N.value,"concurrency-cap":a(k).concurrency,"is-cloud-deployment":a(k).isCloudDeployment,"data-test-id":`global-execution-list-item`,onStop:xe,onDelete:Se,onSelect:ae,onRetrySaved:ye,onRetryOriginal:be,onGoToUpgrade:$},null,8,[`execution`,`workflow-name`,`workflow-permissions`,`selected`,`concurrency-cap`,`is-cloud-deployment`]))),128)),a(E).loading&&!e.executions.length?(_(!0),r(f,{key:0},y(a(E).itemsPerPage,e=>(_(),r(`tr`,{key:e},[(_(),r(f,null,y(9,e=>T(`td`,{key:e},[c(a(ee))])),64))]))),128)):i(``,!0),T(`tr`,null,[T(`td`,ke,[e.executions.length?e.total>e.executions.length||e.estimated?(_(),u(a(A),{key:1,ref:`loadMoreButton`,icon:`refresh-cw`,title:a(g).baseText(`executionsList.loadMore`),label:a(g).baseText(`executionsList.loadMore`),loading:a(E).loading,"data-test-id":`load-more-button`,onClick:o[1]||=e=>X()},null,8,[`title`,`label`,`loading`])):(_(),r(f,{key:2},[b(n(a(g).baseText(`executionsList.loadedAll`)),1)],64)):(_(),r(`span`,Ae,n(a(g).baseText(`executionsList.empty`)),1))])])])]),_:1})],2)],2),c(he,{"selected-count":L.value,onDeleteSelected:ce,onClearSelection:J},null,8,[`selected-count`])],2))}}),[[`__cssModules`,{$style:{execListWrapper:`_execListWrapper_5gyes_125`,execList:`_execList_5gyes_125`,execListHeaderControls:`_execListHeaderControls_5gyes_140`,execTable:`_execTable_5gyes_147`,execHeaderRight:`_execHeaderRight_5gyes_152`}}]]),Me=l({__name:`ExecutionsView`,setup(e){let t=k(),n=O(),r=V(),o=K(),l=G(),f=H(),p=ue(),m=fe(),g=U(),v=ie(),y=pe(),{executionsCount:b,executionsCountEstimated:x,concurrentExecutionsCount:S,filters:w,allExecutions:T}=J(p);C(async()=>{await E(),o.run(`executionsList.openDialog`),r.track(`User opened Executions log`,{workflow_id:l.workflowId})}),d(async()=>{g.set(n.baseText(`executionsList.workflowExecutions`)),document.addEventListener(`visibilitychange`,D),await p.initialize()}),s(()=>{p.reset(),document.removeEventListener(`visibilitychange`,D)});async function E(){try{await f.fetchAllWorkflows(t.params?.projectId)}catch(e){v.showError(e,n.baseText(`executionsList.showError.loadWorkflows.title`))}}function D(){document.visibilityState===`hidden`?p.stopAutoRefreshInterval():p.startAutoRefreshInterval()}async function A(){try{await p.fetchExecutions()}catch(e){v.showError(e,n.baseText(`executionsList.showError.refreshData.title`))}}async function j(e){p.reset(),p.setFilters(e),await p.initialize()}async function M(){await A()}return(e,t)=>(_(),u(je,{executions:a(T),filters:a(w),total:a(b),"estimated-total":a(x),"concurrent-total":a(S),"onExecution:stop":M,"onUpdate:filters":j},{default:h(()=>[c(Z,null,{default:h(()=>[a(y).isOverviewSubPage&&a(m).isSummaryEnabled?(_(),u(me,{key:0,loading:a(m).weeklySummary.isLoading,summary:a(m).weeklySummary.state,"time-range":`week`},null,8,[`loading`,`summary`])):i(``,!0)]),_:1})]),_:1},8,[`executions`,`filters`,`total`,`estimated-total`,`concurrent-total`]))}});export{Me as default};
//# sourceMappingURL=ExecutionsView-DxIg-WI2.js.map