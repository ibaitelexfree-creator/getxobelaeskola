(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`62b0f4dc-4661-415c-9283-d379412ea91f`,e._sentryDebugIdIdentifier=`sentry-dbid-62b0f4dc-4661-415c-9283-d379412ea91f`)})()}catch{}import{C as e,Cn as t,D as n,E as r,Gt as i,It as a,M as o,P as s,T as c,_ as l,_t as u,at as d,bt as f,et as p,j as m,ot as h,vn as g,w as _}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as v,x as y,yt as b}from"./_MapCache-DjbOQyB7.js";import{At as x,Bi as S,Hi as C,Pi as w,Ui as T,Vi as E,gi as D,wi as O}from"./src-CppJvwzX.js";import{t as k}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as A,T as j,qa as M,r as N,s as P,wr as F,yr as I}from"./users.store-pCkD7Zo0.js";import{_ as L,rs as R}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as z}from"./usePageRedirectionHelper-BoF8hzbN.js";import{t as B}from"./usage.store-CK5aU6GK.js";var V=s({__name:`EvaluationsPaywall`,setup(e){let t=b(),n=N(),r=async()=>{n.openModalWithData({name:M,data:{customHeading:void 0}})};return(e,n)=>(p(),c(i(w),{"data-test-id":`evaluations-unlicensed`,heading:i(t).baseText(`evaluations.paywall.title`),description:i(t).baseText(`evaluations.paywall.description`),"button-text":i(t).baseText(`evaluations.paywall.cta`),onClick:r},null,8,[`heading`,`description`,`button-text`]))}}),H=k(s({__name:`StepIndicator`,props:{stepNumber:{},isCompleted:{type:Boolean},isActive:{type:Boolean}},setup(e){return(r,a)=>(p(),n(`div`,{class:g([r.$style.stepIndicator,e.isCompleted&&r.$style.completed,e.isActive&&r.$style.active,!e.isActive&&!e.isCompleted&&r.$style.inactive])},[e.isCompleted?(p(),c(i(T),{key:0,icon:`check`,size:`xsmall`})):(p(),n(l,{key:1},[m(t(e.stepNumber),1)],64))],2))}}),[[`__cssModules`,{$style:{stepIndicator:`_stepIndicator_1oszv_125`,active:`_active_1oszv_139`,completed:`_completed_1oszv_143`,inactive:`_inactive_1oszv_148`}}]]),U=k(s({__name:`StepHeader`,props:{stepNumber:{},title:{},isCompleted:{type:Boolean},isActive:{type:Boolean},isOptional:{type:Boolean}},emits:[`click`],setup(e,{emit:a}){let s=a,l=b(),u=e=>{!e.target.closest(`button`)&&!e.target.closest(`a`)&&!e.target.closest(`input`)&&!e.target.closest(`select`)&&s(`click`)};return(a,s)=>(p(),n(`div`,{class:g(a.$style.stepHeader),onClick:u},[o(H,{"step-number":e.stepNumber,"is-completed":e.isCompleted,"is-active":e.isActive},null,8,[`step-number`,`is-completed`,`is-active`]),_(`div`,{class:g(a.$style.titleSlot)},[d(a.$slots,`default`,{},()=>[o(i(E),{size:`medium`,color:e.isActive||e.isCompleted?`text-dark`:`text-light`,tag:`span`,bold:``},{default:f(()=>[m(t(e.title),1)]),_:1},8,[`color`])])],2),e.isOptional?(p(),c(i(x),{key:0,style:{"background-color":`var(--color--background)`,border:`none`}},{default:f(()=>[m(t(i(l).baseText(`evaluations.setupWizard.stepHeader.optional`)),1)]),_:1})):r(``,!0)],2))}}),[[`__cssModules`,{$style:{stepHeader:`_stepHeader_xciv4_125`}}]]),W=k(s({__name:`SetupWizard`,emits:[`runTest`],setup(s){let l=O(),u=b(),d=P(),h=j(),y=B(),x=z(),w=e(()=>h.testRunsByWorkflowId[d.workflow.id]?.length>0),T=e(()=>y.workflowsWithEvaluationsLimit===-1||y.workflowsWithEvaluationsCount<y.workflowsWithEvaluationsLimit),D=e(()=>y.workflowsWithEvaluationsLimit!==-1&&y.workflowsWithEvaluationsCount>=y.workflowsWithEvaluationsLimit&&!w.value),k=a(0);(()=>{if(D.value){k.value=2;return}h.evaluationTriggerExists&&h.evaluationSetMetricsNodeExist?k.value=3:h.evaluationTriggerExists&&h.evaluationSetOutputsNodeExist?k.value=2:h.evaluationTriggerExists?k.value=1:k.value=0})();let A=e=>{k.value=e};function M(e){let t=d.workflow.id||`new`;l.push({name:R.WORKFLOW,params:{name:t},query:e?{action:e}:void 0})}function N(){x.goToUpgrade(`evaluations`,`upgrade-evaluations`)}return(e,a)=>(p(),n(`div`,{class:g(e.$style.container),"data-test-id":`evaluation-setup-wizard`},[_(`div`,{class:g(e.$style.steps)},[_(`div`,{class:g([e.$style.step,e.$style.completed])},[o(U,{"step-number":1,title:i(u).baseText(`evaluations.setupWizard.step1.title`),"is-completed":i(h).evaluationTriggerExists,"is-active":k.value===0,onClick:a[0]||=e=>A(0)},null,8,[`title`,`is-completed`,`is-active`]),k.value===0?(p(),n(`div`,{key:0,class:g(e.$style.stepContent)},[_(`ul`,{class:g(e.$style.bulletPoints)},[_(`li`,null,[o(i(E),{size:`small`,color:`text-base`},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step1.item1`)),1)]),_:1})]),_(`li`,null,[o(i(E),{size:`small`,color:`text-base`},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step1.item2`)),1)]),_:1})])],2),_(`div`,{class:g(e.$style.actionButton)},[o(i(C),{variant:`subtle`,size:`small`,onClick:a[1]||=e=>M(`addEvaluationTrigger`)},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step1.button`)),1)]),_:1})],2)],2)):r(``,!0)],2),_(`div`,{class:g([e.$style.step,k.value===1?e.$style.active:``])},[o(U,{"step-number":2,title:i(u).baseText(`evaluations.setupWizard.step2.title`),"is-completed":i(h).evaluationSetOutputsNodeExist,"is-active":k.value===1,onClick:a[2]||=e=>A(1)},null,8,[`title`,`is-completed`,`is-active`]),k.value===1?(p(),n(`div`,{key:0,class:g(e.$style.stepContent)},[_(`ul`,{class:g(e.$style.bulletPoints)},[_(`li`,null,[o(i(E),{size:`small`,color:`text-base`},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step2.item1`)),1)]),_:1})])],2),_(`div`,{class:g(e.$style.actionButton)},[o(i(C),{variant:`subtle`,size:`small`,onClick:a[3]||=e=>M(`addEvaluationNode`)},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step2.button`)),1)]),_:1})],2)],2)):r(``,!0)],2),_(`div`,{class:g(e.$style.step)},[o(U,{"step-number":3,title:i(u).baseText(`evaluations.setupWizard.step3.title`),"is-completed":i(h).evaluationSetMetricsNodeExist,"is-active":k.value===2,"is-optional":!0,onClick:a[4]||=e=>A(2)},null,8,[`title`,`is-completed`,`is-active`]),k.value===2?(p(),n(`div`,{key:0,class:g(e.$style.stepContent)},[D.value?(p(),c(i(S),{key:1,theme:`warning`,iconless:``},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.limitReached`)),1)]),_:1})):(p(),n(`ul`,{key:0,class:g(e.$style.bulletPoints)},[_(`li`,null,[o(i(E),{size:`small`,color:`text-base`},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step3.item1`)),1)]),_:1})]),_(`li`,null,[o(i(E),{size:`small`,color:`text-base`},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step3.item2`)),1)]),_:1})])],2)),_(`div`,{class:g(e.$style.actionButton)},[D.value?(p(),c(i(C),{key:1,size:`small`,onClick:N},{default:f(()=>[m(t(i(u).baseText(`generic.seePlans`)),1)]),_:1})):(p(),c(i(C),{key:0,variant:`subtle`,size:`small`,onClick:a[5]||=e=>M(`addEvaluationNode`)},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step3.button`)),1)]),_:1})),o(i(C),{variant:`ghost`,size:`small`,style:{color:`var(--color--text--tint-1)`},onClick:a[6]||=e=>A(3)},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step3.skip`)),1)]),_:1})],2),i(y).workflowsWithEvaluationsLimit!==-1&&T.value?(p(),n(`div`,{key:2,class:g(e.$style.quotaNote)},[o(i(E),{size:`xsmall`,color:`text-base`},{default:f(()=>[o(i(v),{keypath:`evaluations.setupWizard.step3.notice`,scope:`global`},{link:f(()=>[_(`a`,{style:{"text-decoration":`underline`,color:`inherit`},onClick:N},t(i(u).baseText(`evaluations.setupWizard.step3.notice.link`)),1)]),_:1})]),_:1})],2)):r(``,!0)],2)):r(``,!0)],2),_(`div`,{class:g(e.$style.step)},[o(U,{"step-number":4,title:i(u).baseText(`evaluations.setupWizard.step4.title`),"is-completed":!1,"is-active":k.value===3,onClick:a[9]||=e=>A(3)},{default:f(()=>[_(`div`,{class:g([e.$style.actionButton,e.$style.actionButtonInline])},[i(h).evaluationSetMetricsNodeExist&&!D.value?(p(),c(i(C),{key:0,variant:`subtle`,size:`medium`,disabled:!i(h).evaluationTriggerExists||!i(h).evaluationSetOutputsNodeExist&&!i(h).evaluationSetMetricsNodeExist,onClick:a[7]||=t=>e.$emit(`runTest`)},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step4.button`)),1)]),_:1},8,[`disabled`])):(p(),c(i(C),{key:1,variant:`subtle`,size:`medium`,disabled:!i(h).evaluationTriggerExists||!i(h).evaluationSetOutputsNodeExist&&!i(h).evaluationSetMetricsNodeExist,onClick:a[8]||=e=>M(`executeEvaluation`)},{default:f(()=>[m(t(i(u).baseText(`evaluations.setupWizard.step4.altButton`)),1)]),_:1},8,[`disabled`]))],2)]),_:1},8,[`title`,`is-active`])],2)],2)],2))}}),[[`__cssModules`,{$style:{container:`_container_1j428_125`,steps:`_steps_1j428_129`,step:`_step_1j428_129`,stepContent:`_stepContent_1j428_139`,slideDown:`_slideDown_1j428_1`,bulletPoints:`_bulletPoints_1j428_144`,actionButton:`_actionButton_1j428_151`,actionButtonInline:`_actionButtonInline_1j428_160`,quotaNote:`_quotaNote_1j428_164`}}]]),G=k(s({__name:`EvaluationsRootView`,props:{name:{}},setup(a){let s=a,l=B(),d=j(),v=A(),x=I(),C=b(),w=F(),T=e(()=>l.workflowsWithEvaluationsLimit!==0),O=e(()=>w.preferences.branchReadOnly),k=e(()=>Object.values(d.testRunsById??{}).filter(({workflowId:e})=>e===s.name)),M=e(()=>k.value.length>0),N=e(()=>!M.value);async function P(){try{await d.startTestRun(s.name)}catch(e){x.showError(e,C.baseText(`evaluation.listRuns.error.cantStartTestRun`));return}try{await d.fetchTestRuns(s.name)}catch(e){x.showError(e,C.baseText(`evaluation.listRuns.error.cantFetchTestRuns`))}}let R=e(()=>l.workflowsWithEvaluationsLimit!==-1&&l.workflowsWithEvaluationsCount>=l.workflowsWithEvaluationsLimit&&!M.value),{isReady:z}=y(async()=>{try{await l.getLicenseInfo(),await d.fetchTestRuns(s.name)}catch(e){x.showError(e,C.baseText(`evaluation.listRuns.error.cantFetchTestRuns`))}},void 0);return u(z,e=>{e&&(N.value?v.track(`User viewed tests tab`,{workflow_id:s.name,test_type:`evaluation`,view:`setup`,trigger_set_up:d.evaluationTriggerExists,output_set_up:d.evaluationSetOutputsNodeExist,metrics_set_up:d.evaluationSetMetricsNodeExist,quota_reached:R.value}):v.track(`User viewed tests tab`,{workflow_id:s.name,test_type:`evaluation`,view:`overview`,run_count:k.value.length}))},{immediate:!0}),(e,a)=>{let s=h(`RouterView`);return p(),n(`div`,{class:g(e.$style.evaluationsView)},[i(z)&&N.value?(p(),n(`div`,{key:0,class:g(e.$style.setupContent)},[_(`div`,null,[o(i(E),{size:`large`,color:`text-dark`,tag:`h3`,bold:``},{default:f(()=>[m(t(i(C).baseText(`evaluations.setupWizard.title`)),1)]),_:1}),o(i(E),{tag:`p`,size:`small`,color:`text-base`,class:g(e.$style.description)},{default:f(()=>[m(t(i(C).baseText(`evaluations.setupWizard.description`))+` `,1),o(i(D),{size:`small`,href:i(L)},{default:f(()=>[m(t(i(C).baseText(`evaluations.setupWizard.moreInfo`)),1)]),_:1},8,[`href`])]),_:1},8,[`class`])]),O.value?(p(),c(i(S),{key:0,theme:`info`,icon:`info`},{default:f(()=>[m(t(i(C).baseText(`evaluations.readOnlyNotice`)),1)]),_:1})):(p(),n(`div`,{key:1,class:g(e.$style.config)},[a[0]||=_(`iframe`,{style:{"min-width":`500px`},width:`500`,height:`280`,src:`https://www.youtube.com/embed/5LlF196PKaE`,title:`n8n Evaluation quickstart`,frameborder:`0`,allow:`accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share`,referrerpolicy:`strict-origin-when-cross-origin`,allowfullscreen:``},null,-1),T.value?(p(),c(W,{key:0,onRunTest:P})):(p(),c(V,{key:1}))],2))],2)):i(z)?(p(),c(s,{key:1})):r(``,!0)],2)}}}),[[`__cssModules`,{$style:{evaluationsView:`_evaluationsView_1ydf9_125`,setupContent:`_setupContent_1ydf9_132`,description:`_description_1ydf9_141`,config:`_config_1ydf9_146`,setupDescription:`_setupDescription_1ydf9_152`}}]]);export{G as default};
//# sourceMappingURL=EvaluationsRootView-o6eiiVZr.js.map