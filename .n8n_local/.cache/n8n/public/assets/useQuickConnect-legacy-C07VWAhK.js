!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"n8n@2.9.4"}}catch(e){}}(),System.register(["./vue.runtime.esm-bundler-legacy-BquwEXRp.js","./_MapCache-legacy-BR_CVmoL.js","./users.store-legacy-B-bVJKl3.js","./constants-legacy-DVkAm8xO.js"],(function(e,t){var n,r,o,i,a,s,u,c,l,d,f,p,y;function h(){const e=u(),t=a(),n=c(),i=d(),l=o(),f=s(),h=r(null),w=r(null);function g(t,n=new Set){if(n.has(t))return[];n.add(t);const r=e.getCredentialTypeByName(t);if(void 0===r?.extends)return[];const o=[];for(const e of r.extends)o.push(e),o.push(...g(e,n));return o}function A(e){const t=g(e);return"oAuth2Api"===e||"oAuth1Api"===e||t.includes("oAuth2Api")||t.includes("oAuth1Api")}function b(){i.showError(new Error(l.baseText("credentialEdit.credentialEdit.showError.invalidOAuthUrl.message")),l.baseText("credentialEdit.credentialEdit.showError.invalidOAuthUrl.title"))}async function v(t,n){const r=await async function(t){const n=g(t.type);try{if("oAuth2Api"===t.type||n.includes("oAuth2Api"))return y(await e.oAuth2Authorize(t));if("oAuth1Api"===t.type||n.includes("oAuth1Api"))return y(await e.oAuth1Authorize(t))}catch(r){return i.showError(r,l.baseText("credentialEdit.credentialEdit.showError.generateAuthorizationUrl.title")),p("api-error")}return p("no-url")}(t);if(!r.ok)return"no-url"===r.error&&b(),!1;if(!function(e){try{const t=new URL(e);return["http:","https:"].includes(t.protocol)}catch{return!1}}(r.result))return b(),!1;const o=function(e,t){const n=window.open(e,"OAuth Authorization","scrollbars=no,resizable=yes,status=no,titlebar=no,location=no,toolbar=no,menubar=no,width=500,height=700");return t?.addEventListener("abort",(()=>{n?.close()})),n}(r.result,n);return o?await async function(e,t){return await new Promise((n=>{const r=new BroadcastChannel("oauth-callback");let o=!1;const a=e=>{o||(o=!0,r.close(),n(e))};t?.addEventListener("abort",(()=>{a(!1)})),r.addEventListener("message",(t=>{e.close(),"success"===t.data?(i.showMessage({title:l.baseText("nodeCredentials.oauth.accountConnected"),type:"success"}),a(!0)):(i.showMessage({title:l.baseText("nodeCredentials.oauth.accountConnectionFailed"),type:"error"}),a(!1))}))}))}(o,n):(b(),!1)}return{getParentTypes:g,isOAuthCredentialType:A,isGoogleOAuthType:function(e){const t=g(e);return"googleOAuth2Api"===e||t.includes("googleOAuth2Api")},hasManagedOAuthCredentials:function(t){if(!A(t))return!1;const n=e.getCredentialTypeByName(t);if(!n)return!1;const r=n.__overwrittenProperties??[];return 0!==r.length&&n.properties.filter((e=>"hidden"!==e.type&&"notice"!==e.type&&!r.includes(e.name))).every((e=>!0!==e.required||"string"!==e.type&&"number"!==e.type))},authorize:v,createAndAuthorize:async function(r,o){const a=e.getCredentialTypeByName(r);if(!a)return null;let s;try{s=await e.createNewCredential({id:"",name:a.displayName,type:r,data:{allowedHttpRequestDomains:"none"}},t.currentProject?.id,void 0,{skipStoreUpdate:!0}),f.track("User created credentials",{credential_type:s.type,credential_id:s.id,workflow_id:n.workflowId})}catch(p){return i.showError(p,l.baseText("nodeCredentials.showMessage.title")),null}const u=new AbortController;h.value=u,w.value=s.id;const c=await v(s,u.signal);h.value=null,w.value=null;const d={credential_type:r,workflow_id:n.workflowId??null,credential_id:s.id,is_complete:!0,is_new:!0,is_valid:c,uses_external_secrets:!1};return o&&(d.node_type=o),f.track("User saved credentials",d),c?(e.upsertCredential(s),s):(e.deleteCredential({id:s.id}),null)},cancelAuthorize:function(){h.value&&h.value.abort(),w.value&&e.deleteCredential({id:w.value})}}}return e({n:h,t:function(){const e=l(),t=i(),r=s(),{isOAuthCredentialType:o,createAndAuthorize:a,cancelAuthorize:u}=h(),c=n((()=>t.isVariantEnabled(f.name,f.variant))),d=n((()=>{const t=new Map;for(const n of e.moduleSettings["quick-connect"]?.options??[])t.set(n.credentialType,n);return t})),p=n((()=>{const t=new Map;for(const n of e.moduleSettings["quick-connect"]?.options??[])t.has(n.packageName)||t.set(n.packageName,n);return t}));function y(e,t){if(!c.value||0===d.value.size)return;const n=d.value.get(e);if(!n)return;const r=t.split(".")[0];return n.packageName===r?n:void 0}return{isQuickConnectEnabled:c,getQuickConnectOption:y,getQuickConnectOptionByPackageName:function(e){if(c.value&&0!==p.value.size)return p.value.get(e)},getQuickConnectOptionByCredentialTypes:function(e){if(c.value&&0!==d.value.size)for(const t of e){const e=d.value.get(t);if(e)return e}},connect:async function(e){const{credentialTypeName:t,nodeType:n,source:i}=e;return r.track("User clicked quick connect button",{source:i,credential_type:t,node_type:n}),y(t,n)?null:o(t)?await a(t,n):null},cancelConnect:u}}}),{setters:[function(e){n=e.C,r=e.It},function(e){o=e.yt},function(e){i=e.Fr,a=e.Gt,s=e.Lt,u=e.rt,c=e.s,l=e.ws,d=e.yr},function(e){f=e.Bc,p=e.Ri,y=e.zi}],execute:function(){try{e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},(t=(new e.Error).stack)&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2a9b8a58-2870-43e8-995b-dc0dbd164695",e._sentryDebugIdIdentifier="sentry-dbid-2a9b8a58-2870-43e8-995b-dc0dbd164695")}catch(e){}var e,t}}}));
//# sourceMappingURL=useQuickConnect-legacy-C07VWAhK.js.map