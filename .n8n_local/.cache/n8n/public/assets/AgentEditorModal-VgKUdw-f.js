(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`b88bab5d-c61e-4f56-aaba-3ca793468622`,e._sentryDebugIdIdentifier=`sentry-dbid-b88bab5d-c61e-4f56-aaba-3ca793468622`)})()}catch{}import{C as e,Cn as t,E as n,Gt as r,It as i,M as a,P as o,T as s,Z as c,_t as l,bt as u,et as d,j as f,mt as ee,vn as p,w as m}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as h}from"./_MapCache-DjbOQyB7.js";import{Hi as g,ji as _,ot as v,w as y,zi as te}from"./src-CppJvwzX.js";import{t as b}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Tr as ne,r as re,yr as x}from"./users.store-pCkD7Zo0.js";import{fi as S}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{r as C,v as w}from"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import{t as ie}from"./Modal-DQeDdfPI.js";import"./nodeIcon--7uU1Imq.js";import"./CredentialIcon-B1JZV04S.js";import"./NodeIcon-Dv1e4Lvu.js";import"./dist-BiTDpeeI.js";import{C as ae,_ as T,m as E,t as D}from"./chat.store-a0NAXg9S.js";import"./ChatAgentAvatar-B0HR6UWG.js";import{n as O,r as k,t as oe}from"./useCustomAgent-DrfdRIKA.js";var A=b(o({__name:`AgentEditorModal`,props:{modalName:{},data:{}},setup(o){let b=o,A=D(),j=h(),M=x(),se=ne(),ce=re(),{customAgent:le,isLoading:N}=oe(b.data.agentId),P=i(``),F=i(``),I=i(``),L=i(null),R=i(!1),z=i(!1),B=i([]),V=i(S),H=i(!1),U=ee(`nameInput`),W=i(T),G=i({}),K=e(()=>L.value&&Z.value[L.value.provider]),q=e(()=>L.value&&A.getAgent(L.value,{name:L.value.model})),J=e(()=>!!b.data.agentId),Y=e(()=>J.value&&N.value),ue=e(()=>J.value?j.baseText(`chatHub.agent.editor.title.edit`):j.baseText(`chatHub.agent.editor.title.new`)),de=e(()=>R.value?j.baseText(`chatHub.agent.editor.saving`):j.baseText(`chatHub.agent.editor.save`)),X=e(()=>P.value.trim().length>0&&I.value.trim().length>0&&L.value!==null&&!!K.value),Z=e(()=>({...b.data.credentials,...G.value})),Q=e(()=>q.value?.metadata.capabilities.functionCalling??!1);function $(){ce.closeModal(b.modalName)}l(q,e=>{e&&!e.metadata.capabilities.functionCalling&&(B.value=[])},{immediate:!0}),l(le,e=>{e&&(W.value=e.icon??T,P.value=e.name,F.value=e.description??``,I.value=e.systemPrompt,L.value={provider:e.provider,model:e.model},B.value=e.toolIds??[],e.credentialId&&(G.value[e.provider]=e.credentialId))},{immediate:!0}),c(()=>{l([Y,U],([e,t])=>{e||t?.focus()},{immediate:!0,flush:`post`})}),l(Z,async e=>{if(e){H.value=!0;try{V.value=await ae(C().restApiContext,{credentials:e})}finally{H.value=!1}}},{immediate:!0});function fe(e,t){G.value={...G.value,[e]:t}}function pe(e){B.value.includes(e)?B.value=B.value.filter(t=>t!==e):B.value=[...B.value,e]}function me(e){w(E(e)),L.value=e}async function he(){if(!(!X.value||R.value)){R.value=!0;try{w(L.value),w(K.value);let e={name:P.value.trim(),description:F.value.trim()||void 0,systemPrompt:I.value.trim(),...L.value,credentialId:K.value,toolIds:B.value,icon:W.value};if(J.value&&b.data.agentId)await A.updateCustomAgent(b.data.agentId,e,b.data.credentials),M.showMessage({title:j.baseText(`chatHub.agent.editor.success.update`),type:`success`});else{let t=await A.createCustomAgent(e,b.data.credentials);b.data.onCreateCustomAgent?.(t),M.showMessage({title:j.baseText(`chatHub.agent.editor.success.create`),type:`success`})}$()}catch(e){let t=e instanceof Error?e.message:``;M.showError(e,j.baseText(`chatHub.agent.editor.error.save`),t)}finally{R.value=!1}}}async function ge(){if(!(!J.value||!b.data.agentId||z.value)&&await se.confirm(j.baseText(`chatHub.agent.editor.delete.confirm.message`),j.baseText(`chatHub.agent.editor.delete.confirm.title`),{confirmButtonText:j.baseText(`chatHub.agent.editor.delete.confirm.button`),cancelButtonText:j.baseText(`chatHub.agent.editor.delete.cancel.button`),type:`warning`})===`confirm`){z.value=!0;try{await A.deleteCustomAgent(b.data.agentId,b.data.credentials),M.showMessage({title:j.baseText(`chatHub.agent.editor.success.delete`),type:`success`}),b.data.onClose?.(),$()}catch(e){let t=e instanceof Error?e.message:``;M.showError(e,j.baseText(`chatHub.agent.editor.error.delete`),t)}finally{z.value=!1}}}return(e,i)=>(d(),s(ie,{name:o.modalName,width:`640px`,loading:Y.value},{header:u(()=>[m(`div`,{class:p(e.$style.header)},[a(r(te),{tag:`h2`,size:`large`},{default:u(()=>[f(t(ue.value),1)]),_:1}),J.value?(d(),s(r(g),{key:0,variant:`subtle`,icon:`trash-2`,class:p(e.$style.deleteButton),disabled:z.value,loading:z.value,onClick:ge},null,8,[`class`,`disabled`,`loading`])):n(``,!0)],2)]),content:u(()=>[m(`div`,{class:p(e.$style.content)},[a(r(v),{"input-name":`agent-name`,label:r(j).baseText(`chatHub.agent.editor.name.label`),required:!0},{default:u(()=>[m(`div`,{class:p(e.$style.agentName)},[a(r(y),{modelValue:W.value,"onUpdate:modelValue":i[0]||=e=>W.value=e,"button-tooltip":r(j).baseText(`chatHub.agent.editor.iconPicker.button.tooltip`)},null,8,[`modelValue`,`button-tooltip`]),a(r(_),{id:`agent-name`,ref:`nameInput`,modelValue:P.value,"onUpdate:modelValue":i[1]||=e=>P.value=e,placeholder:r(j).baseText(`chatHub.agent.editor.name.placeholder`),maxlength:128,class:p(e.$style.agentNameInput)},null,8,[`modelValue`,`placeholder`,`class`])],2)]),_:1},8,[`label`]),a(r(v),{"input-name":`agent-description`,label:r(j).baseText(`chatHub.agent.editor.description.label`)},{default:u(()=>[a(r(_),{id:`agent-description`,modelValue:F.value,"onUpdate:modelValue":i[2]||=e=>F.value=e,type:`textarea`,placeholder:r(j).baseText(`chatHub.agent.editor.description.placeholder`),maxlength:512,rows:3,class:p(e.$style.input)},null,8,[`modelValue`,`placeholder`,`class`])]),_:1},8,[`label`]),a(r(v),{"input-name":`agent-system-prompt`,label:r(j).baseText(`chatHub.agent.editor.systemPrompt.label`),required:!0},{default:u(()=>[a(r(_),{id:`agent-system-prompt`,modelValue:I.value,"onUpdate:modelValue":i[3]||=e=>I.value=e,type:`textarea`,placeholder:r(j).baseText(`chatHub.agent.editor.systemPrompt.placeholder`),rows:6,class:p(e.$style.input)},null,8,[`modelValue`,`placeholder`,`class`])]),_:1},8,[`label`]),m(`div`,{class:p(e.$style.row)},[a(r(v),{"input-name":`agent-model`,class:p(e.$style.input),label:r(j).baseText(`chatHub.agent.editor.model.label`),required:!0},{default:u(()=>[a(k,{"selected-agent":q.value,"include-custom-agents":!1,credentials:Z.value,agents:V.value,"is-loading":H.value,class:p(e.$style.modelSelector),"warn-missing-credentials":``,onChange:me,onSelectCredential:fe},null,8,[`selected-agent`,`credentials`,`agents`,`is-loading`,`class`])]),_:1},8,[`class`,`label`]),a(r(v),{"input-name":`agent-tool`,class:p(e.$style.input),label:r(j).baseText(`chatHub.agent.editor.tools.label`),required:!1},{default:u(()=>[m(`div`,null,[a(O,{disabled:!Q.value,"disabled-tooltip":Q.value?void 0:L.value?r(j).baseText(`chatHub.tools.selector.disabled.tooltip`):r(j).baseText(`chatHub.tools.selector.disabled.noModel.tooltip`),"checked-tool-ids":B.value,onToggle:pe},null,8,[`disabled`,`disabled-tooltip`,`checked-tool-ids`])])]),_:1},8,[`class`,`label`])],2)],2)]),footer:u(()=>[m(`div`,{class:p(e.$style.footer)},[a(r(g),{variant:`subtle`,onClick:$},{default:u(()=>[f(t(r(j).baseText(`chatHub.tools.editor.cancel`)),1)]),_:1}),a(r(g),{variant:`solid`,disabled:!X.value||R.value,onClick:he},{default:u(()=>[f(t(de.value),1)]),_:1},8,[`disabled`])],2)]),_:1},8,[`name`,`loading`]))}}),[[`__cssModules`,{$style:{header:`_header_5439g_125`,deleteButton:`_deleteButton_5439g_133`,content:`_content_5439g_137`,input:`_input_5439g_144`,agentName:`_agentName_5439g_148`,agentNameInput:`_agentNameInput_5439g_154`,row:`_row_5439g_158`,modelSelector:`_modelSelector_5439g_164`,footer:`_footer_5439g_168`}}]]);export{A as default};
//# sourceMappingURL=AgentEditorModal-VgKUdw-f.js.map