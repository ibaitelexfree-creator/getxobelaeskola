(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`ee49ea5d-b8fe-4dbe-86e2-7704cfefc4bf`,e._sentryDebugIdIdentifier=`sentry-dbid-ee49ea5d-b8fe-4dbe-86e2-7704cfefc4bf`)})()}catch{}import{C as e,Cn as t,D as n,E as r,Gt as i,It as a,J as o,M as s,P as c,T as l,U as u,Z as d,_ as f,bt as p,et as m,ft as h,it as g,j as _,m as v,vn as y,w as b}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as x}from"./_MapCache-DjbOQyB7.js";import{Hi as S,U as C,Ui as w,_t as T,ft as E,pt as D}from"./src-CppJvwzX.js";import{t as O}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as k,yr as A}from"./users.store-pCkD7Zo0.js";import"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./banners.store-Ce6ZTWqJ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import"./dataTable.store-dy4dvFXe.js";import{t as j}from"./Modal-DQeDdfPI.js";import"./executions.store-DnLtKXBA.js";import"./useEnvFeatureFlag-CHY3xSda.js";import"./usePinnedData-C6FFXoty.js";import"./nodeIcon--7uU1Imq.js";import"./canvas.utils-C8dCdoZZ.js";import"./nodeCreator.store-KD9kt9dE.js";import"./useCanvasOperations-BHGWcL34.js";import"./folders.store-CS_gIPIm.js";import"./useDynamicCredentials-BSZ25lEI.js";import"./NodeIcon-Dv1e4Lvu.js";import"./roles.store-Cq99swn7.js";import"./dist-BiTDpeeI.js";import"./sso.store-Dd63iqNy.js";import"./router-BsVVJ6vf.js";import"./insights.store-CIIvho7C.js";import"./insights.constants-DHL43iRt.js";import"./insights.utils-B2NpOI0Q.js";import{a as M,i as N,n as P,t as F}from"./mcp.constants-BtNzU3_O.js";import{t as I}from"./mcp.store-BS0hY8V7.js";import{t as L}from"./WorkflowLocation-JAxJfyHi.js";var R=O(c({__name:`MCPWorkflowsSelect`,props:u({placeholder:{},disabled:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:u([`ready`,`confirm`],[`update:modelValue`]),setup(o,{expose:c,emit:u}){let b=x(),S=A(),C=h(o,`modelValue`),T=u,O=I(),k=a(!1),j=a(!1),M=a(!1),N=a(),P=a([]),F=null,R=e(()=>!k.value&&j.value&&P.value.length===0);async function z(e){F&&=(clearTimeout(F),null),k.value=!0,j.value=!1;try{P.value=(await O.getMcpEligibleWorkflows({take:10,query:e??void 0}))?.data??[]}catch(e){S.showError(e,b.baseText(`settings.mcp.connectWorkflows.error`))}finally{await B(200),k.value=!1,j.value=!0}}async function B(e){await new Promise(t=>{setTimeout(()=>{t()},e)})}function V(){N.value?.focusOnInput()}function H(e){P.value=P.value.filter(t=>t.id!==e)}function U(e){M.value=e}function W(e){e.key===`Enter`&&!M.value&&C.value&&(e.preventDefault(),e.stopPropagation(),T(`confirm`))}return d(async()=>{await z(),T(`ready`)}),c({focusOnInput:V,removeOption:H}),(e,a)=>(m(),n(`div`,{onKeydownCapture:v(W,[`enter`])},[s(i(E),{ref_key:`selectRef`,ref:N,modelValue:C.value,"onUpdate:modelValue":a[0]||=e=>C.value=e,"data-test-id":`mcp-workflows-select`,placeholder:o.placeholder,disabled:o.disabled,loading:k.value,filterable:!0,remote:!0,"remote-method":z,"popper-class":{[e.$style[`mcp-workflows-select-loading`]]:k.value,[e.$style[`mcp-workflows-select-empty`]]:R.value},onVisibleChange:U},{prefix:p(()=>[s(i(w),{class:y(e.$style[`search-icon`]),icon:`search`,size:`large`},null,8,[`class`])]),default:p(()=>[R.value?(m(),l(i(D),{key:0,value:``,disabled:``,class:y(e.$style[`empty-option`])},{default:p(()=>[_(t(i(b).baseText(`settings.mcp.connectWorkflows.emptyState`)),1)]),_:1},8,[`class`])):r(``,!0),(m(!0),n(f,null,g(P.value,e=>(m(),l(i(D),{key:e.id,value:e.id,label:e.name},{default:p(()=>[s(L,{"workflow-id":e.id,"workflow-name":e.name,"home-project":e.homeProject,"parent-folder":e.parentFolder},null,8,[`workflow-id`,`workflow-name`,`home-project`,`parent-folder`])]),_:2},1032,[`value`,`label`]))),128))]),_:1},8,[`modelValue`,`placeholder`,`disabled`,`loading`,`popper-class`])],32))}}),[[`__cssModules`,{$style:{"mcp-workflows-select-loading":`_mcp-workflows-select-loading_eulzw_125`,"mcp-workflows-select-empty":`_mcp-workflows-select-empty_eulzw_126`,"empty-option":`_empty-option_eulzw_133`}}]]),z=O(c({__name:`MCPConnectWorkflowsModal`,props:{data:{}},setup(t){let n=t,r=x(),c=k(),u=a(!1),f=a(),h=a(null),g=T(),_=a(!1),v=`${M}#${F}`,w=e(()=>!!f.value),E=e=>{_.value=!0,c.track(`User dismissed mcp workflows dialog`),e()};async function D(e){if(f.value){u.value=!0;try{await n.data.onEnableMcpAccess(f.value),_.value=!0,c.track(`User selected workflow from list`,{workflowId:f.value}),e()}finally{u.value=!1}}}function O(){_.value||c.track(`User dismissed mcp workflows dialog`)}function A(){h.value?.focusOnInput()}function P(){u.value||D(()=>g.emit(`close`))}return d(()=>{g.on(`closed`,O)}),o(()=>{g.off(`closed`,O)}),(e,t)=>(m(),l(j,{name:i(N),title:i(r).baseText(`settings.mcp.connectWorkflows.modalTitle`),width:`600px`,class:y(e.$style.container),"event-bus":i(g)},{content:p(()=>[b(`div`,{class:y(e.$style.content)},[s(i(C),{"data-test-id":`mcp-connect-workflows-info-notice`,theme:`info`,content:i(r).baseText(`settings.mcp.connectWorkflows.notice`,{interpolate:{docsLink:v}}),class:y(e.$style.notice)},null,8,[`content`,`class`]),s(R,{ref_key:`selectRef`,ref:h,modelValue:f.value,"onUpdate:modelValue":t[0]||=e=>f.value=e,placeholder:i(r).baseText(`settings.mcp.connectWorkflows.input.placeholder`),disabled:u.value,onReady:A,onConfirm:P},null,8,[`modelValue`,`placeholder`,`disabled`])],2)]),footer:p(({close:t})=>[b(`div`,{class:y(e.$style.footer)},[s(i(S),{variant:`subtle`,label:i(r).baseText(`generic.cancel`),size:`small`,disabled:u.value,"data-test-id":`mcp-connect-workflows-cancel-button`,onClick:e=>E(t)},null,8,[`label`,`disabled`,`onClick`]),s(i(S),{variant:`solid`,label:i(r).baseText(`settings.mcp.connectWorkflows.confirm.label`),loading:u.value,disabled:!w.value||u.value,"data-test-id":`mcp-connect-workflows-save-button`,onClick:e=>D(t)},null,8,[`label`,`loading`,`disabled`,`onClick`])],2)]),_:1},8,[`name`,`title`,`class`,`event-bus`]))}}),[[`__cssModules`,{$style:{container:`_container_lejd8_125`,content:`_content_lejd8_130`,notice:`_notice_lejd8_135`,footer:`_footer_lejd8_142`}}]]);export{z as default};
//# sourceMappingURL=MCPConnectWorkflowsModal-QsnOGN2B.js.map