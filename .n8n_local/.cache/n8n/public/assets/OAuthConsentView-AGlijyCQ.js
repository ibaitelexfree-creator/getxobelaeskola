(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`cfe2f4c6-d5f4-41ec-80dd-4668f05fb3d5`,e._sentryDebugIdIdentifier=`sentry-dbid-cfe2f4c6-d5f4-41ec-80dd-4668f05fb3d5`)})()}catch{}import{C as e,Cn as t,D as n,E as r,Gt as i,It as a,M as o,P as s,T as c,Z as l,bt as u,et as d,j as f,st as p,vn as m,w as h,xt as g}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as _}from"./_MapCache-DjbOQyB7.js";import{Hi as v,U as y,Ui as b,Vi as x,X as S,zi as C}from"./src-CppJvwzX.js";import{t as w}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Wc as T,fn as E,yr as D}from"./users.store-pCkD7Zo0.js";import"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{d as O,j as k,r as A}from"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import{a as j}from"./mcp.constants-BtNzU3_O.js";async function M(e){return await O(e,`GET`,`/consent/details`)}async function N(e,t){return await O(e,`POST`,`/consent/approve`,{approved:t})}const P=k(T.CONSENT,()=>{let e=a(null),t=a(!1),n=a(null),r=A();return{fetchConsentDetails:async()=>{t.value=!0,n.value=null;try{return e.value=await M(r.restApiContext),e.value}catch(e){throw n.value=e instanceof Error?e.message:`Failed to load consent details`,e}finally{t.value=!1}},approveConsent:async e=>{t.value=!0,n.value=null;try{return await N(r.restApiContext,e)}catch(e){throw n.value=e instanceof Error?e.message:`Failed to process consent`,e}finally{t.value=!1}},resetState:()=>{e.value=null,t.value=!1,n.value=null},consentDetails:e,isLoading:t,error:n}});var F=w(s({__name:`OAuthConsentView`,setup(s){let w=[`claude`,`mcp inspector`],T=[`lovable`],O=P(),k=_(),A=E(),M=D(),N=a(!1),F=e(()=>O.error),I=e(()=>O.isLoading),L=e(()=>O.consentDetails),R=e(()=>{let e=L.value?.clientName?.toLowerCase()??``;return w.some(t=>e.includes(t))?`anthropic`:T.some(t=>e.includes(t))?`lovable`:`mcp`}),z=async()=>{try{let e=await O.approveConsent(!0);N.value=!0,window.location.href=e.redirectUrl}catch(e){M.showError(e,k.baseText(`oauth.consentView.error.allow`))}},B=async()=>{try{let e=await O.approveConsent(!1);window.location.href=e.redirectUrl}catch(e){M.showError(e,k.baseText(`oauth.consentView.error.deny`))}};return l(async()=>{A.set(k.baseText(`oauth.consentView.title`));try{await O.fetchConsentDetails()}catch(e){M.showError(e,k.baseText(`oauth.consentView.error.fetchDetails`))}}),(e,a)=>{let s=p(`n8n-html`);return d(),n(`div`,{class:m(e.$style.overlay)},[h(`div`,{class:m(e.$style[`consent-dialog`])},[h(`header`,{class:m(e.$style.header)},[h(`div`,{class:m([e.$style.logo,e.$style.n8n])},[o(i(S),{size:`small`,collapsed:!0,"release-channel":`stable`})],2),h(`div`,{class:m(e.$style.arrow)},[o(i(b),{icon:`arrow-right`,size:`large`,color:`text-light`})],2),h(`div`,{class:m(e.$style.logo)},[o(i(b),{icon:R.value,size:`xlarge`,color:`text-dark`},null,8,[`icon`])],2)],2),N.value?(d(),n(`div`,{key:0,class:m(e.$style.success),"data-test-id":`consent-success-screen`},[o(i(C),{tag:`h2`,size:`large`,bold:!0},{default:u(()=>[f(t(i(k).baseText(`oauth.consentView.success.title`)),1)]),_:1}),o(i(x),{color:`text-base`},{default:u(()=>[f(t(i(k).baseText(`oauth.consentView.success.description`)),1)]),_:1})],2)):(d(),n(`div`,{key:1,class:m(e.$style.content),"data-test-id":`consent-content`},[o(i(C),{tag:`h2`,size:`large`,bold:!0},{default:u(()=>[f(t(i(k).baseText(`oauth.consentView.heading`,{interpolate:{clientName:L.value?.clientName??``}})),1)]),_:1}),h(`div`,{class:m(e.$style[`text-content`])},[o(i(x),{color:`text-base`,size:`small`},{default:u(()=>[f(t(i(k).baseText(`oauth.consentView.description`,{interpolate:{clientName:L.value?.clientName??``}})),1)]),_:1}),h(`ul`,{class:m(e.$style[`permission-list`])},[h(`li`,null,t(i(k).baseText(`oauth.consentView.action.listWorkflows`)),1),h(`li`,null,t(i(k).baseText(`oauth.consentView.action.workflowDetails`)),1),h(`li`,null,t(i(k).baseText(`oauth.consentView.action.executeWorkflows`)),1)],2),h(`p`,{class:m(e.$style[`docs-link`])},[g(h(`span`,null,null,512),[[s,i(k).baseText(`oauth.consentView.readMore`,{interpolate:{docsUrl:i(j)}})]])],2)],2)],2)),N.value?r(``,!0):(d(),n(`footer`,{key:2,class:m(e.$style.footer)},[F.value?(d(),c(i(y),{key:0,theme:`danger`,"data-test-id":`consent-error-notice`,content:F.value},null,8,[`content`])):r(``,!0),h(`div`,{class:m(e.$style[`button-group`])},[o(i(v),{variant:`subtle`,"data-test-id":`consent-deny-button`,size:`large`,loading:I.value,disabled:I.value||F.value!==null,onClick:B},{default:u(()=>[f(t(i(k).baseText(`generic.deny`)),1)]),_:1},8,[`loading`,`disabled`]),o(i(v),{variant:`solid`,"data-test-id":`consent-allow-button`,size:`large`,loading:I.value,disabled:I.value||F.value!==null,onClick:z},{default:u(()=>[f(t(i(k).baseText(`generic.allow`)),1)]),_:1},8,[`loading`,`disabled`])],2)],2))],2)],2)}}}),[[`__cssModules`,{$style:{overlay:`_overlay_k3net_125`,"consent-dialog":`_consent-dialog_k3net_138`,header:`_header_k3net_151`,logo:`_logo_k3net_157`,n8n:`_n8n_k3net_166`,content:`_content_k3net_171`,success:`_success_k3net_178`,"text-content":`_text-content_k3net_187`,"permission-list":`_permission-list_k3net_193`,"docs-link":`_docs-link_k3net_205`,footer:`_footer_k3net_210`,"button-group":`_button-group_k3net_220`}}]]);export{F as default};
//# sourceMappingURL=OAuthConsentView-AGlijyCQ.js.map