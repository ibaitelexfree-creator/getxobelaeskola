const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/InsightsPaywall-CsEdvdoS.js","assets/_plugin-vue_export-helper-B_J4Khre.js","assets/src-CppJvwzX.js","assets/CalendarDate-CR2L-kBx.js","assets/_MapCache-DjbOQyB7.js","assets/vue.runtime.esm-bundler-1e_FtHOF.js","assets/chunk-Din3qlHY.js","assets/sanitize-html-K63Olwt_.js","assets/en-CTDtIhP1.js","assets/src-By0uoI3W.css","assets/constants-D1jZwsUK.js","assets/merge-CKxbv8m_.js","assets/users.store-pCkD7Zo0.js","assets/_baseOrderBy-El3qbNHQ.js","assets/dateformat-BhE5sUDK.js","assets/useDebounce-D6lADr4O.js","assets/versions.store-1_eor2Ku.js","assets/usePageRedirectionHelper-BoF8hzbN.js","assets/InsightsPaywall-CGFftIXb.css","assets/InsightsChartTotal-C5NVUOJ1.js","assets/dist-hhZkOity.js","assets/chart-xT2RiC54.js","assets/chartjs.utils-CFP86T-k.js","assets/smartDecimal-D382dS7h.js","assets/insights.constants-DHL43iRt.js","assets/InsightsChartFailed-D7W5bKl9.js","assets/InsightsChartFailureRate-C6m6WnzF.js","assets/insights.utils-B2NpOI0Q.js","assets/InsightsChartTimeSaved-drKRWwIk.js","assets/InsightsChartAverageRuntime-CbHQH11k.js","assets/InsightsTableWorkflows-LMKTQPXH.js","assets/InsightsTableWorkflows-Dun0Wnwl.css"])))=>i.map(i=>d[i]);
(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`9b10a7e6-a9c0-40bd-9306-149027bc3fe3`,e._sentryDebugIdIdentifier=`sentry-dbid-9b10a7e6-a9c0-40bd-9306-149027bc3fe3`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,M as s,N as c,P as l,T as u,Z as d,_ as f,_t as p,bt as m,ct as h,et as g,ft as _,it as v,j as y,q as b,vn as x,w as S,zt as C}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as w}from"./_MapCache-DjbOQyB7.js";import{Ci as T,F as E,Hi as D,Ki as O,Ui as k,Vi as A,l as j,zi as M}from"./src-CppJvwzX.js";import{t as N}from"./_plugin-vue_export-helper-B_J4Khre.js";import{h as P,l as F,m as I}from"./CalendarDate-CR2L-kBx.js";import"./sanitize-html-K63Olwt_.js";import{Gt as L,Lt as R,fn as z}from"./users.store-pCkD7Zo0.js";import{t as B}from"./dialog-Ds437WFa.js";import"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as V}from"./usePageRedirectionHelper-BoF8hzbN.js";import"./ProjectIcon-D-HRIqn6.js";import"./orderBy-KAUxkCYD.js";import{t as H}from"./ProjectSharing-DgwjJKfK.js";import{t as ee}from"./insights.store-CIIvho7C.js";import{s as te}from"./insights.constants-DHL43iRt.js";import{a as U,i as ne,n as W,t as G}from"./insights.utils-B2NpOI0Q.js";import{t as re}from"./InsightsSummary-8qyRMqyz.js";var K={class:`perks-list`},q={class:`insight-modal-button-container`},J=N(l({__name:`InsightsUpgradeModal`,props:{modelValue:{type:Boolean},modelModifiers:{}},emits:[`update:modelValue`],setup(e){let i=_(e,`modelValue`),o=w();function c(){i.value=!1,V().goToUpgrade(`insights`,`upgrade-insights`)}let l=t(()=>[...[,,,].keys()].map(e=>o.baseText(`insights.upgradeModal.perks.${e}`)));return(e,t)=>(g(),u(a(B),{modelValue:i.value,"onUpdate:modelValue":t[1]||=e=>i.value=e,title:a(o).baseText(`insights.upgradeModal.title`),width:`500`},{footer:m(()=>[S(`div`,q,[s(a(D),{variant:`subtle`,onClick:t[0]||=e=>i.value=!1},{default:m(()=>[y(n(a(o).baseText(`insights.upgradeModal.button.dismiss`)),1)]),_:1}),s(a(D),{variant:`solid`,onClick:c},{default:m(()=>[y(n(a(o).baseText(`generic.upgrade`)),1)]),_:1})])]),default:m(()=>[S(`div`,null,[s(a(A),{tag:`p`,class:`mb-s`},{default:m(()=>[y(n(a(o).baseText(`insights.upgradeModal.content`)),1)]),_:1}),S(`ul`,K,[(g(!0),r(f,null,v(l.value,e=>(g(),u(a(A),{key:e,color:`text-dark`,tag:`li`},{default:m(()=>[t[2]||=S(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 16 16`,width:`16px`,height:`16px`},[S(`path`,{d:`M 16 8 C 16 12.418 12.418 16 8 16 C 3.582 16 0 12.418 0 8 C 0 3.582 3.582 0 8 0 C 12.418 0 16 3.582 16 8 Z M 3.97 9.03 L 5.97 11.03 L 6.5 11.561 L 7.03 11.03 L 12.53 5.53 L 11.47 4.47 L 6.5 9.439 L 5.03 7.97 L 3.97 9.03 Z`,fill:`currentColor`})],-1),y(` `+n(e),1)]),_:2},1024))),128))])])]),_:1},8,[`modelValue`,`title`]))}}),[[`__scopeId`,`data-v-fdfc14aa`]]),ie=N(l({__name:`InsightsDataRangePicker`,props:{maxValue:{},minValue:{},modelValue:{},presets:{}},emits:[`update:modelValue`,`update:placeholder`,`update:startValue`,`update:open`],setup(e,{emit:c}){let l=e,d=c,h=R(),_=o(!1);function b(){_.value=!0}let S=o(`custom`);function w({start:e,end:t}){return!e||!t?0:t.compare(e)}function T(e,t){return e.compare(t)<=0}function E(e,t){return e.compare(t)>=0}function O(e,t){return!e||!t?!1:e.compare(t)===0}function A({start:e,end:t}){return!e||!t?!1:T(t,l.maxValue)&&E(e,l.minValue)}let M=C({start:l.modelValue.start?.copy(),end:l.modelValue.end?.copy()});function N(){(!O(M.value?.start,l.modelValue.start)||!O(M.value?.end,l.modelValue.end))&&(M.value={start:l.modelValue.start?.copy(),end:l.modelValue.end?.copy()})}let P=null;function L(e){if(e){N();return}let t={start:M.value?.start?.copy(),end:M.value?.end?.copy()??M.value?.start?.copy()};if(!A(t)){console.error(`Invalid date range selected`,t),N();return}if(P&&O(t.start,P.start)&&O(t.end,P.end)||O(t.start,l.modelValue.start)&&O(t.end,l.modelValue.end))return;P=t,d(`update:modelValue`,t);let{startDate:n,endDate:r}=W(t),i={start_date:n.toISOString(),end_date:r.toISOString(),range_length_days:w(t),type:S.value};h.track(`User updated insights time range`,i)}let z=o(!1);p(z,e=>{e&&(S.value=`custom`),L(e)});function B(e){M.value={start:l.maxValue.copy().subtract({days:e}),end:l.maxValue.copy()},S.value=`preset`,z.value=!1}let V=t(()=>{let{start:e,end:t}=l.modelValue;return e?G({start:e,end:t}):`Select range`});function H(e){return F(l.modelValue.end,I())?l.modelValue.end.compare(l.modelValue.start)===e:!1}return(t,o)=>(g(),r(f,null,[s(a(j),{modelValue:M.value,"onUpdate:modelValue":o[0]||=e=>M.value=e,open:z.value,"onUpdate:open":o[1]||=e=>z.value=e,"max-value":e.maxValue,"min-value":e.minValue},{trigger:m(()=>[s(a(D),{variant:`subtle`,icon:`calendar`},{default:m(()=>[y(n(V.value),1)]),_:1})]),presets:m(()=>[(g(!0),r(f,null,v(e.presets,e=>(g(),u(a(D),{key:e.value,class:x(t.$style.PresetButton),variant:H(e.value)?`solid`:`outline`,size:`small`,onClick:t=>e.disabled?b():B(e.value)},{default:m(()=>[y(n(e.label)+` `,1),e.disabled?(g(),u(a(k),{key:0,icon:`lock`,class:x(t.$style.LockIcon)},null,8,[`class`])):i(``,!0)]),_:2},1032,[`class`,`variant`,`onClick`]))),128))]),_:1},8,[`modelValue`,`open`,`max-value`,`min-value`]),s(J,{modelValue:_.value,"onUpdate:modelValue":o[2]||=e=>_.value=e},null,8,[`modelValue`])],64))}}),[[`__cssModules`,{$style:{PresetButton:`_PresetButton_1waws_2`,LockIcon:`_LockIcon_1waws_7`}}]]),ae={class:`mt-s`,style:{display:`flex`,gap:`12px`,"align-items":`center`}},Y=N(l({__name:`InsightsDashboard`,props:{insightType:{}},setup(e){let l=c(async()=>await O(()=>import(`./InsightsPaywall-CsEdvdoS.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),f=c(async()=>await O(()=>import(`./InsightsChartTotal-C5NVUOJ1.js`),__vite__mapDeps([19,4,5,6,14,11,20,21,22,23,24]))),_=c(async()=>await O(()=>import(`./InsightsChartFailed-D7W5bKl9.js`),__vite__mapDeps([25,4,5,6,14,11,20,21,23,22,24]))),v=c(async()=>await O(()=>import(`./InsightsChartFailureRate-C6m6WnzF.js`),__vite__mapDeps([26,4,5,6,14,11,20,21,23,22,24,27,3]))),D=c(async()=>await O(()=>import(`./InsightsChartTimeSaved-drKRWwIk.js`),__vite__mapDeps([28,4,5,6,21,14,11,20,22,23,24,27,3]))),k=c(async()=>await O(()=>import(`./InsightsChartAverageRuntime-CbHQH11k.js`),__vite__mapDeps([29,4,5,6,21,14,11,20,23,22,24,27,3]))),A=c(async()=>await O(()=>import(`./InsightsTableWorkflows-LMKTQPXH.js`),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,23,24,27,31]))),j=e,N=T(),F=w(),R=ee(),B=L(),V=t(()=>N.params.insightType===te.TIME_SAVED),G=t(()=>({total:f,failed:_,failureRate:v,timeSaved:D,averageRunTime:k})),K=({id:e,desc:t})=>`${e}:${t?`desc`:`asc`}`,q=o([{id:j.insightType,desc:!0}]),J=t(()=>{let{start:e,end:t}=Z.value;if(!e||!t)return`day`;let n=t.compare(e);return n<=0?`hour`:n<=30?`day`:`week`}),Y=o(null),X=P(I()),oe=R.dateRanges.toReversed().find(e=>e.licensed)?.key??`week`,se=ne(),ce=t(()=>R.dateRanges.map(e=>({value:U[e.key],label:se[e.key],disabled:!e.licensed}))),le=C(X.copy()),ue=C(X.copy().subtract({days:U[oe]})),Z=C({start:X.copy().subtract({days:7}),end:X.copy()}),Q=()=>W(Z.value),$=({page:e=0,itemsPerPage:t=25,sortBy:n,projectId:r=Y.value?.id})=>{let i=e*t,a=t,o=n.length?K(n[0]):void 0,{startDate:s,endDate:c}=Q();R.table.execute(0,{skip:i,take:a,sortBy:o,startDate:s,endDate:c,projectId:r})};p(()=>[j.insightType,Y.value,Z.value],()=>{q.value=[{id:j.insightType,desc:!0}];let{startDate:e,endDate:t}=Q();R.isSummaryEnabled&&R.summary.execute(0,{startDate:e,endDate:t,projectId:Y.value?.id}),R.charts.execute(0,{startDate:e,endDate:t,projectId:Y.value?.id}),R.isDashboardEnabled&&$({sortBy:q.value,projectId:Y.value?.id})},{immediate:!0}),d(()=>{z().set(F.baseText(`insights.heading`))}),b(async()=>{await B.getAvailableProjects()});let de=/^<([A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,})>$/,fe=t(()=>B.availableProjects.filter(e=>e.name&&!de.test(e.name.trim())));return(e,t)=>(g(),r(`div`,{class:x(e.$style.insightsView)},[S(`div`,{class:x(e.$style.insightsContainer)},[s(a(M),{bold:``,tag:`h2`,size:`xlarge`},{default:m(()=>[y(n(a(F).baseText(`insights.dashboard.title`)),1)]),_:1}),S(`div`,ae,[s(H,{modelValue:Y.value,"onUpdate:modelValue":t[0]||=e=>Y.value=e,projects:fe.value,placeholder:a(F).baseText(`insights.dashboard.search.placeholder`),"empty-options-text":a(F).baseText(`projects.sharing.noMatchingProjects`),size:`mini`,class:x(e.$style.projectSelect),clearable:``,onClear:t[1]||=e=>Y.value=null},null,8,[`modelValue`,`projects`,`placeholder`,`empty-options-text`,`class`]),s(ie,{modelValue:Z.value,"onUpdate:modelValue":t[2]||=e=>Z.value=e,"max-value":le.value,"min-value":ue.value,presets:ce.value},null,8,[`modelValue`,`max-value`,`min-value`,`presets`])]),a(R).isSummaryEnabled?(g(),u(re,{key:0,summary:a(R).summary.state,loading:a(R).summary.isLoading,"start-date":Z.value.start,"end-date":Z.value.end,class:x(e.$style.insightsBanner)},null,8,[`summary`,`loading`,`start-date`,`end-date`,`class`])):i(``,!0),S(`div`,{class:x(e.$style.insightsContent)},[a(R).isDashboardEnabled||V.value?(g(),r(`div`,{key:0,class:x(e.$style.insightsContentWrapper)},[S(`div`,{class:x([e.$style.dataLoader,{[e.$style.isDataLoading]:a(R).charts.isLoading||a(R).table.isLoading}])},[s(a(E)),S(`span`,null,n(a(F).baseText(`insights.chart.loading`)),1)],2),S(`div`,{class:x(e.$style.insightsChartWrapper)},[y(n(J.value)+` `,1),(g(),u(h(G.value[j.insightType]),{type:j.insightType,data:a(R).charts.state,granularity:J.value,"start-date":Z.value.start.toString(),"end-date":Z.value.end.toString()},null,8,[`type`,`data`,`granularity`,`start-date`,`end-date`]))],2),S(`div`,{class:x(e.$style.insightsTableWrapper)},[s(a(A),{"sort-by":q.value,"onUpdate:sortBy":t[3]||=e=>q.value=e,data:a(R).table.state,loading:a(R).table.isLoading,"is-dashboard-enabled":a(R).isDashboardEnabled,"onUpdate:options":$},null,8,[`sort-by`,`data`,`loading`,`is-dashboard-enabled`])],2)],2)):(g(),u(a(l),{key:1}))],2)],2)],2))}}),[[`__cssModules`,{$style:{insightsView:`_insightsView_1mozi_125`,insightsContainer:`_insightsContainer_1mozi_133`,insightsBanner:`_insightsBanner_1mozi_140`,insightsContent:`_insightsContent_1mozi_148`,insightsContentWrapper:`_insightsContentWrapper_1mozi_157`,insightsChartWrapper:`_insightsChartWrapper_1mozi_162`,insightsTableWrapper:`_insightsTableWrapper_1mozi_169`,dataLoader:`_dataLoader_1mozi_175`,isDataLoading:`_isDataLoading_1mozi_188`,projectSelect:`_projectSelect_1mozi_210`,PresetButton:`_PresetButton_1mozi_217`}}]]);export{Y as default};
//# sourceMappingURL=InsightsDashboard--pCqPUvP.js.map