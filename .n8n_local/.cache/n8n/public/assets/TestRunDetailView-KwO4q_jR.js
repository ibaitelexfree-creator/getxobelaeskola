(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`dd25eaab-cb09-401a-b20c-b4b0bf0c98c4`,e._sentryDebugIdIdentifier=`sentry-dbid-dd25eaab-cb09-401a-b20c-b4b0bf0c98c4`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,M as s,P as c,T as l,Z as u,_ as d,bt as f,et as p,h as m,it as ee,j as h,vn as g,w as _}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as te}from"./_MapCache-DjbOQyB7.js";import{Bi as v,Et as ne,Mi as y,Oi as b,Ui as x,Vi as S,Xt as C,ct as re,f as ie,wi as ae,zi as w}from"./src-CppJvwzX.js";import{t as T}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import"./table-BUhHdyzF.js";import{Rr as oe,T as se,yr as ce}from"./users.store-pCkD7Zo0.js";import{Tc as le,rs as ue}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import{t as de}from"./dateFormatter-C82w-7IH.js";import{t as E}from"./orderBy-KAUxkCYD.js";import{t as fe}from"./injectStrict-CjZBqt9B.js";import{t as pe}from"./useWorkflowsCache-DLQfYyl1.js";import{a as me,c as he,i as ge,n as D,o as O,r as k,s as A,t as j}from"./evaluation.constants-CwiQgQMV.js";var M=e(E(),1),N={style:{display:`flex`}},P={style:{display:`flex`,"justify-content":`space-between`,gap:`10px`}},F={style:{display:`inline-flex`,gap:`12px`,"align-items":`center`,"max-width":`100%`}},I=T(c({__name:`TestRunDetailView`,setup(e){let c=ae(),T=ce(),E=se(),I=oe(),L=te(),R=pe(),z=o(!0),B=o([]),V=o(!1),H=t(()=>c.currentRoute.value.params.runId),U=fe(le),_e=t(()=>I.getWorkflowById(U.value)?.name??``),W=o(),G=o(new Set),K=t(()=>E.testRunsById[H.value]),q=t(()=>K.value?.errorDetails),J=t(()=>(0,M.default)(B.value,e=>e.runAt,[`asc`]).map((e,t)=>Object.assign(e,{index:t+1}))),Y=t(()=>G.value.size===J.value.length),ve=t(()=>Object.values((0,M.default)(E.testRunsById,e=>new Date(e.runAt),[`asc`]).filter(({workflowId:e})=>e===U.value)??{}).findIndex(({id:e})=>e===H.value)),X=t(()=>de(new Date(K.value?.runAt).getTime())),ye=e=>{let t=e.executionId;if(t){let{href:e}=c.resolve({name:ue.EXECUTION_PREVIEW,params:{name:U.value,executionId:t}});window.open(e,`_blank`)}},be=t(()=>A(J.value,`inputs`)),Z=t(()=>me(ge(O(K.value,J.value),W.value?.order),W.value?.visibility)),xe=t(()=>[{prop:`index`,width:100,label:L.baseText(`evaluation.runDetail.testCase`),sortable:!0},{prop:`status`,label:L.baseText(`evaluation.listRuns.status`),minWidth:125},...he(Z.value,J.value)]),Q=t(()=>K.value?.metrics??{}),Se=async()=>{if(!(!H.value||!U.value)){z.value=!0;try{let e=await E.getTestRun({workflowId:U.value,runId:H.value}),t=await E.fetchTestCaseExecutions({workflowId:U.value,runId:e.id});B.value=t??[],V.value=t?.some(e=>e.status===`error`),await E.fetchTestRuns(K.value.workflowId)}catch(e){T.showError(e,L.baseText(`evaluation.listRuns.toast.error.fetchTestCases`))}finally{z.value=!1}}};async function Ce(){W.value=await R.getEvaluationPreferences(U.value)}async function $(){W.value&&await R.saveEvaluationPreferences(U.value,W.value)}async function we(e,t){W.value??={order:[],visibility:{}},W.value.visibility[e]=t,await $()}async function Te(e){W.value??={order:[],visibility:{}},W.value.order=e,await $()}function Ee(e){G.value.has(e.id)?G.value.delete(e.id):G.value.add(e.id)}function De(){Y.value?G.value.clear():G.value=new Set(J.value.map(e=>e.id))}return u(async()=>{await Se(),await Ce()}),(e,t)=>(p(),r(`div`,{class:g(e.$style.container),"data-test-id":`test-definition-run-detail`},[_(`div`,{class:g(e.$style.header)},[_(`button`,{class:g(e.$style.backButton),onClick:t[0]||=e=>a(c).back()},[s(a(x),{icon:`arrow-left`}),s(a(w),{size:`large`,bold:!0},{default:f(()=>[h(n(a(L).baseText(`evaluation.listRuns.runListHeader`,{interpolate:{name:_e.value}})),1)]),_:1})],2),_(`span`,{class:g(e.$style.headerSeparator)},`/`,2),s(a(w),{size:`large`,bold:!0},{default:f(()=>[h(n(a(L).baseText(`evaluation.listRuns.testCasesListHeader`,{interpolate:{index:ve.value+1}})),1)]),_:1})],2),K.value?.status===`error`?(p(),l(a(v),{key:0,theme:`danger`,icon:`triangle-alert`,class:`mb-s`},{default:f(()=>[s(a(S),{size:`small`,class:g(e.$style.capitalized)},{default:f(()=>[h(n(a(L).baseText(`${a(j)(K.value?.errorCode)}`,q.value?{interpolate:q.value}:{})??a(L).baseText(`${a(j)(`UNKNOWN_ERROR`)}`)),1)]),_:1},8,[`class`])]),_:1})):i(``,!0),s(a(C),{always:``,class:g([e.$style.scrollableSummary,`mb-m`])},{default:f(()=>[_(`div`,N,[_(`div`,{class:g(e.$style.summaryCard)},[s(a(S),{size:`small`,class:g(e.$style.summaryCardTitle)},{default:f(()=>[h(n(a(L).baseText(`evaluation.runDetail.totalCases`)),1)]),_:1},8,[`class`]),s(a(S),{size:`xlarge`,class:g(e.$style.summaryCardContentLargeNumber),bold:``},{default:f(()=>[h(n(B.value.length),1)]),_:1},8,[`class`])],2),_(`div`,{class:g(e.$style.summaryCard)},[s(a(S),{size:`small`,class:g(e.$style.summaryCardTitle)},{default:f(()=>[h(n(a(L).baseText(`evaluation.runDetail.ranAt`)),1)]),_:1},8,[`class`]),_(`div`,null,[s(a(S),{size:`medium`},{default:f(()=>[h(n(X.value.date)+` `+n(X.value.time),1)]),_:1})])],2),_(`div`,{class:g(e.$style.summaryCard)},[s(a(S),{size:`small`,class:g(e.$style.summaryCardTitle)},{default:f(()=>[h(n(a(L).baseText(`evaluation.listRuns.status`)),1)]),_:1},8,[`class`]),K.value?.status===`completed`&&V.value?(p(),l(a(S),{key:0,size:`medium`,color:`warning`},{default:f(()=>[h(n(a(L).baseText(`evaluation.runDetail.error.partialCasesFailed`)),1)]),_:1})):(p(),l(a(S),{key:1,color:a(D)[K.value?.status]?.color,size:`medium`,class:g(K.value?.status.toLowerCase()),style:{"text-transform":`capitalize`}},{default:f(()=>[h(n(K.value?.status),1)]),_:1},8,[`color`,`class`]))],2),(p(!0),r(d,null,ee(Q.value,(t,i)=>(p(),r(`div`,{key:i,class:g(e.$style.summaryCard)},[s(a(b),{content:i,placement:`top`},{default:f(()=>[s(a(S),{size:`small`,class:g(e.$style.summaryCardTitle),style:{"text-overflow":`ellipsis`,overflow:`hidden`}},{default:f(()=>[h(n(i),1)]),_:2},1032,[`class`])]),_:2},1032,[`content`]),s(a(S),{size:`xlarge`,class:g(e.$style.summaryCardContentLargeNumber),bold:``},{default:f(()=>[h(n(t.toFixed(2)),1)]),_:2},1032,[`class`])],2))),128))])]),_:1},8,[`class`]),_(`div`,{class:g([`mb-s`,e.$style.runsHeader])},[_(`div`,null,[s(a(w),{size:`large`,bold:!0},{default:f(()=>[h(n(a(L).baseText(`evaluation.listRuns.allTestCases`,{interpolate:{count:J.value.length}})),1)]),_:1})]),_(`div`,{class:g(e.$style.runsHeaderButtons)},[s(a(y),{variant:`subtle`,icon:Y.value?`chevrons-down-up`:`chevrons-up-down`,size:`medium`,onClick:De},null,8,[`icon`]),s(a(ie),{size:`medium`,"icon-size":`small`,columns:Z.value,"onUpdate:columnVisibility":we,"onUpdate:columnOrder":Te},null,8,[`columns`])],2)],2),!z.value&&!be.value.length&&K.value?.status===`completed`&&K.value?.finalResult===`success`?(p(),l(a(v),{key:1,theme:`secondary`,icon:`info`,class:`mb-s`},{default:f(()=>[s(a(S),{size:`small`,class:g(e.$style.capitalized)},{default:f(()=>[h(n(a(L).baseText(`evaluation.runDetail.notice.useSetInputs`)),1)]),_:1},8,[`class`])]),_:1})):i(``,!0),z.value?(p(),r(`div`,{key:2,class:g(e.$style.loading)},[s(a(ne),{loading:!0,rows:5})],2)):(p(),l(k,{key:3,data:J.value,columns:xe.value,"default-sort":{prop:`id`,order:`descending`},"expanded-rows":G.value,onRowClick:Ee},{id:f(({row:e})=>[_(`div`,P,n(e.id),1)]),index:f(({row:t})=>[_(`div`,null,[t.executionId?(p(),l(a(re),{key:0,class:`open-execution-link`,onClick:m(e=>ye(t),[`stop`,`prevent`])},{default:f(()=>[h(` #`+n(t.index),1)]),_:2},1032,[`onClick`])):(p(),r(`span`,{key:1,class:g(e.$style.deletedExecutionRowIndex)},`#`+n(t.index),3))])]),status:f(({row:t})=>[_(`div`,F,[s(a(x),{icon:a(D)[t.status].icon,color:a(D)[t.status].color},null,8,[`icon`,`color`]),t.status===`error`?(p(),l(a(b),{key:0,placement:`top`,"show-after":300},{content:f(()=>[h(n(a(L).baseText(`${a(j)(t.errorCode)}`)||t.status),1)]),default:f(()=>[s(a(S),{color:`danger`,class:g(e.$style.capitalized)},{default:f(()=>[h(n(a(L).baseText(`${a(j)(t.errorCode)}`)||t.status),1)]),_:2},1032,[`class`])]),_:2},1024)):(p(),l(a(S),{key:1,class:g(e.$style.capitalized)},{default:f(()=>[h(n(t.status),1)]),_:2},1032,[`class`]))])]),_:1},8,[`data`,`columns`,`expanded-rows`]))],2))}}),[[`__cssModules`,{$style:{container:`_container_1s9s8_125`,header:`_header_1s9s8_132`,timestamp:`_timestamp_1s9s8_138`,backButton:`_backButton_1s9s8_143`,headerSeparator:`_headerSeparator_1s9s8_158`,summary:`_summary_1s9s8_163`,summaryStats:`_summaryStats_1s9s8_166`,stat:`_stat_1s9s8_171`,controls:`_controls_1s9s8_176`,downloadButton:`_downloadButton_1s9s8_182`,runsHeader:`_runsHeader_1s9s8_186`,runsHeaderButtons:`_runsHeaderButtons_1s9s8_193`,loading:`_loading_1s9s8_198`,scrollableSummary:`_scrollableSummary_1s9s8_205`,summaryCard:`_summaryCard_1s9s8_220`,capitalized:`_capitalized_1s9s8_237`,summaryCardTitle:`_summaryCardTitle_1s9s8_245`,summaryCardContentLargeNumber:`_summaryCardContentLargeNumber_1s9s8_256`,alertText:`_alertText_1s9s8_261`,deletedExecutionRowIndex:`_deletedExecutionRowIndex_1s9s8_276`}}],[`__scopeId`,`data-v-d996fa7b`]]);export{I as default};
//# sourceMappingURL=TestRunDetailView-KwO4q_jR.js.map