(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`19fc4784-4b80-4ea9-b92d-bb174e12adb1`,e._sentryDebugIdIdentifier=`sentry-dbid-19fc4784-4b80-4ea9-b92d-bb174e12adb1`)})()}catch{}import{C as e,Cn as t,D as n,E as r,Gt as i,It as a,J as o,M as s,P as c,T as l,Z as u,_ as d,at as f,bt as p,et as m,it as h,j as g,q as _,vn as v,w as y}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as b}from"./_MapCache-DjbOQyB7.js";import{F as x,Pi as S,Ui as C,Vi as w,bt as T,wi as E,zi as D}from"./src-CppJvwzX.js";import{t as O}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as k,fn as A,ws as j,yr as M}from"./users.store-pCkD7Zo0.js";import"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{r as N}from"./_baseOrderBy-El3qbNHQ.js";import"./banners.store-Ce6ZTWqJ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as P}from"./usePageRedirectionHelper-BoF8hzbN.js";import{t as F}from"./useClipboard-Duc7LjuO.js";import"./executions.store-DnLtKXBA.js";import"./assistant.store-BGYzebcZ.js";import"./usePinnedData-C6FFXoty.js";import"./nodeIcon--7uU1Imq.js";import"./canvas.utils-C8dCdoZZ.js";import"./nodeCreator.store-KD9kt9dE.js";import"./useCanvasOperations-BHGWcL34.js";import"./folders.store-CS_gIPIm.js";import"./useRunWorkflow-DzzlHC01.js";import{t as I}from"./pushConnection.store-IFO3HVvG.js";import{t as ee}from"./sortByProperty-B0onItmN.js";import"./readyToRun.store-DM7AW4os.js";import"./aiTemplatesStarterCollection.store-NMq1bc_J.js";import{t as L}from"./ConnectionTracker-JAeLGxUW.js";import{n as te,r as R,t as z}from"./usePushConnection-Bqaw2gmy.js";import{n as B}from"./dist-hhZkOity.js";function V(e){return e.reduce((e,t)=>e+t,0)/e.length}function H(e){return V(e).toFixed(2)}function U(e,t=2){return Number((e/1024/1024/1024).toFixed(t))}function W(e,t=2){return Number((e/1024/1024).toFixed(t))}var G=O(c({__name:`WorkerAccordion`,props:{icon:{default:`list-checks`},iconColor:{default:`text-dark`},initialExpanded:{type:Boolean,default:!0}},setup(e){let t=a(e.initialExpanded);function o(){t.value=!t.value}return(a,c)=>(m(),n(`div`,{class:v([`accordion`,a.$style.container])},[y(`div`,{class:v({[a.$style.header]:!0,[a.$style.expanded]:t.value}),onClick:o},[s(i(C),{icon:e.icon,color:e.iconColor,size:`small`,class:`mr-2xs`},null,8,[`icon`,`color`]),s(i(w),{class:v(a.$style.headerText),color:`text-base`,size:`small`,align:`left`,bold:``},{default:p(()=>[f(a.$slots,`title`)]),_:3},8,[`class`]),s(i(C),{icon:t.value?`chevron-up`:`chevron-down`,bold:``},null,8,[`icon`])],2),t.value?(m(),n(`div`,{key:0,class:v({[a.$style.description]:!0,[a.$style.collapsed]:!t.value})},[f(a.$slots,`content`)],2)):r(``,!0)],2))}}),[[`__cssModules`,{$style:{container:`_container_k0ymr_125`,header:`_header_k0ymr_129`,headerText:`_headerText_k0ymr_135`,expanded:`_expanded_k0ymr_139`,description:`_description_k0ymr_143`}}]]),K=[`href`],q=[`href`],J=O(c({__name:`WorkerJobAccordion`,props:{items:{}},setup(e){let r=e,a=b();function o(e){let t=Math.floor((new Date().getTime()-e.getTime())/1e3),n=Math.floor(t/3600);t-=n*3600;let r=Math.floor(t/60);return t-=r*60,`${n}h ${r}m ${Math.floor(t)}s`}return(c,u)=>(m(),l(G,{icon:`list-checks`,"icon-color":`text-dark`,"initial-expanded":!0},{title:p(()=>[g(t(i(a).baseText(`workerList.item.jobListTitle`))+` (`+t(e.items.length)+`) `,1)]),content:p(()=>[r.items.length>0?(m(),n(`div`,{key:0,class:v(c.$style.accordionItems)},[(m(!0),n(d,null,h(r.items,e=>(m(),n(`div`,{key:e.executionId,class:v(c.$style.accordionItem)},[y(`a`,{href:`/workflow/`+e.workflowId+`/executions/`+e.executionId},` Execution `+t(e.executionId)+` - `+t(e.workflowName),9,K),s(i(w),{color:`text-base`,size:`small`,align:`left`},{default:p(()=>[g(` | Started at: `+t(new Date(e.startedAt)?.toLocaleTimeString())+` | Running for `+t(o(new Date(e.startedAt)))+` `+t(e.retryOf?`| Retry of: ${e.retryOf}`:``)+` | `,1)]),_:2},1024),y(`a`,{target:`_blank`,href:`/workflow/`+e.workflowId},` (Open workflow)`,8,q)],2))),128))],2)):(m(),n(`div`,{key:1,class:v(c.$style.accordionItems)},[y(`span`,{class:v(c.$style.empty)},t(i(a).baseText(`workerList.item.jobList.empty`)),3)],2))]),_:1}))}}),[[`__cssModules`,{$style:{accordionItems:`_accordionItems_1mb6o_125`,accordionItem:`_accordionItem_1mb6o_125`,empty:`_empty_1mb6o_138`}}]]),Y=[`onClick`],X=O(c({__name:`WorkerNetAccordion`,props:{items:{}},setup(e){let a=e,o=b(),s=F(),{showMessage:c}=M();function u(e){try{s.copy(e),c({title:o.baseText(`workerList.item.copyAddressToClipboard`),type:`success`})}catch{}}return(s,c)=>(m(),l(G,{icon:`list-checks`,"icon-color":`text-dark`,"initial-expanded":!1},{title:p(()=>[g(t(i(o).baseText(`workerList.item.netListTitle`))+` (`+t(e.items.length)+`) `,1)]),content:p(()=>[a.items.length>0?(m(),n(`div`,{key:0,class:v(s.$style.accordionItems)},[(m(!0),n(d,null,h(a.items,e=>(m(),n(`div`,{key:e.address,class:v(s.$style.accordionItem),onClick:t=>u(e.address)},[g(t(e.family)+`: `,1),y(`span`,{class:v(s.$style.clickable)},t(e.address),3),g(` `+t(e.internal?`(internal)`:``),1)],10,Y))),128))],2)):r(``,!0)]),_:1}))}}),[[`__cssModules`,{$style:{accordionItems:`_accordionItems_tq3dn_125`,accordionItem:`_accordionItem_tq3dn_125`,clickable:`_clickable_tq3dn_139`}}]]),Z=O(c({__name:`WorkerChartsAccordion`,props:{workerId:{}},setup(e){let n=e,r=b(),o=(e,t,n=0)=>({datasets:[{label:e,backgroundColor:t,data:n?Array(Math.min(100,n)).fill(0):[]}],labels:Array(Math.min(100,n)).fill(``)}),c=R(),u=a(void 0),d=a(void 0),f=a(void 0),h=()=>({responsive:!0,maintainAspectRatio:!0,scales:{y:{type:`linear`,display:!0,position:`left`,min:0,suggestedMax:5}}}),_=h(),x=h();x.scales?.y&&(x.scales.y.suggestedMax=100);let S=h();S.scales?.y&&(S.scales.y.suggestedMax=100);let C=a(o(`Job Count`,`rgb(255, 111, 92)`,100)),w=a(o(`Processor Usage`,`rgb(19, 205, 103)`,100)),T=a(o(`Memory Usage (%)`,`rgb(244, 216, 174)`,100));return c.$onAction(({name:e,store:t})=>{if(e===`updateWorkerStatus`){let e=100-(t.workersHistory[n.workerId]?.length??0),r=o(`Job Count`,`rgb(255, 111, 92)`,e),i=o(`Processor Usage`,`rgb(19, 205, 103)`,e),a=o(`Memory Usage (%)`,`rgb(244, 216, 174)`,e);t.workersHistory[n.workerId]?.forEach(e=>{r.datasets[0].data.push(e.data.runningJobsSummary.length),r.labels?.push(new Date(e.timestamp).toLocaleTimeString()),i.datasets[0].data.push(V(e.data.loadAvg)),i.labels=r.labels,a.labels=r.labels;let t=e.data.isInContainer?e.data.process.memory.constraint:e.data.host.memory.total,n=(t-e.data.process.memory.available)/t*100;a.datasets[0].data.push(n)}),C.value=r,w.value=i,T.value=a}}),(e,n)=>(m(),l(G,{icon:`list-checks`,"icon-color":`text-dark`,"initial-expanded":!1},{title:p(()=>[g(t(i(r).baseText(`workerList.item.chartsTitle`)),1)]),content:p(()=>[y(`div`,{class:v(e.$style.charts)},[s(i(B),{ref_key:`chartRefJobs`,ref:u,type:`line`,data:C.value,options:i(_),class:v(e.$style.chart)},null,8,[`data`,`options`,`class`]),s(i(B),{ref_key:`chartRefCPU`,ref:d,type:`line`,data:w.value,options:i(x),class:v(e.$style.chart)},null,8,[`data`,`options`,`class`]),s(i(B),{ref_key:`chartRefMemoryUsage`,ref:f,type:`line`,data:T.value,options:i(S),class:v(e.$style.chart)},null,8,[`data`,`options`,`class`])],2)]),_:1}))}}),[[`__cssModules`,{$style:{accordionItems:`_accordionItems_16rh4_125`,accordionItem:`_accordionItem_16rh4_125`,charts:`_charts_16rh4_138`,chart:`_chart_16rh4_138`}}]]),Q={key:0},ne=O(c({__name:`WorkerMemoryMonitorAccordion`,props:{worker:{}},setup(e){let a=e,o=b();return(s,c)=>(m(),l(G,{icon:`list-checks`,"icon-color":`text-dark`,"initial-expanded":!1},{title:p(()=>[g(t(i(o).baseText(`workerList.item.memoryMonitorTitle`)),1)]),content:p(()=>[y(`div`,{class:v(s.$style[`accordion-content`])},[c[7]||=y(`strong`,null,`Host/OS Memory:`,-1),y(`table`,null,[y(`tbody`,null,[y(`tr`,null,[c[0]||=y(`th`,null,`Total (os.totalmem)`,-1),y(`td`,null,t(i(U)(a.worker.host.memory.total))+`GB`,1)]),y(`tr`,null,[c[1]||=y(`th`,null,`Free (os.freemem)`,-1),y(`td`,null,t(i(U)(a.worker.host.memory.free))+`GB`,1)])])]),c[8]||=y(`br`,null,null,-1),c[9]||=y(`strong`,null,`Process Memory:`,-1),c[10]||=y(`br`,null,null,-1),y(`table`,null,[y(`tbody`,null,[e.worker.isInContainer?(m(),n(`tr`,Q,[c[2]||=y(`th`,null,`Constraint: (process.constrainedMemory)`,-1),y(`td`,null,t(i(W)(a.worker.process.memory.constraint))+`MB`,1)])):r(``,!0),y(`tr`,null,[c[3]||=y(`th`,null,`Available: (process.availableMemory)`,-1),y(`td`,null,t(i(W)(a.worker.process.memory.available))+`MB`,1)]),y(`tr`,null,[c[4]||=y(`th`,null,`RSS: (process.memoryUsage().rss)`,-1),y(`td`,null,t(i(W)(a.worker.process.memory.rss))+`MB`,1)]),y(`tr`,null,[c[5]||=y(`th`,null,`Heap total: (process.memoryUsage().heapTotal)`,-1),y(`td`,null,t(i(W)(a.worker.process.memory.heapTotal))+`MB`,1)]),y(`tr`,null,[c[6]||=y(`th`,null,`Heap used: (process.memoryUsage().heapUsed)`,-1),y(`td`,null,t(i(W)(a.worker.process.memory.heapUsed))+`MB`,1)])])])],2)]),_:1}))}}),[[`__cssModules`,{$style:{"accordion-content":`_accordion-content_1lqir_135`}}]]),re=O(c({__name:`WorkerCard`,props:{workerId:{}},setup(n){let c,d=R(),f=b(),h=n,_=a(`0`),x=a(!1),S=e(()=>d.getWorkerStatus(h.workerId)),C=e(()=>ee(`family`,S.value?.interfaces.slice()??[]));function E(e){let t=Math.floor(e/(3600*24));e-=t*3600*24;let n=Math.floor(e/3600);e-=n*3600;let r=Math.floor(e/60);return e-=r*60,`${t}d ${n}h ${r}m ${Math.floor(e)}s`}return u(()=>{c=setInterval(()=>{let e=d.getWorkerLastUpdated(h.workerId);if(!e)return;let t=Math.ceil((Date.now()-e)/1e3);x.value=t>10,_.value=t.toFixed(0)},500)}),o(()=>{clearInterval(c)}),(e,n)=>S.value?(m(),l(i(T),{key:0,class:v(e.$style.cardLink)},{header:p(()=>[s(i(D),{tag:`h2`,bold:``,class:v(x.value?[e.$style.cardHeading,e.$style.stale]:[e.$style.cardHeading]),"data-test-id":`worker-card-name`},{default:p(()=>[g(` Name: `+t(S.value.senderId)+` (`+t(S.value.hostname)+`) `,1),n[0]||=y(`br`,null,null,-1),g(` Average Load: `+t(i(H)(S.value.loadAvg??[0]))+` | Free memory: `+t(i(U)(S.value.process.memory.available))+`GB / `+t(i(U)(S.value.isInContainer?S.value.process.memory.constraint:S.value.host.memory.total))+`GB `+t(x.value?` (stale)`:``),1)]),_:1},8,[`class`])]),append:p(()=>[y(`div`,{ref:`cardActions`,class:v(e.$style.cardActions)},null,2)]),default:p(()=>[y(`div`,{class:v(e.$style.cardDescription)},[s(i(w),{color:`text-light`,size:`small`,class:v(e.$style.container)},{default:p(()=>[y(`span`,null,t(i(f).baseText(`workerList.item.lastUpdated`))+` `+t(_.value)+`s ago | n8n-Version: `+t(S.value.version)+` | Architecture: `+t(S.value.arch)+` ( `+t(S.value.platform)+`) | Uptime: `+t(E(S.value.uptime)),1),n[1]||=y(`br`,null,null,-1),s(J,{items:S.value.runningJobsSummary},null,8,[`items`]),s(X,{items:C.value},null,8,[`items`]),s(Z,{"worker-id":S.value.senderId},null,8,[`worker-id`]),s(ne,{worker:S.value},null,8,[`worker`])]),_:1},8,[`class`])],2)]),_:1},8,[`class`])):r(``,!0)}}),[[`__cssModules`,{$style:{container:`_container_znmwg_125`,cardLink:`_cardLink_znmwg_129`,cardHeading:`_cardHeading_znmwg_139`,stale:`_stale_znmwg_145`,cardDescription:`_cardDescription_znmwg_149`,cardActions:`_cardActions_znmwg_156`}}]]),ie={key:0},ae={key:1},oe={key:0},$={key:1},se=O(c({__name:`WorkerList`,props:{autoRefreshEnabled:{type:Boolean,default:!0}},setup(r){let a=E(),c=b(),l=z({router:a}),f=A(),S=k(),C=R(),w=N(),T=I(),O=e(()=>C.initialStatusReceived),j=e(()=>Object.keys(C.workers)),M=e(()=>c.baseText(`workerList.pageTitle`));return u(()=>{f.set(M.value),S.track(`User viewed worker view`,{instance_id:w.instanceId})}),_(()=>{l.initialize(),T.pushConnect(),C.startWorkerStatusPolling()}),o(()=>{C.stopWorkerStatusPolling(),T.pushDisconnect(),l.terminate()}),(e,r)=>(m(),n(`div`,null,[s(L,{class:`actions`}),y(`div`,{class:v(e.$style.workerListHeader)},[s(i(D),{tag:`h1`,size:`2xlarge`},{default:p(()=>[g(t(M.value),1)]),_:1})],2),O.value?(m(),n(`div`,ae,[j.value.length===0?(m(),n(`div`,oe,t(i(c).baseText(`workerList.empty`)),1)):(m(),n(`div`,$,[(m(!0),n(d,null,h(j.value,t=>(m(),n(`div`,{key:t,class:v(e.$style.card)},[s(re,{"worker-id":t,"data-test-id":`worker-card`},null,8,[`worker-id`])],2))),128))]))])):(m(),n(`div`,ie,[s(i(x))]))]))}}),[[`__cssModules`,{$style:{workerListHeader:`_workerListHeader_ifjfd_125`,card:`_card_ifjfd_132`,tableLoader:`_tableLoader_ifjfd_136`}}]]),ce=[`href`],le=O(c({__name:`WorkerView`,setup(e){let n=j(),r=P(),a=b(),o=()=>{r.goToUpgrade(`worker-view`,`upgrade-worker-view`)};return(e,r)=>i(n).isQueueModeEnabled&&i(n).isWorkerViewAvailable?(m(),l(se,{key:0,"data-test-id":`worker-view-licensed`})):(m(),l(i(S),{key:1,"data-test-id":`worker-view-unlicensed`,class:v(e.$style.actionBox),description:i(a).baseText(`workerList.actionBox.description`),"button-text":i(a).baseText(`workerList.actionBox.buttonText`),"onClick:button":o},{heading:p(()=>[y(`span`,null,t(i(a).baseText(`workerList.actionBox.title`)),1)]),description:p(()=>[g(t(i(a).baseText(`workerList.actionBox.description`))+` `,1),y(`a`,{href:i(a).baseText(`workerList.docs.url`),target:`_blank`},t(i(a).baseText(`workerList.actionBox.description.link`)),9,ce)]),_:1},8,[`class`,`description`,`button-text`]))}}),[[`__cssModules`,{$style:{actionBox:`_actionBox_t24gt_125`}}]]);export{le as default};
//# sourceMappingURL=WorkerView-BClIeTcJ.js.map