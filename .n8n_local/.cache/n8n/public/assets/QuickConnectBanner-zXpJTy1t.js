(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`3edbd076-f294-40e6-bc0b-308b47991802`,e._sentryDebugIdIdentifier=`sentry-dbid-3edbd076-f294-40e6-bc0b-308b47991802`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,G as a,Gt as o,It as s,M as c,P as l,T as u,Ut as d,Z as f,_ as p,_t as m,bt as h,c as g,et as _,j as v,k as y,vn as b,w as x}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{gt as S,yt as C}from"./_MapCache-DjbOQyB7.js";import{Bi as w,Hi as T,Ui as E,Vi as D,gi as O,wi as k}from"./src-CppJvwzX.js";import{t as A}from"./_plugin-vue_export-helper-B_J4Khre.js";import{C as j,Lt as M,R as N,r as P,rt as F,s as I,t as L,yr as R}from"./users.store-pCkD7Zo0.js";import{Ua as z,rs as B}from"./constants-D1jZwsUK.js";import{n as V}from"./exports--h7UC0Af.js";import{n as H,t as U}from"./semver-DulOjSKL.js";import{t as W}from"./useCanvasOperations-BHGWcL34.js";function G(){let e=H(),n=j(),r=F(),i=I(),o=t(()=>L().isInstanceOwner),c=s(!1),l=R(),u=W(),d=M(),f=async e=>{let t=await n.getCommunityNodeAttributes(e);if(t)return t.npmVersion};return{installNode:async t=>{if(!o.value){let e=Error(`User is not an owner`);return l.showError(e,S.baseText(`settings.communityNodes.messages.install.error`)),{success:!1,error:e}}t.telemetry&&d.track(`user started cnr package install`,{input_string:t.packageName,has_quick_connect:t.telemetry.hasQuickConnect,source:t.telemetry.source});try{c.value=!0,t.type===`verified`?await e.installPackage(t.packageName,!0,await f(t.nodeType)):await e.installPackage(t.packageName),await Promise.all([n.getNodeTypes(),n.fetchCommunityNodePreviews(),r.fetchCredentialTypes(!0)]),await a();let o=t.nodeType;if(o&&i.workflow.nodes?.length){let e=i.workflow.nodes.filter(e=>e.type===N(o));u.initializeUnknownNodes(e)}return l.showMessage({title:S.baseText(`settings.communityNodes.messages.install.success`),type:`success`}),{success:!0}}catch(e){return l.showError(e,S.baseText(`settings.communityNodes.messages.install.error`)),{success:!1,error:e}}finally{c.value=!1}},loading:c}}var K=e(U(),1);async function q(e){let t=await H().getInstalledPackage(e),n=j().communityNodeType(e);if(!t)return;let r=()=>!t?.updateAvailable||!n?!1:K.default.gt(t.updateAvailable,n.npmVersion);return{...t,unverifiedUpdate:r()}}function J(e){let n=H(),r=L(),i=s(void 0),a=t(()=>d(e)?.split(`.`)[0]??``),o=t(()=>{let t=d(e);return t?z(t):!1}),c=async()=>{if(!(!a.value||!o.value))return i.value=await q(a.value),i.value};return m(()=>n.installedPackages[a.value],async e=>{!a.value||!e||await c()},{deep:!0}),f(async()=>{!a.value||!o.value||await c()}),{installedPackage:i,isUpdateCheckAvailable:t(()=>o.value&&r.isInstanceOwner&&!i.value?.unverifiedUpdate),isCommunityNode:o,initInstalledPackage:c}}var Y={style:{"padding-bottom":`8px`}},X=A(l({__name:`ContactAdministratorToInstall`,props:{box:{type:Boolean}},setup(e){let a=e,s=g(),l=L(),d=C(),p=t(()=>l.allUsers.filter(e=>e.role?.includes(`owner`)).map(e=>e.email)),m=t(()=>({[s.contactOwnerHint]:!0,[s.border]:a.box}));return f(async()=>{await l.fetchUsers({filter:{isOwner:!0}})}),(e,t)=>(_(),r(`div`,{class:b(m.value)},[a.box?(_(),u(o(E),{key:0,color:`text-light`,icon:`info`,size:`large`})):i(``,!0),c(o(D),{color:`text-base`,size:`medium`},{default:h(()=>[x(`div`,Y,n(o(d).baseText(`communityNodeInfo.contact.admin`)),1),p.value.length?(_(),u(o(D),{key:0,bold:``},{default:h(()=>[v(n(p.value.join(`, `)),1)]),_:1})):i(``,!0)]),_:1})],2))}}),[[`__cssModules`,{$style:{contactOwnerHint:`_contactOwnerHint_qnrnx_125`,border:`_border_qnrnx_133`}}]]),Z=A(l({__name:`CommunityNodeFooter`,props:{packageName:{},showManage:{type:Boolean}},setup(e){let t=e,a=k(),l=s(`https://registry.npmjs.org/${t.packageName}`),{installedPackage:d}=J(t.packageName);async function m(){await a.push({name:B.COMMUNITY_NODES})}async function g(){l.value&&window.open(l.value,`_blank`)}async function y(e){let t=`https://registry.npmjs.org/${e}`;try{let e=await fetch(t);if(!e.ok)throw Error(`Could not get metadata for package`);let n=await e.json();n.bugs?.url&&(l.value=n.bugs.url)}catch(e){V(e)}}return f(async()=>{t.packageName&&await y(t.packageName)}),(e,a)=>(_(),r(`div`,null,[x(`div`,{class:b(e.$style.separator)},null,2),x(`div`,{class:b(e.$style.container)},[o(d)?(_(),u(o(D),{key:0,size:`small`,color:`text-light`,style:{"margin-right":`auto`}},{default:h(()=>[v(` Package version `+n(o(d).installedVersion)+` (`+n(o(d).updateAvailable&&!o(d).unverifiedUpdate?o(S).baseText(`communityNodeFooter.legacy`):o(S).baseText(`nodeSettings.latest`))+`) `,1)]),_:1})):i(``,!0),t.showManage?(_(),r(p,{key:1},[c(o(O),{theme:`text`,onClick:m},{default:h(()=>[c(o(D),{size:`small`,color:`primary`,bold:``},{default:h(()=>[v(n(o(S).baseText(`communityNodeFooter.manage`)),1)]),_:1})]),_:1}),c(o(D),{size:`small`,style:{color:`var(--color--foreground)`},bold:``},{default:h(()=>[...a[0]||=[v(`|`,-1)]]),_:1})],64)):i(``,!0),c(o(O),{theme:`text`,onClick:g},{default:h(()=>[c(o(D),{size:`small`,color:`primary`,bold:``},{default:h(()=>[v(n(o(S).baseText(`communityNodeFooter.reportIssue`)),1)]),_:1})]),_:1})],2)]))}}),[[`__cssModules`,{$style:{container:`_container_b6vvo_125`,separator:`_separator_b6vvo_133`}}]]),Q=l({__name:`CommunityNodeUpdateInfo`,props:{packageName:{},source:{}},setup(e){let t=e,{openCommunityPackageUpdateConfirmModal:r}=P(),i=()=>{t.packageName&&r(t.packageName,t.source)};return(e,r)=>(_(),u(o(w),{theme:`secondary`,iconless:!0,style:{"margin-bottom":`var(--spacing--sm)`}},y({default:h(()=>[v(n(o(S).baseText(`communityNodeUpdateInfo.available`))+` `,1)]),_:2},[t.packageName?{name:`trailingContent`,fn:h(()=>[c(o(T),{variant:`subtle`,onClick:i},{default:h(()=>[v(n(o(S).baseText(`generic.update`)),1)]),_:1})]),key:`0`}:void 0]),1024))}}),$=l({__name:`QuickConnectBanner`,props:{text:{}},setup(e){return(t,r)=>(_(),u(o(w),{theme:`secondary`,iconless:``,"data-test-id":`quick-connect-banner`},{default:h(()=>[v(n(e.text),1)]),_:1}))}});export{J as a,X as i,Q as n,G as o,Z as r,$ as t};
//# sourceMappingURL=QuickConnectBanner-zXpJTy1t.js.map