!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"n8n@2.9.4"}}catch(e){}}(),System.register(["./chunk-legacy-BCpDjeTS.js","./vue.runtime.esm-bundler-legacy-BquwEXRp.js","./_MapCache-legacy-BR_CVmoL.js","./src-legacy-kcwUfEuS.js","./_plugin-vue_export-helper-legacy-DtDV0xrP.js","./sanitize-html-legacy-rns0ELH_.js","./users.store-legacy-B-bVJKl3.js","./constants-legacy-DVkAm8xO.js","./merge-legacy-C4nCP5az.js","./_baseOrderBy-legacy-BnyL5wLN.js","./dateformat-legacy-BvMRGS_P.js","./useDebounce-legacy-BSzeAS4U.js","./roles.store-legacy-DOWLLO4H.js"],(function(e,t){var a,l,o,s,r,c,n,i,d,u,p,b,m,f,_,y,v,x,g,j,h,R,T,w,k,C,$,N,E,B,S,V,U,P,I,L,D,O,z,M,W,G,H;return{setters:[function(e){a=e.o},function(e){l=e.Bt,o=e.C,s=e.Cn,r=e.D,c=e.E,n=e.Gt,i=e.It,d=e.M,u=e.P,p=e.T,b=e._,m=e.bt,f=e.et,_=e.it,y=e.j,v=e.vn,x=e.w},function(e){g=e.x,j=e.yt},function(e){h=e.Ci,R=e.Et,T=e.Hi,w=e.Oi,k=e.Vi,C=e.at,$=e.wi,N=e.zi},function(e){E=e.t},function(e){},function(e){B=e.Lt,S=e.Tr,V=e.Z,U=e.yr},function(e){P=e.Po,I=e.Ss,L=e.rs},function(e){},function(e){},function(e){},function(e){},function(e){D=e.t}],execute:function(){(O=document.createElement("style")).textContent="._container_14r2u_2{flex-direction:column;max-width:700px;margin:0 auto;display:flex}._cardContainer_14r2u_9{border:var(--border);background-color:var(--color--background--light-3);border-radius:4px;padding:8px 16px}._cardContainer_14r2u_9 .el-skeleton__p{margin-top:0;margin-bottom:8px}._card_14r2u_9{display:flex}._card_14r2u_9:not(:last-child){border-bottom:var(--border)}._cardTitle_14r2u_28{width:133px}._backButton_14r2u_32{position:absolute;top:10px;left:10px}._headerContainer_14r2u_38{justify-content:space-between;align-items:center;display:flex}._formContainer_14r2u_44{max-width:415px}._presetsContainer_14r2u_48{gap:8px;display:flex}._checkbox_14r2u_53{margin-bottom:0!important;display:inline-flex!important}._checkbox_14r2u_53 label{padding-bottom:0!important}\n/*$vite$:1*/",document.head.appendChild(O);try{t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},(J=(new t.Error).stack)&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[J]="663ad102-7158-4f09-a6b7-29c1fc71b92b",t._sentryDebugIdIdentifier="sentry-dbid-663ad102-7158-4f09-a6b7-29c1fc71b92b")}catch(t){}var t,J;z=a(P(),1),M=a(V(),1),W={key:0},G={style:{flex:"1"}},H={key:1,class:"mt-xl"},e("default",E(u({__name:"ProjectRoleView",props:{roleSlug:{}},setup(e){const t=D(),a=h(),u=$(),{showError:E,showMessage:V}=U(),P=j(),O=S(),J=B(),q=e,Z=()=>({displayName:"",description:"",scopes:structuredClone(l(t.processedProjectRoles.find((e=>"project:viewer"===e.slug))?.scopes||[]))}),A=i(),{state:Q,isLoading:Y}=g((async()=>{if(!q.roleSlug)return Z();try{const e=await t.fetchRoleBySlug({slug:q.roleSlug});return A.value=structuredClone(e),{displayName:e.displayName,description:e.description,scopes:e.scopes}}catch(e){return E(e,"Error fetching role"),Z()}}),Z(),{shallow:!1}),F=o((()=>!0===A.value?.systemRole||a.name===L.PROJECT_ROLE_VIEW)),K=o((()=>!(!A.value||(0,z.default)(A.value.displayName,Q.value.displayName)&&(0,z.default)(A.value.description??null,Q.value.description||null)&&(0,z.default)((0,M.default)(A.value.scopes),(0,M.default)(Q.value.scopes))))),X=["read","update","delete"].map((e=>`project:${e}`)),ee=["read","update","create","move","delete"].map((e=>`folder:${e}`)),te=["read","update","create","publish","unpublish","move","delete"].map((e=>`workflow:${e}`)),ae=["read","update","create","share","move","delete"].map((e=>`credential:${e}`)),le=["push"].map((e=>`sourceControl:${e}`)),oe=["read","readRow","update","writeRow","create","delete"].map((e=>`dataTable:${e}`)),se=["read","update","create","delete"].map((e=>`projectVariable:${e}`)),re=["project","folder","workflow","credential","dataTable","projectVariable","sourceControl"],ce={project:X,folder:ee,workflow:te,credential:ae,sourceControl:le,dataTable:oe,projectVariable:se};function ne(e){const t=Q.value.scopes.indexOf(e);-1!==t?Q.value.scopes.splice(t,1):Q.value.scopes.push(e),e.startsWith("dataTable:")&&e.endsWith(":read")?ne(e.replace(":read",":listProject")):(e.endsWith(":read")&&ne(e.replace(":read",":list")),"workflow:update"===e&&ne("workflow:execute"))}async function ie(e){if(await async function(e){return!e||await O.confirm(P.baseText("projectRoles.action.update.text",{interpolate:{count:e}}),P.baseText("projectRoles.action.update.title",{interpolate:{count:e}}),{type:"warning",confirmButtonText:P.baseText("projectRoles.action.update"),cancelButtonText:P.baseText("projectRoles.action.cancel")})===I}(A?.value?.usedByUsers))try{const a=await t.updateProjectRole(e,{...Q.value,description:Q.value.description??void 0});return t.fetchRoles(),J.track("User updated role",{role_id:a.slug,role_name:a.displayName,permissions_from:A.value?.scopes,permissions_to:a.scopes}),A.value=structuredClone(a),V({type:"success",message:P.baseText("projectRoles.action.update.success")}),a}catch(a){return void E(a,P.baseText("projectRoles.action.update.error"))}}async function de(){q.roleSlug?await ie(q.roleSlug):await async function(){try{const e=await t.createProjectRole({...Q.value,description:Q.value.description??void 0,roleType:"project"});return t.fetchRoles(),J.track("User successfully created new role",{role_id:e.slug,role_name:e.displayName,permissions:e.scopes}),u.replace({name:L.PROJECT_ROLE_SETTINGS,params:{roleSlug:e.slug}}),V({type:"success",message:P.baseText("projectRoles.action.create.success")}),A.value=structuredClone(e),e}catch(e){return void E(e,P.baseText("projectRoles.action.create.error"))}}()}function ue(e){const a=t.processedProjectRoles.find((t=>t.slug===e));a&&(Q.value.scopes=structuredClone(l(a.scopes)))}async function pe(){if(A?.value&&"confirm"===await O.confirm(P.baseText("projectRoles.action.delete.text",{interpolate:{roleName:A.value.displayName}}),P.baseText("projectRoles.action.delete.title",{interpolate:{roleName:A.value.displayName}}),{type:"warning",confirmButtonText:P.baseText("projectRoles.action.delete"),cancelButtonText:P.baseText("projectRoles.action.cancel")})){J.track("User clicked delete role",{role_id:A.value.slug,role_name:A.value.displayName,permissions:A.value?.scopes});try{await t.deleteProjectRole(A.value.slug);const e=t.roles.project.findIndex((e=>e.slug===A.value?.slug));-1!==e&&t.roles.project.splice(e,1),V({title:P.baseText("projectRoles.action.delete.success"),type:"success"}),J.track("User successfully deleted role",{role_id:A.value.slug,role_name:A.value.displayName,permissions:A.value?.scopes}),u.back()}catch(e){return void E(e,P.baseText("projectRoles.action.delete.error"))}}}const be=[{name:"REQUIRED"},{name:"MIN_LENGTH",config:{minimum:2}}];return(t,a)=>(f(),r("div",{class:v(["pb-xl",t.$style.container])},[d(n(T),{variant:"ghost",icon:"arrow-left",class:v(t.$style.backButton),onClick:a[0]||(a[0]=()=>n(u).back())},{default:m((()=>[y(s(n(P).baseText("projectRoles.backToRoleList")),1)])),_:1},8,["class"]),x("div",{class:v(["mb-xl",t.$style.headerContainer])},[d(n(N),{tag:"h1",size:"2xlarge"},{default:m((()=>[y(s(e.roleSlug?`Role "${n(Q).displayName}"`:n(P).baseText("projectRoles.newRole")),1)])),_:1}),A.value&&!F.value?(f(),r("div",W,[d(n(T),{variant:"subtle",disabled:!K.value,class:"mr-xs",onClick:a[1]||(a[1]=e=>{return t=A.value,void(Q.value=t?{displayName:t.displayName,description:t.description,scopes:t.scopes}:Z());var t})},{default:m((()=>[y(s(n(P).baseText("projectRoles.discardChanges")),1)])),_:1},8,["disabled"]),d(n(T),{disabled:!K.value,onClick:de},{default:m((()=>[y(s(n(P).baseText("projectRoles.save")),1)])),_:1},8,["disabled"])])):A.value?c("",!0):(f(),p(n(T),{key:1,onClick:de},{default:m((()=>[y(s(n(P).baseText("projectRoles.create")),1)])),_:1}))],2),x("div",{class:v(["mb-l",t.$style.formContainer])},[d(n(C),{modelValue:n(Q).displayName,"onUpdate:modelValue":a[2]||(a[2]=e=>n(Q).displayName=e),label:n(P).baseText("projectRoles.roleName"),"validate-on-blur":"","validation-rules":be,class:"mb-s","show-required-asterisk":"",required:"",maxlength:100,disabled:F.value},null,8,["modelValue","label","disabled"]),d(n(C),{modelValue:n(Q).description,"onUpdate:modelValue":a[3]||(a[3]=e=>n(Q).description=e),label:n(P).baseText("projectRoles.description"),placeholder:n(P).baseText("projectRoles.optional"),type:"textarea",maxlength:500,autosize:{minRows:2,maxRows:4},disabled:F.value},null,8,["modelValue","label","placeholder","disabled"])],2),d(n(N),{tag:"h2",size:"xlarge",class:"mb-s"},{default:m((()=>[y(s(n(P).baseText("projectRoles.permissions")),1)])),_:1}),F.value?c("",!0):(f(),r(b,{key:0},[d(n(k),{color:"text-light",class:"mb-2xs",tag:"p"},{default:m((()=>[y(s(n(P).baseText("projectRoles.preset")),1)])),_:1}),x("div",{class:v(["mb-s",t.$style.presetsContainer])},[d(n(T),{variant:"subtle",onClick:a[4]||(a[4]=e=>ue("project:admin"))},{default:m((()=>[y(s(n(P).baseText("projectRoles.admin")),1)])),_:1}),d(n(T),{variant:"subtle",onClick:a[5]||(a[5]=e=>ue("project:editor"))},{default:m((()=>[y(s(n(P).baseText("projectRoles.editor")),1)])),_:1}),d(n(T),{variant:"subtle",onClick:a[6]||(a[6]=e=>ue("project:viewer"))},{default:m((()=>[y(s(n(P).baseText("projectRoles.viewer")),1)])),_:1})],2)],64)),x("div",{class:v(t.$style.cardContainer)},[(f(),r(b,null,_(re,(e=>x("div",{key:e,class:v(["mb-s mt-s",t.$style.card])},[x("div",{class:v(t.$style.cardTitle)},s(n(P).baseText(`projectRoles.type.${e}`)),3),x("div",G,[n(Y)?(f(),p(n(R),{key:0,rows:ce[e].length,"shrink-last":!1},null,8,["rows"])):(f(!0),r(b,{key:1},_(ce[e],(e=>(f(),r("div",{key:e,class:"mb-2xs"},[d(n(w),{content:n(P).baseText(`projectRoles.${e}.tooltip`),placement:"right",enterable:!1,"show-after":250},{default:m((()=>[d(n(C),{"data-test-id":`scope-checkbox-${e}`,"model-value":n(Q).scopes.includes(e),label:n(P).baseText(`projectRoles.${e}`),"validate-on-blur":"",type:"checkbox",class:v(t.$style.checkbox),disabled:F.value,"onUpdate:modelValue":()=>ne(e)},null,8,["data-test-id","model-value","label","class","disabled","onUpdate:modelValue"])])),_:2},1032,["content"])])))),128))])],2))),64))],2),e.roleSlug&&!F.value?(f(),r("div",H,[d(n(N),{tag:"h2",class:"mb-2xs",size:"large"},{default:m((()=>[y(s(n(P).baseText("projectRoles.dangerZone")),1)])),_:1}),d(n(k),{tag:"p",class:"mb-s"},{default:m((()=>[A.value?.usedByUsers?(f(),r(b,{key:0},[y(s(n(P).baseText("projectRoles.action.delete.useWarning",{interpolate:{count:A.value.usedByUsers}})),1)],64)):(f(),r(b,{key:1},[y(s(n(P).baseText("projectRoles.action.delete.warning")),1)],64))])),_:1}),d(n(T),{variant:"destructive",disabled:Boolean(A.value?.usedByUsers),onClick:pe},{default:m((()=>[y(s(n(P).baseText("projectRoles.action.delete.button")),1)])),_:1},8,["disabled"])])):c("",!0)],2))}}),[["__cssModules",{$style:{container:"_container_14r2u_2",cardContainer:"_cardContainer_14r2u_9",card:"_card_14r2u_9",cardTitle:"_cardTitle_14r2u_28",backButton:"_backButton_14r2u_32",headerContainer:"_headerContainer_14r2u_38",formContainer:"_formContainer_14r2u_44",presetsContainer:"_presetsContainer_14r2u_48",checkbox:"_checkbox_14r2u_53"}}]]))}}}));
//# sourceMappingURL=ProjectRoleView-legacy-xVHEaRH_.js.map