!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"n8n@2.9.4"}}catch(e){}}(),System.register(["./chunk-legacy-BCpDjeTS.js","./vue.runtime.esm-bundler-legacy-BquwEXRp.js","./_MapCache-legacy-BR_CVmoL.js","./src-legacy-kcwUfEuS.js","./_plugin-vue_export-helper-legacy-DtDV0xrP.js","./users.store-legacy-B-bVJKl3.js","./constants-legacy-DVkAm8xO.js","./useCanvasOperations-legacy-CEMGNuuE.js","./NodeIcon-legacy-DOI-M5xN.js","./KeyboardShortcutTooltip-legacy-C9k84nly.js"],(function(e,t){var n,o,a,r,i,s,l,c,d,u,p,g,m,f,b,_,y,h,w,v,x,k,T,N,I,C,E,$,j,B,A,z,O,S,F,L,M,W,V,P,R,G,H,q,D,U,K,Q,Y,Z,J,X,ee,te;return e({n:function(){function e({key:e,action:t}){ee.customActions[e]=t}function t(e){const t=e.target;if(!(t instanceof Element)||"A"!==t.tagName)return;const n=t.getAttribute("data-action");if(n&&"function"==typeof a.value[n]){e.preventDefault();const o=function(e){const t={};for(let n=0;n<e.attributes.length;n++){const o=e.attributes[n];o.name.startsWith("data-action-parameter-")&&(t[o.name.replace("data-action-parameter-","")]=o.value)}return t}(t);a.value[n](o)}}function n(){window.top?window.top.location.reload():window.location.reload()}const a=o((()=>({reload:n,...ee.customActions})));return g((()=>{ee.delegatedClickHandler||(ee.delegatedClickHandler=t,window.addEventListener("click",t),S.on("registerGlobalLinkAction",e))})),u((()=>{window.removeEventListener("click",t),ee.delegatedClickHandler=null,S.off("registerGlobalLinkAction",e)})),{registerCustomAction:e,unregisterCustomAction:function(e){const{[e]:t,...n}=ee.customActions;ee.customActions=n}}},r:function(){const e=z(),t=O(),n=E(),a=F(),r=I(),i=A(),s=K(),l=v(),c=$(),d=o((()=>H(t.workflow.connections))),u=o((()=>t.workflowObject));function p(e){a.showMessage({type:"error",message:e,title:l.baseText("workflowExtraction.error.failure"),duration:15e3})}function g(e){switch(e.errorCode){case"Input Edge To Non-Root Node":return l.baseText("workflowExtraction.error.selectionGraph.inputEdgeToNonRoot",{interpolate:{node:e.node}});case"Output Edge From Non-Leaf Node":return l.baseText("workflowExtraction.error.selectionGraph.outputEdgeFromNonLeaf",{interpolate:{node:e.node}});case"Multiple Input Nodes":return l.baseText("workflowExtraction.error.selectionGraph.multipleInputNodes",{interpolate:{nodes:[...e.nodes].map((e=>`'${e}'`)).join(", ")}});case"Multiple Output Nodes":return l.baseText("workflowExtraction.error.selectionGraph.multipleOutputNodes",{interpolate:{nodes:[...e.nodes].map((e=>`'${e}'`)).join(", ")}});case"No Continuous Path From Root To Leaf In Selection":return l.baseText("workflowExtraction.error.selectionGraph.noContinuousPathFromRootToLeaf",{interpolate:{start:e.start,end:e.end}})}}function m(n){const o=n.map(t.getNodeById).filter((e=>void 0!==e)),a=o.filter((e=>E().getNodeType(e.type,e.typeVersion)?.group.includes("trigger")));if(a.length>0)return p(l.baseText("workflowExtraction.error.triggerSelected",{interpolate:{nodes:a.map((e=>`'${e.name}'`)).join(", ")}})),!1;const r=W(new Set(o.map((e=>e.name))),d.value);return!!function(e){if(Array.isArray(e))return p(l.baseText("workflowExtraction.error.selectionGraph.listHeader",{interpolate:{body:e.map(g).map((e=>`- ${e}`)).join("<br>")}})),!1;const{start:n,end:o}=e,a=(e,n)=>{const o=t.getNodeByName(e);if(!o)return!0;const a=E().getNodeType(o.type,o.typeVersion);return!a||n(u.value,o,a).filter((e=>"string"==typeof e?"main"===e:"main"===e.type)).length<=1};return n&&!a(n,U)?(p(l.baseText("workflowExtraction.error.inputNodeHasMultipleInputBranches",{interpolate:{node:n}})),!1):o&&!a(o,q)?(p(l.baseText("workflowExtraction.error.outputNodeHasMultipleOutputBranches",{interpolate:{node:o}})),!1):!Array.isArray(e)}(r)&&(e.openModalWithData({name:V,data:{subGraph:o,selection:r}}),!0)}async function f(o,c,d){const{start:p,end:g}=o,m=t.workflow.nodes.map((e=>e.name));let f="Start";const b=c.map((e=>e.name));for(;b.includes(f);)f+="_1";let _="Return";for(;b.includes(_);)_+="_1";const y=g?u.value.getChildNodes(g,"main",1).map((e=>u.value.getNode(e)?.name)).filter((e=>void 0!==e)):[],h=g?u.value.getChildNodes(g,"ALL").map((e=>u.value.getNode(e))).filter((e=>null!==e)):[],{nodes:w,variables:v}=M(c,m,f,p?[p]:void 0);let x=`Call ${d}`;for(;m.includes(x);)x+="_1";const{nodes:k,variables:T}=M(h,h.map((e=>e.name)).concat(b),x,y),N=await async function(e){try{const o=await t.createNewWorkflow(e);try{await t.publishWorkflow(o.id,{versionId:o.versionId})}catch(n){console.error("Failed to activate extracted sub-workflow:",n)}const{href:i}=r.resolve({name:D.WORKFLOW,params:{name:o.id}});return a.showMessage({title:l.baseText("workflowExtraction.success.title"),message:l.baseText("workflowExtraction.success.message",{interpolate:{url:i}}),type:"success",duration:1e4}),o}catch(o){return a.showError(o,l.baseText("workflowExtraction.error.subworkflowCreationFailed")),null}}(function(e,{start:o,end:a},r,i,s,l,c,d){const u=Object.fromEntries(Object.entries(i).filter((([e])=>r.some((t=>t.name===e)))));a&&delete u[a];const p=r.find((e=>e.name===o)),g=p??r.sort(((e,t)=>e.position[1]-t.position[1]))[0],m=[g.position[0]-j,g.position[1]],f=r.find((e=>e.name===a)),b=f??r.sort(((e,t)=>t.position[1]-e.position[1]))[0],_=[b.position[0]+j,b.position[1]],y=l.size>0,h=n.getNodeType(g.type,g.typeVersion),w=void 0!==p||h&&P(h,"main")?{[c]:{main:[[{node:g.name,type:"main",index:0}]]}}:{},v=f&&y?{[f.name]:{main:[[{node:d,type:"main",index:0}]]}}:{},x=y?[{parameters:{assignments:{assignments:[...l.entries().map((e=>({id:L(),name:e[0],value:`={{ ${e[1]} }}`,type:"string"})))]},options:{}},type:"n8n-nodes-base.set",typeVersion:3.4,position:_,id:L(),name:d}]:[],k=0===s.size?{inputSource:"passthrough"}:{workflowInputs:{values:[...s.keys().map((e=>({name:e,type:"any"})))]}},T={id:L(),typeVersion:1.1,name:c,type:G,position:m,parameters:k};return{name:e,nodes:[...r,...x,T],connections:{...u,...w,...v},settings:{executionOrder:"v1"},projectId:t.workflow.homeProject?.id,parentFolderId:t.workflow.parentFolder?.id??void 0}}(d,o,w,t.workflow.connections,v,T,f,_));if(null===N)return!1;const I=function(e){const t=e.reduce(((e,t)=>[e[0]+t.position[0],e[1]+t.position[1],e[2]+1]),[0,0,0]);return[t[0]/t[2],t[1]/t[2]]}(c);return await async function(n,o,a,r,l){i.startRecordingUndo(),e.resetLastInteractedWith();const c=(await s.addNodes([n],{...X,forcePosition:!0}))[0];a&&s.replaceNodeConnections(a,c.id,{...X,replaceInputs:!1}),o&&s.replaceNodeConnections(o,c.id,{...X,replaceOutputs:!1}),s.deleteNodes(r.map((e=>e.id)),X);for(const e of l){const n=t.workflow.nodes.find((t=>t.id===e.id));(0,J.default)(e,n)||s.replaceNodeParameters(e.id,{...n?.parameters},{...e.parameters},X)}e.markStateDirty(),i.stopRecordingUndo()}(function(e,t,n,o){return{parameters:{workflowId:{__rl:!0,value:e,mode:"list"},workflowInputs:{mappingMode:"defineBelow",value:Object.fromEntries(o.entries().map((([e,t])=>[e,`={{ ${t} }}`]))),matchingColumns:[...o.keys()],schema:[...o.keys().map((e=>({id:e,displayName:e,required:!1,defaultMatch:!1,display:!0,canBeUsedToMatch:!0,removed:!1})))],attemptToConvertTypes:!1,convertFieldsToString:!0},options:{}},type:"n8n-nodes-base.executeWorkflow",typeVersion:1.2,position:n,name:t}}(N.id,x,I,v),c.find((e=>e.name===p))?.id,c.find((e=>e.name===g))?.id,c,k),!0}return{adjacencyList:d,extractWorkflow:function(e){const t=m(e);!function(e,t){c.track("User started nodes to sub-workflow extraction",{node_count:e,success:t})}(e.length,t)},tryExtractNodesIntoSubworkflow:m,extractNodesIntoSubworkflow:async function(e,t,n){const o=await f(e,t,n);!function(e,t){c.track("User extracted nodes to sub-workflow",{node_count:e,success:t})}(t.length,o)}}}}),{setters:[function(e){n=e.o},function(e){o=e.C,a=e.Cn,r=e.D,i=e.E,s=e.Gt,l=e.M,c=e.P,d=e.Pt,u=e.Q,p=e.T,g=e.Z,m=e._,f=e.bt,b=e.et,_=e.j,y=e.vn,h=e.w},function(e){w=e.bt,v=e.yt},function(e){x=e.Dt,k=e.Hi,T=e.Ii,N=e.Vi,I=e.wi},function(e){C=e.t},function(e){E=e.C,$=e.Lt,j=e.On,B=e.d,A=e.fi,z=e.r,O=e.s,S=e.ya,F=e.yr,L=e.zr},function(e){M=e.Ai,W=e.Ei,V=e.Fs,P=e.Oa,R=e.Po,G=e.So,H=e.Ti,q=e.da,D=e.rs,U=e.ua},function(e){K=e.t},function(e){Q=e.t},function(e){Y=e.t}],execute:function(){(Z=document.createElement("style")).textContent="._component_1chpr_125{align-items:stretch;display:flex;position:relative}._split_1chpr_131 ._button_1chpr_131{height:var(--spacing--2xl);border-top-right-radius:0;border-bottom-right-radius:0;padding-top:0;padding-bottom:0}._split_1chpr_131 ._button_1chpr_131:not(:-webkit-any(:lang(ae),:lang(ar),:lang(arc),:lang(bcc),:lang(bqi),:lang(ckb),:lang(dv),:lang(fa),:lang(glk),:lang(he),:lang(ku),:lang(mzn),:lang(nqo),:lang(pnb),:lang(ps),:lang(sd),:lang(ug),:lang(ur),:lang(yi))){padding-left:var(--spacing--xs)}._split_1chpr_131 ._button_1chpr_131:not(:is(:lang(ae),:lang(ar),:lang(arc),:lang(bcc),:lang(bqi),:lang(ckb),:lang(dv),:lang(fa),:lang(glk),:lang(he),:lang(ku),:lang(mzn),:lang(nqo),:lang(pnb),:lang(ps),:lang(sd),:lang(ug),:lang(ur),:lang(yi))){padding-left:var(--spacing--xs)}._split_1chpr_131 ._button_1chpr_131:-webkit-any(:lang(ae),:lang(ar),:lang(arc),:lang(bcc),:lang(bqi),:lang(ckb),:lang(dv),:lang(fa),:lang(glk),:lang(he),:lang(ku),:lang(mzn),:lang(nqo),:lang(pnb),:lang(ps),:lang(sd),:lang(ug),:lang(ur),:lang(yi)){padding-right:var(--spacing--xs)}._split_1chpr_131 ._button_1chpr_131:is(:lang(ae),:lang(ar),:lang(arc),:lang(bcc),:lang(bqi),:lang(ckb),:lang(dv),:lang(fa),:lang(glk),:lang(he),:lang(ku),:lang(mzn),:lang(nqo),:lang(pnb),:lang(ps),:lang(sd),:lang(ug),:lang(ur),:lang(yi)){padding-right:var(--spacing--xs)}._divider_1chpr_139{background-color:var(--button--color--text,var(--button--color--text--primary));width:1px}._chevron_1chpr_144{width:40px;height:var(--spacing--2xl);border-top-left-radius:0;border-bottom-left-radius:0}._menu_1chpr_151 .el-dropdown{height:100%}._menuPopper_1chpr_155{max-width:none!important}._menuItem_1chpr_159{align-items:center;gap:var(--spacing--2xs);display:flex}._menuItem_1chpr_159._disabled_1chpr_165 ._menuIcon_1chpr_165{opacity:.2}._buttonContent_1chpr_169{gap:var(--spacing--5xs);flex-direction:column;display:flex;align-items:flex-start!important}._subText_1chpr_176{font-size:var(--font-size--2xs)}\n/*$vite$:1*/",document.head.appendChild(Z);try{t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},(u=(new t.Error).stack)&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[u]="dc40bf2b-38c1-4283-a405-42489b4ae911",t._sentryDebugIdIdentifier="sentry-dbid-dc40bf2b-38c1-4283-a405-42489b4ae911")}catch(t){}var t,u;J=n(R(),1),X={trackBulk:!1,trackHistory:!0},ee=d({customActions:{},delegatedClickHandler:null}),te=c({__name:"CanvasRunWorkflowButton",props:{selectedTriggerNodeName:{},triggerNodes:{},waitingForWebhook:{type:Boolean},executing:{type:Boolean},disabled:{type:Boolean},hideTooltip:{type:Boolean},label:{},size:{},includeChatTrigger:{type:Boolean},getNodeType:{type:Function}},emits:["mouseenter","mouseleave","execute","selectTriggerNode"],setup(e,{emit:t}){const n=t,c=e,d=v(),u=o((()=>c.triggerNodes.filter((e=>!(e.disabled||!c.includeChatTrigger&&B(e)))))),g=o((()=>c.executing?c.waitingForWebhook?d.baseText("nodeView.runButtonText.waitingForTriggerEvent"):d.baseText("nodeView.runButtonText.executingWorkflow"):c.label??d.baseText("nodeView.runButtonText.executeWorkflow"))),I=o((()=>c.triggerNodes.filter((e=>!!c.includeChatTrigger||!B(e))).toSorted(((e,t)=>{const[n,o]=e.position,[a,r]=t.position;return o===r?n-a:o-r})).map((e=>({label:T(e.name,50),disabled:!!e.disabled||c.executing,id:e.name,checked:c.selectedTriggerNodeName===e.name}))))),C=o((()=>u.value.length>1&&void 0!==c.selectedTriggerNodeName));function E(e){const t=c.triggerNodes.find((t=>t.name===e));return t?c.getNodeType(t.type,t.typeVersion):null}return(t,o)=>(b(),r("div",{class:y([t.$style.component,C.value?t.$style.split:""])},[l(Y,{label:g.value,shortcut:{metaKey:!0,keys:["â†µ"]},disabled:e.executing||e.hideTooltip},{default:f((()=>[l(s(k),{variant:"solid",class:y(t.$style.button),loading:e.executing,iconOnly:e.executing,disabled:e.disabled,size:e.size??"large",icon:"flask-conical","data-test-id":"execute-workflow-button",onMouseenter:o[0]||(o[0]=e=>t.$emit("mouseenter",e)),onMouseleave:o[1]||(o[1]=e=>t.$emit("mouseleave",e)),onClick:o[2]||(o[2]=e=>n("execute"))},{default:f((()=>[h("span",{class:y(t.$style.buttonContent)},[_(a(g.value)+" ",1),C.value?(b(),p(s(N),{key:0,class:y(t.$style.subText),bold:!1},{default:f((()=>[l(s(w),{keypath:"nodeView.runButtonText.from",scope:"global"},{nodeName:f((()=>[l(s(N),{bold:"",size:"mini"},{default:f((()=>[_(a(s(T)(c.selectedTriggerNodeName??"",25)),1)])),_:1})])),_:1})])),_:1},8,["class"])):i("",!0)],2)])),_:1},8,["class","loading","iconOnly","disabled","size"])])),_:1},8,["label","disabled"]),C.value?(b(),r(m,{key:0},[h("div",{role:"presentation",class:y(t.$style.divider)},null,2),l(s(x),{class:y(t.$style.menu),items:I.value,disabled:e.disabled,placement:"top","extra-popper-class":t.$style.menuPopper,onSelect:o[3]||(o[3]=e=>n("selectTriggerNode",e))},{activator:f((()=>[l(s(k),{variant:"solid","icon-size":"large",disabled:e.disabled,class:y(t.$style.chevron),"aria-label":"Select trigger node",icon:"chevron-down"},null,8,["disabled","class"])])),menuItem:f((e=>[h("div",{class:y([t.$style.menuItem,e.disabled?t.$style.disabled:""])},[l(Q,{class:y(t.$style.menuIcon),size:16,"node-type":E(e.id)},null,8,["class","node-type"]),h("span",null,[l(s(w),{keypath:"nodeView.runButtonText.from",scope:"global"},{nodeName:f((()=>[l(s(N),{bold:"",size:"small"},{default:f((()=>[_(a(e.label),1)])),_:2},1024)])),_:2},1024)])],2)])),_:1},8,["class","items","disabled","extra-popper-class"])],64)):i("",!0)],2))}}),e("t",C(te,[["__cssModules",{$style:{component:"_component_1chpr_125",split:"_split_1chpr_131",button:"_button_1chpr_131",divider:"_divider_1chpr_139",chevron:"_chevron_1chpr_144",menu:"_menu_1chpr_151",menuPopper:"_menuPopper_1chpr_155",menuItem:"_menuItem_1chpr_159",disabled:"_disabled_1chpr_165",menuIcon:"_menuIcon_1chpr_165",buttonContent:"_buttonContent_1chpr_169",subText:"_subText_1chpr_176"}}]]))}}}));
//# sourceMappingURL=CanvasRunWorkflowButton-legacy-DmPqrO5o.js.map