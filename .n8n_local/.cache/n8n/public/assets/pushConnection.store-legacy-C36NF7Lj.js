!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"n8n@2.9.4"}}catch(e){}}(),System.register(["./vue.runtime.esm-bundler-legacy-BquwEXRp.js","./users.store-legacy-B-bVJKl3.js","./constants-legacy-DVkAm8xO.js","./_baseOrderBy-legacy-BnyL5wLN.js"],(function(e,n){var t,o,l,s,a,u,r,c,i,v,d,f,p,g;return{setters:[function(e){t=e.C,o=e.It,l=e._t},function(e){s=e.Wc,a=e.ws},function(e){u=e.Qc,r=e.ol,c=e.ri},function(e){i=e.j,v=e.r}],execute:function(){try{n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},(m=(new n.Error).stack)&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[m]="7575c2f3-f672-4af5-9fa9-c943d9416a29",n._sentryDebugIdIdentifier="sentry-dbid-7575c2f3-f672-4af5-9fa9-c943d9416a29")}catch(n){}var n,m;e("n",d=e=>{const{interval:n,onHeartbeat:t}=e,l=o(null);return{startHeartbeat:()=>{l.value=setInterval(t,n)},stopHeartbeat:()=>{l.value&&(clearInterval(l.value),l.value=null)}}}),f=({onAttempt:e,onAttemptScheduled:n})=>{const t=o(null),l=o(0);return{scheduleReconnect:()=>{const o=Math.min(1e3*2**l.value,15e3);l.value++,n(o),t.value=setTimeout((()=>{e()}),o)},stopReconnectTimer:()=>{t.value&&(clearTimeout(t.value),t.value=null)},resetConnectionAttempts:()=>{l.value=0}}},p=e=>{const n=o(!1),t=o(null),{startHeartbeat:l,stopHeartbeat:s}=d({interval:3e4,onHeartbeat:()=>{t.value?.send(JSON.stringify(c()))}}),a=()=>{t.value?.removeEventListener("open",a),n.value=!0,l(),g.resetConnectionAttempts()},u=e=>{console.warn(`[WebSocketClient] Connection lost, code=${e.code??"unknown"}`),v(),g.scheduleReconnect()},r=n=>{e.onMessage(n.data)},i=e=>{console.warn("[WebSocketClient] Connection error:",e)},v=()=>{t.value&&(s(),g.stopReconnectTimer(),t.value.removeEventListener("message",r),t.value.removeEventListener("error",i),t.value.removeEventListener("close",u),t.value.close(1e3),t.value=null),n.value=!1},p=()=>{v(),t.value=new WebSocket(e.url),t.value.addEventListener("open",a),t.value.addEventListener("message",r),t.value.addEventListener("error",i),t.value.addEventListener("close",u),t.value.binaryType="arraybuffer"},g=f({onAttempt:p,onAttemptScheduled:e=>{console.log(`[WebSocketClient] Attempting to reconnect in ${e}ms`)}});return{isConnected:n,connect:p,disconnect:v,sendMessage:e=>{if(!n.value||!t.value)throw new Error("Not connected to the server");t.value.send(e)}}},g=e=>{const n=o(!1),t=o(null),l=()=>{n.value=!0,c.resetConnectionAttempts()},s=()=>{console.warn("[EventSourceClient] Connection lost"),n.value=!1,c.scheduleReconnect()},a=n=>{e.onMessage(n.data)},u=()=>{t.value&&(c.stopReconnectTimer(),t.value.close(),t.value=null),n.value=!1},r=()=>{u(),t.value=new EventSource(e.url,{withCredentials:!0}),t.value.addEventListener("open",l),t.value.addEventListener("message",a),t.value.addEventListener("close",s)},c=f({onAttempt:r,onAttemptScheduled:e=>{console.log(`[EventSourceClient] Attempting to reconnect in ${e}ms`)}});return{isConnected:n,connect:r,disconnect:u,sendMessage:e=>{}}},e("t",i(s.PUSH,(()=>{const e=v(),n=a(),s=o([]),c=o(!1),i=o(!1),d=o([]),f=t((()=>"websocket"===n.pushBackend));async function m(e){let n;e instanceof ArrayBuffer&&(e=new TextDecoder("utf-8").decode(new Uint8Array(e)));try{n=JSON.parse(e)}catch(t){return}d.value.forEach((e=>{e(n)}))}const h=(()=>{const n=e.restUrl,t=`/push?pushRef=${e.pushRef}`;if(f.value){const{protocol:e,host:o}=window.location;return`${n.startsWith("http")?n.replace(/^http/,"ws"):`${"https:"===e?"wss":"ws"}://${o+n}`}${t}`}return`${n}${t}`})(),y=t((()=>f.value?p({url:h,onMessage:m}):g({url:h,onMessage:m})));function b(e){y.value.isConnected.value?y.value.sendMessage(JSON.stringify(e)):s.value.push(e)}const w=()=>r(u.CONNECTION.WEBSOCKET_DISCONNECT);let C=!1,E=null,T=null;return l((()=>y.value.isConnected.value),(e=>{if(e&&(i.value=!1),e&&s.value.length){for(const e of s.value)b(e);s.value=[]}})),{isConnected:t((()=>y.value.isConnected.value)),isConnecting:i,isConnectionRequested:c,onMessageReceivedHandlers:d,addEventListener:e=>(d.value.push(e),()=>{const n=d.value.indexOf(e);-1!==n&&d.value.splice(n,1)}),pushConnect:()=>{C=!0,E&&clearTimeout(E),E=setTimeout((()=>{C=!1,E=null}),w()),T&&(clearTimeout(T),T=null),c.value=!0,i.value=!0,y.value.connect()},pushDisconnect:()=>{C||(T&&clearTimeout(T),T=setTimeout((()=>{C||(c.value=!1,i.value=!1,y.value.disconnect()),T=null}),w()))},send:b,clearQueue:()=>{s.value=[]}}})))}}}));
//# sourceMappingURL=pushConnection.store-legacy-C36NF7Lj.js.map