(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`e3200064-6bec-44b7-a550-762ea651c2f1`,e._sentryDebugIdIdentifier=`sentry-dbid-e3200064-6bec-44b7-a550-762ea651c2f1`)})()}catch{}import{o as e,t}from"./chunk-Din3qlHY.js";import{C as n,Cn as r,D as i,E as a,G as o,Gt as s,It as c,M as l,P as u,T as d,W as f,Z as p,_ as m,_t as h,at as g,bn as _,bt as v,et as y,it as b,j as x,k as S,p as C,q as w,st as T,vn as E,w as D,xt as O}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{c as k,yt as A}from"./_MapCache-DjbOQyB7.js";import{Ci as ee,Et as j,Hi as te,Si as ne,Ui as M,Vi as N,bt as P,ji as re,st as F,wi as ie,zi as I}from"./src-CppJvwzX.js";import{t as L}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as ae,fn as oe,t as se,ws as ce,xn as le,yr as ue}from"./users.store-pCkD7Zo0.js";import{rs as de,u as fe}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import{n as R,t as pe}from"./useDebounce-D6lADr4O.js";import"./nodeIcon--7uU1Imq.js";import"./NodeIcon-Dv1e4Lvu.js";import"./TimeAgo-BLqTSlco.js";import{t as z}from"./orderBy-KAUxkCYD.js";import{t as me}from"./TemplatesView-C8R65plk.js";import{n as B,t as he}from"./TemplateList-DWe5QI38.js";var V=[`textContent`],H=L(u({__name:`CollectionWorkflowCard`,props:{loading:{type:Boolean},title:{}},setup(e){return(t,n)=>(y(),d(s(P),f({class:t.$style.card},t.$attrs),S({default:v(()=>[l(s(j),{loading:e.loading,rows:3,variant:`p`},null,8,[`loading`])]),_:2},[!e.loading&&e.title?{name:`header`,fn:v(()=>[D(`span`,{class:E(t.$style.title),textContent:r(e.title)},null,10,V)]),key:`0`}:void 0,e.loading?void 0:{name:`footer`,fn:v(()=>[g(t.$slots,`footer`)]),key:`1`}]),1040,[`class`]))}}),[[`__cssModules`,{$style:{card:`_card_pxgdc_125`,title:`_title_pxgdc_141`}}]]),U=u({__name:`TemplatesInfoCard`,props:{collection:{},loading:{type:Boolean,default:!1},showItemCount:{type:Boolean,default:!0},width:{}},setup(e){let t=A();return(n,i)=>(y(),d(H,{loading:e.loading,title:e.collection.name,style:_({width:e.width})},{footer:v(()=>[D(`span`,null,[O(l(s(N),{size:`small`,color:`text-light`},{default:v(()=>[x(r(e.collection.workflows.length)+` `+r(s(t).baseText(`templates.workflows`)),1)]),_:1},512),[[C,e.showItemCount]])]),l(B,{nodes:e.collection.nodes,"show-more":!1},null,8,[`nodes`])]),_:1},8,[`loading`,`title`,`style`]))}}),W={methods:{handleMouseDown(e){this.isMouseDown=!0,e.type.indexOf(`touch`)!==-1&&(this.dragStartX=e.touches[0].clientX,this.dragStartY=e.touches[0].clientY),e.type.indexOf(`mouse`)!==-1&&(this.dragStartX=e.clientX,this.dragStartY=e.clientY)},handleMouseMove(e){let t,n;e.type.indexOf(`touch`)!==-1&&(t=e.touches[0].clientX,n=e.touches[0].clientY),e.type.indexOf(`mouse`)!==-1&&(t=e.clientX,n=e.clientY),Math.abs(t-this.dragStartX)>3*Math.abs(n-this.dragStartY)&&(this.disableScroll(),this.dragDistance=t-this.dragStartX)},handleMouseUp(){this.isMouseDown=!1,this.enableScroll()},handleMouseOver(e){this.settings.autoplay&&(e===`dot`&&this.settings.pauseOnDotsHover||e===`track`&&this.settings.pauseOnHover)&&(this.isAutoplayPaused=!0)},handleMouseOut(e){this.settings.autoplay&&(e===`dot`&&this.settings.pauseOnDotsHover||e===`track`&&this.settings.pauseOnHover)&&(this.isAutoplayPaused=!1)}}},G={methods:{getWidth(){if(this.isSSR)return!1;this.widthWindow=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.widthContainer=this.$refs.list.clientWidth},htmlCollectionToArray(e){return Array.prototype.slice.call(e,0)}}},ge={methods:{clearAutoPlayPause(){clearTimeout(this.autoplayTimeout),this.autoplayRemaining=null},disableAutoPlay(){clearInterval(this.autoplayInterval),this.autoplayInterval=null},disableScroll(){document.ontouchmove=e=>e.preventDefault()},enableScroll(){document.ontouchmove=()=>!0},restartAutoPlay(){this.disableAutoPlay(),this.toggleAutoPlay()},toggleAutoPlay(){let e=!this.settings.unagile&&this.settings.autoplay;!this.autoplayInterval&&e?this.autoplayInterval=setInterval(()=>{document.hidden||(this.canGoToNext?this.goToNext():this.disableAutoPlay())},this.settings.autoplaySpeed):this.disableAutoPlay()},toggleFade(){let e=!this.settings.unagile&&this.settings.fade;for(let t=0;t<this.countSlides;t++)this.slides[t].style.transition=e?`opacity `+this.settings.timing+` `+this.settings.speed+`ms`:`none`,this.slides[t].style.transform=e?`translate(-${t*this.widthSlide}px)`:`none`}}},K={methods:{prepareSlides(){this.slides=this.htmlCollectionToArray(this.$refs.slides.children),this.slidesCloned&&(this.slidesClonedBefore=this.htmlCollectionToArray(this.$refs.slidesClonedBefore.children),this.slidesClonedAfter=this.htmlCollectionToArray(this.$refs.slidesClonedAfter.children));for(let e of this.slidesAll)e.classList.add(`agile__slide`)},prepareSlidesClasses(){if(this.currentSlide===null)return!1;for(let e=0;e<this.countSlides;e++)this.slides[e].classList.remove(`agile__slide--active`),this.slides[e].classList.remove(`agile__slide--current`);setTimeout(()=>this.slides[this.currentSlide].classList.add(`agile__slide--active`),this.changeDelay);let e=this.slidesCloned?this.countSlides+this.currentSlide:this.currentSlide;this.centerMode&&(e-=Math.floor(this.settings.slidesToShow/2)-+(this.settings.slidesToShow%2==0));for(let t=Math.max(e,0);t<Math.min(e+this.settings.slidesToShow,this.countSlides);t++)this.slidesAll[t].classList.add(`agile__slide--current`)},prepareCarousel(){this.settings.unagile?this.translateX=0:(this.currentSlide===null&&this.countSlides&&(this.currentSlide=this.settings.initialSlide),this.currentSlide>this.countSlides&&(this.currentSlide=this.countSlides-1),this.goTo(this.currentSlide,!1,!1))}}},_e=e(z()),ve={props:{asNavFor:{type:Array,default:function(){return[]}},autoplay:{type:Boolean,default:!1},autoplaySpeed:{type:Number,default:3e3},centerMode:{type:Boolean,default:!1},centerPadding:{type:String,default:`15%`},changeDelay:{type:Number,default:0},dots:{type:Boolean,default:!0},fade:{type:Boolean,default:!1},infinite:{type:Boolean,default:!0},initialSlide:{type:Number,default:0},mobileFirst:{type:Boolean,default:!0},navButtons:{type:Boolean,default:!0},options:{type:Object,default:()=>null},pauseOnDotsHover:{type:Boolean,default:!1},pauseOnHover:{type:Boolean,default:!0},responsive:{type:Array,default:()=>null},rtl:{type:Boolean,default:!1},slidesToScroll:{type:Number,default:1},slidesToShow:{type:Number,default:1},speed:{type:Number,default:300},swipeDistance:{type:Number,default:50},throttleDelay:{type:Number,default:500},timing:{type:String,default:`ease`,validator:e=>[`ease`,`linear`,`ease-in`,`ease-out`,`ease-in-out`].indexOf(e)!==-1},unagile:{type:Boolean,default:!1}},computed:{initialSettings:function(){let{options:e,...t}=this.$props;return e&&(t={...t,...e}),t.responsive&&=(0,_e.default)(t.responsive,`breakpoint`),t},settings:function(){let{responsive:e,...t}=this.initialSettings;return e&&e.forEach(e=>{if(t.mobileFirst?e.breakpoint<this.widthWindow:e.breakpoint>this.widthWindow)for(let n in e.settings)t[n]=e.settings[n]}),t}}},q=e(t(((e,t)=>{var n=R(),r=k(),i=`Expected a function`;function a(e,t,a){var o=!0,s=!0;if(typeof e!=`function`)throw TypeError(i);return r(a)&&(o=`leading`in a?!!a.leading:o,s=`trailing`in a?!!a.trailing:s),n(e,t,{leading:o,maxWait:t,trailing:s})}t.exports=a}))()),J={name:`agile`,mixins:[W,G,ge,K,ve,{created(){this.goTo=(0,q.default)(this.goTo,this.throttleDelay),this.getWidth=(0,q.default)(this.getWidth,500)}},{watch:{currentBreakpoint(){this.$emit(`breakpoint`,{breakpoint:this.currentBreakpoint})},currentSlide(){this.prepareSlidesClasses(),this.autoplayStartTimestamp=this.settings.autoplay?+new Date:null,this.$emit(`after-change`,{currentSlide:this.currentSlide})},dragDistance(){if(this.isMouseDown){let{rtl:e}=this.settings,t=this.dragDistance*(e?-1:1);t>this.swipeDistance&&this.canGoToPrev&&(this.goToPrev(),this.handleMouseUp()),t<-1*this.swipeDistance&&this.canGoToNext&&(this.goToNext(),this.handleMouseUp())}},isAutoplayPaused(e){e?(this.remaining=this.settings.autoplaySpeed-(+new Date-this.autoplayStartTimestamp),this.disableAutoPlay(),this.clearAutoPlayPause()):this.autoplayTimeout=setTimeout(()=>{this.clearAutoPlayPause(),this.goToNext(),this.toggleAutoPlay()},this.remaining)},"settings.autoplay"(){this.toggleAutoPlay()},"settings.fade"(){this.toggleFade()},"settings.unagile"(){},widthSlide(){for(let e=0;e<this.countSlidesAll;e++)this.slidesAll[e].style.width=`${this.widthSlide}${this.widthSlide===`auto`?``:`px`}`},widthWindow(e,t){t&&(this.prepareCarousel(),this.toggleFade())}}}],emits:[`before-change`,`after-change`,`breakpoint`],data(){return{autoplayInterval:null,autoplayRemaining:null,autoplayStartTimestamp:null,autoplayTimeout:null,currentSlide:null,dragDistance:0,dragStartX:0,dragStartY:0,isAutoplayPaused:!1,isMouseDown:!1,slides:[],slidesClonedAfter:[],slidesClonedBefore:[],isSSR:typeof window>`u`,transitionDelay:0,translateX:0,widthWindow:0,widthContainer:0}},computed:{breakpoints:function(){return this.initialSettings.responsive?this.initialSettings.responsive.map(e=>e.breakpoint):[]},canGoToPrev:function(){return this.settings.infinite||this.currentSlide>0},canGoToNext:function(){return this.settings.infinite||this.currentSlide<this.countSlides-1},countSlides:function(){return this.isSSR?this.htmlCollectionToArray(this.$slots.default).length:this.slides.length},countSlidesAll:function(){return this.slidesAll.length},currentBreakpoint:function(){let e=this.breakpoints.map(e=>e).reverse();return this.initialSettings.mobileFirst?e.find(e=>e<this.widthWindow)||0:e.find(e=>e>this.widthWindow)||null},marginX:function(){if(this.settings.unagile)return 0;let e=this.slidesCloned?this.countSlides*this.widthSlide:0;return this.settings.centerMode&&(e-=(Math.floor(this.settings.slidesToShow/2)-+(this.settings.slidesToShow%2==0))*this.widthSlide),this.settings.rtl?e:-1*e},slidesCloned:function(){return!this.settings.unagile&&!this.settings.fade&&this.settings.infinite},slidesAll:function(){return this.slidesCloned?[...this.slidesClonedBefore,...this.slides,...this.slidesClonedAfter]:this.slides},widthSlide:function(){return this.settings.unagile?`auto`:this.widthContainer/this.settings.slidesToShow}},mounted(){window.addEventListener(`resize`,this.getWidth),this.$refs.track.addEventListener(`touchstart`,this.handleMouseDown),this.$refs.track.addEventListener(`touchend`,this.handleMouseUp),this.$refs.track.addEventListener(`touchmove`,this.handleMouseMove),this.$refs.track.addEventListener(`mousedown`,this.handleMouseDown),this.$refs.track.addEventListener(`mouseup`,this.handleMouseUp),this.$refs.track.addEventListener(`mousemove`,this.handleMouseMove),this.isSSR=!1,this.reload()},beforeUnmount(){this.destroy()},methods:{destroy(){window.removeEventListener(`resize`,this.getWidth),this.$refs.track.removeEventListener(`touchstart`,this.handleMouseDown),this.$refs.track.removeEventListener(`touchend`,this.handleMouseUp),this.$refs.track.removeEventListener(`touchmove`,this.handleMouseMove),this.$refs.track.removeEventListener(`mousedown`,this.handleMouseDown),this.$refs.track.removeEventListener(`mouseup`,this.handleMouseUp),this.$refs.track.removeEventListener(`mousemove`,this.handleMouseMove),this.disableAutoPlay()},getCurrentBreakpoint(){return this.currentBreakpoint},getCurrentSettings(){return this.settings},getCurrentSlide(){return this.currentSlide},getInitialSettings(){return this.initialSettings},goTo(e,t=!0,n=!1){if(this.settings.unagile)return!1;n||this.settings.asNavFor.forEach(n=>{n&&n.goTo(e,t,!0)});let r=e;t&&(this.settings.infinite&&e<0?r=this.countSlides-1:e>=this.countSlides&&(r=0),this.$emit(`before-change`,{currentSlide:this.currentSlide,nextSlide:r}),this.currentSlide=r,e!==r&&setTimeout(()=>{this.goTo(r,!1)},this.settings.speed));let i=this.settings.fade?0:e*this.widthSlide*this.settings.slidesToScroll;this.transitionDelay=t?this.speed:0,(this.infinite||this.currentSlide+this.slidesToShow<=this.countSlides)&&(this.translateX=this.settings.rtl?i:-1*i)},goToNext(){this.canGoToNext&&this.goTo(this.currentSlide+1)},goToPrev(){this.canGoToPrev&&this.goTo(this.currentSlide-1)},reload(){this.getWidth(),this.prepareSlides(),this.prepareCarousel(),this.toggleFade(),this.toggleAutoPlay()}}},Y={ref:`list`,class:`agile__list`},X={ref:`slidesClonedBefore`,class:`agile__slides agile__slides--cloned`},ye={ref:`slides`,class:`agile__slides agile__slides--regular`},be={ref:`slidesClonedAfter`,class:`agile__slides agile__slides--cloned`},Z={key:0,class:`agile__caption`},xe={key:1,class:`agile__actions`},Q=[`disabled`],Se={key:1,ref:`dots`,class:`agile__dots`},Ce=[`onClick`],we=[`disabled`];function Te(e,t,n,o,s,c){return y(),i(`div`,{class:E([{"agile--ssr":s.isSSR,"agile--auto-play":e.settings.autoplay,"agile--disabled":e.settings.unagile,"agile--fade":e.settings.fade&&!e.settings.unagile,"agile--rtl":e.settings.rtl,"agile--no-nav-buttons":!e.settings.navButtons},`agile`]),onTouchstart:()=>{}},[D(`div`,Y,[D(`div`,{ref:`track`,style:_({transform:`translate(${s.translateX+c.marginX}px)`,transition:`transform ${e.settings.timing} ${s.transitionDelay}ms`}),class:`agile__track`,onMouseout:t[0]||=t=>e.handleMouseOut(`track`),onMouseover:t[1]||=t=>e.handleMouseOver(`track`)},[O(D(`div`,X,[g(e.$slots,`default`)],512),[[C,c.slidesCloned]]),D(`div`,ye,[g(e.$slots,`default`)],512),O(D(`div`,be,[g(e.$slots,`default`)],512),[[C,c.slidesCloned]])],36)],512),e.$slots.caption?(y(),i(`div`,Z,[g(e.$slots,`caption`)])):a(``,!0),!e.settings.unagile&&(e.settings.navButtons||e.settings.dots)?(y(),i(`div`,xe,[e.settings.navButtons&&!e.settings.unagile?(y(),i(`button`,{key:0,ref:`prevButton`,disabled:!c.canGoToPrev,"aria-label":`Previous`,class:`agile__nav-button agile__nav-button--prev`,type:`button`,onClick:t[2]||=t=>(c.goToPrev(),e.restartAutoPlay())},[g(e.$slots,`prevButton`,{},()=>[t[6]||=x(` ← `,-1)])],8,Q)):a(``,!0),e.settings.dots&&!e.settings.unagile?(y(),i(`ul`,Se,[(y(!0),i(m,null,b(c.countSlides,n=>(y(),i(`li`,{key:n,class:E([{"agile__dot--current":n-1===s.currentSlide},`agile__dot`]),onMouseout:t[3]||=t=>e.handleMouseOut(`dot`),onMouseover:t[4]||=t=>e.handleMouseOver(`dot`)},[D(`button`,{type:`button`,onClick:t=>(c.goTo(n-1),e.restartAutoPlay())},r(n),9,Ce)],34))),128))],512)):a(``,!0),e.settings.navButtons&&!e.settings.unagile?(y(),i(`button`,{key:2,ref:`nextButton`,disabled:!c.canGoToNext,"aria-label":`Next`,class:`agile__nav-button agile__nav-button--next`,type:`button`,onClick:t[5]||=t=>(c.goToNext(),e.restartAutoPlay())},[g(e.$slots,`nextButton`,{},()=>[t[7]||=x(` → `,-1)])],8,we)):a(``,!0)])):a(``,!0)],34)}var Ee=L(J,[[`render`,Te]]),De=L(u({__name:`TemplatesInfoCarousel`,props:{collections:{},loading:{type:Boolean,default:!1},showItemCount:{type:Boolean,default:!0},showNavigation:{type:Boolean,default:!0},cardsWidth:{default:`240px`}},emits:[`openCollection`],setup(e,{emit:t}){let n=e,r=t,a=c(0),u=c(parseInt(n.cardsWidth,10)),f=c(!1),g=c(null),_=c(null),x=()=>{if(g.value){a.value=Number(g.value.scrollLeft.toFixed());let e=g.value.clientWidth,t=g.value.scrollWidth,n=a.value;f.value=t-e<=n+7}},S=(e,t)=>{r(`openCollection`,{event:e,id:t})},T=()=>{g.value&&g.value.scrollBy({left:-(u.value*2),top:0,behavior:`smooth`})},k=()=>{g.value&&g.value.scrollBy({left:u.value*2,top:0,behavior:`smooth`})};return h(()=>n.collections,()=>{setTimeout(()=>{x()},0)}),h(()=>n.loading,()=>{setTimeout(()=>{x()},0)}),p(async()=>{await o(),_.value&&(g.value=_.value.$el.querySelector(`.agile__list`),g.value&&g.value.addEventListener(`scroll`,x))}),w(()=>{_.value&&_.value.destroy(),window.addEventListener(`scroll`,x)}),(t,n)=>O((y(),i(`div`,{class:E(t.$style.container)},[l(s(Ee),{ref_key:`sliderRef`,ref:_,dots:!1,"nav-buttons":!1,infinite:!1,"slides-to-show":4,onAfterChange:x},{default:v(()=>[(y(!0),i(m,null,b(e.loading?4:0,t=>(y(),d(H,{key:`loading-${t}`,loading:e.loading},null,8,[`loading`]))),128)),(y(!0),i(m,null,b(e.loading?[]:e.collections,t=>(y(),d(U,{key:t.id,"data-test-id":`templates-info-card`,collection:t,"show-item-count":e.showItemCount,width:e.cardsWidth,onClick:e=>S(e,t.id)},null,8,[`collection`,`show-item-count`,`width`,`onClick`]))),128))]),_:1},512),O(D(`button`,{class:E({[t.$style.leftButton]:!0}),onClick:T},[l(s(M),{icon:`chevron-left`})],2),[[C,e.showNavigation&&a.value>0]]),O(D(`button`,{class:E({[t.$style.rightButton]:!0}),onClick:k},[l(s(M),{icon:`chevron-right`})],2),[[C,e.showNavigation&&!f.value]])],2)),[[C,e.loading||e.collections.length]])}}),[[`__cssModules`,{$style:{container:`_container_1m7ae_125`,button:`_button_1m7ae_129`,leftButton:`_leftButton_1m7ae_150 _button_1m7ae_129`,rightButton:`_rightButton_1m7ae_159 _button_1m7ae_129`}}]]),$=[`textContent`],Oe=[`data-test-id`],ke=L(u({__name:`TemplateFilters`,props:{categories:{default:()=>[]},sortOnPopulate:{type:Boolean,default:!1},expandLimit:{default:12},loading:{type:Boolean,default:!1},selected:{default:()=>[]}},emits:[`clearAll`,`select`,`clear`],setup(e,{emit:t}){let o=e,u=t,d=A(),f=c(!0),p=c([]),g=n(()=>o.selected.length===0);function _(){if(!o.sortOnPopulate)p.value=o.categories;else{let e=o.selected||[],t=o.categories.filter(t=>e.includes(t)),n=o.categories.filter(t=>!e.includes(t));p.value=t.concat(n)}}function S(){f.value=!1}function C(e,t){u(e?`select`:`clear`,t)}function w(e){return o.selected.includes(e)}function T(){u(`clearAll`)}return h(()=>o.sortOnPopulate,e=>{e&&_()},{immediate:!0}),h(()=>o.categories,e=>{e.length>0&&_()},{immediate:!0}),(t,n)=>(y(),i(`div`,{class:E([t.$style.filters,`template-filters`]),"data-test-id":`templates-filter-container`},[D(`div`,{class:E(t.$style.title),textContent:r(s(d).baseText(`templates.categoriesHeading`))},null,10,$),e.loading?(y(),i(`div`,{key:0,class:E(t.$style.list)},[l(s(j),{loading:e.loading,rows:e.expandLimit},null,8,[`loading`,`rows`])],2)):a(``,!0),e.loading?a(``,!0):(y(),i(`ul`,{key:1,class:E(t.$style.categories)},[D(`li`,{class:E(t.$style.item),"data-test-id":`template-filter-all-categories`},[l(s(F),{"model-value":g.value,label:s(d).baseText(`templates.allCategories`),"onUpdate:modelValue":n[0]||=()=>T()},null,8,[`model-value`,`label`])],2),(y(!0),i(m,null,b(f.value?p.value.slice(0,e.expandLimit):p.value,(e,n)=>(y(),i(`li`,{key:n,class:E(t.$style.item),"data-test-id":`template-filter-${e.name.toLowerCase().replaceAll(` `,`-`)}`},[l(s(F),{"model-value":w(e),label:e.name,"onUpdate:modelValue":t=>C(t,e)},null,8,[`model-value`,`label`,`onUpdate:modelValue`])],10,Oe))),128))],2)),p.value.length>e.expandLimit&&f.value&&!e.loading?(y(),i(`div`,{key:2,class:E(t.$style.button),"data-test-id":`expand-categories-button`,onClick:S},[l(s(N),{size:`small`,color:`primary`},{default:v(()=>[x(` + `+r(`${p.value.length-e.expandLimit} more`),1)]),_:1})],2)):a(``,!0)],2))}}),[[`__cssModules`,{$style:{title:`_title_hd29n_125`,categories:`_categories_hd29n_130`,item:`_item_hd29n_135`,button:`_button_hd29n_142`}}]]),Ae=[`textContent`],je=L(u({__name:`TemplatesSearchView`,setup(e){let t=c(!1),o=c([]),u=c(!0),f=c(!0),m=c(!0),g=c(``),_=c(null),b=c(!1),{callDebounced:S}=pe(),w=ue(),k=oe(),j=ce(),P=le(),F=se(),L=A(),R=ee(),z=ie(),B=ae(),V=e=>({categories:o.value.map(t=>e===`name`?t.name:String(t.id)),search:g.value}),H=n(()=>P.getSearchedWorkflowsTotal(V(`name`))),U=n(()=>P.getSearchedWorkflows(V(`name`))??[]),W=n(()=>P.getSearchedCollections(V(`id`))??[]),G=n(()=>m.value?null:!f.value&&U.value.length===0&&W.value.length===0?!j.isTemplatesEndpointReachable&&b.value?L.baseText(`templates.connectionWarning`):L.baseText(`templates.noSearchResults`):null),ge=(e,t)=>{let n=Object.assign({},R.query);t.length?n.categories=t:delete n.categories,e.length?n.search=e:delete n.search,z.replace({query:n})},K=()=>{ge(g.value,o.value.map(e=>e.id).join(`,`)),Y(!1)},_e=async()=>{try{m.value=!0,await P.getWorkflows({search:g.value,categories:o.value.map(e=>e.name)}),b.value=!1}catch{b.value=!0}m.value=!1},ve=async()=>{try{f.value=!0,await P.getCollections({categories:o.value.map(e=>String(e.id)),search:g.value})}catch{}f.value=!1},q=(e,t)=>{e&&(_.value&&_.value.search_string.length>e.length||(_.value={search_string:e,workflow_results_count:U.value.length,collection_results_count:W.value.length,categories_applied:t.map(e=>P.getCategoryById(e.toString())),wf_template_repo_session_id:P.currentSessionId}))},J=()=>{o.value.length&&B.track(`User changed template filters`,{search_string:g.value,categories_applied:o.value,wf_template_repo_session_id:P.currentSessionId})},Y=async e=>{let t=[...o.value],n=g.value;await Promise.all([_e(),ve()]),e||q(n,t.map(e=>e.id))},X=(e,t,n)=>{if(e.metaKey||e.ctrlKey){let e=z.resolve({name:t,params:{id:n}});window.open(e.href,`_blank`);return}else z.push({name:t,params:{id:n}})},ye=({event:e,id:t})=>{X(e,de.COLLECTION,t)},be=({event:e,id:t})=>{X(e,de.TEMPLATE,t)},Z=()=>{_.value&&=(B.track(`User searched workflow templates`,_.value),null)},xe=e=>{m.value=!0,f.value=!0,g.value=e,S(K,{debounceTime:500,trailing:!0}),e.length===0&&Z()},Q=e=>{o.value=o.value.concat(e),K(),J()},Se=e=>{o.value=o.value.filter(t=>t.id!==e.id),K(),J()},Ce=()=>{o.value=[],K()},we=async()=>{if(!(U.value.length>=H.value))try{m.value=!0,await P.getMoreWorkflows({categories:o.value.map(e=>e.name),search:g.value})}catch{w.showMessage({title:`Error`,message:`Could not load more workflows`,type:`error`})}finally{m.value=!1}},Te=async()=>{try{await P.getCategories()}catch{}u.value=!1},Ee=(e,t=`smooth`)=>{setTimeout(()=>{let n=document.getElementById(`content`);n&&n.scrollTo({top:e,behavior:t})},0)},$=()=>{let e=!1;if(R.query.search&&typeof R.query.search==`string`&&(g.value=R.query.search,e=!0),typeof R.query.categories==`string`&&R.query.categories.length){let t=R.query.categories.split(`,`);o.value=P.allCategories.filter(e=>t.includes(e.id.toString())),e=!0}e&&(K(),J(),t.value=!0)};return p(async()=>{k.set(`Templates`),await Te(),Y(!0),F.showPersonalizationSurvey(),$(),j.isTemplatesEnabled&&j.testTemplatesEndpoint().catch(()=>{}),setTimeout(()=>{let e=R.meta?.scrollOffset;typeof e==`number`&&e>0&&Ee(e,`auto`)},100)}),ne((e,t,n)=>{let r=document.getElementById(`content`);r&&R.meta?.setScrollPosition?.(r.scrollTop),Z(),n()}),h(U,e=>{e.length===0&&window.scrollTo(0,0)}),(e,n)=>{let c=T(`n8n-html`);return y(),d(me,null,{header:v(()=>[D(`div`,{class:E(e.$style.wrapper)},[D(`div`,{class:E(e.$style.title)},[l(s(I),{tag:`h1`,size:`2xlarge`},{default:v(()=>[x(r(s(L).baseText(`templates.heading`)),1)]),_:1})],2),D(`div`,{class:E(e.$style.button)},[l(s(te),{variant:`subtle`,size:`large`,href:s(fe),label:s(L).baseText(`templates.shareWorkflow`),target:`_blank`},null,8,[`href`,`label`])],2)],2)]),content:v(()=>[D(`div`,{class:E(e.$style.contentWrapper)},[D(`div`,{class:E(e.$style.filters)},[l(ke,{categories:s(P).allCategories,"sort-on-populate":t.value,selected:o.value,loading:u.value,onClear:Se,onClearAll:Ce,onSelect:Q},null,8,[`categories`,`sort-on-populate`,`selected`,`loading`])],2),D(`div`,{class:E(e.$style.search)},[l(s(re),{"model-value":g.value,placeholder:s(L).baseText(`templates.searchPlaceholder`),clearable:``,"data-test-id":`template-search-input`,"onUpdate:modelValue":xe,onBlur:Z},{prefix:v(()=>[l(s(M),{icon:`search`})]),_:1},8,[`model-value`,`placeholder`]),O(D(`div`,{class:E(e.$style.carouselContainer)},[D(`div`,{class:E(e.$style.header)},[l(s(I),{bold:!0,size:`medium`,color:`text-light`},{default:v(()=>[x(r(s(L).baseText(`templates.collections`))+` `,1),f.value?a(``,!0):(y(),i(`span`,{key:0,"data-test-id":`collection-count-label`,textContent:r(`(${W.value.length})`)},null,8,Ae))]),_:1})],2),l(De,{collections:W.value,loading:f.value,onOpenCollection:ye},null,8,[`collections`,`loading`])],2),[[C,W.value.length||f.value]]),l(he,{"infinite-scroll-enabled":!0,loading:m.value,workflows:U.value,"total-count":H.value,onLoadMore:we,onOpenTemplate:be},null,8,[`loading`,`workflows`,`total-count`]),G.value?(y(),i(`div`,{key:0,class:E(e.$style.endText)},[l(s(N),{size:`medium`,color:`text-base`},{default:v(()=>[O(D(`span`,null,null,512),[[c,G.value]])]),_:1})],2)):a(``,!0)],2)],2)]),_:1})}}}),[[`__cssModules`,{$style:{wrapper:`_wrapper_n14ka_125`,contentWrapper:`_contentWrapper_n14ka_130`,filters:`_filters_n14ka_140`,search:`_search_n14ka_146`,header:`_header_n14ka_158`}}]]);export{je as default};
//# sourceMappingURL=TemplatesSearchView-DIgxvuNE.js.map