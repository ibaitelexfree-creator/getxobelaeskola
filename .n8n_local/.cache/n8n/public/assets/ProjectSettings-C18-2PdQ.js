(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`361f5f9c-a691-4718-9bea-edb1aab3d012`,e._sentryDebugIdIdentifier=`sentry-dbid-361f5f9c-a691-4718-9bea-edb1aab3d012`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,G as a,Gt as o,I as s,It as c,M as l,P as u,T as d,U as f,W as p,Z as m,_t as h,at as g,bt as _,et as v,ft as y,h as b,j as x,q as S,vn as C,w,yn as T}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{bt as E,ot as D,yt as O}from"./_MapCache-DjbOQyB7.js";import{At as k,E as A,Hi as j,O as M,Oi as N,Pi as P,Tt as F,Ui as I,Vi as L,a as R,at as z,gi as B,i as V,ji as ee,ot as H,p as U,w as W,wi as te,zi as G}from"./src-CppJvwzX.js";import{t as K}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Gt as ne,Lt as re,Xr as ie,fn as ae,lr as oe,r as q,t as se,ws as J,yr as ce}from"./users.store-pCkD7Zo0.js";import{t as Y}from"./radio-CPckkBdz.js";import{t as X}from"./dialog-Ds437WFa.js";import{t as le}from"./Alert-DMo6Skho.js";import{Es as ue,Ha as de,Qc as fe,f as pe,ol as me,rs as Z,ti as he}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import{t as ge}from"./usePageRedirectionHelper-BoF8hzbN.js";import{t as _e}from"./useEnvFeatureFlag-CHY3xSda.js";import"./folders.store-CS_gIPIm.js";import{n as ve}from"./ProjectIcon-D-HRIqn6.js";import"./orderBy-KAUxkCYD.js";import{t as ye}from"./ProjectSharing-DgwjJKfK.js";import{t as be}from"./roles.store-Cq99swn7.js";import"./readyToRun.store-DM7AW4os.js";import{t as xe}from"./ProjectHeader-KFxxuu0P.js";import{t as Se}from"./userRoleProvisioning.store-CIdn8sQc.js";import{t as Ce}from"./useSecretsProvidersList.ee-COKc7Sm2.js";var we={key:1},Te={class:`pt-l`},Ee=K(u({__name:`ProjectDeleteDialog`,props:f({currentProject:{},projects:{},resourceCounts:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:f([`confirmDelete`],[`update:modelValue`]),setup(e,{emit:a}){let s=e,u=y(e,`modelValue`),f=a,p=O(),m=c(null),h=c(null),g=c(``),S=t(()=>s.resourceCounts.credentials+s.resourceCounts.workflows+s.resourceCounts.dataTables>0),T=t(()=>{let e=p.baseText(`projects.settings.delete.question.wipe.placeholder`);return!S.value||h.value===`transfer`&&!!m.value||h.value===`wipe`&&g.value===e}),E=()=>{T.value&&(h.value===`wipe`&&(m.value=null),f(`confirmDelete`,m.value?.id))};return(e,t)=>(v(),d(o(X),{modelValue:u.value,"onUpdate:modelValue":t[4]||=e=>u.value=e,title:o(p).baseText(`projects.settings.delete.title`,{interpolate:{projectName:s.currentProject?.name??``}}),width:`650`},{footer:_(()=>[l(o(j),{variant:`destructive`,type:`button`,disabled:!T.value,"data-test-id":`project-settings-delete-confirm-button`,onClick:b(E,[`stop`,`prevent`])},{default:_(()=>[x(n(o(p).baseText(`projects.settings.danger.deleteProject`)),1)]),_:1},8,[`disabled`])]),default:_(()=>[S.value?S.value?(v(),r(`div`,we,[l(o(L),{color:`text-base`},{default:_(()=>[x(n(o(p).baseText(`projects.settings.delete.message`)),1)]),_:1}),w(`div`,Te,[l(o(Y),{"model-value":h.value??``,label:`transfer`,class:`mb-s`,"onUpdate:modelValue":t[0]||=e=>h.value=`transfer`},{default:_(()=>[l(o(L),{color:`text-dark`},{default:_(()=>[x(n(o(p).baseText(`projects.settings.delete.question.transfer.label`)),1)]),_:1})]),_:1},8,[`model-value`]),h.value===`transfer`?(v(),r(`div`,{key:0,class:C(e.$style.operation)},[l(o(L),{color:`text-dark`},{default:_(()=>[x(n(o(p).baseText(`projects.settings.delete.question.transfer.title`)),1)]),_:1}),l(ye,{modelValue:m.value,"onUpdate:modelValue":t[1]||=e=>m.value=e,class:`pt-2xs`,projects:s.projects,"empty-options-text":o(p).baseText(`projects.sharing.noMatchingProjects`)},null,8,[`modelValue`,`projects`,`empty-options-text`])],2)):i(``,!0),l(o(Y),{"model-value":h.value??``,label:`wipe`,class:`mb-s`,"onUpdate:modelValue":t[2]||=e=>h.value=`wipe`},{default:_(()=>[l(o(L),{color:`text-dark`},{default:_(()=>[x(n(o(p).baseText(`projects.settings.delete.question.wipe.label`)),1)]),_:1})]),_:1},8,[`model-value`]),h.value===`wipe`?(v(),r(`div`,{key:1,class:C(e.$style.operation)},[l(o(H),{label:o(p).baseText(`projects.settings.delete.question.wipe.title`)},{default:_(()=>[l(o(ee),{modelValue:g.value,"onUpdate:modelValue":t[3]||=e=>g.value=e,"data-test-id":`project-delete-confirm-input`,placeholder:o(p).baseText(`projects.settings.delete.question.wipe.placeholder`)},null,8,[`modelValue`,`placeholder`])]),_:1},8,[`label`])],2)):i(``,!0)])])):i(``,!0):(v(),d(o(L),{key:0,color:`text-base`},{default:_(()=>[x(n(o(p).baseText(`projects.settings.delete.message.empty`)),1)]),_:1}))]),_:1},8,[`modelValue`,`title`]))}}),[[`__cssModules`,{$style:{operation:`_operation_jv0de_125`}}]]),De={class:`pt-l`},Oe=u({__name:`ProjectRoleUpgradeDialog`,props:f({limit:{},planName:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,r=y(e,`modelValue`),i=ge(),a=O(),s=async()=>{await i.goToUpgrade(`rbac`,`upgrade-rbac`),r.value=!1};return(e,i)=>(v(),d(o(X),{modelValue:r.value,"onUpdate:modelValue":i[1]||=e=>r.value=e,title:o(a).baseText(`projects.settings.role.upgrade.title`),width:`500`},{footer:_(()=>[l(o(j),{variant:`subtle`,"native-type":`button`,onClick:i[0]||=e=>r.value=!1},{default:_(()=>[x(n(o(a).baseText(`generic.cancel`)),1)]),_:1}),l(o(j),{variant:`solid`,"native-type":`button`,onClick:s},{default:_(()=>[x(n(o(a).baseText(`projects.create.limitReached.link`)),1)]),_:1})]),default:_(()=>[w(`div`,De,[l(o(E),{keypath:`projects.settings.role.upgrade.message`,scope:`global`},{planName:_(()=>[x(n(t.planName),1)]),limit:_(()=>[x(n(o(a).baseText(`projects.create.limit`,{adjustToNumber:t.limit,interpolate:{count:String(t.limit)}})),1)]),_:1})])]),_:1},8,[`modelValue`,`title`]))}}),ke=u({__name:`ProjectMembersActionsCell`,props:{data:{},actions:{}},emits:[`action`],setup(e,{emit:t}){let n=e,r=t,a=e=>{r(`action`,{action:e,userId:n.data.id})};return(e,t)=>n.actions.length>0?(v(),d(o(F),{key:0,placement:`bottom`,actions:n.actions,theme:`dark`,onAction:a},null,8,[`actions`])):i(``,!0)}}),Ae=K(u({__name:`RoleHoverPopover`,props:{role:{}},setup(e){let r=new Set(`project:read.project:update.project:delete.folder:read.folder:update.folder:create.folder:move.folder:delete.workflow:read.workflow:update.workflow:create.workflow:publish.workflow:move.workflow:delete.credential:read.credential:update.credential:create.credential:share.credential:move.credential:delete.dataTable:read.dataTable:readRow.dataTable:update.dataTable:writeRow.dataTable:create.dataTable:delete.projectVariable:read.projectVariable:update.projectVariable:create.projectVariable:delete.sourceControl:push`.split(`.`)),a=r.size,s=e,c=O(),u=te(),f=se(),p=t(()=>f.isInstanceOwner||f.isAdmin),m=t(()=>p.value&&!s.role.systemRole),h=t(()=>s.role.scopes?.filter(e=>r.has(e)).length??0),y=t(()=>m.value?c.baseText(`projects.settings.role.popover.viewAndEdit`):c.baseText(`projects.settings.role.popover.viewDetails`)),b=()=>{m.value?u.push({name:Z.PROJECT_ROLE_SETTINGS,params:{roleSlug:s.role.slug}}):u.push({name:Z.PROJECT_ROLE_VIEW,params:{roleSlug:s.role.slug}})};return(t,r)=>(v(),d(o(N),{placement:`right`,"show-after":300,enterable:!0,offset:1,"content-class":`role-hover-popover`},{content:_(()=>[w(`div`,{class:C(t.$style.popoverContent)},[l(o(L),{tag:`div`,bold:!0,size:`medium`,class:C(t.$style.roleName)},{default:_(()=>[x(n(e.role.displayName),1)]),_:1},8,[`class`]),l(o(L),{tag:`div`,size:`small`,color:`text-light`,class:C(t.$style.permissionCount)},{default:_(()=>[x(n(o(c).baseText(`projects.settings.role.selector.permissionCount`,{interpolate:{count:String(h.value),total:String(o(a))}})),1)]),_:1},8,[`class`]),e.role.description?(v(),d(o(L),{key:0,tag:`div`,size:`small`,class:C(t.$style.description)},{default:_(()=>[x(n(e.role.description),1)]),_:1},8,[`class`])):i(``,!0),l(o(j),{type:`tertiary`,size:`small`,class:C(t.$style.actionButton),onClick:b},{append:_(()=>[w(`span`,{class:C(t.$style.externalIcon)},`↗`,2)]),default:_(()=>[x(n(y.value)+` `,1)]),_:1},8,[`class`])],2)]),default:_(()=>[g(t.$slots,`default`)]),_:3}))}}),[[`__cssModules`,{$style:{popoverContent:`_popoverContent_1ra36_125`,roleName:`_roleName_1ra36_130`,permissionCount:`_permissionCount_1ra36_134`,description:`_description_1ra36_138`,actionButton:`_actionButton_1ra36_142`,externalIcon:`_externalIcon_1ra36_146`}}]]),je=K(u({__name:`ProjectRoleContactAdminModal`,props:f({customRolesExist:{type:Boolean,default:!1}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let r=e,i=y(e,`modelValue`),a=O(),s=t(()=>r.customRolesExist?`projects.settings.role.contactAdmin.titleWithRoles`:`projects.settings.role.contactAdmin.title`),c=t(()=>r.customRolesExist?`projects.settings.role.contactAdmin.bodyWithRoles`:`projects.settings.role.contactAdmin.body`);return(e,t)=>(v(),d(o(X),{modelValue:i.value,"onUpdate:modelValue":t[0]||=e=>i.value=e,width:`400`,"show-close":!0},{header:_(()=>[l(o(L),{tag:`span`,size:`large`,bold:!0},{default:_(()=>[x(n(o(a).baseText(s.value)),1)]),_:1})]),default:_(()=>[w(`div`,{class:C(e.$style.content)},[l(o(L),{tag:`p`,size:`medium`},{default:_(()=>[x(n(o(a).baseText(c.value).replace(`{documentation}`,``))+` `,1),l(o(B),{href:o(pe),"new-window":!0},{default:_(()=>[x(n(o(a).baseText(`generic.documentation`)),1)]),_:1},8,[`href`])]),_:1})],2)]),_:1},8,[`modelValue`]))}}),[[`__cssModules`,{$style:{content:`_content_m6nnw_125`}}]]),Me=K(u({__name:`ProjectCustomRolesUpgradeModal`,props:{modelValue:{type:Boolean},modelModifiers:{}},emits:[`update:modelValue`],setup(e){let t=y(e,`modelValue`),r=O(),{goToUpgrade:i}=ge(),a=async()=>{await i(`custom-roles`,`upgrade-custom-roles`),t.value=!1};return(e,i)=>(v(),d(o(X),{modelValue:t.value,"onUpdate:modelValue":i[1]||=e=>t.value=e,title:o(r).baseText(`projects.settings.role.upgrade.title`),width:`400`},{footer:_(()=>[w(`div`,{class:C(e.$style.footer)},[l(o(j),{type:`secondary`,onClick:i[0]||=e=>t.value=!1},{default:_(()=>[x(n(o(r).baseText(`generic.cancel`)),1)]),_:1}),l(o(j),{type:`primary`,onClick:a},{append:_(()=>[w(`span`,{class:C(e.$style.externalIcon)},`↗`,2)]),default:_(()=>[x(n(o(r).baseText(`projects.settings.role.upgrade.custom.viewPlans`))+` `,1)]),_:1})],2)]),default:_(()=>[w(`div`,{class:C(e.$style.content)},[l(o(L),{tag:`p`,size:`medium`},{default:_(()=>[x(n(o(r).baseText(`projects.settings.role.upgrade.custom.body`).replace(`{documentation}`,``))+` `,1),l(o(B),{href:o(pe),"new-window":!0},{default:_(()=>[x(n(o(r).baseText(`generic.documentation`)),1)]),_:1},8,[`href`])]),_:1})],2)]),_:1},8,[`modelValue`,`title`]))}}),[[`__cssModules`,{$style:{content:`_content_c8g9i_125`,footer:`_footer_c8g9i_129`,externalIcon:`_externalIcon_c8g9i_135`}}]]),Ne={key:1},Pe=K(u({__name:`ProjectMembersRoleCell`,props:{data:{},roles:{}},emits:[`update:role`],setup(e,{emit:a}){let s=e,u=a,f=O(),m=te(),g=J(),y=se(),S=c(!1),T=c(!1),E=c(!1),D=c(``);h(S,e=>{e||(D.value=``)});let A=()=>{S.value=!1,document.activeElement instanceof HTMLElement&&document.activeElement.blur()},j=t(()=>s.roles.find(e=>e.slug===s.data.role)),M=t(()=>s.data.role!==`project:personalOwner`),N=t(()=>g.isCustomRolesFeatureEnabled),P=t(()=>y.isInstanceOwner||y.isAdmin),F=t(()=>s.roles.filter(e=>e.systemRole)),z=t(()=>s.roles.filter(e=>!e.systemRole)),B=t(()=>{let e=D.value.toLowerCase().trim();return e?F.value.filter(t=>t.displayName.toLowerCase().includes(e)):F.value}),H=t(()=>{let e=D.value.toLowerCase().trim();return e?z.value.filter(t=>t.displayName.toLowerCase().includes(e)):z.value}),U=t(()=>{let e=[];return B.value.length>0&&(e.push({type:`label`,label:f.baseText(`projects.settings.role.selector.section.system`)}),B.value.forEach(t=>{e.push({value:t.slug,label:t.displayName,role:t})})),(H.value.length>0||!D.value&&!N.value)&&(e.push({type:`label`,label:f.baseText(`projects.settings.role.selector.section.custom`)}),H.value.forEach(t=>{e.push({value:t.slug,label:t.displayName,disabled:!t.licensed,role:t})})),e}),W=e=>{if(!e||typeof e!=`string`)return;let t=s.roles.find(t=>t.slug===e);if(t&&!t.licensed){A(),E.value=!0;return}u(`update:role`,{role:e,userId:s.data.id})},G=()=>{A(),N.value?P.value?m.push({name:Z.PROJECT_NEW_ROLE}):T.value=!0:E.value=!0};return(t,a)=>M.value?(v(),r(`div`,{key:0,class:C(t.$style.container)},[l(o(V),{open:S.value,"onUpdate:open":a[4]||=e=>S.value=e,items:U.value,"model-value":e.data.role,size:`small`,variant:`ghost`,class:C(t.$style.roleSelect),"data-test-id":`project-member-role-dropdown`,"onUpdate:modelValue":W},{default:_(()=>[w(`span`,{class:C(t.$style.triggerContent)},n(j.value?.displayName),3)]),header:_(()=>[w(`div`,{class:C(t.$style.searchContainer)},[l(o(ee),{modelValue:D.value,"onUpdate:modelValue":a[0]||=e=>D.value=e,placeholder:o(f).baseText(`generic.search`),size:`medium`,class:C(t.$style.searchInput),onClick:a[1]||=b(()=>{},[`stop`]),onKeydown:a[2]||=b(()=>{},[`stop`])},null,8,[`modelValue`,`placeholder`,`class`])],2)]),item:_(({item:e})=>[e.role?(v(),d(Ae,{key:0,role:e.role},{default:_(()=>[l(o(R),p(e,{class:t.$style.selectItem}),{"item-label":_(()=>[l(o(L),{tag:`span`,size:`medium`,color:e.disabled?`text-light`:`text-dark`},{default:_(()=>[x(n(e.label),1)]),_:2},1032,[`color`])]),"item-trailing":_(()=>[e.disabled&&N.value?(v(),d(o(k),{key:0,theme:`warning`,class:C(t.$style.upgradeBadge)},{default:_(()=>[x(n(o(f).baseText(`generic.upgrade`)),1)]),_:1},8,[`class`])):i(``,!0)]),_:2},1040,[`class`])]),_:2},1032,[`role`])):i(``,!0)]),label:_(({item:e})=>[w(`span`,{class:C(t.$style.sectionLabelContent)},[x(n(e.label)+` `,1),e.label===o(f).baseText(`projects.settings.role.selector.section.custom`)&&!N.value?(v(),d(o(k),{key:0,theme:`default`,class:C(t.$style.sectionUpgradeBadge),onClick:a[3]||=b(e=>{A(),E.value=!0},[`stop`])},{default:_(()=>[l(o(I),{icon:`lock`,size:`xsmall`}),x(` `+n(o(f).baseText(`generic.upgrade`)),1)]),_:1},8,[`class`])):i(``,!0)],2)]),footer:_(()=>[w(`button`,{type:`button`,class:C(t.$style.addCustomRoleButton),onClick:b(G,[`stop`])},[l(o(I),{icon:`plus`,size:`small`}),l(o(L),{tag:`span`,size:`small`},{default:_(()=>[x(n(o(f).baseText(`projects.settings.role.selector.addCustomRole`)),1)]),_:1})],2)]),_:1},8,[`open`,`items`,`model-value`,`class`]),l(je,{modelValue:T.value,"onUpdate:modelValue":a[5]||=e=>T.value=e,"custom-roles-exist":z.value.length>0},null,8,[`modelValue`,`custom-roles-exist`]),l(Me,{modelValue:E.value,"onUpdate:modelValue":a[6]||=e=>E.value=e},null,8,[`modelValue`])],2)):(v(),r(`span`,Ne,n(j.value?.displayName),1))}}),[[`__cssModules`,{$style:{container:`_container_lhuqt_125`,searchContainer:`_searchContainer_lhuqt_129`,searchInput:`_searchInput_lhuqt_133`,roleSelect:`_roleSelect_lhuqt_141`,triggerContent:`_triggerContent_lhuqt_150`,selectItem:`_selectItem_lhuqt_157`,upgradeBadge:`_upgradeBadge_lhuqt_164`,sectionLabelContent:`_sectionLabelContent_lhuqt_169`,sectionUpgradeBadge:`_sectionUpgradeBadge_lhuqt_175`,addCustomRoleButton:`_addCustomRoleButton_lhuqt_182`}}]]),Q={class:`pt-xs pb-xs`},Fe=u({__name:`ProjectMembersTable`,props:f({data:{},loading:{type:Boolean},currentUserId:{},projectRoles:{},actions:{},canEditRole:{type:Boolean}},{tableOptions:{default:()=>({page:0,itemsPerPage:10,sortBy:[]})},tableOptionsModifiers:{}}),emits:f([`update:options`,`update:role`,`action`],[`update:tableOptions`]),setup(e,{emit:i}){let a=O(),u=e,f=i,p=y(e,`tableOptions`),m=t(()=>u.data.items),h=c([{title:a.baseText(`projects.settings.table.header.user`),key:`name`,width:400,disableSort:!0,value:e=>e},{title:a.baseText(`projects.settings.table.header.role`),key:`role`,width:200,disableSort:!0},{title:``,key:`actions`,align:`end`,width:46,disableSort:!0,value(){}}]),g=e=>e.id!==u.currentUserId&&u.canEditRole,b=({role:e,userId:t})=>{f(`update:role`,{role:e,userId:t})},S=e=>e.id===u.currentUserId||e.role===`project:personalOwner`?[]:(u.actions??[]).filter(t=>t.guard?.(e)??!0);return(t,i)=>(v(),r(`div`,null,[l(o(U),{"sort-by":p.value.sortBy,"onUpdate:sortBy":i[1]||=e=>p.value.sortBy=e,page:p.value.page,"onUpdate:page":i[2]||=e=>p.value.page=e,"items-per-page":e.data.count,headers:h.value,items:m.value,"items-length":e.data.count,loading:e.loading,"page-sizes":[e.data.count+1],"onUpdate:options":i[3]||=e=>f(`update:options`,e)},{"item.name":_(({value:e})=>[w(`div`,Q,[l(o(M),T(s(e)),null,16)])]),"item.role":_(({item:e})=>[g(e)?(v(),d(Pe,{key:0,data:e,roles:u.projectRoles,"onUpdate:role":b},null,8,[`data`,`roles`])):(v(),d(o(L),{key:1,color:`text-dark`},{default:_(()=>[x(n(u.projectRoles.find(t=>t.slug===e.role)?.displayName??e.role),1)]),_:2},1024))]),"item.actions":_(({item:e})=>[l(ke,{data:e,actions:S(e),onAction:i[0]||=e=>t.$emit(`action`,e)},null,8,[`data`,`actions`])]),_:2},1032,[`sort-by`,`page`,`items-per-page`,`headers`,`items`,`items-length`,`loading`,`page-sizes`])]))}}),Ie={key:0},Le={class:`mb-s`},Re={for:`projectExternalSecrets`},ze=[`onClick`],Be=K(u({__name:`ProjectExternalSecrets`,setup(e,{expose:a}){let s=O(),u=ce(),f=te(),p=ne(),g=q(),y=se(),b=Ce(),S=_e(),T=c([]),E=c(!1),D=c(``),k=c(new Set),A=c(0),M=c(5),N=t(()=>S.check.value(`EXTERNAL_SECRETS_FOR_PROJECTS`)),F=t(()=>p.currentProject?.scopes?.includes(`externalSecretsProvider:list`)??!1),R=t(()=>p.currentProject?.scopes?.includes(`externalSecretsProvider:create`)??!1),z=t(()=>y.currentUser?.role===he.Owner||y.currentUser?.role===he.Admin),V=t(()=>N.value&&F.value),H=t(()=>T.value.length>0?null:z.value?b.activeProviders.value.length>0?`instance-admin-no-project-providers`:`project-admin-no-providers`:R.value?`project-admin-no-providers`:null),W=t(()=>{let e=H.value;return e?{"instance-admin-no-project-providers":{heading:s.baseText(`projects.settings.externalSecrets.emptyState.heading`),description:s.baseText(`projects.settings.externalSecrets.emptyState.instanceAdmin.noProjectProviders.description`),buttonText:s.baseText(`projects.settings.externalSecrets.button.shareSecretsStore`),buttonType:`secondary`,buttonAction:fe,testId:`external-secrets-empty-state-no-project-providers`},"project-admin-no-providers":{heading:s.baseText(`projects.settings.externalSecrets.emptyState.heading`),description:s.baseText(`projects.settings.externalSecrets.emptyState.projectAdmin.description`),buttonText:s.baseText(`projects.settings.externalSecrets.button.addSecretsStore`),buttonType:`secondary`,buttonAction:de,testId:`external-secrets-empty-state-project-admin`}}[e]:null}),K=t(()=>{if(!D.value.trim())return T.value;let e=D.value.toLowerCase();return T.value.filter(t=>t.secrets?.some(n=>n.name.toLowerCase().includes(e)||t.name.toLowerCase().includes(e)))}),re=t(()=>{let e=A.value*M.value,t=e+M.value;return K.value.slice(e,t)}),ie=t(()=>{let e=[];return re.value.forEach(t=>{let n=J(t.type)?.displayName??t.type,r=k.value.has(t.name),i=t.secrets??[];if(D.value.trim()){let e=D.value.toLowerCase();i=i.filter(n=>n.name.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))}let a=i.length;e.push({id:`header-${t.name}`,type:`provider-header`,providerName:t.name,providerKey:t.name,providerType:t.type,providerDisplayName:n,secretsCount:a,isExpanded:r}),r&&i.length>0&&i.forEach(r=>{e.push({id:`${t.name}-${r.name}`,type:`secret`,secretName:r.name,providerName:t.name,providerKey:t.name,providerType:t.type,providerDisplayName:n,credentialsCount:r.credentialsCount})})}),e}),ae=t(()=>[{title:s.baseText(`projects.settings.externalSecrets.table.header.secretName`),key:`secretName`,disableSort:!0,value:e=>e.type===`secret`?e.secretName:``},{title:s.baseText(`projects.settings.externalSecrets.table.header.provider`),key:`secretsStore`,disableSort:!0,value:e=>e.providerName},{title:s.baseText(`projects.settings.externalSecrets.table.header.usedInCredentials`),key:`credentialsCount`,width:200,disableSort:!0,value:e=>e.type===`secret`&&e.credentialsCount!==void 0?e.credentialsCount:``}]);function oe(e){k.value.has(e)?k.value.delete(e):k.value.add(e)}function J(e){return b.providerTypes.value.find(t=>t.type===e)}async function Y(){if(!(!p.currentProjectId||!F.value||!N.value)){E.value=!0;try{T.value=await p.getProjectSecretProviders(p.currentProjectId)}catch(e){u.showError(e,s.baseText(`projects.settings.externalSecrets.load.error`))}finally{E.value=!1}}}function X(e,t=`connection`){let n=b.activeProviders.value.map(e=>e.name);g.openModalWithData({name:ue,data:{activeTab:t,providerKey:e,providerTypes:b.providerTypes.value,existingProviderNames:n,projectId:p.currentProjectId,onClose:async()=>{await Y()}}})}function le(e){X(e,`connection`)}function de(){X()}function fe(){f.push({name:Z.EXTERNAL_SECRETS_SETTINGS})}return h(D,()=>{A.value=0}),h(()=>p.currentProjectId,async e=>{e&&V.value&&await Y()},{immediate:!0}),m(async()=>{V.value&&await Promise.all([b.fetchProviderTypes(),b.fetchActiveConnections()])}),a({fetchProjectSecretProviders:Y}),(e,t)=>V.value?(v(),r(`fieldset`,Ie,[w(`h3`,Le,[w(`label`,Re,n(o(s).baseText(`projects.settings.externalSecrets`)),1)]),W.value?(v(),d(o(P),{key:0,class:C(e.$style.externalSecretsEmpty),"data-test-id":W.value.testId,description:`yes`},{description:_(()=>[l(o(G),{tag:`h3`,size:`small`,class:`mb-2xs`},{default:_(()=>[x(n(W.value.heading),1)]),_:1}),l(o(L),{size:`small`,color:`text-base`,class:C(e.$style.description)},{default:_(()=>[x(n(W.value.description),1)]),_:1},8,[`class`])]),additionalContent:_(()=>[l(o(j),{type:`highlight`,class:`mr-2xs`,element:`a`,href:o(s).baseText(`settings.externalSecrets.docs`),target:`_blank`,"data-test-id":`secrets-provider-connections-learn-more`},{default:_(()=>[x(n(o(s).baseText(`generic.learnMore`))+` `,1),l(o(I),{icon:`arrow-up-right`})]),_:1},8,[`href`]),l(o(j),{type:W.value.buttonType,"data-test-id":`${H.value}-button`,onClick:W.value.buttonAction},{default:_(()=>[x(n(W.value.buttonText),1)]),_:1},8,[`type`,`data-test-id`,`onClick`])]),_:1},8,[`class`,`data-test-id`])):T.value.length>0?(v(),r(`div`,{key:1,class:C(e.$style.secretProvidersContainer)},[T.value.length>=5?(v(),r(`div`,{key:0,class:C(e.$style.searchContainer)},[l(o(ee),{modelValue:D.value,"onUpdate:modelValue":t[0]||=e=>D.value=e,placeholder:o(s).baseText(`projects.settings.externalSecrets.search.placeholder`),clearable:``,"data-test-id":`secrets-providers-search`,size:`small`},{prefix:_(()=>[l(o(I),{icon:`search`})]),_:1},8,[`modelValue`,`placeholder`])],2)):i(``,!0),l(o(U),{page:A.value,"onUpdate:page":t[1]||=e=>A.value=e,headers:ae.value,items:ie.value,"items-length":K.value.length,loading:E.value,"items-per-page":M.value,"page-sizes":[5,10,25,50],"row-props":t=>({class:t.type===`provider-header`?e.$style.groupHeaderRow:``}),"data-test-id":`external-secrets-table`},{item:_(({item:t})=>[t.type===`provider-header`?(v(),r(`tr`,{key:0,class:C(e.$style.groupHeaderRow),onClick:e=>oe(t.providerName)},[w(`td`,{colspan:`3`,class:C(e.$style.groupHeaderCell)},[w(`div`,{class:C(e.$style.groupHeaderContent)},[l(o(I),{icon:t.isExpanded?`chevron-down`:`chevron-right`,class:C(e.$style.expandIcon)},null,8,[`icon`,`class`]),l(o(L),{bold:``},{default:_(()=>[x(n(t.providerDisplayName),1)]),_:2},1024)],2)],2)],10,ze)):(v(),r(`tr`,{key:1,class:C(e.$style.secretRow)},[w(`td`,{class:C(e.$style.secretNameCell)},[w(`code`,{class:C(e.$style.secretName)},n(t.secretName),3)],2),w(`td`,{class:C(e.$style.secretStoreCell)},[l(o(B),{class:C(e.$style.providerLink),"data-test-id":`secrets-store-link`,onClick:e=>le(t.providerKey)},{default:_(()=>[x(n(t.providerName),1)]),_:2},1032,[`class`,`onClick`])],2),w(`td`,{class:C(e.$style.secretCredentialsCell)},[t.credentialsCount===void 0?i(``,!0):(v(),d(o(L),{key:0,size:`small`,class:C(e.$style.credentialsCount)},{default:_(()=>[x(n(t.credentialsCount),1)]),_:2},1032,[`class`]))],2)],2))]),_:1},8,[`page`,`headers`,`items`,`items-length`,`loading`,`items-per-page`,`row-props`])],2)):i(``,!0)])):i(``,!0)}}),[[`__cssModules`,{$style:{externalSecretsEmpty:`_externalSecretsEmpty_137hw_125`,description:`_description_137hw_129`,secretProvidersContainer:`_secretProvidersContainer_137hw_134`,searchContainer:`_searchContainer_137hw_140`,groupHeaderRow:`_groupHeaderRow_137hw_145`,groupHeaderCell:`_groupHeaderCell_137hw_153`,secretRow:`_secretRow_137hw_157`,groupHeaderContent:`_groupHeaderContent_137hw_179`,expandIcon:`_expandIcon_137hw_188`,secretNameCell:`_secretNameCell_137hw_196`,secretName:`_secretName_137hw_196`,secretIcon:`_secretIcon_137hw_210`,secretStoreCell:`_secretStoreCell_137hw_215`,secretCredentialsCell:`_secretCredentialsCell_137hw_219`,providerLink:`_providerLink_137hw_223`,credentialsCount:`_credentialsCount_137hw_227`}}]]),Ve={for:`projectName`},He={for:`projectDescription`},Ue={id:`projectMembers`},We={for:`projectMembers`},Ge={key:0,class:`mb-m`},Ke={class:`mb-m`},qe=10,$=K(u({__name:`ProjectSettings`,setup(e){let s=se(),u=O(),f=ne(),p=be(),g=oe(),y=Se(),T=ce(),E=te(),k=re(),M=ae(),N=e=>{T.showError(e,u.baseText(`projects.settings.save.error.title`))},P=c(!1),F=c(!1),R=c(!1),B=c(!1),V=c({credentials:-1,dataTables:-1,workflows:-1}),H=c({name:``,description:``,relations:[]}),U=c(!1),G=c(null),K=c({type:`icon`,value:`layers`}),q=c(``),J=c({page:0,itemsPerPage:10,sortBy:[{id:`firstName`,desc:!1},{id:`lastName`,desc:!1},{id:`email`,desc:!1}]}),Y=c(``),X=c([]),ue=c(!1),pe=t(()=>X.value.filter(e=>!(H.value.relations||[]).find(t=>t.id===e.id))),ge=t(()=>f.availableProjects.filter(e=>e.id!==f.currentProjectId)),_e=t(()=>p.processedProjectRoles.find(e=>e.licensed)?.slug),ye=t(()=>[{label:u.baseText(`projects.settings.table.row.removeUser`),value:`remove`,guard:e=>e.id!==s.currentUser?.id&&e.role!==`project:personalOwner`}]),Ce=async e=>{if(!f.currentProject)return;let t=s.usersById[e];if(!t)return;let n=_e.value;if(n){(t.role===he.Owner||t.role===he.Admin)&&p.processedProjectRoles.find(e=>e.slug===`project:admin`&&e.licensed)&&(n=`project:admin`),H.value.relations.find(t=>t.id===e)||H.value.relations.push({id:e,role:n});try{U.value=!0,await f.addMember(f.currentProject.id,{userId:e,role:n}),T.showMessage({type:`success`,title:u.baseText(`projects.settings.member.added.title`)}),k.track(`User added member to project`,{project_id:f.currentProject.id,target_user_id:e,role:n})}catch(t){H.value.relations=H.value.relations.filter(t=>t.id!==e),N(t)}}},we=async({userId:e,role:t})=>{if(!f.currentProject)return;let n=H.value.relations.findIndex(t=>t.id===e);if(n===-1)return;let r=H.value.relations[n].role;H.value.relations[n].role=t;try{U.value=!0,await f.updateMemberRole(f.currentProject.id,e,t),p.fetchRoles(),T.showMessage({type:`success`,title:u.baseText(`projects.settings.memberRole.updated.title`)}),k.track(`User changed member role on project`,{project_id:f.currentProject.id,target_user_id:e,role:t})}catch(e){H.value.relations[n].role=r,T.showError(e,u.baseText(`projects.settings.memberRole.update.error.title`))}},Te=()=>{R.value=!0};async function De(e){let t=f.currentProject;if(!t)return;let n=H.value.relations.findIndex(t=>t.id===e);if(n===-1)return;let r=H.value.relations.splice(n,1)[0];if(t.relations.some(t=>t.id===e))try{U.value=!0,await f.removeMember(t.id,e),T.showMessage({type:`success`,title:u.baseText(`projects.settings.member.removed.title`)}),k.track(`User removed member from project`,{project_id:t.id,target_user_id:e})}catch(e){H.value.relations.splice(n,0,r),N(e)}}let ke=async({action:e,userId:t})=>{switch(e){case`remove`:await De(t);break;default:break}},Ae=()=>{H.value.relations=f.currentProject?.relations?de(f.currentProject.relations):[],H.value.name=f.currentProject?.name??``,H.value.description=f.currentProject?.description??``},je=()=>{Ae(),R.value=!1},Me=()=>{let e={};return f.currentProject?(H.value.name!==f.currentProject.name&&(e.name=H.value.name??``),H.value.description!==f.currentProject.description&&(e.description=H.value.description??``),H.value.relations.length!==f.currentProject.relations.length&&(e.memberAdded=H.value.relations.filter(e=>!f.currentProject?.relations.find(t=>t.id===e.id)),e.memberRemoved=f.currentProject.relations.filter(e=>!H.value.relations.find(t=>t.id===e.id))),e.role=H.value.relations.filter(t=>f.currentProject?.relations.find(e=>e.id===t.id)?.role!==t.role&&!e.memberAdded?.find(e=>e.id===t.id)),e):e},Ne=e=>{let t=f.currentProject?.id;e.name&&k.track(`User changed project name`,{project_id:t,name:e.name}),e.memberAdded?.forEach(e=>{k.track(`User added member to project`,{project_id:t,target_user_id:e.id,role:e.role})}),e.memberRemoved?.forEach(e=>{k.track(`User removed member from project`,{project_id:t,target_user_id:e.id})}),e.role?.forEach(e=>{k.track(`User changed member role on project`,{project_id:t,target_user_id:e.id,role:e.role})})},Pe=async()=>{if(f.currentProject)try{await f.updateProject(f.currentProject.id,{name:H.value.name??``,description:H.value.description??``}),R.value=!1}catch(e){throw N(e),e}},Q=async()=>{if(R.value)try{await Pe(),Ne(Me()),T.showMessage({title:u.baseText(`projects.settings.save.successful.title`,{interpolate:{projectName:H.value.name??``}}),type:`success`})}catch{}},Ie=async()=>{await f.getAvailableProjects(),f.currentProjectId&&(V.value=await f.getResourceCounts(f.currentProjectId)),P.value=!0},Le=async e=>{try{if(f.currentProject){let t=f.currentProject?.name??``;await f.deleteProject(f.currentProject.id,e),await E.push({name:Z.HOMEPAGE}),T.showMessage({title:u.baseText(`projects.settings.delete.successful.title`,{interpolate:{projectName:t}}),type:`success`}),P.value=!0}}catch(e){T.showError(e,u.baseText(`projects.settings.delete.error.title`))}},Re=()=>{H.value.name===u.baseText(`projects.settings.newProjectName`)&&(G.value?.inputRef?.focus(),G.value?.inputRef?.select())},ze=async()=>{if(f.currentProject)try{await f.updateProject(f.currentProject.id,{icon:K.value}),T.showMessage({title:u.baseText(`projects.settings.icon.update.successful.title`),type:`success`})}catch(e){N(e)}};h(()=>f.currentProject,async()=>{if(U.value){U.value=!1;return}Ae(),await a(),Re(),f.currentProject?.icon&&ve(f.currentProject.icon)&&(K.value=f.currentProject.icon)},{immediate:!0});let $=t(()=>H.value.relations.map(e=>{let t=s.usersById[e.id],n=ie(e.role)?e.role:`project:viewer`;return{...t,...e,role:n,firstName:e?.firstName??t?.firstName??null,lastName:e?.lastName??t?.lastName??null,email:e?.email??t?.email??null}})),Je=t(()=>({items:$.value,count:$.value.length})),Ye=t(()=>{if(!q.value.trim())return Je.value;let e=q.value.toLowerCase(),t=$.value.filter(t=>{let n=`${t.firstName??``} ${t.lastName??``}`.toLowerCase(),r=(t.email??``).toLowerCase();return n.includes(e)||r.includes(e)});return{items:t,count:t.length}}),Xe=t(()=>$.value.length>=qe);h(Xe,e=>{!e&&q.value&&(q.value=``)});let Ze=D(()=>{J.value.page=0},me(fe.INPUT.SEARCH)),Qe=e=>{q.value=e,Ze()},$e=e=>{J.value=e},et=async e=>{Y.value=e,ue.value=!0;try{let t=e.trim()?{fullText:e}:void 0;await s.fetchUsers({take:50,filter:t}),e.trim()?X.value=s.allUsers.filter(t=>{let n=e.toLowerCase(),r=`${t.firstName??``} ${t.lastName??``}`.toLowerCase(),i=(t.email??``).toLowerCase();return r.includes(n)||i.includes(n)}):X.value=s.allUsers}catch(e){T.showError(e,u.baseText(`projects.settings.users.search.error`))}finally{ue.value=!1}},tt=D(et,me(fe.INPUT.SEARCH));S(async()=>{await et(``)});let nt=t(()=>y.provisioningConfig?.scopesProvisionProjectRoles||!1);return m(async()=>{M.set(u.baseText(`projects.settings`)),Re(),await Promise.all([y.getProvisioningConfig(),p.fetchRoles()])}),(e,t)=>(v(),r(`div`,{class:C(e.$style.projectSettings),"data-test-id":`project-settings-container`},[w(`div`,{class:C(e.$style.header)},[l(xe),w(`div`,{class:C(e.$style.headerRow)},[l(o(L),{tag:`h1`,size:`xlarge`,class:`pt-xs pb-m`},{default:_(()=>[x(n(o(u).baseText(`projects.settings.info`)),1)]),_:1}),w(`div`,{class:C(e.$style.headerButtons)},[l(o(j),{variant:`subtle`,"native-type":`button`,disabled:!R.value,class:`mr-2xs`,"data-test-id":`project-settings-cancel-button`,onClick:b(je,[`stop`,`prevent`])},{default:_(()=>[x(n(o(u).baseText(`projects.settings.button.cancel`)),1)]),_:1},8,[`disabled`]),l(o(j),{disabled:!B.value||!R.value,variant:`solid`,"data-test-id":`project-settings-save-button`,onClick:b(Q,[`stop`,`prevent`])},{default:_(()=>[x(n(o(u).baseText(`projects.settings.button.save`)),1)]),_:1},8,[`disabled`])],2)],2)],2),w(`form`,{onSubmit:b(Q,[`prevent`])},[w(`fieldset`,null,[w(`label`,Ve,n(o(u).baseText(`projects.settings.name`)),1),w(`div`,{class:C(e.$style.projectName)},[l(o(W),{modelValue:K.value,"onUpdate:modelValue":[t[0]||=e=>K.value=e,ze],"button-tooltip":o(u).baseText(`projects.settings.iconPicker.button.tooltip`)},null,8,[`modelValue`,`button-tooltip`]),l(o(z),{id:`projectName`,ref_key:`nameInput`,ref:G,modelValue:H.value.name,"onUpdate:modelValue":t[1]||=e=>H.value.name=e,label:``,type:`text`,name:`name`,required:``,"data-test-id":`project-settings-name-input`,class:C(e.$style.projectNameInput),onEnter:Q,onInput:Te,onValidate:t[2]||=e=>B.value=e},null,8,[`modelValue`,`class`])],2)]),w(`fieldset`,null,[w(`label`,He,n(o(u).baseText(`projects.settings.description`)),1),l(o(z),{id:`projectDescription`,modelValue:H.value.description,"onUpdate:modelValue":t[3]||=e=>H.value.description=e,label:``,name:`description`,type:`textarea`,maxlength:512,autosize:!0,"data-test-id":`project-settings-description-input`,class:C(e.$style.projectDescriptionInput),onEnter:Q,onInput:Te,onValidate:t[4]||=e=>B.value=e},null,8,[`modelValue`,`class`])]),l(Be,{class:C(e.$style.externalSecrets)},null,8,[`class`]),w(`fieldset`,Ue,[w(`h3`,null,[w(`label`,We,n(o(u).baseText(`projects.settings.projectMembers`)),1)]),w(`div`,{class:C([e.$style.membersInputRow,`mb-s`])},[l(o(A),{id:`projectMembers`,class:C(e.$style.userSelect),size:`large`,users:pe.value,"current-user-id":o(s).currentUser?.id,placeholder:o(u).baseText(`workflows.shareModal.select.placeholder`),"data-test-id":`project-members-select`,remote:``,"remote-method":o(tt),loading:ue.value,"onUpdate:modelValue":Ce,disabled:nt.value},{prefix:_(()=>[l(o(I),{icon:`search`})]),_:1},8,[`class`,`users`,`current-user-id`,`placeholder`,`remote-method`,`loading`,`disabled`]),Xe.value?(v(),d(o(ee),{key:0,class:C(e.$style.search),"model-value":q.value,placeholder:o(u).baseText(`projects.settings.members.search.placeholder`),clearable:``,"data-test-id":`project-members-search`,"onUpdate:modelValue":Qe},{prefix:_(()=>[l(o(I),{icon:`search`})]),_:1},8,[`class`,`model-value`,`placeholder`])):i(``,!0)],2),nt.value?(v(),r(`div`,Ge,[l(o(le),{type:`info`,title:o(u).baseText(`settings.provisioningProjectRolesHandledBySsoProvider.description`)},null,8,[`title`])])):i(``,!0),$.value.length>0?(v(),r(`div`,{key:1,class:C(e.$style.membersTableContainer)},[l(Fe,{"table-options":J.value,"onUpdate:tableOptions":t[5]||=e=>J.value=e,"data-test-id":`project-members-table`,data:Ye.value,"current-user-id":o(s).currentUser?.id,"project-roles":o(p).processedProjectRoles,actions:ye.value,"can-edit-role":!nt.value,"onUpdate:options":$e,"onUpdate:role":we,onAction:ke},null,8,[`table-options`,`data`,`current-user-id`,`project-roles`,`actions`,`can-edit-role`])],2)):i(``,!0)]),w(`fieldset`,null,[w(`h3`,Ke,n(o(u).baseText(`projects.settings.danger.title`)),1),w(`small`,{class:C(e.$style.danger)},n(o(u).baseText(`projects.settings.danger.message`)),3),l(o(j),{variant:`subtle`,size:`large`,"native-type":`button`,"data-test-id":`project-settings-delete-button`,onClick:b(Ie,[`stop`,`prevent`])},{default:_(()=>[x(n(o(u).baseText(`projects.settings.danger.deleteProject`)),1)]),_:1})])],32),l(Ee,{modelValue:P.value,"onUpdate:modelValue":t[6]||=e=>P.value=e,"current-project":o(f).currentProject,"resource-counts":V.value,projects:ge.value,onConfirmDelete:Le},null,8,[`modelValue`,`current-project`,`resource-counts`,`projects`]),l(Oe,{modelValue:F.value,"onUpdate:modelValue":t[7]||=e=>F.value=e,limit:o(f).teamProjectsLimit,"plan-name":o(g).currentPlanData?.displayName},null,8,[`modelValue`,`limit`,`plan-name`])],2))}}),[[`__cssModules`,{$style:{projectSettings:`_projectSettings_yap04_125`,header:`_header_yap04_149`,headerRow:`_headerRow_yap04_155`,headerButtons:`_headerButtons_yap04_162`,upgrade:`_upgrade_yap04_168`,externalSecrets:`_externalSecrets_yap04_172`,membersInputRow:`_membersInputRow_yap04_177`,membersTableContainer:`_membersTableContainer_yap04_185`,search:`_search_yap04_189`,projectName:`_projectName_yap04_194`,projectNameInput:`_projectNameInput_yap04_199`,projectDescriptionInput:`_projectDescriptionInput_yap04_203`,userSelect:`_userSelect_yap04_204`,danger:`_danger_yap04_214`}}]]);export{$ as default};
//# sourceMappingURL=ProjectSettings-C18-2PdQ.js.map