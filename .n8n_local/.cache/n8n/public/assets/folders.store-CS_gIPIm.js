(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`a8cf55aa-337e-4d63-b1c3-bcd40f9e2fb1`,e._sentryDebugIdIdentifier=`sentry-dbid-a8cf55aa-337e-4d63-b1c3-bcd40f9e2fb1`)})()}catch{}import{It as e}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as t}from"./_MapCache-DjbOQyB7.js";import{Wc as n,qt as r,wa as i}from"./users.store-pCkD7Zo0.js";import{d as a,j as o,r as s,u as c}from"./_baseOrderBy-El3qbNHQ.js";async function l(e,t,n,r){return await a(e,`POST`,`/projects/${t}/folders`,{name:n,parentFolderId:r})}async function u(e,t,n){return await a(e,`GET`,`/projects/${t}/folders/${n}/tree`)}async function d(e,t,n,r){return await a(e,`DELETE`,`/projects/${t}/folders/${n}`,{transferToFolderId:r})}async function f(e,t,n,r){return await a(e,`PATCH`,`/projects/${t}/folders/${n}`,{name:r})}async function p(e,t,n,r,i){let a=await c(e,`GET`,`/projects/${t}/folders`,{...r?{filter:r}:{},...n||{},...i?{select:JSON.stringify(i)}:{}});return{data:a.data,count:a.count}}async function m(e,t,n){return(await c(e,`GET`,`/projects/${t}/folders/${n}/credentials`)).data}async function h(e,t,n,r){return await a(e,`PATCH`,`/projects/${t}/folders/${n}`,{parentFolderId:r})}async function g(e,t,n){return(await c(e,`GET`,`/projects/${t}/folders/${n}/content`)).data}var _=300;const v=o(n.FOLDERS,()=>{let n=s(),a=t(),o=e(!1),c=e(0),v=e(null),y=e(null),b=e({}),x=e=>{e.forEach(e=>{b.value[e.id]||(b.value[e.id]={id:e.id,name:e.name,parentFolder:e.parentFolder})})},S=e=>b.value[e];async function C(e,t,r){return await l(n.restApiContext,t,e,r)}async function w(e,t){let r=await u(n.restApiContext,e,t);return x(T(r)),r}function T(e,t){let n=[];return e.forEach(e=>{if(n.push({id:e.id,name:e.name,parentFolder:t}),e.children&&e.children.length>0){let t=T(e.children,e.id);n=[...n,...t]}}),n}async function E(e,t){o.value=!1;let{count:r}=await i(n.restApiContext,{projectId:e,parentFolderId:t},{skip:0,take:1},!0);return c.value=r,o.value=!0,r}let D=e=>{e.forEach(e=>{delete b.value[e]})};async function O(e,t,r){await d(n.restApiContext,e,t,r)}async function k(e,t,r){await f(n.restApiContext,e,t,r)}async function A(e){return await p(n.restApiContext,e)}async function j(e,t,r){let i=0,a=0,o=[];do{let{data:s,count:c}=await p(n.restApiContext,e,{skip:i,take:100,sortBy:`updatedAt:desc`},{excludeFolderIdAndDescendants:t,name:r?.name},[`id`,`name`,`createdAt`,`updatedAt`,`project`,`tags`,`parentFolder`,`workflowCount`,`subFolderCount`,`path`]);o=o.concat(s.map(e=>({...e,resource:`folder`}))),a=c,i+=s.length}while(o.length<a&&i<a);return x(o.map(e=>({id:e.id,name:e.name,parentFolder:e.parentFolder?.id}))),o.sort((e,t)=>{if(e.path.length!==t.path.length)return e.path.length-t.path.length;for(let n=0;n<e.path.length;n++){let r=e.path[n].localeCompare(t.path[n]);if(r!==0)return r}return 0}),o}async function M(e,t){return await m(n.restApiContext,e,t)}async function N(e,t,r){await h(n.restApiContext,e,t,r),delete b.value[t]}async function P(e,t,i,a,o){await r(n.restApiContext,e,t,i,a,o),delete b.value[t]}async function F(e,t){return await g(n.restApiContext,e,t)}async function I(e,t,n){let r=Date.now(),i=await w(e.id,t),o=t=>{let r=[{id:t.id,label:t.name,href:n?.addLinks?`/projects/${e.id}/folders/${t.id}/workflows`:void 0}];if(t.children?.length){let i=t.children.flatMap(t=>{let r=[{id:t.id,label:t.name,href:n?.addLinks?`/projects/${e.id}/folders/${t.id}/workflows`:void 0}];return t.children?.length&&r.push.apply(r,o(t).slice(1)),r});r.push.apply(r,i)}return r},s;s=i.length===0?[{id:e.id,label:e.name},{id:`-1`,label:a.baseText(`folders.breadcrumbs.noTruncated.message`)}]:[{id:e.id,label:e.name},...i.flatMap(o)];let c=Date.now()-r,l=Math.max(0,_-c);return l>0&&await new Promise(e=>setTimeout(e,l)),s}return{fetchTotalWorkflowsAndFoldersCount:E,breadcrumbsCache:b,cacheFolders:x,getCachedFolder:S,createFolder:C,getFolderPath:w,totalWorkflowCount:c,workflowsCountLoaded:o,deleteFolder:O,deleteFoldersFromCache:D,renameFolder:k,fetchProjectFolders:A,fetchFoldersAvailableForMove:j,moveFolder:N,moveFolderToProject:P,fetchFolderContent:F,getHiddenBreadcrumbsItems:I,draggedElement:v,activeDropTarget:y,fetchFolderUsedCredentials:M}});export{v as t};
//# sourceMappingURL=folders.store-CS_gIPIm.js.map