(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`7227362c-f9d4-4f10-924d-ed9082be4d12`,e._sentryDebugIdIdentifier=`sentry-dbid-7227362c-f9d4-4f10-924d-ed9082be4d12`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,M as s,P as c,T as l,Z as u,_t as d,at as f,bt as p,et as m,j as h,k as g,p as _,vn as v,w as y,xt as b}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as x}from"./_MapCache-DjbOQyB7.js";import{Et as S,Hi as C,Oi as w,Pi as T,Q as E,Tt as D,U as O,Ui as k,V as A,Vi as j,Y as M,gi as N,j as P,ji as F,jt as I,p as L,z as R,zi as z}from"./src-CppJvwzX.js";import{t as B}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as V,fn as ee,r as te,t as ne,yr as H}from"./users.store-pCkD7Zo0.js";import{Ns as re,qo as U,rs as W}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{r as G}from"./_baseOrderBy-El3qbNHQ.js";import"./banners.store-Ce6ZTWqJ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import"./dataTable.store-dy4dvFXe.js";import{t as K}from"./useClipboard-Duc7LjuO.js";import"./executions.store-DnLtKXBA.js";import"./useEnvFeatureFlag-CHY3xSda.js";import"./usePinnedData-C6FFXoty.js";import"./nodeIcon--7uU1Imq.js";import"./canvas.utils-C8dCdoZZ.js";import"./nodeCreator.store-KD9kt9dE.js";import"./useCanvasOperations-BHGWcL34.js";import"./folders.store-CS_gIPIm.js";import"./useDynamicCredentials-BSZ25lEI.js";import"./NodeIcon-Dv1e4Lvu.js";import{t as q}from"./TimeAgo-BLqTSlco.js";import"./roles.store-Cq99swn7.js";import"./dist-BiTDpeeI.js";import"./sso.store-Dd63iqNy.js";import{t as J}from"./router-BsVVJ6vf.js";import"./insights.store-CIIvho7C.js";import"./insights.constants-DHL43iRt.js";import"./insights.utils-B2NpOI0Q.js";import{a as ie,i as ae,l as oe,n as Y,o as se,r as X}from"./mcp.constants-BtNzU3_O.js";import{t as ce}from"./useMcp-Vjm6-wcy.js";import{t as Z}from"./mcp.store-BS0hY8V7.js";import{t as le}from"./WorkflowLocation-JAxJfyHi.js";var Q={key:0},ue={key:1},de=[`href`],fe=B(c({__name:`MCPEmptyState`,props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:[`turnOnMcp`],setup(e,{emit:t}){let o=e,c=t,l=x();return(e,t)=>(m(),r(`div`,{class:v(e.$style.container),"data-test-id":`mcp-empty-state-container`},[s(a(T),{icon:{type:`icon`,value:`mcp`},heading:a(l).baseText(`settings.mcp.actionBox.heading`),description:a(l).baseText(`settings.mcp.description`),"button-text":a(l).baseText(`settings.mcp.actionBox.button.label`),"button-disabled":o.disabled||o.loading,"button-variant":`solid`,"data-test-id":`enable-mcp-access-button`,"onClick:button":t[0]||=e=>c(`turnOnMcp`)},{disabledButtonTooltip:p(()=>[o.loading?(m(),r(`span`,Q,n(a(l).baseText(`generic.loading`))+`...`,1)):o.disabled?(m(),r(`span`,ue,n(a(l).baseText(`settings.mcp.toggle.disabled.tooltip`)),1)):i(``,!0)]),additionalContent:p(()=>[s(a(j),{color:`text-light`,size:`small`},{default:p(()=>[h(n(a(l).baseText(`settings.mcp.emptyState.docs.part1`))+` `,1),y(`a`,{href:a(ie),class:v(e.$style[`docs-link`]),target:`_blank`,rel:`noopener noreferrer`},n(a(l).baseText(`generic.learnMore`).toLowerCase()),11,de)]),_:1})]),_:1},8,[`heading`,`description`,`button-text`,`button-disabled`])],2))}}),[[`__cssModules`,{$style:{container:`_container_pmfp4_125`,"docs-link":`_docs-link_pmfp4_134`}}]]),pe=B(c({__name:`McpAccessToggle`,props:{modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:[`disableMcpAccess`],setup(e,{emit:t}){let i=e,o=t,c=x(),l=()=>{o(`disableMcpAccess`)};return(t,o)=>(m(),r(`div`,{class:v(t.$style[`main-toggle-container`])},[y(`div`,{class:v(t.$style[`main-toggle-info`])},[s(a(j),{bold:!0,color:e.modelValue?`success`:`text-light`,size:`small`},{default:p(()=>[h(n(e.modelValue?a(c).baseText(`settings.mcp.header.toggle.enabled`):a(c).baseText(`settings.mcp.header.toggle.disabled`)),1)]),_:1},8,[`color`])],2),y(`div`,{class:v(t.$style[`main-toggle`]),"data-test-id":`mcp-toggle-container`},[s(a(w),{content:a(c).baseText(`settings.mcp.toggle.disabled.tooltip`),disabled:!i.disabled,placement:`top`},{default:p(()=>[s(a(I),{size:`large`,"data-test-id":`mcp-access-toggle`,"model-value":i.modelValue,disabled:i.disabled,loading:i.loading,"onUpdate:modelValue":l},null,8,[`model-value`,`disabled`,`loading`])]),_:1},8,[`content`,`disabled`])],2)],2))}}),[[`__cssModules`,{$style:{"main-toggle-container":`_main-toggle-container_6ezoc_125`,"main-toggle":`_main-toggle_6ezoc_125`}}]]),me=[`for`],he=[`id`],$=B(c({__name:`ConnectionParameter`,props:{id:{},label:{},value:{},valueLoading:{type:Boolean,default:!1},infoTip:{default:void 0},allowCopy:{type:Boolean,default:!0}},emits:[`copy`],setup(e,{emit:t}){let{copy:o,copied:c,isSupported:u}=K(),d=x(),g=e,_=t,b=async e=>{await o(e),_(`copy`,e)};return(e,t)=>(m(),r(`div`,{class:v(e.$style.container)},[y(`div`,{class:v(e.$style[`label-wrapper`])},[y(`label`,{class:v(e.$style.label),for:`connection-parameter-${g.id}`},n(g.label),11,me),g.infoTip?(m(),r(`div`,{key:0,class:v(e.$style[`info-tip`])},[s(a(E),{type:`tooltip`,size:`small`},{default:p(()=>[h(n(g.infoTip),1)]),_:1})],2)):i(``,!0)],2),y(`div`,{id:`connection-parameter-${g.id}`,class:v({[e.$style[`parameter-value`]]:!0,[e.$style[`parameter-value--loading`]]:g.valueLoading}),"data-test-id":`connection-parameter-value`},[y(`div`,{class:v(e.$style[`input-wrapper`])},[g.valueLoading?(m(),l(a(S),{key:0,loading:g.valueLoading,variant:`h1`,class:v(e.$style[`parameter-skeleton`])},null,8,[`loading`,`class`])):(m(),l(a(F),{key:1,modelValue:g.value,"onUpdate:modelValue":t[0]||=e=>g.value=e,type:`text`,readonly:!0},null,8,[`modelValue`]))],2),y(`div`,{class:v(e.$style[`copy-button-wrapper`])},[f(e.$slots,`customActions`),s(a(w),{disabled:!a(u),content:a(c)?a(d).baseText(`generic.copied`):a(d).baseText(`generic.copy`),"show-after":a(100),placement:`bottom`},{default:p(()=>[g.allowCopy&&a(u)?(m(),l(a(C),{key:0,variant:`subtle`,iconOnly:``,icon:a(c)?`check`:`copy`,class:v(e.$style[`copy-button`]),disabled:g.valueLoading,onClick:t[1]||=e=>b(g.value)},null,8,[`icon`,`class`,`disabled`])):i(``,!0)]),_:1},8,[`disabled`,`content`,`show-after`])],2)],10,he)],2))}}),[[`__cssModules`,{$style:{container:`_container_pb8ho_125`,"label-wrapper":`_label-wrapper_pb8ho_131`,"info-tip":`_info-tip_pb8ho_136`,label:`_label_pb8ho_131`,"parameter-value":`_parameter-value_pb8ho_149`,"parameter-value--loading":`_parameter-value--loading_pb8ho_160`,"input-wrapper":`_input-wrapper_pb8ho_163`,"parameter-skeleton":`_parameter-skeleton_pb8ho_181`,"copy-button-wrapper":`_copy-button-wrapper_pb8ho_203`,"copy-button":`_copy-button_pb8ho_203`}}]]),ge=B(c({__name:`MCPOAuthPopoverTab`,props:{serverUrl:{}},emits:[`copy`],setup(e,{emit:t}){let n=e,i=t,o=x(),c=e=>{i(`copy`,e)};return(e,t)=>(m(),r(`div`,{class:v(e.$style.container),"data-test-id":`mcp-oauth-popover-tab`},[s($,{id:`oauth-server-url`,label:a(o).baseText(`settings.mcp.connectPopover.serverUrl`),value:n.serverUrl,onCopy:c},null,8,[`label`,`value`])],2))}}),[[`__cssModules`,{$style:{container:`_container_x8qjm_125`}}]]),_e=B(c({__name:`MCPAccessTokenPopoverTab`,props:{serverUrl:{}},emits:[`copy`],setup(e,{emit:c}){let d=e,f=c,g=x(),_=H(),b=Z(),T=o(!0),E=o(!1),D=t(()=>b.currentUserMCPKey),{copy:k,copied:A,isSupported:j}=K(),N=t(()=>`
{
  "mcpServers": {
    "n8n-mcp": {
      "command": "npx",
      "args": [
        "-y",
        "supergateway",
        "--streamableHttp",
        "${d.serverUrl}",
        "--header",
        "authorization:Bearer ${I.value}"
      ]
    }
  }
}
`),P=t(()=>D.value?.apiKey?.includes(`******`)??!1),F=t(()=>`\`\`\`json${N.value}\`\`\``),I=t(()=>E.value?`<${g.baseText(`generic.loading`)}...>`:P.value?`<YOUR_ACCESS_TOKEN_HERE>`:D.value?.apiKey),L=async()=>{try{T.value=!0,await b.getOrCreateApiKey()}catch(e){_.showError(e,g.baseText(`settings.mcp.error.fetching.apiKey`))}finally{setTimeout(()=>{T.value=!1},200)}},R=async()=>{try{E.value=!0,await b.generateNewApiKey()}catch(e){_.showError(e,g.baseText(`settings.mcp.error.rotating.apiKey`))}finally{setTimeout(()=>{E.value=!1},200)}},z=async()=>{await k(N.value),f(`copy`,`mcpJson`,N.value)},B=e=>{f(`copy`,`serverUrl`,e)},V=()=>{D.value?.apiKey&&f(`copy`,`accessToken`,D.value.apiKey)};return u(async()=>{D.value?T.value=!1:await L()}),(e,t)=>(m(),r(`div`,{class:v(e.$style.container),"data-test-id":`mcp-access-token-popover-tab`},[s($,{id:`oauth-server-url`,label:a(g).baseText(`settings.mcp.connectPopover.serverUrl`),value:d.serverUrl,onCopy:B},null,8,[`label`,`value`]),T.value?(m(),r(`div`,{key:0,class:v(e.$style[`loading-container`])},[s(a(S),{loading:T.value,variant:`h1`,class:v(e.$style[`url-skeleton`])},null,8,[`loading`,`class`]),s(a(S),{loading:T.value,variant:`button`,class:v(e.$style[`code-skeleton`])},null,8,[`loading`,`class`])],2)):D.value?.apiKey?(m(),r(`div`,{key:1,class:v(e.$style[`parameters-container`])},[s($,{id:`access-token`,value:D.value.apiKey,"value-loading":E.value,label:a(g).baseText(`settings.mcp.connectPopover.tab.accessToken`),"info-tip":a(g).baseText(`settings.mcp.instructions.apiKey.tip`),"allow-copy":!P.value,onCopy:V},{customActions:p(()=>[s(a(w),{content:a(g).baseText(`settings.mcp.instructions.rotateKey.tooltip`),"show-after":a(100)},{default:p(()=>[s(a(C),{variant:`subtle`,iconOnly:``,icon:`refresh-cw`,disabled:E.value,onClick:R},null,8,[`disabled`])]),_:1},8,[`content`,`show-after`])]),_:1},8,[`value`,`value-loading`,`label`,`info-tip`,`allow-copy`]),P.value?i(``,!0):(m(),l(a(O),{key:0},{default:p(()=>[h(n(a(g).baseText(`settings.mcp.access.token.notice`)),1)]),_:1})),y(`div`,{class:v(e.$style[`json-container`]),"data-test-id":`mcp-access-token-json`},[y(`label`,{class:v(e.$style.label),for:`mcp-json`},n(a(g).baseText(`settings.mcp.connectPopover.jsonConfig`)),3),s(a(M),{id:`mcp-json`,content:F.value},null,8,[`content`]),s(a(w),{disabled:!a(j),content:a(A)?a(g).baseText(`generic.copied`):a(g).baseText(`generic.copy`),"show-after":a(100)},{default:p(()=>[a(j)&&!T.value&&!E.value?(m(),l(a(C),{key:0,variant:`subtle`,iconOnly:``,icon:a(A)?`check`:`copy`,class:v(e.$style[`copy-json-button`]),"data-test-id":`mcp-json-copy-button`,onClick:z},null,8,[`icon`,`class`])):i(``,!0)]),_:1},8,[`disabled`,`content`,`show-after`])],2)],2)):i(``,!0)],2))}}),[[`__cssModules`,{$style:{container:`_container_1jg97_125`,"loading-container":`_loading-container_1jg97_130`,"url-skeleton":`_url-skeleton_1jg97_136`,"code-skeleton":`_code-skeleton_1jg97_141`,"parameters-container":`_parameters-container_1jg97_146`,"json-container":`_json-container_1jg97_152`,label:`_label_1jg97_157`,"copy-json-button":`_copy-json-button_1jg97_175`}}]]),ve=B(c({__name:`McpConnectPopover`,props:{disabled:{type:Boolean}},setup(e){let t=x(),c=V(),u=G(),f=Z(),g=e,_={ACCESS_TOKEN:`accessToken`,OAUTH:`oauth`},b=o([{value:_.OAUTH,label:t.baseText(`settings.mcp.connectPopover.tab.oauth`)},{value:_.ACCESS_TOKEN,label:t.baseText(`settings.mcp.connectPopover.tab.accessToken`)}]),S=o(`${u.urlBaseEditor}${se}`),w=o(b.value[0].value),T=e=>{e?f.openConnectPopover():(f.closeConnectPopover(),f.resetCurrentUserMCPKey())},E=e=>{w.value=e},D=e=>{O({item:{serverUrl:`server-url`,accessToken:`access-token`,mcpJson:`mcp-json`}[e],source:`token-tab`})},O=e=>{c.track(`User copied MCP connection parameter`,{parameter:e.item,source:e.source})};return d(()=>g.disabled,e=>{e||f.openConnectPopover()}),(o,c)=>(m(),r(`div`,null,[s(a(A),{id:`mcp-connect-popover`,open:a(f).connectPopoverOpen,"content-class":o.$style.popper,"show-arrow":!1,width:`${a(460)}px`,"onUpdate:open":T},{trigger:p(()=>[s(a(C),{variant:`subtle`,"data-test-id":`mcp-connect-popover-trigger-button`,disabled:e.disabled},{default:p(()=>[h(n(a(t).baseText(`settings.mcp.connectPopover.triggerLabel`)),1)]),_:1},8,[`disabled`])]),content:p(()=>[y(`div`,{class:v(o.$style[`popper-content`]),"data-test-id":`mcp-connect-popover-content`},[y(`header`,null,[s(a(R),{"data-test-id":`mcp-connect-popover-tabs`,"model-value":w.value,options:b.value,"onUpdate:modelValue":E},null,8,[`model-value`,`options`])]),y(`main`,null,[w.value===_.OAUTH?(m(),l(ge,{key:0,"server-url":S.value,onCopy:c[0]||=e=>O({item:`server-url`,source:`oauth-tab`})},null,8,[`server-url`])):w.value===_.ACCESS_TOKEN?(m(),l(_e,{key:1,"server-url":S.value,onCopy:D},null,8,[`server-url`])):i(``,!0)])],2)]),_:1},8,[`open`,`content-class`,`width`])]))}}),[[`__cssModules`,{$style:{popper:`_popper_7glv7_125`,"popper-content":`_popper-content_7glv7_129`}}]]),ye=B(c({__name:`MCPHeaderActions`,props:{toggleDisabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},accessEnabled:{type:Boolean}},emits:[`disableMcpAccess`],setup(e,{emit:t}){let n=e,i=t;return(t,a)=>(m(),r(`div`,{class:v(t.$style.container),"data-test-id":`mcp-header-actions`},[s(pe,{"model-value":e.accessEnabled,disabled:n.toggleDisabled,loading:n.loading,class:v(t.$style[`mcp-access-toggle`]),onDisableMcpAccess:a[0]||=e=>i(`disableMcpAccess`)},null,8,[`model-value`,`disabled`,`loading`,`class`]),s(ve,{disabled:!e.accessEnabled},null,8,[`disabled`])],2))}}),[[`__cssModules`,{$style:{container:`_container_gl7pe_125`}}]]),be={key:0},xe={key:1,class:`mt-s mb-xl`},Se=[`onClick`],Ce={key:0},we={key:1},Te=B(c({__name:`WorkflowsTable`,props:{workflows:{},loading:{type:Boolean}},emits:[`removeMcpAccess`,`connectWorkflows`,`updateDescription`],setup(e,{emit:t}){let i=e,c=t,l=x(),u=o([{title:l.baseText(`settings.mcp.workflows.table.column.name`),key:`workflow`,width:150,disableSort:!0,value(){}},{title:l.baseText(`settings.mcp.workflows.table.column.location`),key:`location`,width:200,disableSort:!0,value(){}},{title:l.baseText(`generic.description`),key:`description`,width:350,disableSort:!0,value(){}},{title:``,key:`actions`,align:`end`,width:50,disableSort:!0,value(){}}]),d=e=>{let t=U(e.scopes);return[{label:l.baseText(`settings.mcp.workflows.table.action.removeMCPAccess`),value:`removeFromMCP`,disabled:!t.workflow.update},{label:l.baseText(`settings.mcp.workflows.table.action.updateDescription`),value:`updateDescription`,disabled:!t.workflow.update}]},f=(e,t)=>{switch(e){case`removeFromMCP`:c(`removeMcpAccess`,t);break;case`updateDescription`:c(`updateDescription`,t);break;default:break}},_=()=>{c(`connectWorkflows`)};return(e,t)=>(m(),r(`div`,{class:v(e.$style[`workflow-table-container`])},[i.loading?(m(),r(`div`,be,[s(a(S),{loading:i.loading,variant:`h1`,class:`mb-l`},null,8,[`loading`]),s(a(S),{loading:i.loading,variant:`p`,rows:5,"shrink-last":!1},null,8,[`loading`])])):(m(),r(`div`,xe,[s(a(L),{class:v(e.$style[`workflow-table`]),"data-test-id":`mcp-workflow-table`,headers:u.value,items:i.workflows,"items-length":i.workflows.length},g({"item.workflow":p(({item:t})=>[y(`div`,{class:v(e.$style[`workflow-cell`]),"data-test-id":`mcp-workflow-cell`},[s(a(N),{"data-test-id":`mcp-workflow-name-link`,"new-window":!0,to:a(J).resolve({name:a(W).WORKFLOW,params:{name:t.id}}).fullPath,theme:`text`,class:v([e.$style[`table-link`],e.$style.truncate])},{default:p(()=>[s(a(j),{class:v(e.$style.truncate),"data-test-id":`mcp-workflow-name`},{default:p(()=>[h(n(t.name),1)]),_:2},1032,[`class`])]),_:2},1032,[`to`,`class`])],2)]),"item.location":p(({item:t})=>[y(`div`,{class:v(e.$style[`location-cell`]),"data-test-id":`mcp-workflow-location-cell`},[s(le,{"workflow-id":t.id,"home-project":t.homeProject,"parent-folder":t.parentFolder,"as-links":!0},null,8,[`workflow-id`,`home-project`,`parent-folder`])],2)]),"item.description":p(({item:t})=>[s(a(w),{content:t.description||a(l).baseText(`settings.mcp.workflows.table.column.description.emptyTooltip`),"show-after":a(100),"popper-class":e.$style[`description-popper`]},{default:p(()=>[y(`div`,{"data-test-id":`mcp-workflow-description-cell`,class:v(e.$style[`description-cell`]),onClick:e=>c(`updateDescription`,t)},[t.description?(m(),r(`span`,Ce,[s(a(j),{"data-test-id":`mcp-workflow-description`},{default:p(()=>[h(n(t.description),1)]),_:2},1024)])):(m(),r(`span`,we,[s(a(k),{icon:`triangle-alert`,size:14,color:`warning`,class:`mr-2xs`}),s(a(j),{"data-test-id":`mcp-workflow-description-empty`},{default:p(()=>[h(n(a(l).baseText(`settings.mcp.workflows.table.column.description.emptyContent`)),1)]),_:1})]))],10,Se)]),_:2},1032,[`content`,`show-after`,`popper-class`])]),"item.actions":p(({item:t})=>[s(a(D),{class:v(e.$style[`action-toggle`]),"data-test-id":`mcp-workflow-action-toggle`,placement:`bottom`,actions:d(t),theme:`dark`,onAction:e=>f(e,t)},null,8,[`class`,`actions`,`onAction`])]),_:2},[i.workflows.length===0?{name:`cover`,fn:p(()=>[y(`div`,{class:v(e.$style[`empty-state`])},[s(a(j),{"data-test-id":`mcp-workflow-table-empty-state`,size:`large`,color:`text-base`},{default:p(()=>[h(n(a(l).baseText(`settings.mcp.workflows.table.empty.title`)),1)]),_:1}),s(a(j),{"data-test-id":`mcp-workflow-table-empty-state-description`,size:`small`,color:`text-base`},{default:p(()=>[h(n(a(l).baseText(`settings.mcp.workflows.table.empty.description`)),1)]),_:1}),s(a(C),{variant:`solid`,"data-test-id":`mcp-workflow-table-empty-state-button`,label:a(l).baseText(`settings.mcp.connectWorkflows`),onClick:_},null,8,[`label`])],2)]),key:`0`}:void 0]),1032,[`class`,`headers`,`items`,`items-length`])]))],2))}}),[[`__cssModules`,{$style:{"workflow-table-container":`_workflow-table-container_12b5m_125`,header:`_header_12b5m_129`,"workflow-table":`_workflow-table_12b5m_125`,"empty-state":`_empty-state_12b5m_139`,"workflow-cell":`_workflow-cell_12b5m_149`,"location-cell":`_location-cell_12b5m_156`,"description-cell":`_description-cell_12b5m_160`,"description-popper":`_description-popper_12b5m_178`,"table-link":`_table-link_12b5m_182`,truncate:`_truncate_12b5m_186`}}]]),Ee={"data-test-id":`oauth-clients-table`},De={key:0},Oe={key:1,class:`mt-s mb-xl`},ke=B(c({__name:`OAuthClientsTable`,props:{clients:{},loading:{type:Boolean}},emits:[`revokeClient`],setup(e,{emit:t}){let i=x(),c=Z(),l=e,u=t,d=o([{title:i.baseText(`settings.mcp.oAuthClients.table.clientName`),key:`name`,width:250,disableSort:!0,value(){}},{title:i.baseText(`settings.mcp.oAuthClients.table.connectedAt`),key:`createdAt`,width:250,disableSort:!0,value(){}},{title:``,key:`actions`,align:`end`,width:50,disableSort:!0,value(){}}]),f=o([{label:i.baseText(`settings.mcp.oAuthClients.table.action.revokeAccess`),value:`revokeClient`}]),_=(e,t)=>{e===`revokeClient`&&u(`revokeClient`,t)};return(e,t)=>(m(),r(`div`,Ee,[l.loading?(m(),r(`div`,De,[s(a(S),{loading:l.loading,variant:`h1`,class:`mb-l`},null,8,[`loading`]),s(a(S),{loading:l.loading,variant:`p`,rows:5,"shrink-last":!1},null,8,[`loading`])])):(m(),r(`div`,Oe,[s(a(L),{"data-test-id":`oauth-clients-data-table`,headers:d.value,items:l.clients,"items-length":l.clients.length},g({"item.name":p(({item:e})=>[s(a(j),{"data-test-id":`mcp-client-name`,color:`text-base`},{default:p(()=>[h(n(e.name),1)]),_:2},1024)]),"item.createdAt":p(({item:e})=>[s(a(j),{"data-test-id":`mcp-client-created-at`,color:`text-base`},{default:p(()=>[s(q,{date:String(e.createdAt)},null,8,[`date`])]),_:2},1024)]),"item.actions":p(({item:e})=>[s(a(D),{"data-test-id":`mcp-oauth-client-action-toggle`,placement:`bottom`,actions:f.value,theme:`dark`,onAction:t=>_(t,e)},null,8,[`actions`,`onAction`])]),_:2},[l.clients.length===0?{name:`cover`,fn:p(()=>[y(`div`,{class:v(e.$style[`empty-state`])},[s(a(j),{"data-test-id":`mcp-workflow-table-empty-state`,size:`large`,color:`text-base`},{default:p(()=>[h(n(a(i).baseText(`settings.mcp.oauth.table.empty.title`)),1)]),_:1}),s(a(j),{"data-test-id":`mcp-workflow-table-empty-state-description`,size:`small`,color:`text-base`},{default:p(()=>[h(n(a(i).baseText(`settings.mcp.oauth.table.empty.description`)),1)]),_:1}),s(a(C),{variant:`solid`,"data-test-id":`mcp-oauth-create-client-button`,onClick:t[0]||=e=>a(c).openConnectPopover()},{default:p(()=>[h(n(a(i).baseText(`settings.mcp.oauth.table.empty.button`)),1)]),_:1})],2)]),key:`0`}:void 0]),1032,[`headers`,`items`,`items-length`])]))]))}}),[[`__cssModules`,{$style:{header:`_header_2opcl_125`,"empty-state":`_empty-state_2opcl_131`}}]]),Ae={"data-test-id":`mcp-settings-description`},je=B(c({__name:`SettingsMCPView`,setup(e){let c=x(),d=H(),f=ee(),g=ce(),S=V(),T=Z(),E=ne(),D=te(),O=o(!1),k=o(`workflows`),A=o([{label:c.baseText(`settings.mcp.tabs.workflows`),value:`workflows`},{label:c.baseText(`settings.mcp.tabs.oauth`),value:`oauth`}]),M=o(!1),F=o([]),I=o(!1),L=o([]),R=t(()=>E.isInstanceOwner),B=t(()=>E.isAdmin),U=t(()=>R.value||B.value),W=t(()=>k.value===`workflows`&&F.value.length>0),G=async e=>{k.value=e,e===`workflows`&&F.value.length===0?await Y():e===`oauth`&&L.value.length===0&&(await X(),S.track(`User clicked connected clients tab`))},K=async e=>{try{O.value=!0,await T.setMcpAccessEnabled(e)?(await Y(),await X()):M.value=!1,g.trackUserToggledMcpAccess(e)}catch(e){d.showError(e,c.baseText(`settings.mcp.toggle.error`))}finally{O.value=!1,M.value=!1}},q=async(e,t)=>{try{await T.toggleWorkflowMcpAccess(e,t),t?await Y():F.value=F.value.filter(t=>t.id!==e)}catch(e){throw d.showError(e,c.baseText(`workflowSettings.toggleMCP.error.title`)),e}},J=e=>{D.openModalWithData({name:re,data:{workflowId:e.id,workflowDescription:e.description??``,onSave:t=>{let n=F.value.findIndex(t=>t.id===e.id);n!==-1&&(F.value[n]={...F.value[n],description:t??void 0})}}})},oe=async()=>{k.value===`workflows`?await Y():k.value===`oauth`&&await X()},Y=async()=>{M.value=!0;try{F.value=await T.fetchWorkflowsAvailableForMCP(1,200)}catch(e){d.showError(e,c.baseText(`workflows.list.error.fetching`))}finally{setTimeout(()=>{M.value=!1},200)}},se=async()=>{await Y()},X=async()=>{try{I.value=!0,L.value=await T.getAllOAuthClients()}catch(e){d.showError(e,c.baseText(`settings.mcp.error.fetching.oAuthClients`))}finally{setTimeout(()=>{I.value=!1},200)}},le=async e=>{try{await T.removeOAuthClient(e.id),L.value=L.value.filter(t=>t.id!==e.id),d.showMessage({type:`success`,title:c.baseText(`settings.mcp.oAuthClients.revoke.success.title`),message:c.baseText(`settings.mcp.oAuthClients.revoke.success.message`,{interpolate:{name:e.name}})})}catch(e){d.showError(e,c.baseText(`settings.mcp.oAuthClients.revoke.error`))}},Q=()=>{D.openModalWithData({name:ae,data:{onEnableMcpAccess:async e=>{await q(e,!0)}}}),S.track(`User clicked connect workflows from mcp settings`)};return u(async()=>{f.set(c.baseText(`settings.mcp`)),T.mcpAccessEnabled&&await Y()}),(e,t)=>(m(),r(`div`,{class:v(e.$style.container)},[y(`header`,{class:v(e.$style[`main-header`]),"data-test-id":`mcp-settings-header`},[y(`div`,{class:v(e.$style.headings)},[s(a(z),{size:`2xlarge`,class:`mb-2xs`},{default:p(()=>[h(n(a(c).baseText(`settings.mcp`)),1)]),_:1}),b(y(`div`,Ae,[s(a(j),{size:`small`,color:`text-light`},{default:p(()=>[h(n(a(c).baseText(`settings.mcp.description`))+`. `,1)]),_:1}),s(a(N),{href:a(ie),target:`_blank`,rel:`noopener noreferrer`,size:`small`,"data-test-id":`mcp-docs-link`},{default:p(()=>[h(n(a(c).baseText(`generic.learnMore`)),1)]),_:1},8,[`href`])],512),[[_,a(T).mcpAccessEnabled]])],2),s(ye,{"access-enabled":a(T).mcpAccessEnabled,"toggle-disabled":!U.value,loading:O.value,onDisableMcpAccess:t[0]||=e=>K(!a(T).mcpAccessEnabled)},null,8,[`access-enabled`,`toggle-disabled`,`loading`])],2),a(T).mcpAccessEnabled?i(``,!0):(m(),l(fe,{key:0,disabled:!U.value,loading:O.value,onTurnOnMcp:t[1]||=e=>K(!0)},null,8,[`disabled`,`loading`])),a(T).mcpAccessEnabled?(m(),r(`div`,{key:1,class:v(e.$style.container),"data-test-id":`mcp-enabled-section`},[y(`header`,{class:v(e.$style[`tabs-header`])},[s(a(P),{"model-value":k.value,options:A.value,"onUpdate:modelValue":G},null,8,[`model-value`,`options`]),y(`div`,{class:v(e.$style.actions)},[W.value?(m(),l(a(C),{key:0,variant:`solid`,label:a(c).baseText(`settings.mcp.connectWorkflows`),"data-test-id":`mcp-connect-workflows-header-button`,size:`small`,onClick:Q},null,8,[`label`])):i(``,!0),s(a(w),{content:a(c).baseText(`settings.mcp.refresh.tooltip`)},{default:p(()=>[s(a(C),{variant:`subtle`,iconOnly:``,"data-test-id":`mcp-workflows-refresh-button`,size:`small`,icon:`refresh-cw`,onClick:oe})]),_:1},8,[`content`])],2)],2),y(`main`,null,[k.value===`workflows`?(m(),l(Te,{key:0,"data-test-id":`mcp-workflow-table`,workflows:F.value,loading:M.value,onRemoveMcpAccess:t[2]||=e=>q(e.id,!1),onConnectWorkflows:Q,onUpdateDescription:J,onRefresh:se},null,8,[`workflows`,`loading`])):k.value===`oauth`?(m(),l(ke,{key:1,"data-test-id":`mcp-oauth-clients-table`,clients:L.value,loading:I.value,onRevokeClient:le,onRefresh:oe},null,8,[`clients`,`loading`])):i(``,!0)])],2)):i(``,!0)],2))}}),[[`__cssModules`,{$style:{container:`_container_aryh2_125`,"main-header":`_main-header_aryh2_130`,headings:`_headings_aryh2_143`,"tabs-header":`_tabs-header_aryh2_149`,actions:`_actions_aryh2_155`}}]]);export{je as default};
//# sourceMappingURL=SettingsMCPView-VhigsaZ0.js.map