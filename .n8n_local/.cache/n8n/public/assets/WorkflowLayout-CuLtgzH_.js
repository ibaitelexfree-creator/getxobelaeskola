(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`05072e5e-a15d-4a92-98b2-f40a37d276fe`,e._sentryDebugIdIdentifier=`sentry-dbid-05072e5e-a15d-4a92-98b2-f40a37d276fe`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{$t as t,C as n,Cn as r,D as i,E as a,G as o,Gt as s,It as c,J as l,L as u,M as d,P as f,T as p,Z as m,_ as h,_t as g,at as _,bn as v,bt as y,c as b,ct as x,en as S,et as C,it as w,j as T,k as E,mt as D,nt as O,ot as k,p as A,q as j,tn as M,v as N,vn as P,w as F,xt as ee,z as te,zt as I}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{M as ne,w as L,yt as R}from"./_MapCache-DjbOQyB7.js";import{At as re,Ci as z,D as B,Dt as V,Hi as H,Ki as U,M as W,Mi as ie,N as G,Ni as K,Oi as ae,Ui as oe,_i as se,_t as ce,d as q,fi as le,wi as ue,z as de}from"./src-CppJvwzX.js";import{t as J}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{At as fe,Bt as Y,C as pe,Dr as me,Ft as he,Gt as ge,Ht as _e,K as ve,Kc as ye,Kt as be,Lt as xe,Ma as Se,Or as Ce,Ot as we,Rr as Te,T as Ee,Ti as De,Tr as Oe,Tt as ke,Vt as Ae,br as je,fi as Me,fn as Ne,ga as X,hn as Pe,ji as Fe,jt as Ie,kt as Le,pn as Re,r as ze,rt as Be,s as Ve,t as He,un as Ue,ur as We,wr as Ge,ws as Ke,xr as qe,yr as Je,zt as Ye}from"./users.store-pCkD7Zo0.js";import"./MainSidebarHeader-C11PZIjQ.js";import{t as Xe}from"./BaseLayout-CcCtCTTx.js";import{$s as Ze,Bs as Qe,Ec as $e,Hs as et,Is as tt,Ms as nt,Ns as rt,Ss as it,T as at,Tc as ot,Vs as st,Yc as ct,_ as lt,_s as ut,br as dt,ds as ft,el as pt,g as mt,hr as ht,ns as Z,o as gt,qo as _t,rs as Q,t as vt,wc as yt,xl as $,y as bt,zs as xt}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import{r as St}from"./_baseOrderBy-El3qbNHQ.js";import{t as Ct}from"./banners.store-Ce6ZTWqJ.js";import"./dateformat-BhE5sUDK.js";import{n as wt,t as Tt}from"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import"./usePageRedirectionHelper-BoF8hzbN.js";import"./dataTable.store-dy4dvFXe.js";import"./useClipboard-Duc7LjuO.js";import"./useBugReporting-CHn_Ru2H.js";import{t as Et}from"./executions.store-DnLtKXBA.js";import{t as Dt}from"./assistant.store-BGYzebcZ.js";import{t as Ot}from"./chatPanel.store-YdM_XYGp.js";import"./RunData-DoJODYvb.js";import"./NDVEmptyState-Cd-QhxaI.js";import"./useEnvFeatureFlag-CHY3xSda.js";import{t as kt}from"./externalSecrets.ee.store-RuZGBiOy.js";import"./uniqBy-Bd2DEoH8.js";import"./usePinnedData-C6FFXoty.js";import"./nodeIcon--7uU1Imq.js";import"./canvas.utils-C8dCdoZZ.js";import"./nodeCreator.store-KD9kt9dE.js";import{n as At,t as jt}from"./useCanvasOperations-BHGWcL34.js";import{t as Mt}from"./folders.store-CS_gIPIm.js";import"./ProjectIcon-D-HRIqn6.js";import"./useDynamicCredentials-BSZ25lEI.js";import"./RunDataHtml-Dkm6vMd9.js";import"./NodeIcon-Dv1e4Lvu.js";import"./useRunWorkflow-DzzlHC01.js";import"./pushConnection.store-IFO3HVvG.js";import"./vue-json-pretty-CT_xxsnb.js";import{t as Nt}from"./collaboration.store-QKYwE2H2.js";import"./dateFormatter-C82w-7IH.js";import"./useExecutionHelpers-mcaelfkG.js";import{t as Pt}from"./TimeAgo-BLqTSlco.js";import"./roles.store-Cq99swn7.js";import"./KeyboardShortcutTooltip-BuQeOxiO.js";import"./TagsDropdown-B5U3GUsU.js";import{t as Ft}from"./WorkflowTagsDropdown-Bab-8Jcr.js";import{t as It}from"./dist-BiTDpeeI.js";import"./sso.store-Dd63iqNy.js";import{t as Lt}from"./router-BsVVJ6vf.js";import"./insights.store-CIIvho7C.js";import"./insights.constants-DHL43iRt.js";import"./insights.utils-B2NpOI0Q.js";import{a as Rt,s as zt}from"./mcp.constants-BtNzU3_O.js";import"./sourceControl.eventBus-C0Et3VBv.js";import{i as Bt,r as Vt}from"./utils-B9GTX8VZ.js";import{t as Ht}from"./useMcp-Vjm6-wcy.js";import{t as Ut}from"./useKeybindings-B_gtbMl6.js";import{t as Wt}from"./injectStrict-CjZBqt9B.js";import{t as Gt}from"./useWorkflowActivate-CpGKv5Cd.js";import"./useGlobalEntityCreation-DU5BFKv0.js";import{t as Kt}from"./LoadingView-CXSfI5xz.js";import"./useSettingsItems-DieYApNB.js";import{t as qt}from"./AppSidebar-Dkkt5893.js";import"./readyToRun.store-DM7AW4os.js";import"./resourceCenter.store-DlWGan11.js";import"./useLogsTreeExpand-CjcPPamK.js";import{t as Jt}from"./LogsPanel-Dlq2t92C.js";import"./AnimatedSpinner-BEM3aFx0.js";import"./useResizablePanel-Dt5N79tf.js";import{t as Yt}from"./aiTemplatesStarterCollection.store-NMq1bc_J.js";import{n as Xt,t as Zt}from"./FolderBreadcrumbs-BF2BbNF-.js";import{t as Qt}from"./useExecutionDebugging-K6R7U7CM.js";import"./ProjectBreadcrumb-Crk3D_Vf.js";import{t as $t}from"./ConnectionTracker-JAeLGxUW.js";import{t as en}from"./useWorkflowsCache-DLQfYyl1.js";import{t as tn}from"./usePushConnection-Bqaw2gmy.js";function nn(){let e=z();return{layoutProps:n(()=>e.meta.layoutProps??{})}}function rn(e){let t=z(),r=ue(),i=R(),a=Je(),o=Ne(),s=qe(),l=Ve(),u=Te(),d=ze(),f=pe(),p=Be(),m=he(),h=kt(),g=Ke(),_=ge(),v=Me(),y=Ue(),b=Yt(),x=Xt(),S=xe(),{resetWorkspace:C,initializeWorkspace:w,fitView:T,openWorkflowTemplate:E,openWorkflowTemplateFromJSON:D}=jt(),{fetchAndSetParentFolder:O}=At(),{applyExecutionData:k}=Qt(e),A=c(!0),j=c(),M=I(null);function N(){M.value&&=(fe(Le(M.value.workflowId,M.value.workflowVersion)),null)}let P=n(()=>{let e=t.params.name;return(Array.isArray(e)?e[0]:e)??``}),F=n(()=>t.query.new===`true`),ee=n(()=>t.name===Q.DEMO),te=n(()=>t.name===Q.TEMPLATE_IMPORT),ne=n(()=>t.name===Q.WORKFLOW_ONBOARDING),L=n(()=>t.name===Q.EXECUTION_DEBUG);async function re(){let e;if(P.value&&!F.value)e={workflowId:P.value};else{let n=(typeof t.query?.projectId==`string`?t.query?.projectId:void 0)??_.personalProject?.id;if(n===void 0)throw Error(`Could not find projectId in the query nor could I find the personal project in the project store`);e={projectId:n}}await p.fetchAllCredentialsForWorkflow(e)}async function B(){if(!te.value)return!1;let e=t.params.id;if(!e)return!1;if(N(),t.query.fromJson===`true`){let t=ve(e.toString());if(!t)return a.showError(Error(i.baseText(`nodeView.couldntLoadWorkflow.invalidWorkflowObject`)),i.baseText(`nodeView.couldntImportWorkflow`)),await r.replace({name:Q.NEW_WORKFLOW}),!0;await D(t)}else await E(e.toString());let n=l.workflowId;return n&&(M.value=Ie(Le(n))),!0}async function V(){if(L.value&&(o.setDocumentTitle(l.workflowName,`DEBUG`),!l.isInDebugMode)){let e=t.params.executionId;typeof e==`string`&&(await k(e),l.isInDebugMode=!0)}}async function H(){let e=g.isPreviewMode&&ee.value,t=(()=>{if(e)return[];let t=[u.fetchActiveWorkflows(),p.fetchCredentialTypes(!0),re()];return g.isEnterpriseFeatureEnabled[ct.Variables]&&t.push(m.fetchAllVariables()),g.isEnterpriseFeatureEnabled[ct.ExternalSecrets]&&(t.push(h.fetchGlobalSecrets()),_.currentProjectId!==_.personalProject?.id&&typeof _.currentProjectId==`string`&&t.push(h.fetchProjectSecrets(_.currentProjectId))),t})();f.allNodeTypes.length===0&&t.push(f.getNodeTypes());try{e?t.push(f.fetchCommunityNodePreviews()):f.fetchCommunityNodePreviews(),await Promise.all(t)}catch(e){a.showError(e,i.baseText(`nodeView.showError.mounted1.title`),i.baseText(`nodeView.showError.mounted1.message`)+`:`)}}async function U(e){N(),C(),y.streaming?o.setDocumentTitle(e.name,`AI_BUILDING`):o.setDocumentTitle(e.name,`IDLE`);let{workflowDocumentStore:t}=await w(e);M.value=t,s.run(`workflow.open`,{workflowId:e.id,workflowName:e.name}),T()}async function W(){N(),C();let n=t.query.parentFolderId;await e.getNewWorkflowDataAndMakeShareable(void 0,_.currentProjectId,n),e.setWorkflowId(P.value),M.value=Ie(Le(P.value)),await _.refreshCurrentProject(),await O(n),d.nodeViewInitialized=!0,j.value=P.value,T()}async function ie(e){try{let t=await u.fetchWorkflow(e);await U(t),t.parentFolder&&l.setParentFolder(t.parentFolder),t.meta?.onboardingId&&S.track(`User opened workflow from onboarding template with ID ${t.meta.onboardingId}`,{workflow_id:e}),t.meta?.templateId?.startsWith(`035_template_onboarding`)&&b.trackUserOpenedWorkflow(t.meta.templateId.split(`-`).pop()??``),t.meta?.templateId?.startsWith(`37_onboarding_experiments_batch_aug11`)&&x.trackOpenWorkflow(t.meta.templateId.split(`-`).pop()??``),await _.setProjectNavActiveIdByWorkflowHomeProject(t.homeProject,t.sharedWithProjects),l.fetchLastSuccessfulExecution()}catch(e){if(e.httpStatusCode===404)return await r.replace({name:Q.ENTITY_NOT_FOUND,params:{entityType:`workflow`}});if(e.httpStatusCode===403)return await r.replace({name:Q.ENTITY_UNAUTHORIZED,params:{entityType:`workflow`}});a.showError(e,i.baseText(`openWorkflow.workflowNotFoundError`)),r.push({name:Q.NEW_WORKFLOW})}finally{d.nodeViewInitialized=!0,j.value=P.value}}async function G(e=!1){if(d.isBlankRedirect){d.isBlankRedirect=!1,A.value=!1;return}if(await B()){A.value=!1;return}if(!P.value){A.value=!1;return}if(!e&&j.value&&j.value===P.value){await V(),A.value=!1;return}A.value=!0;try{if(v.reset(),ee.value){await W();return}if(F.value)if(!await u.checkWorkflowExists(P.value)&&t.meta?.nodeView===!0){await W();return}else await r.replace({...t,query:{...t.query,new:void 0}});await ie(P.value),await V()}finally{A.value=!1}}function K(){N(),C(),d.nodeViewInitialized=!1}return{isLoading:A,initializedWorkflowId:j,workflowId:P,currentWorkflowDocumentStore:M,isNewWorkflowRoute:F,isDemoRoute:ee,isTemplateRoute:te,isOnboardingRoute:ne,isDebugRoute:L,loadCredentials:re,initializeData:H,openWorkflow:U,initializeWorkspaceForNewWorkflow:W,initializeWorkspaceForExistingWorkflow:ie,handleTemplateImportRoute:B,handleDebugModeRoute:V,initializeWorkflow:G,cleanup:K}}var an=J(f({__name:`AskAssistantFloatingButton`,setup(e){let t=Dt(),a=Ue(),o=Ot(),c=Ke(),l=R(),{APP_Z_INDEXES:u}=je(),f=n(()=>{let e=t.lastUnread;return e?.type===`block`?e.title:e?.type===`text`?e.content:e?.type===`code-diff`?e.description:``}),p=n(()=>c.settings.ai.allowSendingParameterValues),m=async()=>{a.isAIBuilderEnabled&&p.value?o.isOpen&&o.isBuilderModeActive?o.close():await o.open({mode:`builder`}):await o.toggle({mode:`assistant`}),o.isOpen&&t.trackUserOpenedAssistant({source:`canvas`,task:`placeholder`,has_existing_session:!t.isSessionEnded})};return(e,n)=>(C(),i(`div`,{class:P(e.$style.container),"data-test-id":`ask-assistant-floating-button`},[d(s(ae),{"z-index":s(u).ASK_ASSISTANT_FLOATING_BUTTON_TOOLTIP,placement:`top`,visible:!!f.value,"popper-class":e.$style.tooltip},{content:y(()=>[F(`div`,{class:P(e.$style.text)},r(f.value),3),F(`div`,{class:P(e.$style.assistant)},[d(s(le),{size:`mini`}),F(`span`,null,r(s(l).baseText(`aiAssistant.name`)),1)],2)]),default:y(()=>[d(s(K),{"unread-count":s(t).unreadCount,onClick:m},null,8,[`unread-count`])]),_:1},8,[`z-index`,`visible`,`popper-class`])],2))}}),[[`__cssModules`,{$style:{container:`_container_m8h8t_125`,tooltip:`_tooltip_m8h8t_132`,assistant:`_assistant_m8h8t_138`,text:`_text_m8h8t_148`}}]]),on=J(f({__name:`TabBar`,props:{items:{},modelValue:{default:Z.WORKFLOW}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=t;function r(e,t){n(`update:modelValue`,e,t)}return(t,n)=>e.items?(C(),i(`div`,{key:0,class:P({[t.$style.container]:!0,"tab-bar-container":!0})},[d(s(de),{"model-value":e.modelValue,options:e.items,"onUpdate:modelValue":r},null,8,[`model-value`,`options`])],2)):a(``,!0)}}),[[`__cssModules`,{$style:{container:`_container_11dda_125`}}]]),sn=f({__name:`BreakpointsObserver`,props:{valueXS:{},valueXL:{},valueLG:{},valueMD:{},valueSM:{},valueDefault:{}},setup(e){let t=e,{callDebounced:r}=Tt(),a=Ct(),s=c(window.innerWidth),u=n(()=>s.value<768?`XS`:s.value>=1920?`XL`:s.value>=1200?`LG`:s.value>=992?`MD`:`SM`),d=n(()=>t.valueXS&&s.value<768?t.valueXS:t.valueXL&&s.value>=1920?t.valueXL:t.valueLG&&s.value>=1200?t.valueLG:t.valueMD&&s.value>=992?t.valueMD:t.valueSM?t.valueSM:t.valueDefault),f=()=>{r(p,{debounceTime:50})},p=async()=>{s.value=window.innerWidth,await o();let e=await ye();a.updateBannersHeight(e)};return m(()=>{window.addEventListener(`resize`,f)}),l(()=>{window.removeEventListener(`resize`,f)}),(e,t)=>(C(),i(`span`,null,[_(e.$slots,`default`,{bp:u.value,value:d.value})]))}}),cn=f({__name:`WorkflowProductionChecklist`,props:{workflow:{}},setup(e){let t=e,r=R(),i=ue(),o=Ee(),l=pe(),u=en(),d=ze(),f=Oe(),h=xe(),_=Ge(),v=Ke(),{isEligibleForMcpAccess:y}=Ht(),b=He(),x=c(!1),S=c(null),w=n(()=>t.workflow.nodes.some(e=>l.getNodeType(e.type,e.typeVersion)?.codex?.categories?.includes(`AI`))),T=n(()=>o.evaluationSetOutputsNodeExist),E=n(()=>!!t.workflow.settings?.errorWorkflow),D=n(()=>t.workflow?.nodes?t.workflow.nodes.some(e=>e.type===`n8n-nodes-base.timeSaved`&&e.disabled!==!0):!1),O=n(()=>t.workflow.settings?.timeSavedPerExecution!==void 0||D.value),k=n(()=>d.isModalActiveById[nt]),A=n(()=>_.preferences.branchReadOnly),j=n(()=>b.isInstanceOwner),M=n(()=>b.isAdmin),N=n(()=>v.isModuleActive(`mcp`)),P=n(()=>v.moduleSettings.mcp?.mcpAccessEnabled??!1),F=n(()=>y(t.workflow)),ee=n(()=>j.value||M.value),te=n(()=>{if(t.workflow.activeVersionId===null||u.isCacheLoading.value)return[];let e=[],n=S.value?.suggestedActions??{};n.errorWorkflow?.ignored||e.push({id:`errorWorkflow`,title:r.baseText(`workflowProductionChecklist.errorWorkflow.title`),description:r.baseText(`workflowProductionChecklist.errorWorkflow.description`),moreInfoLink:mt,completed:E.value}),w.value&&o.isEvaluationEnabled&&!n.evaluations?.ignored&&e.push({id:`evaluations`,title:r.baseText(`workflowProductionChecklist.evaluations.title`),description:r.baseText(`workflowProductionChecklist.evaluations.description`),moreInfoLink:lt,completed:T.value}),n.timeSaved?.ignored||e.push({id:`timeSaved`,title:r.baseText(`workflowProductionChecklist.timeSaved.title`),description:r.baseText(`workflowProductionChecklist.timeSaved.description`),moreInfoLink:at,completed:O.value});let i=a();return i&&e.push(i),e;function a(){if(!N.value||!F.value)return null;let e={title:r.baseText(`mcp.productionChecklist.title`),moreInfoLink:Rt};return P.value?n[`workflow-mcp-access`]?.ignored?null:{...e,id:`workflow-mcp-access`,description:r.baseText(`mcp.productionChecklist.workflow.description`),completed:t.workflow.settings?.availableInMCP??!1}:!ee.value||n[`instance-mcp-access`]?.ignored?null:{...e,id:`instance-mcp-access`,description:r.baseText(`mcp.productionChecklist.instance.description`),completed:!1}}});async function I(){t.workflow.id&&(S.value=await u.getMergedWorkflowSettings(t.workflow.id))}async function ne(e){switch(e){case`evaluations`:await i.push({name:Q.EVALUATION_EDIT,params:{name:t.workflow.id}});break;case`errorWorkflow`:case`timeSaved`:case`workflow-mcp-access`:d.openModal(st);break;case`instance-mcp-access`:await i.push({name:zt});break;default:break}x.value=!1}function L(e){return[`evaluations`,`errorWorkflow`,`timeSaved`,`workflow-mcp-access`,`instance-mcp-access`].includes(e)}async function re(e){L(e)&&(await u.ignoreSuggestedAction(t.workflow.id,e),await I(),h.track(`user clicked ignore suggested action`,{actionId:e}))}async function z(){await f.confirm(r.baseText(`workflowProductionChecklist.ignoreAllConfirmation.description`),r.baseText(`workflowProductionChecklist.ignoreAllConfirmation.title`),{confirmButtonText:r.baseText(`workflowProductionChecklist.ignoreAllConfirmation.confirm`)})===`confirm`&&(await u.ignoreAllSuggestedActionsForAllWorkflows(te.value.map(e=>e.id)),await I(),h.track(`user clicked ignore suggested actions for all workflows`))}function B(){x.value=!0}function V(){h.track(`user opened suggested actions checklist`)}function H(e){e?(x.value=!0,V()):k.value||(x.value=!1)}return g(()=>!!t.workflow.activeVersionId,async(e,n)=>{e&&!n&&(S.value?.firstActivatedAt||setTimeout(()=>{B()},0),await u.updateFirstActivatedAt(t.workflow.id))}),m(async()=>{await I()}),(e,t)=>te.value.length>0?(C(),p(s(W),{key:0,open:x.value,title:s(r).baseText(`workflowProductionChecklist.title`),actions:te.value,"ignore-all-label":s(r).baseText(`workflowProductionChecklist.turnOffWorkflowSuggestions`),notice:A.value?s(r).baseText(`workflowProductionChecklist.readOnlyNotice`):``,"popover-alignment":`end`,onActionClick:ne,onIgnoreClick:re,onIgnoreAll:z,"onUpdate:open":H},null,8,[`open`,`title`,`actions`,`ignore-all-label`,`notice`])):a(``,!0)}}),ln=f({__name:`IntersectionObserver`,props:{threshold:{default:0},enabled:{type:Boolean,default:!1},eventBus:{}},emits:[`observed`],setup(e,{emit:t}){let n=e,r=t,a=c(null),o=c(null);return l(()=>{n.enabled&&a.value&&a.value.disconnect()}),m(()=>{if(!n.enabled)return;let e={root:o.value,rootMargin:`0px`,threshold:n.threshold},t=new IntersectionObserver(e=>{e.forEach(({target:e,isIntersecting:t})=>{r(`observed`,{el:e,isIntersecting:t})})},e);a.value=t,n.eventBus.on(`observe`,e=>{e&&t.observe(e)}),n.eventBus.on(`unobserve`,e=>{t.unobserve(e)})}),(e,t)=>(C(),i(`div`,{ref_key:`root`,ref:o},[_(e.$slots,`default`)],512))}}),un=f({__name:`IntersectionObserved`,props:{enabled:{type:Boolean,default:!1},eventBus:{}},setup(e){let t=e,n=c(null);return m(async()=>{t.enabled&&(await o(),t.eventBus.emit(`observe`,n.value))}),l(()=>{t.enabled&&t.eventBus.emit(`unobserve`,n.value)}),(e,t)=>(C(),i(`span`,{ref_key:`observed`,ref:n},[_(e.$slots,`default`)],512))}}),dn=e(wt(),1),fn={class:`tags`},pn=[`onClick`],mn=J(f({__name:`TagsContainer`,props:{tagIds:{},tagsById:{},limit:{default:20},clickable:{type:Boolean,default:!1},responsive:{type:Boolean,default:!1}},emits:[`click`],setup(e,{emit:t}){let r=e,a=t,u=c(320),f=ce(),g=c({}),_=c(),b=n(()=>({"max-width":`${u.value}px`})),x=n(()=>{let e=r.tagIds.map(e=>r.tagsById[e]).filter(Boolean),t=r.limit?e.slice(0,r.limit):e;t=t.map(e=>({...e,hidden:r.responsive&&!g.value[e.id]}));let n=t.length;if(r.responsive&&(n=Object.values(g.value).reduce((e,t)=>t?e+1:e,0)),n<e.length){let r=e.slice(n),i=r.reduce((e,t)=>e?`${e}, ${t.name}`:t.name,``),a={id:`count`,name:`+${r.length}`,title:i,isCount:!0};t.splice(n,0,a)}return t}),S=()=>{let e=_.value?.$el?.parentNode;e&&(u.value=0,o(()=>{u.value=e.clientWidth}))},T=(0,dn.default)(S,100),E=({el:e,isIntersecting:t})=>{e.dataset.id&&(g.value={...g.value,[e.dataset.id]:t})},D=(e,t)=>{r.clickable&&e.stopPropagation(),t.hidden||a(`click`,t.id)};return m(()=>{S(),window.addEventListener(`resize`,T)}),l(()=>{window.removeEventListener(`resize`,T)}),(t,n)=>(C(),p(ln,{ref_key:`tagsContainer`,ref:_,threshold:1,class:`tags-container`,style:v(b.value),enabled:e.responsive,"event-bus":s(f),onObserved:E},{default:y(()=>[F(`span`,fn,[(C(!0),i(h,null,w(x.value,t=>(C(),i(`span`,{key:t.id,class:P({clickable:!t.hidden}),onClick:e=>D(e,t)},[t.isCount?(C(),p(s(G),{key:0,title:t.title,text:t.name,clickable:!1,class:`count-container`},null,8,[`title`,`text`])):(C(),p(un,{key:1,class:P({hideTag:t.hidden}),"data-id":t.id,enabled:e.responsive,"event-bus":s(f)},{default:y(()=>[d(s(G),{title:t.name,text:t.name,clickable:e.clickable},null,8,[`title`,`text`,`clickable`])]),_:2},1032,[`class`,`data-id`,`enabled`,`event-bus`]))],10,pn))),128))])]),_:1},8,[`style`,`enabled`,`event-bus`]))}}),[[`__scopeId`,`data-v-8ecf8b55`]]),hn=f({__name:`WorkflowTagsContainer`,props:{tagIds:{},limit:{},clickable:{type:Boolean},responsive:{type:Boolean}},emits:[`click`],setup(e,{emit:t}){let r=t,i=we(),a=n(()=>i.tagsById);function o(e){r(`click`,e)}return(t,n)=>(C(),p(mn,{"tag-ids":e.tagIds,"tags-by-id":a.value,limit:e.limit,clickable:e.clickable,responsive:e.responsive,onClick:o},null,8,[`tag-ids`,`tags-by-id`,`limit`,`clickable`,`responsive`]))}}),gn=e(Ce(),1);const _n=(e,t)=>e??(typeof t==`string`?t:void 0);var vn=J(f({__name:`ActionsDropdownMenu`,props:{workflowPermissions:{},isNewWorkflow:{type:Boolean},isArchived:{type:Boolean},id:{},name:{},tags:{},currentFolder:{},meta:{}},setup(e,{expose:t}){let r=e,a=c(),o=Je(),l=R(),u=z(),f=ge(),p=Ge(),m=Nt(),h=Te(),g=ze(),_=b(),v=St(),y=we(),x=Ke(),S=He(),w=ke(),T=ce(),E=xe(),D=n(()=>u.meta&&(u.meta.nodeView||u.meta.keepWorkflowAlive===!0)),O=n(()=>[Q.EXECUTION_HOME.toString(),Q.WORKFLOW_EXECUTIONS.toString(),Q.EXECUTION_PREVIEW].includes(u.name||``)),k=n(()=>m.shouldBeReadOnly),A=n(()=>x.isEnterpriseFeatureEnabled[ct.Sharing]);function j(){let e=a.value;if(e?.files&&e.files.length!==0){let t=new FileReader;t.onload=()=>{let n;try{n=JSON.parse(t.result)}catch{o.showMessage({title:l.baseText(`mainSidebar.showMessage.handleFileImport.title`),message:l.baseText(`mainSidebar.showMessage.handleFileImport.message`),type:`error`});return}finally{t.onload=null,e.value=``}X.emit(`importWorkflowData`,{data:n})},t.readAsText(e.files[0])}}let M=n(()=>{let e=[{id:$.DOWNLOAD,label:l.baseText(`menuActions.download`),disabled:!D.value}];return A.value&&e.push({id:$.SHARE,label:l.baseText(`workflowDetails.share`),disabled:!D.value}),r.workflowPermissions.move&&f.isTeamProjectFeatureEnabled&&e.push({id:$.CHANGE_OWNER,label:l.baseText(`workflows.item.changeOwner`),disabled:r.isNewWorkflow}),!k.value&&!r.isArchived&&!p.preferences.branchReadOnly&&e.push({id:$.RENAME,label:l.baseText(`generic.rename`),disabled:!D.value||r.workflowPermissions.update!==!0}),(r.workflowPermissions.update===!0&&!k.value&&!r.isArchived&&!p.preferences.branchReadOnly||r.isNewWorkflow)&&(e.unshift({id:$.DUPLICATE,label:l.baseText(`menuActions.duplicate`),disabled:!D.value||!r.id}),e.unshift({id:$.EDIT_DESCRIPTION,label:l.baseText(`menuActions.editDescription`),disabled:!D.value||!r.id}),e.push({id:$.IMPORT_FROM_URL,label:l.baseText(`menuActions.importFromUrl`),disabled:!D.value||O.value},{id:$.IMPORT_FROM_FILE,label:l.baseText(`menuActions.importFromFile`),disabled:!D.value||O.value})),We([`rbac`],{rbac:{scope:`sourceControl:push`}})&&e.push({id:$.PUSH,label:l.baseText(`menuActions.push`),disabled:!p.isEnterpriseSourceControlEnabled||!D.value||O.value||p.preferences.branchReadOnly}),e.push({id:$.SETTINGS,label:l.baseText(`generic.settings`),disabled:!D.value||r.isNewWorkflow}),(r.workflowPermissions.delete===!0&&!k.value&&!p.preferences.branchReadOnly||r.isNewWorkflow)&&(r.isArchived?(e.push({id:$.UNARCHIVE,label:l.baseText(`menuActions.unarchive`),disabled:!D.value||r.isNewWorkflow}),e.push({id:$.DELETE,label:l.baseText(`menuActions.delete`),disabled:!D.value||r.isNewWorkflow,customClass:_.deleteItem,divided:!0})):e.push({id:$.ARCHIVE,label:l.baseText(`menuActions.archive`),disabled:!D.value||r.isNewWorkflow,customClass:_.deleteItem,divided:!0})),e});async function N(e){switch(e){case $.EDIT_DESCRIPTION:{let e=_n(r.id,u.params.name);if(!e)return;let t=h.getWorkflowById(e).description;g.openModalWithData({name:rt,data:{workflowId:e,workflowDescription:t}});break}case $.DUPLICATE:g.openModalWithData({name:ft,data:{id:r.id,name:r.name,tags:r.tags,parentFolderId:r.currentFolder?.id}});break;case $.RENAME:X.emit(`renameWorkflow`);break;case $.DOWNLOAD:{let e=await w.getWorkflowDataToSave(),{tags:t,...n}=e,i={...n,meta:{...r.meta,instanceId:v.instanceId},tags:(t??[]).map(e=>{let{usageCount:t,...n}=y.tagsById[e];return n})},a=new Blob([JSON.stringify(i,null,2)],{type:`application/json;charset=utf-8`}),o=r.name||`unsaved_workflow`;o=It(o),Ye.track(`User exported workflow`,{workflow_id:e.id}),(0,gn.default)(a,o+`.json`);break}case $.IMPORT_FROM_URL:g.openModal(ut);break;case $.IMPORT_FROM_FILE:X.emit(`importWorkflowFromFile`);break;case $.PUSH:try{Lt.push({query:{...u.query,sourceControl:`push`}})}catch(e){switch(e.message){case`source_control_not_connected`:o.showError({...e,message:``},l.baseText(`settings.sourceControl.error.not.connected.title`),l.baseText(`settings.sourceControl.error.not.connected.message`));break;default:o.showError(e,l.baseText(`error`))}}break;case $.SETTINGS:g.openModal(st);break;case $.SHARE:g.openModalWithData({name:et,data:{id:r.id}}),E.track(`User opened sharing modal`,{workflow_id:r.id,user_id_sharer:S.currentUser?.id,sub_view:u.name===Q.WORKFLOWS?`Workflows listing`:`Workflow editor`});break;case $.ARCHIVE:X.emit(`archiveWorkflow`);break;case $.UNARCHIVE:X.emit(`unarchiveWorkflow`);break;case $.DELETE:X.emit(`deleteWorkflow`);break;case $.CHANGE_OWNER:{let e=_n(r.id,u.params.name);if(!e)return;T.once(`resource-moved`,async()=>await Lt.push({name:Q.WORKFLOWS})),g.openModalWithData({name:Se,data:{resource:h.workflowsById[e],resourceType:De.Workflow,resourceTypeLabel:l.baseText(`generic.workflow`).toLowerCase(),eventBus:T}});break}default:break}}return t({importFileRef:a}),(e,t)=>(C(),i(`div`,{class:P([s(_).group])},[F(`input`,{ref_key:`importFileRef`,ref:a,class:P(s(_).hiddenInput),type:`file`,"data-test-id":`workflow-import-input`,onChange:t[0]||=e=>j()},null,34),d(s(V),{items:M.value,"data-test-id":`workflow-menu`,onSelect:N},null,8,[`items`])],2))}}),[[`__cssModules`,{$style:{deleteItem:`_deleteItem_ldsb8_125`,group:`_group_ldsb8_129`,hiddenInput:`_hiddenInput_ldsb8_134`}}]]),yn={key:0},bn={key:1},xn={key:2},Sn={key:3},Cn=f({__name:`WorkflowHistoryButton`,props:{workflowId:{},isNewWorkflow:{type:Boolean}},setup(e){let t=R(),o=e,l=ze(),u=Pe(),f=c(!1),{debounce:m}=Tt(),h=m(()=>{f.value=!1},{debounceTime:pt,trailing:!0});g(()=>l.isActionActive.workflowSaving,e=>{e?f.value=!0:h()});let _=n(()=>({name:Q.WORKFLOW_HISTORY,params:{workflowId:o.workflowId}})),v=n(()=>u.autoSaveState===vt.Scheduled),b=n(()=>o.isNewWorkflow||v.value||f.value);return(n,o)=>e.workflowId?(C(),p(s(ae),{key:0,placement:`bottom`,"show-after":300},{content:y(()=>[e.isNewWorkflow?(C(),i(`span`,yn,r(s(t).baseText(`workflowHistory.button.tooltip.empty`)),1)):v.value?(C(),i(`span`,bn,r(s(t).baseText(`workflowHistory.button.tooltip.scheduled`)),1)):f.value?(C(),i(`span`,xn,r(s(t).baseText(`workflowHistory.button.tooltip.saving`)),1)):(C(),i(`span`,Sn,r(s(t).baseText(`workflowHistory.button.tooltip`)),1))]),default:y(()=>[(C(),p(x(b.value?`div`:s(se)),{to:b.value?void 0:_.value},{default:y(()=>[d(s(ie),{class:`n8n-button--highlight`,variant:`ghost`,disabled:b.value,loading:f.value,"data-test-id":`workflow-history-button`,icon:`history`,size:`medium`},null,8,[`disabled`,`loading`])]),_:1},8,[`to`]))]),_:1})):a(``,!0)}}),wn=J(f({__name:`CollaborationPane`,setup(e){let t=Nt(),r=He();g(L(),e=>{e===`hidden`?t.stopHeartbeat():t.startHeartbeat()});let o=n(()=>t.collaborators.length>1),c=n(()=>{let e=t.collaborators.map(({user:e})=>e),n=e.findIndex(e=>e.id===r.currentUser?.id);if(n<1)return{defaultGroup:e};let[i]=e.splice(n,1);return{defaultGroup:[i,...e]}}),u=n(()=>r.currentUser?.email);return m(()=>{t.initialize()}),l(()=>{t.terminate()}),(e,t)=>o.value?(C(),i(`div`,{key:0,class:P(`collaboration-pane-container ${e.$style.container}`),"data-test-id":`collaboration-pane`},[d(s(B),{users:c.value,"current-user-email":u.value},null,8,[`users`,`current-user-email`])],2)):a(``,!0)}}),[[`__cssModules`,{$style:{container:`_container_cvwuq_125`}}]]),Tn={"data-test-id":`workflow-active-version-info`},En=function(e){return e.PUBLISH=`publish`,e.NAME_VERSION=`name-version`,e.UNPUBLISH=`unpublish`,e}(En||{}),Dn=J(f({__name:`WorkflowHeaderDraftPublishActions`,props:{id:{},tags:{},name:{},meta:{},currentFolder:{},isArchived:{type:Boolean},isNewWorkflow:{type:Boolean},workflowPermissions:{}},setup(e,{expose:t}){let o=e,u=D(`actionsMenu`),f=ze(),g=Ve(),_=Nt(),v=ge(),b=me(),x=Ke(),S=R(),w=ue(),E=Je(),O=Pe(),{saveCurrentWorkflow:k,cancelAutoSave:A}=Re({router:w}),j=Gt(),M=n(()=>x.isEnterpriseFeatureEnabled[ct.NamedVersions]),N=c(!1),ee=n(()=>u.value?.importFileRef),te=n(()=>Fe(g.workflowTriggerNodes)),I=n(()=>te.value.length>0),ne=n(()=>{let e=!!g.workflow.activeVersion,t=g.workflow.versionId!==g.workflow.activeVersion?.versionId||f.hasUnsavedWorkflowChanges;return e?I.value?g.nodesIssuesExist?`published-node-issues`:t?`published-with-changes`:`published-no-changes`:`published-invalid-trigger`:I.value&&!g.nodesIssuesExist?`not-published-eligible`:`not-published-not-eligible`}),L=n(()=>_.shouldBeReadOnly),re=n(()=>o.workflowPermissions.update),z=n(()=>o.workflowPermissions.publish),B=n(()=>o.workflowPermissions.unpublish),U=n(()=>v.currentProject?.type===be.Personal),W=async()=>{let e=!1;if(O.autoSaveState===vt.InProgress&&O.pendingSave){N.value=!0;try{await O.pendingSave,e=!0}catch{}finally{N.value=!1}}else O.autoSaveState===vt.Scheduled&&A();return(!e||f.stateIsDirty||o.isNewWorkflow)&&(N.value=!0,e=await k({},!0),N.value=!1),e},G=async()=>{(f.stateIsDirty||o.isNewWorkflow)&&!await W()||f.openModalWithData({name:Qe,data:{}})},K=n(()=>{if(!z.value){let e={text:S.baseText(`workflows.publish`),enabled:!1,showIndicator:!1,indicatorClass:``,tooltip:U.value?S.baseText(`workflows.publish.personalSpaceRestricted`):S.baseText(`workflows.publish.permissionDenied`),showVersionInfo:!1};return g.workflow.activeVersion?{...e,showIndicator:!0,showVersionInfo:!0,indicatorClass:`published`}:e}return o.isNewWorkflow?{text:S.baseText(`workflows.publish`),enabled:I.value&&!g.nodesIssuesExist,showIndicator:!1,indicatorClass:``,tooltip:I.value?g.nodesIssuesExist?S.baseText(`workflowActivator.showMessage.activeChangedNodesIssuesExistTrue.title`,{interpolate:{count:g.nodesWithIssues.length},adjustToNumber:g.nodesWithIssues.length}):``:S.baseText(`workflows.publishModal.noTriggerMessage`),showVersionInfo:!1}:{"not-published-not-eligible":{text:S.baseText(`workflows.publish`),enabled:!1,showIndicator:!1,indicatorClass:``,tooltip:I.value?S.baseText(`workflowActivator.showMessage.activeChangedNodesIssuesExistTrue.title`,{interpolate:{count:g.nodesWithIssues.length},adjustToNumber:g.nodesWithIssues.length}):S.baseText(`workflows.publishModal.noTriggerMessage`),showVersionInfo:!1},"not-published-eligible":{text:S.baseText(`workflows.publish`),enabled:!0,showIndicator:!1,indicatorClass:``,tooltip:``,showVersionInfo:!1},"published-no-changes":{text:S.baseText(`generic.published`),enabled:!1,showIndicator:!0,indicatorClass:`published`,tooltip:``,showVersionInfo:!0},"published-with-changes":{text:S.baseText(`workflows.publish`),enabled:!0,showIndicator:!0,indicatorClass:`changes`,tooltip:S.baseText(`workflows.publishModal.changes`),showVersionInfo:!1},"published-node-issues":{text:S.baseText(`workflows.publish`),enabled:!1,showIndicator:!0,indicatorClass:`error`,tooltip:S.baseText(`workflowActivator.showMessage.activeChangedNodesIssuesExistTrue.title`,{interpolate:{count:g.nodesWithIssues.length},adjustToNumber:g.nodesWithIssues.length}),showVersionInfo:!0},"published-invalid-trigger":{text:S.baseText(`workflows.publish`),enabled:!1,showIndicator:!0,indicatorClass:`changes`,tooltip:S.baseText(`workflows.publishModal.noTriggerMessage`),showVersionInfo:!0}}[ne.value]}),oe=n(()=>o.isNewWorkflow?!1:o.isArchived||!re.value&&!z.value),se=n(()=>o.isNewWorkflow||L.value||!K.value.enabled||!z.value),q=n(()=>g.workflow.activeVersion),le=n(()=>q.value?q.value.name??Vt(q.value.versionId):``),de=n(()=>Bt(q.value?.workflowPublishHistory??[])?.createdAt),J=n(()=>{let e=[{id:En.PUBLISH,label:S.baseText(`workflows.publish`),shortcut:{shiftKey:!0,keys:[`P`]},disabled:se.value}];return M.value&&e.push({id:En.NAME_VERSION,label:S.baseText(`generic.nameVersion`),shortcut:{metaKey:!0,keys:[`S`]},disabled:!re.value||!g.workflow.versionId}),e.push({id:En.UNPUBLISH,label:S.baseText(`workflows.unpublish`),disabled:!q.value||L.value||!B.value,divided:!0,shortcut:{metaKey:!0,keys:[`U`]}}),e}),fe=async()=>{if((f.stateIsDirty||o.isNewWorkflow)&&!await W())return;let e=g.workflow.versionId,t=g.versionData,n=ce(),r=c({versionId:e,versionName:t?.name??void 0,description:t?.description??void 0,modalTitle:S.baseText(`workflowHistory.nameVersionModal.title`),submitButtonLabel:S.baseText(`workflowHistory.nameVersionModal.confirmButton`),submitting:!1,eventBus:n});n.once(`submit`,async t=>{r.value.submitting=!0;try{await b.updateWorkflowHistoryVersion(o.id,e,{name:t.name,description:t.description}),g.setWorkflowVersionData({versionId:e,name:t.name,description:t.description}),E.showMessage({title:S.baseText(`workflowHistory.action.nameVersion.success.title`),type:`success`}),f.closeModal(tt)}catch(e){E.showError(e,S.baseText(`workflowHistory.action.nameVersion.error.title`))}finally{r.value.submitting=!1}}),f.openModalWithData({name:tt,data:r.value})},Y=()=>{if(!q.value){E.showMessage({title:S.baseText(`workflowHistory.action.unpublish.notAvailable`),type:`warning`});return}let e=ce();e.once(`unpublish`,async()=>{let e=await j.unpublishWorkflowFromHistory(o.id);f.closeModal(xt),e&&E.showMessage({title:S.baseText(`workflowHistory.action.unpublish.success.title`),type:`success`})}),f.openModalWithData({name:xt,data:{versionName:q.value.name,eventBus:e}})},pe=async e=>{switch(e){case En.PUBLISH:await G();break;case En.NAME_VERSION:await fe();break;case En.UNPUBLISH:Y();break;default:break}};return Ut({shift_p:{disabled:()=>se.value,run:async()=>{await G()}},"ctrl+s":{disabled:()=>!M.value||!re.value||!g.workflow.versionId,run:async()=>{await fe()}},"ctrl+u":{disabled:()=>!q.value||!z.value||L.value,run:Y}}),m(()=>{X.on(`publishWorkflow`,G),X.on(`unpublishWorkflow`,Y)}),l(()=>{X.off(`publishWorkflow`,G),X.off(`unpublishWorkflow`,Y)}),t({importFileRef:ee}),(t,n)=>(C(),i(`div`,{class:P(t.$style.container)},[e.isNewWorkflow?a(``,!0):(C(),p(wn,{key:0})),oe.value?a(``,!0):(C(),i(`div`,{key:1,class:P(t.$style.publishButtonWrapper)},[F(`div`,{class:P(t.$style.buttonGroup)},[d(s(ae),{disabled:ne.value===`not-published-eligible`&&o.workflowPermissions.publish,"show-after":300,offset:15},{content:y(()=>[F(`div`,null,[K.value.tooltip?(C(),i(h,{key:0},[T(r(K.value.tooltip)+` `,1),n[0]||=F(`br`,null,null,-1)],64)):a(``,!0),q.value&&K.value.showVersionInfo?(C(),i(h,{key:1},[F(`span`,Tn,r(le.value),1),n[1]||=F(`br`,null,null,-1),T(r(s(S).baseText(`workflowHistory.item.active`))+` `,1),de.value?(C(),p(Pt,{key:0,date:de.value},null,8,[`date`])):a(``,!0)],64)):a(``,!0)])]),default:y(()=>[d(s(H),{class:P(t.$style.groupButtonLeft),loading:N.value,disabled:!K.value.enabled||se.value,variant:`subtle`,"data-test-id":`workflow-open-publish-modal-button`,onClick:G},{default:y(()=>[F(`div`,{class:P([t.$style.flex])},[K.value.showIndicator?(C(),i(`span`,{key:0,"data-test-id":`workflow-active-version-indicator`,class:P({[t.$style.indicatorDot]:!0,[t.$style.indicatorPublished]:K.value.indicatorClass===`published`,[t.$style.indicatorChanges]:K.value.indicatorClass===`changes`,[t.$style.indicatorIssues]:K.value.indicatorClass===`error`})},null,2)):a(``,!0),F(`span`,{class:P([ne.value===`published-no-changes`&&t.$style.indicatorPublishedText])},r(K.value.text),3)],2)]),_:1},8,[`class`,`loading`,`disabled`])]),_:1},8,[`disabled`]),d(s(V),{items:J.value,placement:`bottom-end`,"data-test-id":`version-menu`,onSelect:pe},{activator:y(()=>[d(s(ie),{class:P(t.$style.groupButtonRight),variant:`subtle`,icon:`chevron-down`,"data-test-id":`version-menu-button`},null,8,[`class`])]),_:1},8,[`items`])],2)],2)),d(Cn,{"workflow-id":o.id,"is-new-workflow":e.isNewWorkflow},null,8,[`workflow-id`,`is-new-workflow`]),d(vn,{id:e.id,ref:`actionsMenu`,"workflow-permissions":e.workflowPermissions,"is-new-workflow":e.isNewWorkflow,"is-archived":e.isArchived,name:e.name,tags:e.tags,"current-folder":e.currentFolder,meta:e.meta},null,8,[`id`,`workflow-permissions`,`is-new-workflow`,`is-archived`,`name`,`tags`,`current-folder`,`meta`])],2))}}),[[`__cssModules`,{$style:{container:`_container_joo8n_125`,activeVersionIndicator:`_activeVersionIndicator_joo8n_129`,icon:`_icon_joo8n_133`,publishButtonWrapper:`_publishButtonWrapper_joo8n_137`,buttonGroup:`_buttonGroup_joo8n_143`,groupButtonLeft:`_groupButtonLeft_joo8n_147`,groupButtonRight:`_groupButtonRight_joo8n_159`,indicatorDot:`_indicatorDot_joo8n_168`,indicatorPublished:`_indicatorPublished_joo8n_176`,indicatorPublishedText:`_indicatorPublishedText_joo8n_180`,indicatorChanges:`_indicatorChanges_joo8n_184`,indicatorIssues:`_indicatorIssues_joo8n_188`,flex:`_flex_joo8n_192`}}]]),On={class:`tags`,"data-test-id":`workflow-tags-container`},kn={key:1},An=J(f({__name:`WorkflowDetails`,props:{id:{},tags:{},name:{},meta:{},scopes:{},active:{type:Boolean},currentFolder:{},isArchived:{type:Boolean},description:{}},setup(e){let t={XS:150,SM:200,MD:250,LG:500,XL:1e3},o=e,u=b(),f=Ke(),_=ze(),v=Ve(),x=Te(),S=ge(),w=Nt(),E=Ge(),O=Mt(),k=R(),A=ue(),j=z(),M=R(),N=xe(),ee=Oe(),I=Je(),ne=Ne(),L=Ae(),B=te(yt,null),V=c(!1),H=c([]),U=D(`workflowHeaderActions`),W=ce(),ie=(e,t)=>{if(e.length!==t.length)return!0;let n=new Set(e);return t.reduce((e,t)=>e||!n.has(t),!1)},G=n(()=>!v.isWorkflowSaved[o.id]),K=n(()=>_t(o.scopes).workflow),ae=n(()=>E.preferences.branchReadOnly||w.shouldBeReadOnly),oe=n(()=>G.value?ae.value:ae.value||o.isArchived||!K.value.update),se=n(()=>o.tags),le=n(()=>{if(!G.value&&o.currentFolder)return o.currentFolder;let e=j.query.parentFolderId;return e?O.getCachedFolder(e):null});g(()=>o.id,()=>{V.value=!1,Y.value?.forceCancel()});function de(){oe.value||(H.value=[...o.tags],V.value=!0,setTimeout(()=>{Y.value?.forceCancel(),W.emit(`focus`)},0))}function J(){let e=o.tags,t=H.value;if(!ie(e,t)){V.value=!1;return}if(oe.value){V.value=!1;return}w.requestWriteAccess(),B?.value&&B.value.setTags(t),_.markStateDirty(`metadata`),N.track(`User edited workflow tags`,{workflow_id:o.id,new_tag_count:t.length}),V.value=!1}function fe(){V.value=!1}let Y=D(`renameInput`);function pe(){Y.value?.forceFocus&&Y.value.forceFocus()}function me(e){let t=e.trim();if(!t){I.showMessage({title:M.baseText(`renameAction.emptyName.title`),message:M.baseText(`renameAction.emptyName.message`),type:`error`}),Y.value?.forceCancel();return}if(t===o.name){Y.value?.forceCancel();return}L.setWorkflowName({newName:t,setStateDirty:!0}),ne.setDocumentTitle(t,`IDLE`),Y.value?.forceCancel()}async function he(){if(o.active&&await ee.confirm(M.baseText(`mainSidebar.confirmMessage.workflowArchive.message`,{interpolate:{workflowName:o.name}}),M.baseText(`mainSidebar.confirmMessage.workflowArchive.headline`),{type:`warning`,confirmButtonText:M.baseText(`mainSidebar.confirmMessage.workflowArchive.confirmButtonText`),cancelButtonText:M.baseText(`mainSidebar.confirmMessage.workflowArchive.cancelButtonText`)})!==`confirm`)return;try{let e=o.id===v.workflowId?v.workflowChecksum:void 0;await v.archiveWorkflow(o.id,e)}catch(e){I.showError(e,M.baseText(`generic.archiveWorkflowError`));return}_.markStateClean(),I.showMessage({title:M.baseText(`mainSidebar.showMessage.handleArchive.title`,{interpolate:{workflowName:o.name}}),type:`success`});let e=x.getWorkflowById(o.id);e?.homeProject?.type===be.Team?await A.push({name:Q.PROJECTS_WORKFLOWS,params:{projectId:e.homeProject.id}}):await A.push({name:Q.WORKFLOWS})}async function _e(){await v.unarchiveWorkflow(o.id),I.showMessage({title:M.baseText(`mainSidebar.showMessage.handleUnarchive.title`,{interpolate:{workflowName:o.name}}),type:`success`})}async function ve(){if(await ee.confirm(M.baseText(`mainSidebar.confirmMessage.workflowDelete.message`,{interpolate:{workflowName:o.name}}),M.baseText(`mainSidebar.confirmMessage.workflowDelete.headline`),{type:`warning`,confirmButtonText:M.baseText(`mainSidebar.confirmMessage.workflowDelete.confirmButtonText`),cancelButtonText:M.baseText(`mainSidebar.confirmMessage.workflowDelete.cancelButtonText`)})!==`confirm`)return;let e=x.getWorkflowById(o.id),t=e?.homeProject?.type===be.Team;try{await x.deleteWorkflow(o.id)}catch(e){I.showError(e,M.baseText(`generic.deleteWorkflowError`));return}_.markStateClean(),ne.reset(),I.showMessage({title:M.baseText(`mainSidebar.showMessage.handleSelect1.title`,{interpolate:{workflowName:o.name}}),type:`success`}),t&&e?.homeProject?await A.push({name:Q.PROJECTS_WORKFLOWS,params:{projectId:e.homeProject.id}}):await A.push({name:Q.WORKFLOWS})}let ye=e=>{e.href&&A.push(e.href).catch(e=>{I.showError(e,k.baseText(`folders.open.error.title`))})},Se=()=>{U.value?.importFileRef&&U.value.importFileRef.click()};return m(()=>{X.on(`importWorkflowFromFile`,Se),X.on(`archiveWorkflow`,he),X.on(`unarchiveWorkflow`,_e),X.on(`deleteWorkflow`,ve),X.on(`renameWorkflow`,pe),X.on(`addTag`,de)}),l(()=>{X.off(`importWorkflowFromFile`,Se),X.off(`archiveWorkflow`,he),X.off(`unarchiveWorkflow`,_e),X.off(`deleteWorkflow`,ve),X.off(`renameWorkflow`,pe),X.off(`addTag`,de)}),(n,o)=>(C(),i(`div`,{class:P(s(u).container)},[d(sn,{"value-x-s":15,"value-s-m":25,"value-m-d":50,class:`name-container`,"data-test-id":`canvas-breadcrumbs`},{default:y(({bp:n})=>[d(Zt,{"current-folder":le.value,"current-folder-as-link":!0,onItemSelected:ye},{append:y(()=>[s(S).currentProject??s(S).personalProject?(C(),i(`span`,{key:0,class:P(s(u)[`path-separator`])},`/`,2)):a(``,!0),(C(),p(s(q),{ref_key:`renameInput`,ref:Y,key:e.id,placeholder:`Workflow name`,"data-test-id":`workflow-name-input`,class:`name`,"model-value":e.name,"max-length":s(128),"max-width":t[n],"read-only":oe.value,disabled:oe.value,"onUpdate:modelValue":me},null,8,[`model-value`,`max-length`,`max-width`,`read-only`,`disabled`]))]),_:2},1032,[`current-folder`])]),_:1}),F(`span`,On,[s(f).areTagsEnabled?(C(),i(h,{key:0},[V.value&&!oe.value?(C(),p(Ft,{key:0,ref:`dropdown`,modelValue:H.value,"onUpdate:modelValue":o[0]||=e=>H.value=e,"event-bus":s(W),placeholder:s(k).baseText(`workflowDetails.chooseOrCreateATag`),class:`tags-edit`,"data-test-id":`workflow-tags-dropdown`,onBlur:J,onEsc:fe},null,8,[`modelValue`,`event-bus`,`placeholder`])):e.tags.length===0&&!oe.value?(C(),i(`div`,kn,[F(`span`,{class:`add-tag clickable`,"data-test-id":`new-tag-link`,onClick:de},` + `+r(s(k).baseText(`workflowDetails.addTag`)),1)])):(C(),p(hn,{key:e.id,"tag-ids":se.value,clickable:!0,responsive:!0,"data-test-id":`workflow-tags`,onClick:de},null,8,[`tag-ids`]))],64)):a(``,!0),F(`span`,{class:P(s(u)[`header-controls`])},[e.isArchived?(C(),p(s(re),{key:0,class:`ml-3xs`,theme:`tertiary`,bold:``,"data-test-id":`workflow-archived-tag`},{default:y(()=>[T(r(s(M).baseText(`workflows.item.archived`)),1)]),_:1})):a(``,!0)],2)]),d($t,{class:`actions`},{default:y(()=>[G.value?a(``,!0):(C(),p(cn,{key:0,workflow:s(v).workflow},null,8,[`workflow`])),d(Dn,{id:e.id,ref:`workflowHeaderActions`,tags:e.tags,name:e.name,meta:e.meta,"is-archived":e.isArchived,"is-new-workflow":G.value,"workflow-permissions":K.value},null,8,[`id`,`tags`,`name`,`meta`,`is-archived`,`is-new-workflow`,`workflow-permissions`])]),_:1})],2))}}),[[`__cssModules`,{$style:{container:`_container_h2714_125`,"path-separator":`_path-separator_h2714_134`,closeNodeViewDiscovery:`_closeNodeViewDiscovery_h2714_140`,"header-controls":`_header-controls_h2714_147`}}],[`__scopeId`,`data-v-25155f8e`]]);M();var jn=f({name:`github-button`,props:{href:String,ariaLabel:String,title:String,dataIcon:String,dataColorScheme:String,dataSize:String,dataShowCount:String,dataText:String},render:function(){let e={ref:`_`};for(let t in this.$props)e[S(t)]=this.$props[t];return u(`span`,[t(this.$slots,`default`)?u(`a`,e,this.$slots.default()):u(`a`,e)])},mounted:function(){this.paint()},beforeUpdate:function(){this.reset()},updated:function(){this.paint()},beforeUnmount:function(){this.reset()},methods:{paint:function(){if(this.$el.lastChild!==this.$refs._)return;let e=this.$el.appendChild(document.createElement(`span`)),t=this;U(()=>import(`./buttons.esm-D4IAUSQp.js`),[]).then(function(n){t.$el.lastChild===e&&n.render(e.appendChild(t.$refs._),function(n){t.$el.lastChild===e&&e.parentNode.replaceChild(n,e)})})},reset:function(){this.$refs._!=null&&this.$el.replaceChild(this.$refs._,this.$el.lastChild)}}}),Mn=J(f({__name:`MainHeader`,setup(e){let t=ue(),o=z(),u=R(),f=tn({router:t}),h=Je(),_=Y(),v=ze(),b=Ve(),x=Te(),S=Et(),w=Ke(),E=c(Z.WORKFLOW),D=c(``),O=c(``),k=c(!1),M=ne(Ze,!1),N=[Q.EVALUATION_EDIT,Q.EVALUATION_RUNS_DETAIL],I=[Q.WORKFLOW,Q.NEW_WORKFLOW,Q.EXECUTION_DEBUG],L=[Q.EXECUTION_HOME,Q.WORKFLOW_EXECUTIONS,Q.EXECUTION_PREVIEW],re=n(()=>[{value:Z.WORKFLOW,label:u.baseText(`generic.editor`)},{value:Z.EXECUTIONS,label:u.baseText(`generic.executions`)},{value:Z.EVALUATION,label:u.baseText(`generic.tests`)}]),B=n(()=>_.activeNode),V=n(()=>!!(B.value&&B.value.type!==`n8n-nodes-base.stickyNote`)),H=n(()=>b.workflow),U=Wt(ot),W=te(yt,null),ie=n(()=>W?.value?.tags??[]),G=n(()=>!!(o.meta.nodeView||o.meta.keepWorkflowAlive)),K=n(()=>w.isQueueModeEnabled&&w.isWorkerViewAvailable),ae=n(()=>w.isTelemetryEnabled),se=n(()=>!K.value&&!w.settings.inE2ETests&&!M.value&&ae.value),ce=n(()=>{if(H.value.parentFolder)return{id:H.value.parentFolder.id,name:H.value.parentFolder.name,parentFolder:H.value.parentFolder.parentFolderId??void 0}});g(o,(e,t)=>{le(e,t)}),j(()=>{f.initialize()}),l(()=>{f.terminate()}),m(async()=>{k.value=v.stateIsDirty,le(o)});function q(e){return typeof e==`string`&&[N,I,L].flat().includes(e)}function le(e,t){let n=[{routes:N,tab:Z.EVALUATION},{routes:L,tab:Z.EXECUTIONS},{routes:I,tab:Z.WORKFLOW}];if(e.name&&q(e.name)){let t=n.find(({routes:t})=>t.includes(e.name));t&&(E.value=t.tab)}typeof e.params.name==`string`&&(D.value=e.params.name),t?.name===Q.EXECUTION_PREVIEW&&e.params.name===t.params.name&&typeof t.params.executionId==`string`&&(O.value=t.params.executionId)}function de(e,t){let n=t.ctrlKey||t.metaKey;switch(e){case Z.WORKFLOW:J(n);break;case Z.EXECUTIONS:fe(n);break;case Z.EVALUATION:pe(n);break;default:break}}async function J(e){let n;if(n=D.value&&D.value!==``?{name:Q.WORKFLOW,params:{name:D.value},query:o.query}:{name:Q.NEW_WORKFLOW,query:o.query},e){let{href:e}=t.resolve(n);window.open(e,`_blank`)}else o.name!==n.name&&(o.name===Q.NEW_WORKFLOW&&(k.value?v.markStateDirty():v.markStateClean()),E.value=Z.WORKFLOW,await t.push(n))}async function fe(e){let n=S.activeExecution?.id||O.value,r=n?{name:Q.EXECUTION_PREVIEW,params:{name:U.value,executionId:n},query:o.query}:{name:Q.EXECUTION_HOME,params:{name:U.value},query:o.query};if(e){let{href:e}=t.resolve(r);window.open(e,`_blank`)}else o.name!==r.name&&(k.value=v.stateIsDirty,D.value=U.value,E.value=Z.EXECUTIONS,await t.push(r))}async function pe(e){let n={name:Q.EVALUATION_EDIT,params:{name:U.value},query:o.query};if(e){let{href:e}=t.resolve(n);window.open(e,`_blank`)}else o.name!==n.name&&(k.value=v.stateIsDirty,D.value=U.value,E.value=Z.EXECUTIONS,await t.push(n))}function me(){M.value=!0}async function he(){if(w.isModuleActive(`mcp`)&&H.value.settings?.availableInMCP)try{let e=await x.fetchWorkflow(H.value.id);b.setWorkflow(e),h.showToast({title:u.baseText(`mcp.workflowDeactivated.title`),message:u.baseText(`mcp.workflowDeactivated.message`),type:`info`})}catch(e){h.showError(e,u.baseText(`workflowSettings.showError.fetchSettings.title`))}}return(e,t)=>(C(),i(`div`,{class:P(e.$style.container)},[F(`div`,{class:P({[e.$style[`main-header`]]:!0,[e.$style.expanded]:!s(v).sidebarMenuCollapsed})},[ee(F(`div`,{class:P(e.$style[`top-menu`])},[H.value?.name?(C(),p(An,{key:0,id:H.value.id,tags:ie.value,name:H.value.name,meta:H.value.meta,scopes:H.value.scopes,active:H.value.active,"current-folder":ce.value,"is-archived":H.value.isArchived,description:H.value.description,"onWorkflow:deactivated":he},null,8,[`id`,`tags`,`name`,`meta`,`scopes`,`active`,`current-folder`,`is-archived`,`description`])):a(``,!0),se.value?(C(),i(`div`,{key:1,class:P([e.$style[`github-button`],`hidden-sm-and-down`])},[F(`div`,{class:P(e.$style[`github-button-container`])},[d(s(jn),{href:s(bt),"data-color-scheme":s(v).appliedTheme,"data-size":`large`,"data-show-count":`true`,"aria-label":s(u).baseText(`editor.mainHeader.githubButton.label`)},{default:y(()=>[T(r(s(u).baseText(`generic.star`)),1)]),_:1},8,[`href`,`data-color-scheme`,`aria-label`]),d(s(oe),{class:P(e.$style[`close-github-button`]),icon:`circle-x`,size:`medium`,onClick:me},null,8,[`class`])],2)],2)):a(``,!0)],2),[[A,!V.value]]),G.value?(C(),p(on,{key:0,items:re.value,"model-value":E.value,"onUpdate:modelValue":de},null,8,[`items`,`model-value`])):a(``,!0)],2)],2))}}),[[`__cssModules`,{$style:{container:`_container_19rmf_125`,"main-header":`_main-header_19rmf_132`,"top-menu":`_top-menu_19rmf_140`,"github-button":`_github-button_19rmf_151`,"close-github-button":`_close-github-button_19rmf_160`,"github-button-container":`_github-button-container_19rmf_175`}}]]),Nn=f({__name:`AppHeader`,setup(e){return(e,t)=>(C(),p(Mn))}}),Pn=f({__name:`WorkflowLayout`,setup(e){let{layoutProps:t}=nn(),n=Dt(),r=_e();O($e,r);let{isLoading:i,workflowId:o,currentWorkflowDocumentStore:c,isDebugRoute:u,initializeData:f,initializeWorkflow:h,handleDebugModeRoute:_,cleanup:v}=rn(r);return O(ot,o),O(yt,c),m(async()=>{await f(),await h()}),g(o,async(e,t)=>{e!==t&&e&&await h(!0)},{flush:`post`}),g(u,async(e,t)=>{e&&!t&&!i.value&&await _()},{flush:`post`}),l(()=>v()),(e,r)=>{let o=k(`RouterView`);return C(),p(Xe,null,E({header:y(()=>[d(Nn)]),sidebar:y(()=>[d(qt)]),overlays:y(()=>[s(n).isFloatingButtonShown?(C(),p(an,{key:0})):a(``,!0)]),default:y(()=>[s(i)?(C(),p(Kt,{key:0})):(C(),p(o,{key:1},{default:y(({Component:e})=>[(C(),p(N,{include:`NodeView`,max:1},[(C(),p(x(e)))],1024))]),_:1}))]),_:2},[s(t).logs?{name:`footer`,fn:y(()=>[d(Jt)]),key:`0`}:void 0]),1024)}}});export{Pn as default};
//# sourceMappingURL=WorkflowLayout-CuLtgzH_.js.map