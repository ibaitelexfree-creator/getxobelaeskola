(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`357ff8bd-67db-4e20-bcdd-c8d28a9d975d`,e._sentryDebugIdIdentifier=`sentry-dbid-357ff8bd-67db-4e20-bcdd-c8d28a9d975d`)})()}catch{}import{C as e,Pt as t}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{_c as n,_r as r,dc as i,fc as a,gc as o,hc as s,mc as c,pc as l,vc as u,ws as d,yc as f}from"./users.store-pCkD7Zo0.js";import{Yc as p}from"./constants-D1jZwsUK.js";import{j as m,r as h}from"./_baseOrderBy-El3qbNHQ.js";import{t as g}from"./useEnvFeatureFlag-CHY3xSda.js";function _(e){return Object.keys(e).reduce((t,n)=>{let r=e[n];return Array.isArray(r)&&(t[n]=r.reduce((e,t)=>{let n=t.split(`.`);if(n.length===1)return e[t]=`*********`,e;let r=e[n[0]]??{},i=r;for(let e=1;e<n.length;e++){let t=n[e];if(e===n.length-1){i[t]=`*********`;continue}Object.keys(i)&&!i[t]&&(i[t]={}),i=i[t]}return e[n[0]]=r,e},{})),t},{})}const v=m(`externalSecrets`,()=>{let m=h(),v=d(),y=r(),{check:b}=g(),x=t({providers:[],secrets:{},projectSecrets:{},connectionState:{}}),S=e(()=>v.isEnterpriseFeatureEnabled[p.ExternalSecrets]),C=e(()=>x.secrets),w=e(()=>x.projectSecrets),T=e(()=>x.providers),E=e(()=>x.connectionState),D=e(()=>_(w.value)),O=e(()=>_(C.value)),k=e(()=>b.value(`EXTERNAL_SECRETS_FOR_PROJECTS`)?{...O.value,...D.value}:O.value);async function A(){if(y.hasScope(`externalSecret:list`))try{x.secrets=b.value(`EXTERNAL_SECRETS_FOR_PROJECTS`)?await s(m.restApiContext):await a(m.restApiContext)}catch{x.secrets={}}}async function j(e){if(b.value(`EXTERNAL_SECRETS_FOR_PROJECTS`)&&y.hasScope(`externalSecret:list`))try{x.projectSecrets=await o(m.restApiContext,e)}catch{x.projectSecrets={}}}async function M(e){let{updated:t}=await n(m.restApiContext,e);return t&&await A(),t}async function N(){x.providers=await c(m.restApiContext)}async function P(e,t){return await u(m.restApiContext,e,t)}async function F(e){let t=await l(m.restApiContext,e),n=x.providers.findIndex(t=>t.name===e);return n===-1?x.providers.push(t):x.providers.splice(n,1,t),t}function I(e,t){let n=x.providers.findIndex(t=>t.name===e);x.providers=[...x.providers.slice(0,n),{...x.providers[n],...t,data:{...x.providers[n].data,...t.data}},...x.providers.slice(n+1)]}async function L(e,t){await i(m.restApiContext,e,t),await A(),I(e,{connected:t,state:t?`connected`:`initializing`})}async function R(e,{data:t}){await f(m.restApiContext,e,t),await A(),I(e,{data:t})}function z(e,t){x.connectionState[e]=t}return{state:x,providers:T,secrets:C,connectionState:E,secretsAsObject:k,globalSecretsAsObject:O,projectSecretsAsObject:D,isEnterpriseExternalSecretsEnabled:S,fetchGlobalSecrets:A,fetchProjectSecrets:j,getProvider:F,getProviders:N,testProviderConnection:P,updateProvider:R,updateStoredProvider:I,updateProviderConnected:L,reloadProvider:M,setConnectionState:z}});export{v as t};
//# sourceMappingURL=externalSecrets.ee.store-RuZGBiOy.js.map