(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`c6578373-78a3-4fda-99dd-8a924f5a6031`,e._sentryDebugIdIdentifier=`sentry-dbid-c6578373-78a3-4fda-99dd-8a924f5a6031`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,M as s,P as c,T as l,_ as u,_t as d,bt as f,et as p,it as m,j as h,p as g,vn as _,w as v,xt as y}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{ot as b,yt as x}from"./_MapCache-DjbOQyB7.js";import{Hi as S,Mi as C,Oi as w,Ui as ee,Vi as T,d as te,ji as ne,jt as E,zi as D}from"./src-CppJvwzX.js";import{t as O}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import"./date-picker-CHH0vNVG.js";import{C as re,Tr as ie,vr as k,yr as ae,zr as oe}from"./users.store-pCkD7Zo0.js";import"./ParameterInputList-BmOOAGJV.js";import{Qc as A,Ss as se,ai as ce,ii as le,ol as ue,so as de}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import{t as fe}from"./Modal-DQeDdfPI.js";import"./useClipboard-Duc7LjuO.js";import"./executions.store-DnLtKXBA.js";import"./assistant.store-BGYzebcZ.js";import"./chatPanel.store-YdM_XYGp.js";import"./RunData-DoJODYvb.js";import"./NDVEmptyState-Cd-QhxaI.js";import"./useEnvFeatureFlag-CHY3xSda.js";import"./externalSecrets.ee.store-RuZGBiOy.js";import"./uniqBy-Bd2DEoH8.js";import"./usePinnedData-C6FFXoty.js";import"./nodeIcon--7uU1Imq.js";import"./canvas.utils-C8dCdoZZ.js";import{r as j}from"./nodeCreator.store-KD9kt9dE.js";import"./useCanvasOperations-BHGWcL34.js";import"./folders.store-CS_gIPIm.js";import"./useQuickConnect-D8uMNvJo.js";import"./CredentialIcon-B1JZV04S.js";import"./useDynamicCredentials-BSZ25lEI.js";import"./RunDataHtml-Dkm6vMd9.js";import"./Draggable-YWqutRc8.js";import{t as M}from"./NodeIcon-Dv1e4Lvu.js";import"./VirtualSchema-SoERffbL.js";import"./useCalloutHelpers-BqZQxC7j.js";import"./useTelemetryContext-Dq1_6uNp.js";import"./useRunWorkflow-DzzlHC01.js";import"./pushConnection.store-IFO3HVvG.js";import"./nodeTransforms-CG9uauaw.js";import"./vue-json-pretty-CT_xxsnb.js";import"./collaboration.store-QKYwE2H2.js";import"./dateFormatter-C82w-7IH.js";import"./useExecutionHelpers-mcaelfkG.js";import"./vue-BgT2pM2d.js";import{t as pe}from"./chat.store-a0NAXg9S.js";import{t as me}from"./ToolSettingsContent-C1KYI1xd.js";var N=O(c({__name:`ToolListItem`,props:{nodeType:{},configuredNode:{},enabled:{type:Boolean},mode:{}},emits:[`toggle`,`configure`,`remove`,`add`],setup(e,{emit:i}){let o=e,c=i,d=x(),m=t(()=>o.configuredNode&&o.configuredNode.name!==o.nodeType.displayName?o.nodeType.displayName:o.nodeType.description),g=t(()=>o.configuredNode?o.configuredNode.name:o.nodeType.displayName);return(t,i)=>(p(),r(`div`,{class:_([t.$style.item,{[t.$style.configured]:e.mode===`configured`}])},[v(`div`,{class:_(t.$style.iconWrapper)},[s(M,{"node-type":e.nodeType,size:32},null,8,[`node-type`])],2),v(`div`,{class:_(t.$style.content)},[s(a(T),{class:_(t.$style.name),size:`small`,color:`text-dark`},{default:f(()=>[h(n(g.value),1)]),_:1},8,[`class`]),s(a(T),{class:_(t.$style.description),size:`small`,color:`text-light`},{default:f(()=>[h(n(m.value),1)]),_:1},8,[`class`])],2),v(`div`,{class:_(t.$style.actions)},[e.mode===`configured`?(p(),r(u,{key:0},[s(a(w),{content:a(d).baseText(`chatHub.toolsManager.configure`)},{default:f(()=>[s(a(C),{icon:`settings`,variant:`ghost`,text:``,class:_(t.$style.actionButton),onClick:i[0]||=e=>c(`configure`)},null,8,[`class`])]),_:1},8,[`content`]),s(a(w),{content:a(d).baseText(`chatHub.toolsManager.remove`)},{default:f(()=>[s(a(C),{icon:`trash-2`,variant:`ghost`,text:``,class:_(t.$style.actionButton),onClick:i[1]||=e=>c(`remove`)},null,8,[`class`])]),_:1},8,[`content`]),s(a(w),{content:e.enabled?a(d).baseText(`chatHub.toolsManager.disableTool`):a(d).baseText(`chatHub.toolsManager.enableTool`)},{default:f(()=>[s(a(E),{"model-value":e.enabled,class:_(t.$style.toggle),"onUpdate:modelValue":i[2]||=e=>c(`toggle`,!!e)},null,8,[`model-value`,`class`])]),_:1},8,[`content`])],64)):(p(),l(a(S),{key:1,variant:`subtle`,size:`small`,icon:`plus`,onClick:i[3]||=e=>c(`add`)},{default:f(()=>[h(n(a(d).baseText(`chatHub.toolsManager.add`)),1)]),_:1}))],2)],2))}}),[[`__cssModules`,{$style:{item:`_item_kwv06_125`,configured:`_configured_kwv06_132`,actionButton:`_actionButton_kwv06_132`,iconWrapper:`_iconWrapper_kwv06_139`,content:`_content_kwv06_147`,name:`_name_kwv06_155`,description:`_description_kwv06_162`,actions:`_actions_kwv06_169`,toggle:`_toggle_kwv06_176`}}]]),P=O(c({__name:`ToolsManagerModal`,props:{modalName:{},data:{}},setup(e){let c=e,w=t(()=>c.data.customAgentId),E=t(()=>w.value?F.customAgents[w.value]?.toolIds??[]:null),O=t(()=>{let e=M.baseText(`chatHub.toolsManager.title`);if(!w.value)return e;let t=F.customAgents[w.value]?.name;return t?`${e} (${t})`:e});function se(e){let{inputs:t}=e;return Array.isArray(t)?t.length>0:!0}let M=x(),P=re(),F=pe(),I=ae(),L=ie(),R=new Map(j.map(e=>[e.id,e.popularity])),z=o(``),B=o(``),he=b(e=>{B.value=e},ue(A.INPUT.SEARCH));d(z,e=>{he(e)});let V=o(`list`),H=o(null),U=o([]),W=o(null),G=o(null),K=o(``),q=o(!1),J=t(()=>F.configuredTools),ge=t(()=>{let e=[...le];return k([`global:chatUser`])&&e.push(...ce),e}),Y=t(()=>(P.visibleNodeTypesByOutputConnectionTypeNames[de.AiTool]??[]).map(e=>P.getNodeType(e)).filter(e=>e!==null&&!ge.value.includes(e.name)&&!se(e)).sort((e,t)=>{let n=R.get(e.name)??0;return(R.get(t.name)??0)-n})),X=t(()=>{if(!B.value)return J.value;let e=B.value.toLowerCase();return J.value.filter(t=>{let n=t.definition,r=P.getNodeType(n.type,n.typeVersion),i=n.name.toLowerCase().includes(e),a=r?.displayName.toLowerCase().includes(e);return i||a})}),Z=t(()=>{if(!B.value)return Y.value;let e=B.value.toLowerCase();return Y.value.filter(t=>{let n=t.displayName.toLowerCase().includes(e),r=t.description?.toLowerCase().includes(e);return n||r})});function _e(e){return P.getNodeType(e.definition.type,e.definition.typeVersion)}function Q(e,t,n){H.value=e,U.value=t,W.value=n,K.value=e.name,q.value=!1,V.value=`settings`}function ve(e){let t=J.value.filter(t=>t.definition.id!==e.definition.id).map(e=>e.definition.name);Q({...e.definition},t,async t=>{try{await F.updateConfiguredTool(e.definition.id,t)}catch(e){I.showError(e,M.baseText(`chatHub.error.updateToolsFailed`))}})}async function ye(e){if(await L.confirm(M.baseText(`chatHub.toolsManager.confirmRemove.message`),M.baseText(`chatHub.toolsManager.confirmRemove.title`),{confirmButtonText:M.baseText(`chatHub.toolsManager.remove`),cancelButtonText:M.baseText(`generic.cancel`)})===`confirm`)try{await F.removeConfiguredTool(e)}catch(e){I.showError(e,M.baseText(`chatHub.error.updateToolsFailed`))}}async function be(e,t){try{w.value?await F.toggleCustomAgentTool(w.value,e.definition.id):await F.toggleToolEnabled(e.definition.id,t)}catch(e){I.showError(e,M.baseText(`chatHub.error.updateToolsFailed`))}}function xe(e){let t=typeof e.version==`number`?e.version:e.version.toSorted((e,t)=>t-e)?.[0];if(!t)return;let n=oe(),r=J.value.map(e=>e.definition.name);Q({type:e.name,typeVersion:t,parameters:{},id:n,name:e.displayName,position:[0,0]},r,async e=>{try{await F.addConfiguredTool(e)}catch(e){I.showError(e,M.baseText(`chatHub.error.updateToolsFailed`))}})}function $(){V.value=`list`,H.value=null,U.value=[],W.value=null,K.value=``,q.value=!1}function Se(){let e=G.value?.node;!e||!W.value||(W.value(e),$())}function Ce(e){G.value?.handleChangeName(e)}return(t,o)=>(p(),l(fe,{name:e.modalName,width:`780px`,"show-close":V.value===`list`,"custom-class":t.$style.modal},{header:f(()=>[V.value===`list`?(p(),l(a(D),{key:0,tag:`h2`,size:`large`},{default:f(()=>[h(n(O.value),1)]),_:1})):(p(),r(`div`,{key:1,class:_(t.$style.settingsHeader)},[v(`div`,{class:_(t.$style.settingsHeaderLeft)},[s(a(C),{icon:`arrow-left`,text:``,size:`large`,variant:`ghost`,class:_(t.$style.backButton),onClick:$},null,8,[`class`]),s(a(te),{"model-value":K.value,"max-width":350,class:_(t.$style.title),"onUpdate:modelValue":Ce},null,8,[`model-value`,`class`])],2),s(a(S),{variant:`solid`,size:`small`,disabled:!q.value,onClick:Se},{default:f(()=>[h(n(a(M).baseText(`chatHub.toolSettings.confirm`)),1)]),_:1},8,[`disabled`])],2))]),content:f(()=>[y(s(a(ne),{modelValue:z.value,"onUpdate:modelValue":o[0]||=e=>z.value=e,placeholder:a(M).baseText(`chatHub.toolsManager.searchPlaceholder`),clearable:``,class:_(t.$style.searchInput)},{prefix:f(()=>[s(a(ee),{icon:`search`})]),_:1},8,[`modelValue`,`placeholder`,`class`]),[[g,V.value===`list`]]),y(v(`div`,{"data-tools-manager-modal":``,class:_(t.$style.listWrapper)},[X.value.length>0?(p(),r(`div`,{key:0,class:_(t.$style.section)},[s(a(D),{size:`small`,color:`text-light`,tag:`h3`},{default:f(()=>[h(n(a(M).baseText(`chatHub.toolsManager.configuredTools`,{interpolate:{count:J.value.length}})),1)]),_:1}),v(`div`,{class:_(t.$style.toolsList)},[(p(!0),r(u,null,m(X.value,e=>(p(),l(N,{key:e.definition.id,"node-type":_e(e),"configured-node":e.definition,enabled:E.value?E.value.includes(e.definition.id):e.enabled,mode:`configured`,onConfigure:t=>ve(e),onRemove:t=>ye(e.definition.id),onToggle:t=>be(e,t)},null,8,[`node-type`,`configured-node`,`enabled`,`onConfigure`,`onRemove`,`onToggle`]))),128))],2)],2)):i(``,!0),Z.value.length>0?(p(),r(`div`,{key:1,class:_(t.$style.section)},[s(a(D),{size:`small`,color:`text-light`,tag:`h3`},{default:f(()=>[h(n(a(M).baseText(`chatHub.toolsManager.availableTools`,{interpolate:{count:Y.value.length}})),1)]),_:1}),v(`div`,{class:_(t.$style.toolsList)},[(p(!0),r(u,null,m(Z.value,e=>(p(),l(N,{key:e.name,"node-type":e,mode:`available`,onAdd:t=>xe(e)},null,8,[`node-type`,`onAdd`]))),128))],2)],2)):i(``,!0),X.value.length===0&&Z.value.length===0?(p(),r(`div`,{key:2,class:_(t.$style.emptyState)},[s(a(T),{color:`text-light`},{default:f(()=>[h(n(a(M).baseText(`chatHub.toolsManager.noResults`)),1)]),_:1})],2)):i(``,!0)],2),[[g,V.value===`list`]]),V.value===`settings`&&H.value?(p(),r(`div`,{key:0,class:_(t.$style.settingsWrapper)},[s(me,{ref_key:`settingsContentRef`,ref:G,"initial-node":H.value,"existing-tool-names":U.value,"onUpdate:valid":o[1]||=e=>q.value=e,"onUpdate:nodeName":o[2]||=e=>K.value=e},null,8,[`initial-node`,`existing-tool-names`])],2)):i(``,!0)]),_:1},8,[`name`,`show-close`,`custom-class`]))}}),[[`__cssModules`,{$style:{modal:`_modal_1cu57_125`,settingsHeader:`_settingsHeader_1cu57_129`,settingsHeaderLeft:`_settingsHeaderLeft_1cu57_136`,icon:`_icon_1cu57_144`,title:`_title_1cu57_149`,listWrapper:`_listWrapper_1cu57_158`,settingsWrapper:`_settingsWrapper_1cu57_169`,searchInput:`_searchInput_1cu57_178`,section:`_section_1cu57_183`,toolsList:`_toolsList_1cu57_189`,emptyState:`_emptyState_1cu57_194`}}]]);export{P as default};
//# sourceMappingURL=ToolsManagerModal-CEaahO9q.js.map