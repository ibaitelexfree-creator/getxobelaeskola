(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`1586c47b-0ac6-4d88-9177-868bc5621868`,e._sentryDebugIdIdentifier=`sentry-dbid-1586c47b-0ac6-4d88-9177-868bc5621868`)})()}catch{}import{C as e,Cn as t,D as n,E as r,Gt as i,It as a,M as o,P as s,T as c,Z as l,bt as u,et as d,j as f,vn as p,w as m}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as h}from"./_MapCache-DjbOQyB7.js";import{Et as g,Hi as _,Oi as v,Pi as y,Tt as b,Vi as x,p as S,zi as C}from"./src-CppJvwzX.js";import{t as w}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as T,fn as E,r as D,rt as O,t as k,ws as A,yr as j}from"./users.store-pCkD7Zo0.js";import{oi as M}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import{t as N}from"./CredentialIcon-B1JZV04S.js";import{t as P}from"./TimeAgo-BLqTSlco.js";import{o as F,y as I}from"./constants-BeYoedeu.js";import{t as L}from"./chat.store-a0NAXg9S.js";var R={key:0},z=4,B=w(s({__name:`ChatProvidersTable`,props:{settings:{},loading:{type:Boolean},disabled:{type:Boolean}},emits:[`editProvider`,`refresh`],setup(s,{emit:l}){let w=s,T=l,E=h(),D=a([{title:E.baseText(`settings.chatHub.providers.table.provider`),key:`provider`,width:120,disableSort:!0,value(){}},{title:E.baseText(`settings.chatHub.providers.table.models`),key:`models`,width:300,disableSort:!0,value(){}},{title:E.baseText(`settings.chatHub.providers.table.updatedAt`),key:`updatedAt`,disableSort:!0,width:80,value(){}},{title:``,key:`actions`,align:`end`,width:50,disableSort:!0,value(){}}]),O=e(()=>[{label:E.baseText(`settings.chatHub.providers.table.action.editProvider`),value:`editProvider`,disabled:w.disabled}]),k=e(()=>w.settings?Object.values(w.settings):[]),A=e=>e.enabled?e.allowedModels.length===0?E.baseText(`settings.chatHub.providers.table.models.allModels`):e.allowedModels.length>z?e.allowedModels.slice(0,z).map(e=>e.displayName).join(`, `)+E.baseText(`settings.chatHub.providers.table.models.more`,{interpolate:{count:e.allowedModels.length-z}}):e.allowedModels.map(e=>e.displayName).join(`, `):E.baseText(`settings.chatHub.providers.table.models.disabled`),j=(e,t)=>{switch(e){case`editProvider`:T(`editProvider`,t);break;default:break}};return(e,a)=>(d(),n(`div`,{class:p(e.$style.tableContainer)},[w.loading?(d(),n(`div`,R,[o(i(g),{loading:w.loading,variant:`h1`,class:p(e.$style.header)},null,8,[`loading`,`class`]),o(i(g),{loading:w.loading,variant:`p`,rows:5,"shrink-last":!1},null,8,[`loading`])])):(d(),n(`div`,{key:1,class:p(e.$style.container)},[m(`div`,{class:p(e.$style.header)},[o(i(C),{size:`medium`,bold:!0},{default:u(()=>[f(t(i(E).baseText(`settings.chatHub.providers.table.title`)),1)]),_:1}),m(`div`,{class:p(e.$style.actions)},[o(i(v),{content:i(E).baseText(`settings.chatHub.providers.table.refresh.tooltip`)},{default:u(()=>[o(i(_),{variant:`subtle`,iconOnly:``,size:`small`,icon:`refresh-cw`,onClick:a[0]||=t=>e.$emit(`refresh`)})]),_:1},8,[`content`])],2)],2),w.settings?(d(),c(i(S),{key:1,class:p(e.$style.chatProvidersTable),headers:D.value,items:k.value,"items-length":k.value.length},{"item.provider":u(({item:n})=>[m(`div`,{class:p(e.$style.providerCell)},[n.provider in i(M)?(d(),c(N,{key:0,"credential-type-name":i(M)[n.provider],size:16,class:p(e.$style.menuIcon)},null,8,[`credential-type-name`,`class`])):r(``,!0),o(i(x),{bold:``},{default:u(()=>[f(t(i(I)[n.provider]),1)]),_:2},1024)],2)]),"item.models":u(({item:e})=>[e.allowedModels?.length&&e.allowedModels?.length>z?(d(),c(i(v),{key:0,content:e.allowedModels?.map(e=>e.displayName).join(`, `)},{default:u(()=>[o(i(x),{color:e.enabled?`text-base`:`primary`},{default:u(()=>[f(t(A(e)),1)]),_:2},1032,[`color`])]),_:2},1032,[`content`])):(d(),c(i(x),{key:1,color:e.enabled?`text-base`:`primary`},{default:u(()=>[f(t(A(e)),1)]),_:2},1032,[`color`]))]),"item.updatedAt":u(({item:e})=>[m(`span`,null,[e.updatedAt?(d(),c(P,{key:0,date:e.updatedAt},null,8,[`date`])):(d(),c(i(x),{key:1},{default:u(()=>[...a[1]||=[f(`-`,-1)]]),_:1}))])]),"item.actions":u(({item:e})=>[o(i(b),{placement:`bottom`,actions:O.value,theme:`dark`,onAction:t=>j(t,e)},null,8,[`actions`,`onAction`])]),_:2},1032,[`class`,`headers`,`items`,`items-length`])):(d(),c(i(y),{key:0,heading:i(E).baseText(`settings.chatHub.providers.table.empty.title`),description:i(E).baseText(`settings.chatHub.providers.table.empty.description`)},null,8,[`heading`,`description`]))],2))],2))}}),[[`__cssModules`,{$style:{container:`_container_qsz2g_125`,tableContainer:`_tableContainer_qsz2g_130`,actions:`_actions_qsz2g_134`,header:`_header_qsz2g_140`,chatProvidersTable:`_chatProvidersTable_qsz2g_147`,menuIcon:`_menuIcon_qsz2g_151`,providerCell:`_providerCell_qsz2g_155`}}]]),V=w(s({__name:`SettingsChatHubView`,setup(r){let a=h(),s=j(),c=E(),g=L(),_=k(),v=A(),y=O(),b=D(),x=T(),S=e(()=>_.isInstanceOwner),w=e(()=>_.isAdmin),N=e(()=>!S.value&&!w.value),P=async()=>{try{await g.fetchAllChatSettings()}catch(e){s.showError(e,a.baseText(`settings.chatHub.providers.fetching.error`))}};function I(e){b.openModalWithData({name:F,data:{provider:e.provider,disabled:N.value,onNewCredential:e=>{let t=M[e];x.track(`User opened Credential modal`,{credential_type:t,source:`chat_hub_settings`,new_credential:!0,workflow_id:null}),b.openNewCredential(t)},onConfirm:async e=>{try{await g.updateProviderSettings(e),s.showMessage({title:a.baseText(`settings.chatHub.providers.updated.success`),type:`success`}),await v.getModuleSettings()}catch(e){s.showError(e,a.baseText(`settings.chatHub.providers.updated.error`))}},onCancel:()=>{}}})}async function R(){await P()}return l(async()=>{c.set(a.baseText(`settings.chatHub`)),v.isChatFeatureEnabled&&await Promise.all([P(),y.fetchAllCredentials(),y.fetchCredentialTypes(!1)])}),(e,r)=>(d(),n(`div`,{class:p(e.$style.container)},[o(i(C),{size:`2xlarge`,class:p(e.$style.title)},{default:u(()=>[f(t(i(a).baseText(`settings.chatHub`)),1)]),_:1},8,[`class`]),m(`div`,{class:p(e.$style.container)},[o(B,{"data-test-id":`chat-providers-table`,settings:i(g).settings,loading:i(g).settingsLoading,disabled:N.value,onEditProvider:I,onRefresh:R},null,8,[`settings`,`loading`,`disabled`])],2)],2))}}),[[`__cssModules`,{$style:{container:`_container_sw5ac_125`,title:`_title_sw5ac_131`}}]]);export{V as default};
//# sourceMappingURL=SettingsChatHubView-BqjiXq58.js.map