(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`0a0ebaa5-080b-447a-9cff-d11048ce1a14`,e._sentryDebugIdIdentifier=`sentry-dbid-0a0ebaa5-080b-447a-9cff-d11048ce1a14`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,Gt as a,It as o,M as s,P as c,T as l,_ as u,bt as d,et as f,it as p,j as m,ot as h,st as g,vn as _,w as v,xt as y}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as b}from"./_MapCache-DjbOQyB7.js";import{At as x,Ci as S,F as C,Hi as w,Ht as T,Lt as E,Mi as D,Rt as O,Vi as k,_t as A,zi as j,zt as M}from"./src-CppJvwzX.js";import{t as N}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as P,Rr as F,Tr as ee,ws as te,yr as I}from"./users.store-pCkD7Zo0.js";import{Ss as L,Tc as R,Yc as z,qo as B,rs as V}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import"./usePageRedirectionHelper-BoF8hzbN.js";import{t as H}from"./executions.store-DnLtKXBA.js";import"./dateFormatter-C82w-7IH.js";import{t as U}from"./useExecutionHelpers-mcaelfkG.js";import"./TagsDropdown-B5U3GUsU.js";import{t as W}from"./injectStrict-CjZBqt9B.js";import{t as ne}from"./useExecutionDebugging-K6R7U7CM.js";import{t as G}from"./AnnotationTagsDropdown.ee-Cj5VoFhA.js";import{t as re}from"./WorkflowPreview-CJf5czT0.js";var ie=N(c({__name:`WorkflowExecutionAnnotationPanel.ee`,props:{execution:{}},setup(e){let c=e,h=F(),S=b(),C=o(null),T=o(!1),D=W(R),O=t(()=>B(h.getWorkflowById(D.value)?.scopes).workflow),A=t(()=>c.execution?.customData?Object.keys(c.execution?.customData).length:0);function M(e){C.value&&e.relatedTarget===null&&C.value.handleClose()}function N(e){T.value=e}return(t,o)=>{let c=g(`n8n-html`);return e.execution?(f(),l(a(E),{key:0,ref_key:`annotationDropdownRef`,ref:C,trigger:`click`,onVisibleChange:N},{dropdown:d(()=>[v(`div`,{ref:`container`,class:_([`execution-annotation-panel`,t.$style.container]),"data-test-id":`execution-annotation-panel`},[v(`div`,{class:_(t.$style.section)},[v(`div`,{class:_(t.$style.heading)},[s(a(j),{tag:`h3`,size:`small`,color:`text-dark`},{default:d(()=>[m(n(a(S).baseText(`generic.annotationData`)),1)]),_:1})],2),e.execution?.customData&&Object.keys(e.execution?.customData).length>0?(f(),r(`div`,{key:0,class:_(t.$style.metadata)},[(f(!0),r(u,null,p(Object.keys(e.execution?.customData),i=>(f(),r(`div`,{key:i,class:_(t.$style.customDataEntry)},[s(a(k),{class:_(t.$style.key),size:`small`,color:`text-base`},{default:d(()=>[m(n(i),1)]),_:2},1032,[`class`]),s(a(k),{class:_(t.$style.value),size:`small`,color:`text-base`},{default:d(()=>[m(n(e.execution?.customData[i]),1)]),_:2},1032,[`class`])],2))),128))],2)):(f(),r(`div`,{key:1,class:_(t.$style.noResultsContainer),"data-test-id":`execution-annotation-data-empty`},[s(a(k),{color:`text-base`,size:`small`,align:`center`},{default:d(()=>[y(v(`span`,null,null,512),[[c,a(S).baseText(`executionAnnotationView.data.notFound`)]])]),_:1})],2))],2)],2)]),default:d(()=>[s(a(w),{variant:`subtle`,title:a(S).baseText(`executionDetails.additionalActions`),disabled:!O.value.update,icon:`list-checks`,class:_({[t.$style.highlightDataButton]:!0,[t.$style.highlightDataButtonActive]:A.value>0,[t.$style.highlightDataButtonOpen]:T.value}),size:`small`,"data-test-id":`execution-preview-ellipsis-button`,onBlur:M},{default:d(()=>[A.value>0?(f(),l(a(x),{key:0,class:_(t.$style.badge),theme:`primary`},{default:d(()=>[m(n(A.value.toString()),1)]),_:1},8,[`class`])):i(``,!0)]),_:1},8,[`title`,`disabled`,`class`])]),_:1},512)):i(``,!0)}}}),[[`__cssModules`,{$style:{highlightDataButton:`_highlightDataButton_7tc76_125`,highlightDataButtonActive:`_highlightDataButtonActive_7tc76_130`,highlightDataButtonOpen:`_highlightDataButtonOpen_7tc76_134`,badge:`_badge_7tc76_140`,container:`_container_7tc76_144`,section:`_section_7tc76_156`,metadata:`_metadata_7tc76_165`,heading:`_heading_7tc76_169`,controls:`_controls_7tc76_176`,customDataEntry:`_customDataEntry_7tc76_188`,key:`_key_7tc76_195`,noResultsContainer:`_noResultsContainer_7tc76_199`,"execution-annotation-panel":`_execution-annotation-panel_7tc76_204`,"el-skeleton__item":`_el-skeleton__item_7tc76_204`}}]]),K={key:1},ae=N(c({__name:`WorkflowExecutionAnnotationTags.ee`,props:{execution:{}},setup(e){let i=e,c=b(),h=P(),{showError:g}=I(),y=H(),x=t(()=>i.execution.annotation?.tags.map(e=>e.id)??[]),S=t(()=>i.execution.annotation?.tags),C=A(),E=o(!1),D=o([]),O=o(!1),k=(e,t)=>{if(e.length!==t.length)return!0;let n=new Set(e);return t.reduce((e,t)=>e||!n.has(t),!1)},j=()=>{D.value=x.value,E.value=!0,C.emit(`focus`)},M=async()=>{if(!i.execution)return;let e=x.value??[],t=D.value;if(!k(e,t)){E.value=!1;return}if(!O.value){O.value=!0;try{await y.annotateExecution(i.execution.id,{tags:t}),t.length>0&&h.track(`User added execution annotation tag`,{tag_ids:t,execution_id:i.execution.id})}catch(e){g(e,`executionAnnotationView.tag.error`)}O.value=!1,E.value=!1}},N=()=>{E.value=!1};return(e,t)=>(f(),r(`div`,{class:_(e.$style.executionDetailsTags)},[v(`span`,{class:_(e.$style.tags),"data-test-id":`annotation-tags-container`},[E.value?(f(),l(G,{key:0,ref:`dropdown`,modelValue:D.value,"onUpdate:modelValue":t[0]||=e=>D.value=e,"create-enabled":!0,"event-bus":a(C),placeholder:a(c).baseText(`executionAnnotationView.chooseOrCreateATag`),class:`tags-edit`,"data-test-id":`workflow-tags-dropdown`,onBlur:M,onEsc:N},null,8,[`modelValue`,`event-bus`,`placeholder`])):x.value.length===0?(f(),r(`div`,K,[s(a(w),{variant:`ghost`,class:_([e.$style.addTagButton,`clickable`]),label:a(c).baseText(`executionAnnotationView.addTag`),size:`xsmall`,outline:!1,"data-test-id":`new-tag-link`,icon:`plus`,onClick:j},null,8,[`class`,`label`])])):(f(),r(`span`,{key:2,class:_([`tags-container`,e.$style.tagsContainer]),"data-test-id":`execution-annotation-tags`,onClick:j},[(f(!0),r(u,null,p(S.value,e=>(f(),r(`span`,{key:e.id,class:`clickable`},[s(a(T),{title:e.name,type:`info`,size:`small`,"disable-transitions":!0},{default:d(()=>[m(n(e.name),1)]),_:2},1032,[`title`])]))),128)),v(`span`,{class:_(e.$style.addTagWrapper)},[s(a(w),{variant:`ghost`,class:_([e.$style.addTagButton,e.$style.addTagButtonIconOnly,`clickable`]),size:`xsmall`,outline:!1,"data-test-id":`new-tag-link`,icon:`plus`,onClick:j},null,8,[`class`])],2)],2))],2)],2))}}),[[`__cssModules`,{$style:{tags:`_tags_12rjz_125`,addTagButton:`_addTagButton_12rjz_130`,addTagButtonIconOnly:`_addTagButtonIconOnly_12rjz_151`,tagsContainer:`_tagsContainer_12rjz_156`}}]]),oe=N(c({__name:`VoteButtons`,props:{vote:{}},emits:[`vote-click`],setup(e,{emit:t}){let n=t,i=e=>{n(`vote-click`,e)};return(t,n)=>(f(),r(`div`,{class:_(t.$style.ratingIcon)},[s(a(D),{variant:`ghost`,class:_([t.$style.icon,e.vote===`up`&&t.$style.up]),size:`small`,icon:`thumbs-up`,onClick:n[0]||=e=>i(`up`)},null,8,[`class`]),s(a(D),{variant:`ghost`,class:_([t.$style.icon,e.vote===`down`&&t.$style.down]),size:`small`,icon:`thumbs-down`,onClick:n[1]||=e=>i(`down`)},null,8,[`class`])],2))}}),[[`__cssModules`,{$style:{ratingIcon:`_ratingIcon_1u7e5_125`,icon:`_icon_1u7e5_129`,up:`_up_1u7e5_132`,down:`_down_1u7e5_132`}}]]),se=[`data-test-id`],ce={class:`retry-button`},q=N(c({__name:`WorkflowExecutionsPreview`,props:{execution:{}},emits:[`deleteCurrentExecution`,`retryExecution`,`stopExecution`],setup(e,{emit:c}){let u=e,p=c,g=S(),y=b(),{showError:x}=I(),T=U(),A=ee(),j=ne(),N=F(),P=te(),L=o(null),G=W(R),K=t(()=>B(N.getWorkflowById(G.value)?.scopes).workflow),q=t(()=>g.params.executionId),le=t(()=>g.params.nodeId),J=t(()=>u.execution?T.getUIDetails(u.execution):null),ue=t(()=>u.execution?.status===`success`?{text:y.baseText(`executionsList.debug.button.copyToEditor`),type:`secondary`}:{text:y.baseText(`executionsList.debug.button.debugInEditor`),type:`primary`}),de=t(()=>!!u.execution&&T.isExecutionRetriable(u.execution)),Y=t(()=>P.isEnterpriseFeatureEnabled[z.AdvancedExecutionFilters]),fe=t(()=>!!u.execution?.annotation&&(u.execution?.annotation.vote||u.execution?.annotation.tags.length>0)),X=H(),Z=t(()=>X.activeExecution),Q=t(()=>Z.value?.annotation?.vote||null);async function pe(){let e=[fe.value&&y.baseText(`executionDetails.confirmMessage.annotationsNote`),y.baseText(`executionDetails.confirmMessage.message`)].filter(Boolean).join(` `);await A.confirm(e,y.baseText(`executionDetails.confirmMessage.headline`),{type:`warning`,confirmButtonText:y.baseText(`executionDetails.confirmMessage.confirmButtonText`),cancelButtonText:``})===`confirm`&&p(`deleteCurrentExecution`)}function me(e){u.execution&&p(`retryExecution`,{execution:u.execution,command:e})}function $(){p(`stopExecution`)}function he(e){L.value&&e.relatedTarget===null&&L.value.handleClose()}let ge=async e=>{if(!Z.value)return;let t=e===Q.value?null:e;try{await X.annotateExecution(Z.value.id,{vote:t})}catch(e){x(e,`executionAnnotationView.vote.error`)}};return(t,o)=>{let c=h(`RouterLink`);return J.value?.name===`new`?(f(),r(`div`,{key:0,class:_(t.$style.newInfo)},[s(a(k),{class:_(t.$style.newMessage),color:`text-light`},{default:d(()=>[m(n(a(y).baseText(`executionDetails.newMessage`)),1)]),_:1},8,[`class`]),s(a(w),{variant:`subtle`,class:`mt-l`,onClick:$},{default:d(()=>[m(n(a(y).baseText(`executionsList.stopExecution`)),1)]),_:1})],2)):J.value?.name===`running`?(f(),r(`div`,{key:1,class:_(t.$style.runningInfo)},[v(`div`,{class:_(t.$style.spinner)},[s(a(C),{type:`ring`})],2),s(a(k),{class:_(t.$style.runningMessage),color:`text-light`},{default:d(()=>[m(n(a(y).baseText(`executionDetails.runningMessage`)),1)]),_:1},8,[`class`]),s(a(w),{variant:`subtle`,"data-test-id":`stop-execution`,class:`mt-l`,disabled:!K.value.execute,onClick:$},{default:d(()=>[m(n(a(y).baseText(`executionsList.stopExecution`)),1)]),_:1},8,[`disabled`])],2)):J.value?(f(),r(`div`,{key:2,class:_(t.$style.previewContainer)},[e.execution?(f(),r(`div`,{key:0,class:_(t.$style.executionDetails),"data-test-id":`execution-preview-details-${q.value}`},[v(`div`,{class:_(t.$style.executionDetailsLeft)},[v(`div`,{class:_(t.$style.executionTitle)},[s(a(k),{size:`large`,color:`text-dark`,bold:!0,"data-test-id":`execution-time`},{default:d(()=>[m(n(J.value?.startTime),1)]),_:1}),Y.value&&e.execution?(f(),l(oe,{key:0,"data-test-id":`execution-preview-vote-buttons`,vote:Q.value,class:_(t.$style.voteButtons),onVoteClick:ge},null,8,[`vote`,`class`])):i(``,!0)],2),v(`div`,{class:_(t.$style.executionDetailsInfo)},[J.value?.name===`running`?(f(),l(a(C),{key:0,size:`small`,class:_([t.$style.spinner,`mr-4xs`])},null,8,[`class`])):i(``,!0),s(a(k),{size:`medium`,class:_([t.$style.status,t.$style[J.value.name]]),"data-test-id":`execution-preview-label`},{default:d(()=>[m(n(J.value.label),1)]),_:1},8,[`class`]),o[1]||=m(` `+n(` `)+` `,-1),J.value?.showTimestamp===!1?(f(),l(a(k),{key:1,color:`text-base`,size:`medium`},{default:d(()=>[m(` | ID#`+n(e.execution.id),1)]),_:1})):J.value.name===`running`?(f(),l(a(k),{key:2,color:`text-base`,size:`medium`},{default:d(()=>[m(n(a(y).baseText(`executionDetails.runningTimeRunning`,{interpolate:{time:J.value?.runningTime}}))+` | ID#`+n(e.execution.id),1)]),_:1})):J.value.name===`waiting`?i(``,!0):(f(),l(a(k),{key:3,color:`text-base`,size:`medium`,"data-test-id":`execution-preview-id`},{default:d(()=>[m(n(a(y).baseText(`executionDetails.runningTimeFinished`,{interpolate:{time:J.value?.runningTime??`unknown`}}))+` | ID#`+n(e.execution.id),1)]),_:1}))],2),e.execution.mode===`retry`?(f(),r(`div`,{key:0,class:_(t.$style.executionDetailsRetry)},[s(a(k),{color:`text-base`,size:`small`},{default:d(()=>[m(n(a(y).baseText(`executionDetails.retry`))+` `,1),s(c,{class:_(t.$style.executionLink),to:{name:a(V).EXECUTION_PREVIEW,params:{workflowId:e.execution.workflowId,executionId:e.execution.retryOf}}},{default:d(()=>[m(` #`+n(e.execution.retryOf),1)]),_:1},8,[`class`,`to`])]),_:1})],2)):i(``,!0),Y.value&&e.execution?(f(),l(ae,{key:1,execution:e.execution},null,8,[`execution`])):i(``,!0)],2),v(`div`,{class:_(t.$style.actions)},[s(c,{to:{name:a(V).EXECUTION_DEBUG,params:{name:e.execution.workflowId,executionId:e.execution.id}}},{default:d(()=>[s(a(w),{size:`medium`,variant:`subtle`,class:_(t.$style.debugLink),disabled:!K.value.update},{default:d(()=>[v(`span`,{"data-test-id":`execution-debug-button`,onClick:o[0]||=(...e)=>a(j).handleDebugLinkClick&&a(j).handleDebugLinkClick(...e)},n(ue.value.text),1)]),_:1},8,[`class`,`disabled`])]),_:1},8,[`to`]),de.value?(f(),l(a(E),{key:0,ref:`retryDropdown`,trigger:`click`,onCommand:me},{dropdown:d(()=>[s(a(M),null,{default:d(()=>[s(a(O),{command:`current-workflow`},{default:d(()=>[m(n(a(y).baseText(`executionsList.retryWithCurrentlySavedWorkflow`)),1)]),_:1}),s(a(O),{command:`original-workflow`},{default:d(()=>[m(n(a(y).baseText(`executionsList.retryWithOriginalWorkflow`)),1)]),_:1})]),_:1})]),default:d(()=>[v(`span`,ce,[s(a(D),{variant:`subtle`,size:`medium`,title:a(y).baseText(`executionsList.retryExecution`),disabled:!K.value.update,icon:`redo-2`,"data-test-id":`execution-preview-retry-button`,onBlur:he},null,8,[`title`,`disabled`])])]),_:1},512)):i(``,!0),Y.value&&Z.value?(f(),l(ie,{key:1,execution:Z.value},null,8,[`execution`])):i(``,!0),s(a(D),{variant:`subtle`,title:a(y).baseText(`executionDetails.deleteExecution`),disabled:!K.value.update,icon:`trash-2`,size:`medium`,"data-test-id":`execution-preview-delete-button`,onClick:pe},null,8,[`title`,`disabled`])],2)],10,se)):i(``,!0),(f(),l(re,{key:q.value,mode:`execution`,"loader-type":`spinner`,"execution-id":q.value,"execution-mode":e.execution?.mode||``,"node-id":le.value},null,8,[`execution-id`,`execution-mode`,`node-id`]))],2)):i(``,!0)}}}),[[`__cssModules`,{$style:{previewContainer:`_previewContainer_77hfc_125`,executionDetails:`_executionDetails_77hfc_131`,executionDetailsLeft:`_executionDetailsLeft_77hfc_149`,executionTitle:`_executionTitle_77hfc_155`,voteButtons:`_voteButtons_77hfc_161`,spinner:`_spinner_77hfc_165`,running:`_running_77hfc_171`,waiting:`_waiting_77hfc_176`,success:`_success_77hfc_180`,error:`_error_77hfc_184`,newInfo:`_newInfo_77hfc_188`,runningInfo:`_runningInfo_77hfc_189`,newMessage:`_newMessage_77hfc_196`,runningMessage:`_runningMessage_77hfc_197`,debugLink:`_debugLink_77hfc_203`,actions:`_actions_77hfc_208`,highlightDataButton:`_highlightDataButton_77hfc_213`,highlightDataButtonActive:`_highlightDataButtonActive_77hfc_218`,highlightDataButtonOpen:`_highlightDataButtonOpen_77hfc_222`,badge:`_badge_77hfc_228`}}]]);export{q as default};
//# sourceMappingURL=WorkflowExecutionsPreview-BzvX-F3x.js.map