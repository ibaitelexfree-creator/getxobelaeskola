(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`ea2e39bd-41e5-4f25-9338-e9fba81bc0d9`,e._sentryDebugIdIdentifier=`sentry-dbid-ea2e39bd-41e5-4f25-9338-e9fba81bc0d9`)})()}catch{}import{C as e,Cn as t,D as n,E as r,G as i,Gt as a,It as o,M as s,P as c,T as l,Z as u,_ as d,_t as f,at as p,bn as m,bt as h,et as g,h as _,it as v,j as y,k as b,mt as x,ot as S,vn as C,w}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{yt as T}from"./_MapCache-DjbOQyB7.js";import{Ci as E,Dt as D,I as O,Mi as k,Ui as A,Vi as j,ji as M,q as N,u as P,wi as F}from"./src-CppJvwzX.js";import{t as I}from"./_plugin-vue_export-helper-B_J4Khre.js";import"./sanitize-html-K63Olwt_.js";import{Lt as L,Tr as R,rt as z,yr as B}from"./users.store-pCkD7Zo0.js";import{n as V,r as H,t as U}from"./MainSidebarHeader-C11PZIjQ.js";import{t as W}from"./BaseLayout-CcCtCTTx.js";import{Ss as G,rs as K}from"./constants-D1jZwsUK.js";import"./merge-CKxbv8m_.js";import"./_baseOrderBy-El3qbNHQ.js";import"./dateformat-BhE5sUDK.js";import"./useDebounce-D6lADr4O.js";import"./versions.store-1_eor2Ku.js";import"./usePageRedirectionHelper-BoF8hzbN.js";import"./canvas.utils-C8dCdoZZ.js";import"./CredentialIcon-B1JZV04S.js";import{t as q}from"./KeyboardShortcutTooltip-BuQeOxiO.js";import{a as J,l as Y,n as X,u as Z}from"./constants-BeYoedeu.js";import{t as ee}from"./useKeybindings-B_gtbMl6.js";import"./useGlobalEntityCreation-DU5BFKv0.js";import{b as te,t as Q,u as ne}from"./chat.store-a0NAXg9S.js";import{t as re}from"./useSettingsItems-DieYApNB.js";import{t as ie}from"./ChatAgentAvatar-B0HR6UWG.js";var ae=I(c({__name:`ChatSidebarLink`,props:{active:{type:Boolean,default:!1},to:{},label:{},title:{},menuItems:{default:()=>[]},icon:{},compact:{type:Boolean}},emits:[`actionSelect`,`click`],setup(e,{emit:i}){let o=i;return(i,c)=>{let u=S(`RouterLink`);return g(),n(`div`,{class:C([i.$style.menuItem,{[i.$style.active]:e.active}])},[i.$slots.default?p(i.$slots,`default`,{key:0}):(g(),n(d,{key:1},[s(u,{to:e.to,class:C([i.$style.menuItemLink,{[i.$style.compact]:e.compact}]),title:e.title,onClick:c[0]||=e=>o(`click`,e)},{default:h(()=>[p(i.$slots,`icon`,{},()=>[e.icon?(g(),l(a(A),{key:0,size:`large`,icon:e.icon},null,8,[`icon`])):r(``,!0)]),e.compact?r(``,!0):(g(),n(`div`,{key:0,class:C(i.$style.textContainer)},[s(a(j),{class:C(i.$style.label),size:`small`,color:`text-light`},{default:h(()=>[y(t(e.label),1)]),_:1},8,[`class`]),s(a(j),{class:C(i.$style.title),size:`medium`,color:`text-dark`},{default:h(()=>[y(t(e.title),1)]),_:1},8,[`class`])],2))]),_:3},8,[`to`,`class`,`title`]),!e.compact&&e.menuItems.length>0?(g(),l(a(D),{key:0,items:e.menuItems,class:C(i.$style.actionDropdown),placement:`bottom-start`,onSelect:c[1]||=e=>o(`actionSelect`,e),onClick:c[2]||=_(()=>{},[`stop`])},{activator:h(()=>[s(a(k),{variant:`ghost`,icon:`ellipsis-vertical`,class:C(i.$style.actionDropdownTrigger)},null,8,[`class`])]),_:1},8,[`items`,`class`])):r(``,!0)],64))],2)}}}),[[`__cssModules`,{$style:{menuItem:`_menuItem_1mhhm_125`,active:`_active_1mhhm_131`,menuItemLink:`_menuItemLink_1mhhm_135`,compact:`_compact_1mhhm_147`,textContainer:`_textContainer_1mhhm_154`,label:`_label_1mhhm_160`,title:`_title_1mhhm_169`,actionDropdown:`_actionDropdown_1mhhm_178`,actionDropdownTrigger:`_actionDropdownTrigger_1mhhm_189`}}]]),oe=I(c({__name:`ChatSessionMenuItem`,props:{session:{},isRenaming:{type:Boolean},active:{type:Boolean},compact:{type:Boolean}},emits:[`startRename`,`cancelRename`,`confirmRename`,`delete`],setup(t,{emit:n}){let r=n,c=x(`input`),u=o(``),d=Q(),p=T(),m=e(()=>{let e=te(t.session);return e?d.getAgent(e,{name:t.session.agentName,icon:t.session.agentIcon}):null}),_=e(()=>[{id:`rename`,label:p.baseText(`chatHub.session.actions.rename`),icon:`pencil`},{id:`delete`,label:p.baseText(`chatHub.session.actions.delete`),icon:`trash-2`}]);function v(e){e===`rename`?(u.value=t.session.title,r(`startRename`,t.session.id)):e===`delete`&&r(`delete`,t.session.id)}function y(){let e=u.value.trim();e&&e!==t.session.title?r(`confirmRename`,t.session.id,e):r(`cancelRename`)}function S(e){if(e.key===`Escape`){r(`cancelRename`);return}e.key===`Enter`&&!e.isComposing&&y()}return f(()=>t.isRenaming,async e=>{e?(u.value=t.session.title,await i(),c.value?.focus(),c.value?.select()):u.value=``},{immediate:!0}),(e,n)=>(g(),l(ae,{to:{name:a(X),params:{id:t.session.id}},active:t.active,compact:t.compact,"menu-items":_.value,label:t.session.agentName,title:t.session.title,onActionSelect:v},b({icon:h(()=>[s(ie,{agent:m.value,size:`sm`,class:C(e.$style.avatar)},null,8,[`agent`,`class`])]),_:2},[t.isRenaming?{name:`default`,fn:h(()=>[s(a(M),{ref_key:`input`,ref:c,modelValue:u.value,"onUpdate:modelValue":n[0]||=e=>u.value=e,size:`large`,onBlur:y,onKeydown:S},null,8,[`modelValue`])]),key:`0`}:void 0]),1032,[`to`,`active`,`compact`,`menu-items`,`label`,`title`]))}}),[[`__cssModules`,{$style:{avatar:`_avatar_1006s_125`}}]]),se={skeletonItem:`_skeletonItem_rwi4t_125`,skeletonAvatar:`_skeletonAvatar_rwi4t_134`,skeletonText:`_skeletonText_rwi4t_135`,"skeleton-pulse":`_skeleton-pulse_rwi4t_1`},ce={};function le(e,t){return g(),n(`div`,{class:C(e.$style.skeletonItem)},[w(`div`,{class:C(e.$style.skeletonAvatar)},null,2),w(`div`,{class:C(e.$style.skeletonText)},null,2)],2)}var $=I(ce,[[`render`,le],[`__cssModules`,{$style:se}]]),ue=I(c({__name:`ChatSidebarContent`,props:{isCollapsed:{type:Boolean}},setup(i){let c=E(),f=F(),p=Q(),m=B(),_=R(),b=z(),x=L(),S=e(()=>p.sessionsReady&&b.allCredentialTypes.length>0),D=T(),O=o(),k=e(()=>typeof c.params.id==`string`?c.params.id:void 0),A=e(()=>ne((p.sessions.ids??[]).reduce((e,t)=>{let n=p.sessions.byId[t];return n&&e.push(n),e},[]))),M=e(()=>({id:`new-chat`,label:D.baseText(`chatHub.sidebar.link.newChat`),icon:`plus`,route:{to:{name:Y,force:!0}}})),I=e(()=>({id:`personal-agents`,label:D.baseText(`chatHub.sidebar.link.personalAgents`),icon:`message-square`,route:{to:{name:J}}})),V=e(()=>({id:`workflow-agents`,label:D.baseText(`chatHub.sidebar.link.workflowAgents`),icon:`robot`,route:{to:{name:Z}}}));function H(e){O.value=e}function U(){O.value=void 0}async function W(e,t){try{await p.renameSession(e,t),O.value=void 0}catch(e){m.showError(e,D.baseText(`chatHub.session.updateTitle.error`))}}async function G(e){if(await _.confirm(D.baseText(`chatHub.session.delete.confirm.message`),D.baseText(`chatHub.session.delete.confirm.title`),{confirmButtonText:D.baseText(`chatHub.session.delete.confirm.button`),cancelButtonText:D.baseText(`chatHub.session.delete.cancel.button`)})===`confirm`)try{await p.deleteSession(e),m.showMessage({type:`success`,title:D.baseText(`chatHub.session.delete.success`)}),e===k.value&&f.push({name:Y})}catch(e){m.showError(e,D.baseText(`chatHub.session.delete.error`))}}function K(){x.track(`User clicked new chat button`,{})}return u(()=>{p.sessionsReady||p.fetchSessions(!0,{minLoadingTime:250})}),(e,o)=>(g(),n(`div`,{class:C(e.$style.component)},[w(`div`,{class:C({[e.$style.links]:!0,[e.$style.collapsed]:i.isCollapsed})},[s(q,{placement:`right`,label:a(D).baseText(`chatHub.sidebar.link.newChat`),"show-after":500,shortcut:{keys:[`o`],metaKey:!0,shiftKey:!0}},{default:h(()=>[s(a(N),{item:M.value,compact:i.isCollapsed,active:a(c).name===a(Y),onClick:K},null,8,[`item`,`compact`,`active`])]),_:1},8,[`label`]),s(a(N),{item:I.value,compact:i.isCollapsed,active:a(c).name===a(J)},null,8,[`item`,`compact`,`active`]),s(a(N),{item:V.value,compact:i.isCollapsed,active:a(c).name===a(Z)},null,8,[`item`,`compact`,`active`])],2),s(a(P),{"as-child":``,type:`scroll`},{default:h(()=>[w(`div`,{class:C([e.$style.historySections,{[e.$style.collapsed]:i.isCollapsed}]),"data-test-id":`chat-conversation-list`},[S.value?(g(!0),n(d,{key:1},v(A.value,(c,u)=>(g(),n(`div`,{key:c.group,class:C(e.$style.group)},[i.isCollapsed?r(``,!0):(g(),l(a(j),{key:0,class:C(e.$style.groupHeader),size:`small`,bold:``,color:`text-light`},{default:h(()=>[y(t(c.group),1)]),_:2},1032,[`class`])),(g(!0),n(d,null,v(c.sessions,e=>(g(),l(oe,{key:e.id,session:e,compact:i.isCollapsed,active:k.value===e.id,"is-renaming":O.value===e.id,onStartRename:H,onCancelRename:U,onConfirmRename:W,onDelete:G},null,8,[`session`,`compact`,`active`,`is-renaming`]))),128)),u===A.value.length-1&&a(p).sessions.hasMore&&!a(p).sessionsLoading?(g(),l(a(N),{key:1,item:{id:`load-more-sessions`,label:a(D).baseText(`chatHub.sidebar.loadMoreSessions`),icon:`circle-ellipsis`},compact:i.isCollapsed,onClick:o[0]||=()=>a(p).fetchMoreSessions({minLoadingTime:250})},null,8,[`item`,`compact`])):r(``,!0),u===A.value.length-1&&a(p).sessionsLoading?(g(),n(d,{key:2},v(10,e=>s($,{key:e})),64)):r(``,!0)],2))),128)):(g(),n(`div`,{key:0,class:C(e.$style.group)},[(g(),n(d,null,v(10,e=>s($,{key:`loading-${e}`})),64))],2))],2)]),_:1})],2))}}),[[`__cssModules`,{$style:{logoContainer:`_logoContainer_1vnf8_125`,component:`_component_1vnf8_131`,header:`_header_1vnf8_137`,logo:`_logo_1vnf8_125`,links:`_links_1vnf8_153`,collapsed:`_collapsed_1vnf8_158`,historySections:`_historySections_1vnf8_162`,group:`_group_1vnf8_172`,groupHeader:`_groupHeader_1vnf8_178`,loading:`_loading_1vnf8_182`,empty:`_empty_1vnf8_183`}}]]),de=I(c({__name:`ChatSidebar`,setup(t){let n=T(),r=F(),{isCollapsed:o,sidebarWidth:c,onResizeStart:u,onResize:d,onResizeEnd:f,toggleCollapse:p}=H();function _(e){e.stopPropagation(),i(()=>{let e=new KeyboardEvent(`keydown`,{key:`k`,code:`KeyK`,metaKey:!0,bubbles:!0,cancelable:!0});document.dispatchEvent(e)})}let{settingsItems:v}=re(),y=e(()=>[{id:`settings`,label:n.baseText(`mainSidebar.settings`),icon:`settings`,available:!0,children:v.value}]),b=e(()=>y.value.filter(e=>e.available!==!1));ee({bracketleft:()=>p()});let x=()=>{r.push({name:K.SIGNOUT})};return(e,t)=>(g(),l(a(O),{id:`side-menu`,class:C({[e.$style.sideMenu]:!0,[e.$style.sideMenuCollapsed]:a(o)}),width:a(c),style:m({width:`${a(c)}px`}),"supported-directions":[`right`],"min-width":200,"max-width":500,"grid-size":8,onResizestart:a(u),onResize:a(d),onResizeend:a(f)},{default:h(()=>[s(U,{"hide-create":``,"is-beta":``,"is-collapsed":a(o),onCollapse:a(p),onOpenCommandBar:_},null,8,[`is-collapsed`,`onCollapse`]),s(a(P),{"as-child":``},{default:h(()=>[w(`div`,{class:C(e.$style.scrollArea)},[s(ue,{"is-collapsed":a(o)},null,8,[`is-collapsed`]),s(V,{items:b.value,"is-collapsed":a(o),onLogout:x},null,8,[`items`,`is-collapsed`])],2)]),_:1})]),_:1},8,[`class`,`width`,`style`,`onResizestart`,`onResize`,`onResizeend`]))}}),[[`__cssModules`,{$style:{sideMenu:`_sideMenu_nzvda_125`,sideMenuCollapsed:`_sideMenuCollapsed_nzvda_133`,scrollArea:`_scrollArea_nzvda_138`}}]]),fe=c({__name:`ChatLayout`,setup(e){return(e,t)=>{let n=S(`RouterView`);return g(),l(W,null,{sidebar:h(()=>[s(de)]),default:h(()=>[s(n)]),_:1})}}});export{fe as default};
//# sourceMappingURL=ChatLayout-gyvhtGDd.js.map