(function(){try{var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e.SENTRY_RELEASE={id:`n8n@2.9.4`}}catch{}})();try{(function(){var e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`9813c2c2-3bd1-489f-8c0a-c18d31852e5a`,e._sentryDebugIdIdentifier=`sentry-dbid-9813c2c2-3bd1-489f-8c0a-c18d31852e5a`)})()}catch{}import{o as e}from"./chunk-Din3qlHY.js";import{C as t,Cn as n,D as r,E as i,G as a,Gt as o,I as s,It as c,J as ee,M as l,P as u,T as d,Z as te,_ as f,_t as p,at as m,bt as h,et as g,it as ne,j as _,p as re,pt as ie,vn as v,w as y,xt as ae,yn as oe}from"./vue.runtime.esm-bundler-1e_FtHOF.js";import{M as b,yt as x}from"./_MapCache-DjbOQyB7.js";import{Ci as se,Et as S,Nt as ce,Pi as le,Q as ue,R as de,Ui as fe,Vi as pe,ft as me,gi as he,ji as ge,pt as _e,ut as ve,wi as ye}from"./src-CppJvwzX.js";import{t as C}from"./_plugin-vue_export-helper-B_J4Khre.js";import{Lt as be,Qr as w,Ur as T,ei as xe,t as Se}from"./users.store-pCkD7Zo0.js";import{uc as E}from"./constants-D1jZwsUK.js";import{t as Ce}from"./useDebounce-D6lADr4O.js";import{r as D}from"./readyToRun.store-DM7AW4os.js";import{t as we}from"./ResourceFiltersDropdown-tUuDPU--.js";var O={wrapper:`_wrapper_1bol0_125`,content:`_content_1bol0_141`},k={};function A(e,t){return g(),r(`div`,{class:v(e.$style.wrapper)},[m(e.$slots,`header`),y(`main`,{class:v(e.$style.content)},[m(e.$slots,`default`)],2)],2)}var Te=C(k,[[`render`,A],[`__cssModules`,{$style:O}]]),Ee=C(u({__name:`PageViewLayoutList`,props:{overflow:{type:Boolean}},setup(e){return(t,n)=>(g(),r(`div`,{class:v({[t.$style.wrapper]:!0,[t.$style.overflow]:e.overflow})},[y(`div`,{class:v(t.$style.list)},[t.$slots.header?(g(),r(`div`,{key:0,class:v(t.$style.header)},[m(t.$slots,`header`)],2)):i(``,!0),y(`div`,{class:v(t.$style.body)},[m(t.$slots,`default`)],2)],2)],2))}}),[[`__cssModules`,{$style:{wrapper:`_wrapper_mbox7_125`,overflow:`_overflow_mbox7_130`,list:`_list_mbox7_130`,body:`_body_mbox7_130`}}]]);function De(){let e=D(),t=t=>e.isOverviewSubPage?`home`:t;return{saveProjectPreferencesToLocalStorage:(e,n,r)=>{let i=t(e);if(!i)return;let a=b(E,{});a.value[i]||(a.value[i]={}),a.value[i][n]={...a.value[i][n],...r}},loadProjectPreferencesFromLocalStorage:(e,n)=>{let r=t(e);return r&&b(`N8N_WORKFLOWS_LIST_PREFERENCES`,{}).value[r]?.[n]||{}},getProjectKey:t}}function Oe(e){let t=x();return{getResourceText:(n,r,i)=>{let a=`${e}.${n}`,o=`resources.${n}`,s=r?`resources.${r}`:void 0;return T(a)?t.baseText(a,{interpolate:i}):T(o)?t.baseText(o,{interpolate:i}):s&&T(s)?t.baseText(s,{interpolate:i}):n.split(`.`).pop()?.replace(/([A-Z])/g,` $1`).trim()||n}}}var ke={key:0,class:`resource-list-loading`},Ae={key:0},je={key:0,class:`mt-xs`,"data-test-id":`resources-list-filters-applied-info`},Me={key:0,class:`resource-list-loading resource-list-loading-instant`},j=C(u({__name:`ResourcesListLayout`,props:{resourceKey:{},displayName:{type:Function,default:e=>e.name||``},resources:{},disabled:{type:Boolean},initialize:{type:Function,default:async()=>{}},filters:{default:()=>({search:``,homeProject:``})},additionalFiltersHandler:{type:Function,default:void 0},shareable:{type:Boolean,default:!0},sortFns:{default:()=>({})},sortOptions:{default:()=>[`lastUpdated`,`lastCreated`,`nameAsc`,`nameDesc`]},type:{default:`list-full`},typeProps:{default:()=>({itemSize:80})},loading:{type:Boolean,default:!0},customPageSize:{default:25},availablePageSizeOptions:{default:()=>[10,25,50,100]},totalItems:{default:0},resourcesRefreshing:{type:Boolean,default:!1},dontPerformSortingAndFiltering:{type:Boolean,default:!1},hasEmptyState:{type:Boolean,default:!0},uiConfig:{default:()=>({searchEnabled:!0,showFiltersDropdown:!0,sortEnabled:!0})}},emits:[`update:filters`,`click:add`,`update:pagination-and-sort`,`update:search`],setup(e,{expose:u,emit:b}){let x=se(),C=ye(),{callDebounced:T}=Ce(),E=Se(),D=be(),O=De(),k=e,{getResourceText:A}=Oe(k.resourceKey),j=c(k.sortOptions[0]),M=c(!1),N=c(1),P=c(k.customPageSize),F=c(!1),I=c(null),L=c(null),R=c(null),z=c(k.customPageSize),B=c(k.sortOptions[0]),V=b;ie();let H=t({get:()=>k.filters,set:e=>V(`update:filters`,e)}),Ne=t(()=>k.hasEmptyState&&k.resources.length===0&&!M.value&&!H.value.search&&!k.resourcesRefreshing),U=t(()=>Object.keys(H.value)),W=t(()=>k.dontPerformSortingAndFiltering?k.resources:k.resources.filter(e=>{let t=!0;if(H.value.homeProject&&xe(e)&&(t&&=!!(`homeProject`in e&&e.homeProject&&e.homeProject.id===H.value.homeProject)),H.value.search){let n=H.value.search.toLowerCase();t&&=k.displayName(e).toLowerCase().includes(n)}return k.additionalFiltersHandler&&(t=k.additionalFiltersHandler(e,H.value,t)),t}).sort((e,t)=>{let n=w(e)&&w(t);switch(j.value){case`lastUpdated`:return n&&`updatedAt`in e&&`updatedAt`in t?k.sortFns.lastUpdated?k.sortFns.lastUpdated(e,t):new Date(t.updatedAt??``).valueOf()-new Date(e.updatedAt??``).valueOf():0;case`lastCreated`:return n&&`createdAt`in e&&`createdAt`in t?k.sortFns.lastCreated?k.sortFns.lastCreated(e,t):new Date(t.createdAt??``).valueOf()-new Date(e.createdAt??``).valueOf():0;case`nameAsc`:return k.sortFns.nameAsc?k.sortFns.nameAsc(e,t):k.displayName(e).trim().localeCompare(k.displayName(t).trim());case`nameDesc`:return k.sortFns.nameDesc?k.sortFns.nameDesc(e,t):k.displayName(t).trim().localeCompare(k.displayName(e).trim());default:return k.sortFns[j.value]?k.sortFns[j.value](e,t):0}}));p(()=>k.filters,e=>{H.value=e,q()&&(M.value=!0)}),p(()=>H.value.homeProject,()=>{Z(`homeProject`)}),p(()=>H.value.tags,()=>{Z(`tags`)}),p(()=>H.value.type,()=>{Z(`type`)}),p(()=>H.value.search,()=>T(Z,{debounceTime:1e3,trailing:!0},`search`)),p(()=>H.value.setupNeeded,()=>{Z(`setupNeeded`)}),p(()=>H.value.incomplete,()=>{Z(`incomplete`)}),p([()=>x.params?.projectId,()=>x.name],async()=>{await Q(),await We(),await k.initialize()}),te(async()=>{await We(),await k.initialize(),await a(),q()&&(M.value=!0),window.addEventListener(`keydown`,G)}),ee(()=>{window.removeEventListener(`keydown`,G)});let G=e=>{(e.ctrlKey||e.metaKey)&&e.key===`f`&&(e.preventDefault(),Pe())},Pe=()=>{I.value&&I.value.focus()},K=e=>e===`search`?!1:typeof k.filters[e]==`boolean`?k.filters[e]:Array.isArray(k.filters[e])?k.filters[e].length>0:k.filters[e]!==``,Fe=t(()=>{let e=U.value.filter(K),t=[`showArchived`];return e.every(e=>t.includes(e))}),q=()=>!!U.value.find(K),J=async e=>{P.value=e,await $(),V(`update:pagination-and-sort`,{pageSize:e})},Y=async(e,t=!0)=>{j.value=e,t&&(await $(),Be()),V(`update:pagination-and-sort`,{sort:e})},X=async(e,t=!0)=>{N.value=e,t&&await $(),V(`update:pagination-and-sort`,{page:e})},Z=e=>{if(F.value){if(e!==`reset`)return;setTimeout(()=>F.value=!1,1500)}let t=H.value,n=[],r=[];Object.keys(t).forEach(e=>{t[e]&&(n.push(e),r.push(e===`search`?null:t[e]))}),D.track(`User set filters in ${k.resourceKey} list`,{filters_set:n,filter_values:r,[`${k.resourceKey}_total_in_view`]:k.resources.length,[`${k.resourceKey}_after_filtering`]:W.value.length})},Ie=e=>{V(`click:add`,e)},Le=e=>{V(`update:filters`,e)},Q=async()=>{Object.keys(H.value).forEach(e=>{H.value[e]=Array.isArray(H.value[e])?[]:``}),await X(1,!1),F.value=!0,M.value=!1,Z(`reset`),V(`update:filters`,H.value)},Re=()=>`itemSize`in k.typeProps?k.typeProps.itemSize:0,ze=()=>`columns`in k.typeProps?k.typeProps.columns:[],Be=()=>{D.track(`User changed sorting in ${k.resourceKey} list`,{sorting:j.value})},Ve=e=>{M.value=e>0},He=e=>{H.value.search=e,V(`update:search`,e)},Ue=e=>k.availablePageSizeOptions.reduce((t,n)=>Math.abs(n-e)<Math.abs(t-e)?n:t),$=async()=>{if(k.type!==`list-paginated`)return;let e={...x.query};N.value===1?delete e.page:e.page=N.value.toString(),P.value===z.value?delete e.pageSize:(e.pageSize=P.value.toString(),z.value=P.value),j.value===B.value?delete e.sort:(e.sort=j.value,B.value=j.value),O.saveProjectPreferencesToLocalStorage(x.params.projectId??``,`workflows`,{sort:j.value,pageSize:P.value}),await C.replace({query:Object.keys(e).length?e:void 0})},We=async()=>{if(k.type!==`list-paginated`)return;let e=x.query,t=O.loadProjectPreferencesFromLocalStorage(x.params.projectId??``,`workflows`),n={};if(e.page){let t=parseInt(e.page,10);t>1&&(N.value=t,n.page=t)}if(e.pageSize??t.pageSize){let r=Ue(parseInt(e.pageSize||String(t.pageSize),10));P.value=r,n.pageSize=r,z.value=r}else P.value=k.customPageSize,n.pageSize=k.customPageSize;e.sort?j.value=n.sort=B.value=e.sort:t.sort?(await Y(t.sort,!1),n.sort=t.sort,B.value=t.sort):j.value=k.sortOptions[0],V(`update:pagination-and-sort`,n)};return u({currentPage:N,setCurrentPage:X,getScrollContainer:()=>k.type===`list-paginated`?R.value??null:L.value??null}),(t,a)=>(g(),d(Te,null,{header:h(()=>[m(t.$slots,`header`,{},void 0,!0)]),default:h(()=>[e.loading?(g(),r(`div`,ke,[l(o(S),{rows:25,"shrink-last":!1})])):(g(),r(f,{key:1},[Ne.value?(g(),r(`div`,Ae,[m(t.$slots,`empty`,{},()=>[l(o(le),{"data-test-id":`empty-resources-list`,icon:{type:`emoji`,value:`ðŸ‘‹`},heading:o(A)(o(E).currentUser?.firstName?`empty.heading`:`empty.heading.userNotSetup`,o(E).currentUser?.firstName?`empty.heading`:`empty.heading.userNotSetup`,{name:o(E).currentUser?.firstName??``}),description:o(A)(`empty.description`),"button-text":o(A)(`empty.button`),"button-type":`secondary`,"button-disabled":e.disabled,"onClick:button":Ie},{disabledButtonTooltip:h(()=>[_(n(o(A)(`empty.button.disabled.tooltip`)),1)]),_:1},8,[`heading`,`description`,`button-text`,`button-disabled`])],!0)])):(g(),d(Ee,{key:1},{header:h(()=>[y(`div`,{class:v(t.$style[`filters-row`])},[y(`div`,{class:v(t.$style.filters)},[m(t.$slots,`breadcrumbs`,{},void 0,!0),k.uiConfig.searchEnabled?(g(),d(o(ge),{key:0,ref_key:`search`,ref:I,"model-value":H.value.search,class:v(t.$style.search),placeholder:o(A)(`search.placeholder`,`search.placeholder`),size:`small`,clearable:``,"data-test-id":`resources-list-search`,"onUpdate:modelValue":He},{prefix:h(()=>[l(o(fe),{icon:`search`})]),_:1},8,[`model-value`,`class`,`placeholder`])):i(``,!0),k.uiConfig.sortEnabled?(g(),r(`div`,{key:1,class:v(t.$style[`sort-and-filter`])},[l(o(me),{modelValue:j.value,"onUpdate:modelValue":a[0]||=e=>j.value=e,size:`small`,class:v(t.$style.resourceList),"data-test-id":`resources-list-sort`,onChange:a[1]||=e=>Y(j.value)},{default:h(()=>[(g(!0),r(f,null,ne(e.sortOptions,e=>(g(),d(o(_e),{key:e,"data-test-id":`resources-list-sort-item`,value:e,label:o(A)(`sort.${e}`,`sort.${e}`)},null,8,[`value`,`label`]))),128))]),_:1},8,[`modelValue`,`class`])],2)):i(``,!0),k.uiConfig.showFiltersDropdown?(g(),r(`div`,{key:2,class:v(t.$style[`sort-and-filter`])},[l(we,{keys:U.value,reset:Q,"model-value":H.value,shareable:e.shareable,"just-icon":!0,"onUpdate:modelValue":Le,"onUpdate:filtersLength":Ve},{default:h(e=>[m(t.$slots,`filters`,oe(s(e)),void 0,!0)]),_:3},8,[`keys`,`model-value`,`shareable`]),m(t.$slots,`add-button`,{},void 0,!0)],2)):i(``,!0)],2)],2),m(t.$slots,`callout`,{},void 0,!0),k.uiConfig.showFiltersDropdown?ae((g(),r(`div`,je,[l(o(ue),{bold:!1},{default:h(()=>[_(n(Fe.value?o(A)(`filters.active.shortText`,`filters.active.shortText`):o(A)(`filters.active`,`filters.active`))+` `,1),l(o(he),{"data-test-id":`workflows-filter-reset`,size:`small`,onClick:Q},{default:h(()=>[_(n(o(A)(`filters.active.reset`,`filters.active.reset`)),1)]),_:1})]),_:1})],512)),[[re,M.value]]):i(``,!0),a[4]||=y(`div`,{class:`pb-xs`},null,-1)]),default:h(()=>[m(t.$slots,`preamble`,{},void 0,!0),e.resourcesRefreshing?(g(),r(`div`,Me,[l(o(S),{rows:P.value,"shrink-last":!1},null,8,[`rows`])])):W.value.length>0?(g(),r(`div`,{key:1,ref_key:`listWrapperRef`,ref:L,"data-test-id":`resources-list-wrapper`,class:v(t.$style.listWrapper)},[e.type===`list-full`?(g(),d(o(de),{key:0,"data-test-id":`resources-list`,items:W.value,"item-size":Re(),"item-key":`id`},{default:h(({item:e,updateItemSize:n})=>[m(t.$slots,`default`,{data:e,updateItemSize:n},void 0,!0)]),_:3},8,[`items`,`item-size`])):e.type===`list-paginated`?(g(),r(`div`,{key:1,class:v(t.$style.paginatedListWrapper),"data-test-id":`paginated-list`},[y(`div`,{ref_key:`listItemsRef`,ref:R,class:v(t.$style.listItems)},[(g(!0),r(f,null,ne(e.resources,(e,i)=>(g(),r(`div`,{key:i,class:v(t.$style.listItem)},[m(t.$slots,`item`,{item:e,index:i},()=>[_(n(e),1)],!0)],2))),128))],2),y(`div`,{class:v(t.$style.listPagination)},[l(o(ce),{"current-page":N.value,"onUpdate:currentPage":[a[2]||=e=>N.value=e,X],"page-size":P.value,"onUpdate:pageSize":a[3]||=e=>P.value=e,background:``,total:e.totalItems,"page-sizes":e.availablePageSizeOptions,layout:`total, prev, pager, next, sizes`,"data-test-id":`resources-list-pagination`,onSizeChange:J},null,8,[`current-page`,`page-size`,`total`,`page-sizes`])],2)],2)):i(``,!0),e.type===`datatable`?(g(),d(o(ve),{key:2,"data-test-id":`resources-table`,class:v(t.$style.datatable),columns:ze(),rows:W.value,"current-page":N.value,"rows-per-page":P.value,"onUpdate:currentPage":X,"onUpdate:rowsPerPage":J},{row:h(({columns:e,row:n})=>[m(t.$slots,`default`,{data:n,columns:e},void 0,!0)]),postdata:h(()=>[m(t.$slots,`postdata`,{},void 0,!0)]),_:3},8,[`class`,`columns`,`rows`,`current-page`,`rows-per-page`])):i(``,!0)],2)):q()||H.value.search!==``?(g(),d(o(pe),{key:2,color:`text-base`,size:`medium`,"data-test-id":`resources-list-empty`},{default:h(()=>[_(n(o(A)(`noResults`,`noResults`)),1)]),_:1})):i(``,!0),m(t.$slots,`postamble`,{},void 0,!0)]),_:3}))],64))]),_:3}))}}),[[`__cssModules`,{$style:{"filters-row":`_filters-row_7jrhp_125`,filters:`_filters_7jrhp_125`,"sort-and-filter":`_sort-and-filter_7jrhp_143`,search:`_search_7jrhp_156`,listWrapper:`_listWrapper_7jrhp_169`,paginatedListWrapper:`_paginatedListWrapper_7jrhp_175`,listItems:`_listItems_7jrhp_183`,listPagination:`_listPagination_7jrhp_187`,datatable:`_datatable_7jrhp_214`,resourceList:`_resourceList_7jrhp_219`}}],[`__scopeId`,`data-v-cac35f61`]]);export{j as t};
//# sourceMappingURL=ResourcesListLayout-Dgyw19qu.js.map