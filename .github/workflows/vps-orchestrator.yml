name: ðŸ¤– Deploy Orchestrator VPS

on:
  push:
    branches: [main]
    paths:
      - "orchestration/**"
      - "docker-compose.vps.yml"

jobs:
  deploy-orchestrator:
    name: Deploy â†’ Hostinger Orchestrator
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v6

      - name: ðŸš€ Deploy via SSH
        uses: appleboy/ssh-action@v1
        with:
          host: ${{ secrets.VPS_IP }}
          username: ${{ secrets.VPS_USER }}
          key: ${{ secrets.VPS_SSH_KEY }}
          script: |
            cd /opt/getxo-sailing
            git pull origin main
            docker compose -f docker-compose.vps.yml pull
            docker compose -f docker-compose.vps.yml up -d --build
            docker compose -f docker-compose.vps.yml ps
            echo "âœ… Orchestrator actualizado en Hostinger"
