name: "âš¡ Fast Lane: Parallel Verification"

on:
    push:
        branches: [main, "feature/**", "fix/**"]
    pull_request:
        branches: [main]

jobs:
    fast-scan:
        name: "ðŸš€ Parallel Scan (<30s)"
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4

            - name: "Setup Runtime"
              uses: actions/setup-node@v4
              with:
                  node-version: 22

            - name: "âš¡ Auditor Agent Verification"
              run: |
                  # 1. Install ultra-fast tools (binaries, no full npm install)
                  npm install -g oxlint@latest @biomejs/biome@latest --no-progress --loglevel=error

                  # 2. Run Auditor Agent
                  echo "ðŸ Starting Auditor Agent..."
                  node scripts/auditor-agent.js

    heavy-compute:
        name: "ðŸ—ï¸ Heavy CI (Conditional)"
        needs: fast-scan
        if: github.ref == 'refs/heads/main'
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - name: "Full Build & Test"
              run: |
                  echo "ðŸ› ï¸ Starting heavy compute tasks..."
                  # AquÃ­ irÃ­a el npm install y next build real
                  # Solo se lanza si el Fast Scan pasa y estamos en main
                  echo "âœ… Full CI completed"
